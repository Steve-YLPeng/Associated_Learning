total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 23.35848045349121
Start Training
gc 0
Train Epoch0 Acc 0.501925 (20077/40000), AUC 0.5041981935501099
ep0_train_time 11.05416464805603
Test Epoch0 layer0 Acc 0.8098, AUC 0.8946231603622437, avg_entr 0.5452430844306946, f1 0.8098000288009644
ep0_l0_test_time 0.6113677024841309
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.7058, AUC 0.8776358366012573, avg_entr 0.6782867908477783, f1 0.7057999968528748
ep0_l1_test_time 0.6232726573944092
Test Epoch0 layer2 Acc 0.558, AUC 0.8295767307281494, avg_entr 0.6852543354034424, f1 0.5580000281333923
ep0_l2_test_time 0.5803344249725342
Test Epoch0 layer3 Acc 0.5512, AUC 0.8652467727661133, avg_entr 0.6774506568908691, f1 0.5511999726295471
ep0_l3_test_time 0.5624518394470215
Test Epoch0 layer4 Acc 0.5002, AUC 0.8221144676208496, avg_entr 0.6826150417327881, f1 0.5001999735832214
ep0_l4_test_time 0.5659291744232178
gc 0
Train Epoch1 Acc 0.825225 (33009/40000), AUC 0.9062185883522034
ep1_train_time 6.6527099609375
Test Epoch1 layer0 Acc 0.8798, AUC 0.945489764213562, avg_entr 0.28493452072143555, f1 0.879800021648407
ep1_l0_test_time 0.5722973346710205
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8826, AUC 0.9465240240097046, avg_entr 0.32863280177116394, f1 0.8826000094413757
ep1_l1_test_time 0.5785641670227051
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8818, AUC 0.9466032981872559, avg_entr 0.23858222365379333, f1 0.8818000555038452
ep1_l2_test_time 0.5920343399047852
Test Epoch1 layer3 Acc 0.8816, AUC 0.9465882778167725, avg_entr 0.23364540934562683, f1 0.881600022315979
ep1_l3_test_time 0.5828642845153809
Test Epoch1 layer4 Acc 0.8826, AUC 0.9465545415878296, avg_entr 0.22715702652931213, f1 0.8826000094413757
ep1_l4_test_time 0.5768799781799316
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.90655 (36262/40000), AUC 0.9655637145042419
ep2_train_time 6.637166976928711
Test Epoch2 layer0 Acc 0.874, AUC 0.9553362131118774, avg_entr 0.220481276512146, f1 0.8740000128746033
ep2_l0_test_time 0.557537317276001
Test Epoch2 layer1 Acc 0.8756, AUC 0.95595383644104, avg_entr 0.2124500274658203, f1 0.8756000399589539
ep2_l1_test_time 0.5553104877471924
Test Epoch2 layer2 Acc 0.8712, AUC 0.9560847282409668, avg_entr 0.18687008321285248, f1 0.8712000846862793
ep2_l2_test_time 0.5617647171020508
Test Epoch2 layer3 Acc 0.869, AUC 0.9561243653297424, avg_entr 0.1738642156124115, f1 0.8690000176429749
ep2_l3_test_time 0.5628139972686768
Test Epoch2 layer4 Acc 0.8682, AUC 0.9561033248901367, avg_entr 0.15777824819087982, f1 0.8682000041007996
ep2_l4_test_time 0.560213565826416
gc 0
Train Epoch3 Acc 0.924525 (36981/40000), AUC 0.976077139377594
ep3_train_time 6.600581884384155
Test Epoch3 layer0 Acc 0.895, AUC 0.9581784009933472, avg_entr 0.19411739706993103, f1 0.8949999809265137
ep3_l0_test_time 0.5602445602416992
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.8964, AUC 0.9585154056549072, avg_entr 0.1806936264038086, f1 0.896399974822998
ep3_l1_test_time 0.559361457824707
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer2 Acc 0.8966, AUC 0.958734393119812, avg_entr 0.16223908960819244, f1 0.8966000080108643
ep3_l2_test_time 0.5634233951568604
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer3 Acc 0.8956, AUC 0.9587275981903076, avg_entr 0.1463211476802826, f1 0.8956000208854675
ep3_l3_test_time 0.5641298294067383
Test Epoch3 layer4 Acc 0.8966, AUC 0.9588064551353455, avg_entr 0.12463172525167465, f1 0.8966000080108643
ep3_l4_test_time 0.5585811138153076
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9362 (37448/40000), AUC 0.9821273684501648
ep4_train_time 6.486143350601196
Test Epoch4 layer0 Acc 0.8984, AUC 0.9590191841125488, avg_entr 0.17725898325443268, f1 0.8984000086784363
ep4_l0_test_time 0.5585541725158691
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.8982, AUC 0.9594135284423828, avg_entr 0.16283470392227173, f1 0.8981999754905701
ep4_l1_test_time 0.5594370365142822
Test Epoch4 layer2 Acc 0.8984, AUC 0.9597756862640381, avg_entr 0.14796525239944458, f1 0.8984000086784363
ep4_l2_test_time 0.5581262111663818
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer3 Acc 0.8988, AUC 0.9600590467453003, avg_entr 0.12474402040243149, f1 0.8988000154495239
ep4_l3_test_time 0.5649001598358154
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer4 Acc 0.898, AUC 0.9603724479675293, avg_entr 0.09372507035732269, f1 0.8980000019073486
ep4_l4_test_time 0.5824856758117676
gc 0
Train Epoch5 Acc 0.94345 (37738/40000), AUC 0.9853677153587341
ep5_train_time 6.567099571228027
Test Epoch5 layer0 Acc 0.8778, AUC 0.9582169055938721, avg_entr 0.17117050290107727, f1 0.8778000473976135
ep5_l0_test_time 0.5570485591888428
Test Epoch5 layer1 Acc 0.8844, AUC 0.9587897658348083, avg_entr 0.15602070093154907, f1 0.8844000101089478
ep5_l1_test_time 0.556466817855835
Test Epoch5 layer2 Acc 0.8798, AUC 0.9592412114143372, avg_entr 0.14254704117774963, f1 0.879800021648407
ep5_l2_test_time 0.5601458549499512
Test Epoch5 layer3 Acc 0.8756, AUC 0.9596717357635498, avg_entr 0.11664745211601257, f1 0.8756000399589539
ep5_l3_test_time 0.5587224960327148
Test Epoch5 layer4 Acc 0.8788, AUC 0.9594467878341675, avg_entr 0.07927550375461578, f1 0.8787999749183655
ep5_l4_test_time 0.5612690448760986
gc 0
Train Epoch6 Acc 0.9474 (37896/40000), AUC 0.9876940846443176
ep6_train_time 6.4017908573150635
Test Epoch6 layer0 Acc 0.8992, AUC 0.9570919275283813, avg_entr 0.15293873846530914, f1 0.8992000222206116
ep6_l0_test_time 0.5595476627349854
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 6
Test Epoch6 layer1 Acc 0.8988, AUC 0.957466185092926, avg_entr 0.13805224001407623, f1 0.8988000154495239
ep6_l1_test_time 0.5601112842559814
Test Epoch6 layer2 Acc 0.8994, AUC 0.958173394203186, avg_entr 0.12071876227855682, f1 0.8993999361991882
ep6_l2_test_time 0.5647683143615723
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 6
Test Epoch6 layer3 Acc 0.898, AUC 0.958981454372406, avg_entr 0.08505526930093765, f1 0.8980000019073486
ep6_l3_test_time 0.5708372592926025
Test Epoch6 layer4 Acc 0.8978, AUC 0.9576421976089478, avg_entr 0.05221901834011078, f1 0.8978000283241272
ep6_l4_test_time 0.5732786655426025
gc 0
Train Epoch7 Acc 0.955125 (38205/40000), AUC 0.9897204637527466
ep7_train_time 6.5021812915802
Test Epoch7 layer0 Acc 0.898, AUC 0.9556511044502258, avg_entr 0.14504274725914001, f1 0.8980000019073486
ep7_l0_test_time 0.5572676658630371
Test Epoch7 layer1 Acc 0.899, AUC 0.9561638832092285, avg_entr 0.1303674429655075, f1 0.8989999890327454
ep7_l1_test_time 0.5599372386932373
Test Epoch7 layer2 Acc 0.8986, AUC 0.9570733308792114, avg_entr 0.11140848696231842, f1 0.8985999822616577
ep7_l2_test_time 0.5658142566680908
Test Epoch7 layer3 Acc 0.8966, AUC 0.9578090310096741, avg_entr 0.06919045001268387, f1 0.8966000080108643
ep7_l3_test_time 0.5586032867431641
Test Epoch7 layer4 Acc 0.8962, AUC 0.9554117918014526, avg_entr 0.040112968534231186, f1 0.8962000012397766
ep7_l4_test_time 0.5614883899688721
gc 0
Train Epoch8 Acc 0.9589 (38356/40000), AUC 0.9910820722579956
ep8_train_time 6.797256946563721
Test Epoch8 layer0 Acc 0.8884, AUC 0.9535384178161621, avg_entr 0.1403317004442215, f1 0.8884000182151794
ep8_l0_test_time 0.6146435737609863
Test Epoch8 layer1 Acc 0.8902, AUC 0.9543341398239136, avg_entr 0.125468447804451, f1 0.8902000188827515
ep8_l1_test_time 0.6177380084991455
Test Epoch8 layer2 Acc 0.8896, AUC 0.9554975032806396, avg_entr 0.10611189901828766, f1 0.8895999193191528
ep8_l2_test_time 0.6059751510620117
Test Epoch8 layer3 Acc 0.8886, AUC 0.9554921984672546, avg_entr 0.06149723380804062, f1 0.8885999917984009
ep8_l3_test_time 0.6048436164855957
Test Epoch8 layer4 Acc 0.8888, AUC 0.9501999616622925, avg_entr 0.03705320879817009, f1 0.8888000249862671
ep8_l4_test_time 0.5639777183532715
gc 0
Train Epoch9 Acc 0.964225 (38569/40000), AUC 0.9926084876060486
ep9_train_time 6.818670988082886
Test Epoch9 layer0 Acc 0.892, AUC 0.952674150466919, avg_entr 0.13587231934070587, f1 0.8920000195503235
ep9_l0_test_time 0.5597243309020996
Test Epoch9 layer1 Acc 0.8912, AUC 0.9533637762069702, avg_entr 0.12122585624456406, f1 0.8912000060081482
ep9_l1_test_time 0.5582499504089355
Test Epoch9 layer2 Acc 0.8888, AUC 0.9544745683670044, avg_entr 0.10030093044042587, f1 0.8888000249862671
ep9_l2_test_time 0.5607266426086426
Test Epoch9 layer3 Acc 0.8912, AUC 0.9543809294700623, avg_entr 0.05634550005197525, f1 0.8912000060081482
ep9_l3_test_time 0.5620837211608887
Test Epoch9 layer4 Acc 0.891, AUC 0.9490981101989746, avg_entr 0.03473254665732384, f1 0.890999972820282
ep9_l4_test_time 0.5607373714447021
gc 0
Train Epoch10 Acc 0.96535 (38614/40000), AUC 0.9933395385742188
ep10_train_time 6.609971523284912
Test Epoch10 layer0 Acc 0.8904, AUC 0.9516087770462036, avg_entr 0.1322658658027649, f1 0.8903999924659729
ep10_l0_test_time 0.6007983684539795
Test Epoch10 layer1 Acc 0.891, AUC 0.9524030685424805, avg_entr 0.11774765700101852, f1 0.890999972820282
ep10_l1_test_time 0.5645647048950195
Test Epoch10 layer2 Acc 0.89, AUC 0.9535556435585022, avg_entr 0.09609250724315643, f1 0.8899999856948853
ep10_l2_test_time 0.5589563846588135
Test Epoch10 layer3 Acc 0.89, AUC 0.9529484510421753, avg_entr 0.05001519247889519, f1 0.8899999856948853
ep10_l3_test_time 0.56243896484375
Test Epoch10 layer4 Acc 0.8902, AUC 0.9493606686592102, avg_entr 0.030575711280107498, f1 0.8902000188827515
ep10_l4_test_time 0.5630080699920654
gc 0
Train Epoch11 Acc 0.96655 (38662/40000), AUC 0.9937717914581299
ep11_train_time 6.777011156082153
Test Epoch11 layer0 Acc 0.8888, AUC 0.9505614638328552, avg_entr 0.13019666075706482, f1 0.8888000249862671
ep11_l0_test_time 0.5616312026977539
Test Epoch11 layer1 Acc 0.889, AUC 0.9513452053070068, avg_entr 0.11595763266086578, f1 0.8889999985694885
ep11_l1_test_time 0.5609972476959229
Test Epoch11 layer2 Acc 0.887, AUC 0.9524586200714111, avg_entr 0.0941663607954979, f1 0.8870000243186951
ep11_l2_test_time 0.563178300857544
Test Epoch11 layer3 Acc 0.8886, AUC 0.9510289430618286, avg_entr 0.04819103702902794, f1 0.8885999917984009
ep11_l3_test_time 0.5584394931793213
Test Epoch11 layer4 Acc 0.8878, AUC 0.9482966065406799, avg_entr 0.02990315482020378, f1 0.8877999782562256
ep11_l4_test_time 0.5662698745727539
gc 0
Train Epoch12 Acc 0.968675 (38747/40000), AUC 0.9944778084754944
ep12_train_time 6.772608280181885
Test Epoch12 layer0 Acc 0.8804, AUC 0.9489137530326843, avg_entr 0.12591595947742462, f1 0.8804000020027161
ep12_l0_test_time 0.5589852333068848
Test Epoch12 layer1 Acc 0.886, AUC 0.9498369097709656, avg_entr 0.11178215593099594, f1 0.8859999775886536
ep12_l1_test_time 0.5747206211090088
Test Epoch12 layer2 Acc 0.8858, AUC 0.950851321220398, avg_entr 0.08743412792682648, f1 0.8858000040054321
ep12_l2_test_time 0.5873227119445801
Test Epoch12 layer3 Acc 0.8814, AUC 0.9487185478210449, avg_entr 0.042410045862197876, f1 0.8813999891281128
ep12_l3_test_time 0.5917577743530273
Test Epoch12 layer4 Acc 0.8842, AUC 0.9477323293685913, avg_entr 0.02725277654826641, f1 0.8842000365257263
ep12_l4_test_time 0.5964231491088867
gc 0
Train Epoch13 Acc 0.97025 (38810/40000), AUC 0.9948951005935669
ep13_train_time 6.8102617263793945
Test Epoch13 layer0 Acc 0.8872, AUC 0.9486091732978821, avg_entr 0.12441159784793854, f1 0.8871999979019165
ep13_l0_test_time 0.5568346977233887
Test Epoch13 layer1 Acc 0.8872, AUC 0.9495120644569397, avg_entr 0.11017036437988281, f1 0.8871999979019165
ep13_l1_test_time 0.5557398796081543
Test Epoch13 layer2 Acc 0.8866, AUC 0.9505503177642822, avg_entr 0.08637946099042892, f1 0.8866000771522522
ep13_l2_test_time 0.5612406730651855
Test Epoch13 layer3 Acc 0.8872, AUC 0.9483906626701355, avg_entr 0.04093017056584358, f1 0.8871999979019165
ep13_l3_test_time 0.5609803199768066
Test Epoch13 layer4 Acc 0.8874, AUC 0.9469642639160156, avg_entr 0.025188736617565155, f1 0.8873999714851379
ep13_l4_test_time 0.5702295303344727
gc 0
Train Epoch14 Acc 0.971 (38840/40000), AUC 0.9949878454208374
ep14_train_time 6.524288177490234
Test Epoch14 layer0 Acc 0.8842, AUC 0.9477843046188354, avg_entr 0.12461986392736435, f1 0.8842000365257263
ep14_l0_test_time 0.580155611038208
Test Epoch14 layer1 Acc 0.8854, AUC 0.9487714767456055, avg_entr 0.11058874428272247, f1 0.8853999972343445
ep14_l1_test_time 0.5584993362426758
Test Epoch14 layer2 Acc 0.8846, AUC 0.9497923851013184, avg_entr 0.08770551532506943, f1 0.8845999836921692
ep14_l2_test_time 0.5821709632873535
Test Epoch14 layer3 Acc 0.886, AUC 0.9473608732223511, avg_entr 0.042348895221948624, f1 0.8859999775886536
ep14_l3_test_time 0.564633846282959
Test Epoch14 layer4 Acc 0.8862, AUC 0.9453456401824951, avg_entr 0.02739853225648403, f1 0.8862000107765198
ep14_l4_test_time 0.5724895000457764
gc 0
Train Epoch15 Acc 0.9717 (38868/40000), AUC 0.9953852891921997
ep15_train_time 6.882283449172974
Test Epoch15 layer0 Acc 0.8848, AUC 0.9474362134933472, avg_entr 0.12346602976322174, f1 0.8848000168800354
ep15_l0_test_time 0.5557186603546143
Test Epoch15 layer1 Acc 0.885, AUC 0.9484177231788635, avg_entr 0.1092110127210617, f1 0.8849999904632568
ep15_l1_test_time 0.5563876628875732
Test Epoch15 layer2 Acc 0.8856, AUC 0.9494485855102539, avg_entr 0.08572026342153549, f1 0.8855999708175659
ep15_l2_test_time 0.5565509796142578
Test Epoch15 layer3 Acc 0.8854, AUC 0.9463311433792114, avg_entr 0.041081156581640244, f1 0.8853999972343445
ep15_l3_test_time 0.5746886730194092
Test Epoch15 layer4 Acc 0.885, AUC 0.9437788128852844, avg_entr 0.026427634060382843, f1 0.8849999904632568
ep15_l4_test_time 0.5629193782806396
gc 0
Train Epoch16 Acc 0.972225 (38889/40000), AUC 0.9956583380699158
ep16_train_time 6.520711898803711
Test Epoch16 layer0 Acc 0.8802, AUC 0.9465295076370239, avg_entr 0.12001538276672363, f1 0.8802000284194946
ep16_l0_test_time 0.5572378635406494
Test Epoch16 layer1 Acc 0.8826, AUC 0.9475623369216919, avg_entr 0.10625407844781876, f1 0.8826000094413757
ep16_l1_test_time 0.5567970275878906
Test Epoch16 layer2 Acc 0.8836, AUC 0.9485316276550293, avg_entr 0.0820070281624794, f1 0.8835999965667725
ep16_l2_test_time 0.5587751865386963
Test Epoch16 layer3 Acc 0.8832, AUC 0.9451601505279541, avg_entr 0.037690170109272, f1 0.8831999897956848
ep16_l3_test_time 0.5626134872436523
Test Epoch16 layer4 Acc 0.884, AUC 0.9454778432846069, avg_entr 0.023753415793180466, f1 0.8840000033378601
ep16_l4_test_time 0.5600016117095947
gc 0
Train Epoch17 Acc 0.972725 (38909/40000), AUC 0.9957756996154785
ep17_train_time 6.5919883251190186
Test Epoch17 layer0 Acc 0.8832, AUC 0.9464095234870911, avg_entr 0.1201024204492569, f1 0.8831999897956848
ep17_l0_test_time 0.5596976280212402
Test Epoch17 layer1 Acc 0.8848, AUC 0.9474679231643677, avg_entr 0.10648283362388611, f1 0.8848000168800354
ep17_l1_test_time 0.5562593936920166
Test Epoch17 layer2 Acc 0.8842, AUC 0.9484388828277588, avg_entr 0.08241577446460724, f1 0.8842000365257263
ep17_l2_test_time 0.5602891445159912
Test Epoch17 layer3 Acc 0.8848, AUC 0.9450927972793579, avg_entr 0.03732973709702492, f1 0.8848000168800354
ep17_l3_test_time 0.5631718635559082
Test Epoch17 layer4 Acc 0.8836, AUC 0.9453305006027222, avg_entr 0.0236111581325531, f1 0.8835999965667725
ep17_l4_test_time 0.5715045928955078
gc 0
Train Epoch18 Acc 0.9734 (38936/40000), AUC 0.9958299398422241
ep18_train_time 6.7475340366363525
Test Epoch18 layer0 Acc 0.8826, AUC 0.9460468888282776, avg_entr 0.11990916728973389, f1 0.8826000094413757
ep18_l0_test_time 0.5599606037139893
Test Epoch18 layer1 Acc 0.8832, AUC 0.9471546411514282, avg_entr 0.10625182837247849, f1 0.8831999897956848
ep18_l1_test_time 0.575537919998169
Test Epoch18 layer2 Acc 0.882, AUC 0.9481307864189148, avg_entr 0.08198215067386627, f1 0.8820000290870667
ep18_l2_test_time 0.5736804008483887
Test Epoch18 layer3 Acc 0.8836, AUC 0.9443754553794861, avg_entr 0.03812505304813385, f1 0.8835999965667725
ep18_l3_test_time 0.5679450035095215
Test Epoch18 layer4 Acc 0.8832, AUC 0.9433078169822693, avg_entr 0.024688024073839188, f1 0.8831999897956848
ep18_l4_test_time 0.56974196434021
gc 0
Train Epoch19 Acc 0.972975 (38919/40000), AUC 0.9959671497344971
ep19_train_time 6.555258512496948
Test Epoch19 layer0 Acc 0.8818, AUC 0.9457911252975464, avg_entr 0.11838684976100922, f1 0.8818000555038452
ep19_l0_test_time 0.5628116130828857
Test Epoch19 layer1 Acc 0.8828, AUC 0.9469492435455322, avg_entr 0.10481071472167969, f1 0.8827999830245972
ep19_l1_test_time 0.5581014156341553
Test Epoch19 layer2 Acc 0.8826, AUC 0.9478946924209595, avg_entr 0.08025214076042175, f1 0.8826000094413757
ep19_l2_test_time 0.5640323162078857
Test Epoch19 layer3 Acc 0.883, AUC 0.9440226554870605, avg_entr 0.03594840317964554, f1 0.8830000162124634
ep19_l3_test_time 0.5606741905212402
Test Epoch19 layer4 Acc 0.8826, AUC 0.9450293779373169, avg_entr 0.02290317229926586, f1 0.8826000094413757
ep19_l4_test_time 0.5627877712249756
gc 0
Train Epoch20 Acc 0.97405 (38962/40000), AUC 0.9960929155349731
ep20_train_time 6.561949014663696
Test Epoch20 layer0 Acc 0.8818, AUC 0.9455708265304565, avg_entr 0.1183324083685875, f1 0.8818000555038452
ep20_l0_test_time 0.5590803623199463
Test Epoch20 layer1 Acc 0.8822, AUC 0.9467020630836487, avg_entr 0.10435868054628372, f1 0.8822000026702881
ep20_l1_test_time 0.5558218955993652
Test Epoch20 layer2 Acc 0.8824, AUC 0.9476293325424194, avg_entr 0.07985889911651611, f1 0.8823999762535095
ep20_l2_test_time 0.5579714775085449
Test Epoch20 layer3 Acc 0.8822, AUC 0.9440695643424988, avg_entr 0.03705810755491257, f1 0.8822000026702881
ep20_l3_test_time 0.5623984336853027
Test Epoch20 layer4 Acc 0.883, AUC 0.9450410604476929, avg_entr 0.024189427495002747, f1 0.8830000162124634
ep20_l4_test_time 0.5593998432159424
gc 0
Train Epoch21 Acc 0.974525 (38981/40000), AUC 0.9960800409317017
ep21_train_time 6.5413291454315186
Test Epoch21 layer0 Acc 0.8816, AUC 0.9453904628753662, avg_entr 0.11736706644296646, f1 0.881600022315979
ep21_l0_test_time 0.5641069412231445
Test Epoch21 layer1 Acc 0.882, AUC 0.9464923739433289, avg_entr 0.10369796305894852, f1 0.8820000290870667
ep21_l1_test_time 0.5703394412994385
Test Epoch21 layer2 Acc 0.8822, AUC 0.9474226236343384, avg_entr 0.0794040784239769, f1 0.8822000026702881
ep21_l2_test_time 0.5555925369262695
Test Epoch21 layer3 Acc 0.8822, AUC 0.9437059164047241, avg_entr 0.03675975278019905, f1 0.8822000026702881
ep21_l3_test_time 0.6062324047088623
Test Epoch21 layer4 Acc 0.8826, AUC 0.943512499332428, avg_entr 0.02390434220433235, f1 0.8826000094413757
ep21_l4_test_time 0.5594706535339355
gc 0
Train Epoch22 Acc 0.974125 (38965/40000), AUC 0.9960588216781616
ep22_train_time 6.5700438022613525
Test Epoch22 layer0 Acc 0.8812, AUC 0.9452289938926697, avg_entr 0.1174606904387474, f1 0.8812000155448914
ep22_l0_test_time 0.5570309162139893
Test Epoch22 layer1 Acc 0.8824, AUC 0.9463566541671753, avg_entr 0.1037142351269722, f1 0.8823999762535095
ep22_l1_test_time 0.5530581474304199
Test Epoch22 layer2 Acc 0.8812, AUC 0.9472992420196533, avg_entr 0.07949905097484589, f1 0.8812000155448914
ep22_l2_test_time 0.5573623180389404
Test Epoch22 layer3 Acc 0.8822, AUC 0.943774938583374, avg_entr 0.036931201815605164, f1 0.8822000026702881
ep22_l3_test_time 0.5600950717926025
Test Epoch22 layer4 Acc 0.8822, AUC 0.943901002407074, avg_entr 0.024303913116455078, f1 0.8822000026702881
ep22_l4_test_time 0.5617473125457764
gc 0
Train Epoch23 Acc 0.97475 (38990/40000), AUC 0.9961879253387451
ep23_train_time 6.581166982650757
Test Epoch23 layer0 Acc 0.88, AUC 0.9450560808181763, avg_entr 0.11695859581232071, f1 0.8799999952316284
ep23_l0_test_time 0.5605013370513916
Test Epoch23 layer1 Acc 0.8812, AUC 0.9461880922317505, avg_entr 0.10317304730415344, f1 0.8812000155448914
ep23_l1_test_time 0.5571506023406982
Test Epoch23 layer2 Acc 0.881, AUC 0.9471078515052795, avg_entr 0.07885362207889557, f1 0.8809999823570251
ep23_l2_test_time 0.5570967197418213
Test Epoch23 layer3 Acc 0.8818, AUC 0.9436289072036743, avg_entr 0.036692939698696136, f1 0.8818000555038452
ep23_l3_test_time 0.5642352104187012
Test Epoch23 layer4 Acc 0.8814, AUC 0.9440879821777344, avg_entr 0.02440541610121727, f1 0.8813999891281128
ep23_l4_test_time 0.5630896091461182
gc 0
Train Epoch24 Acc 0.974725 (38989/40000), AUC 0.9961753487586975
ep24_train_time 6.593306303024292
Test Epoch24 layer0 Acc 0.881, AUC 0.9448946714401245, avg_entr 0.11563073843717575, f1 0.8809999823570251
ep24_l0_test_time 0.5791795253753662
Test Epoch24 layer1 Acc 0.881, AUC 0.9460374712944031, avg_entr 0.10200676321983337, f1 0.8809999823570251
ep24_l1_test_time 0.5587215423583984
Test Epoch24 layer2 Acc 0.8812, AUC 0.9469373226165771, avg_entr 0.07762666046619415, f1 0.8812000155448914
ep24_l2_test_time 0.5730321407318115
Test Epoch24 layer3 Acc 0.8812, AUC 0.9432586431503296, avg_entr 0.03529716655611992, f1 0.8812000155448914
ep24_l3_test_time 0.5596714019775391
Test Epoch24 layer4 Acc 0.882, AUC 0.9436628222465515, avg_entr 0.022920383140444756, f1 0.8820000290870667
ep24_l4_test_time 0.5589599609375
gc 0
Train Epoch25 Acc 0.9745 (38980/40000), AUC 0.9963354468345642
ep25_train_time 6.552613973617554
Test Epoch25 layer0 Acc 0.8806, AUC 0.9447745680809021, avg_entr 0.11490242928266525, f1 0.8805999755859375
ep25_l0_test_time 0.5583629608154297
Test Epoch25 layer1 Acc 0.8812, AUC 0.9459228515625, avg_entr 0.1012541651725769, f1 0.8812000155448914
ep25_l1_test_time 0.5561633110046387
Test Epoch25 layer2 Acc 0.881, AUC 0.9467912912368774, avg_entr 0.07678233087062836, f1 0.8809999823570251
ep25_l2_test_time 0.5628764629364014
Test Epoch25 layer3 Acc 0.8816, AUC 0.9429947733879089, avg_entr 0.03452379256486893, f1 0.881600022315979
ep25_l3_test_time 0.5627098083496094
Test Epoch25 layer4 Acc 0.8822, AUC 0.9435548782348633, avg_entr 0.022039808332920074, f1 0.8822000026702881
ep25_l4_test_time 0.5590314865112305
gc 0
Train Epoch26 Acc 0.974375 (38975/40000), AUC 0.9963396191596985
ep26_train_time 6.58642578125
Test Epoch26 layer0 Acc 0.88, AUC 0.9447823762893677, avg_entr 0.11511353403329849, f1 0.8799999952316284
ep26_l0_test_time 0.5616104602813721
Test Epoch26 layer1 Acc 0.8812, AUC 0.9459203481674194, avg_entr 0.10147219896316528, f1 0.8812000155448914
ep26_l1_test_time 0.5548772811889648
Test Epoch26 layer2 Acc 0.881, AUC 0.9468345642089844, avg_entr 0.07709569483995438, f1 0.8809999823570251
ep26_l2_test_time 0.5581135749816895
Test Epoch26 layer3 Acc 0.8816, AUC 0.9429128170013428, avg_entr 0.03540487214922905, f1 0.881600022315979
ep26_l3_test_time 0.5571751594543457
Test Epoch26 layer4 Acc 0.8816, AUC 0.9431048631668091, avg_entr 0.02324248105287552, f1 0.881600022315979
ep26_l4_test_time 0.566849946975708
gc 0
Train Epoch27 Acc 0.9748 (38992/40000), AUC 0.9963165521621704
ep27_train_time 6.607429504394531
Test Epoch27 layer0 Acc 0.8808, AUC 0.944689929485321, avg_entr 0.11400555074214935, f1 0.8808000087738037
ep27_l0_test_time 0.582815408706665
Test Epoch27 layer1 Acc 0.8812, AUC 0.9458248615264893, avg_entr 0.10044261813163757, f1 0.8812000155448914
ep27_l1_test_time 0.5588803291320801
Test Epoch27 layer2 Acc 0.8812, AUC 0.9467057585716248, avg_entr 0.07591531425714493, f1 0.8812000155448914
ep27_l2_test_time 0.5790195465087891
Test Epoch27 layer3 Acc 0.8812, AUC 0.9427820444107056, avg_entr 0.03395239636301994, f1 0.8812000155448914
ep27_l3_test_time 0.5832452774047852
Test Epoch27 layer4 Acc 0.881, AUC 0.9437572956085205, avg_entr 0.02177247405052185, f1 0.8809999823570251
ep27_l4_test_time 0.563610315322876
gc 0
Train Epoch28 Acc 0.974775 (38991/40000), AUC 0.99639892578125
ep28_train_time 6.5487916469573975
Test Epoch28 layer0 Acc 0.8796, AUC 0.9446649551391602, avg_entr 0.11424962431192398, f1 0.8795999884605408
ep28_l0_test_time 0.5575096607208252
Test Epoch28 layer1 Acc 0.8814, AUC 0.9458030462265015, avg_entr 0.10063452273607254, f1 0.8813999891281128
ep28_l1_test_time 0.5575511455535889
Test Epoch28 layer2 Acc 0.881, AUC 0.9467161893844604, avg_entr 0.07638105750083923, f1 0.8809999823570251
ep28_l2_test_time 0.5571835041046143
Test Epoch28 layer3 Acc 0.8816, AUC 0.9430456161499023, avg_entr 0.035020679235458374, f1 0.881600022315979
ep28_l3_test_time 0.5619323253631592
Test Epoch28 layer4 Acc 0.8814, AUC 0.943953812122345, avg_entr 0.023070696741342545, f1 0.8813999891281128
ep28_l4_test_time 0.5610237121582031
gc 0
Train Epoch29 Acc 0.975 (39000/40000), AUC 0.9964044094085693
ep29_train_time 6.688778400421143
Test Epoch29 layer0 Acc 0.88, AUC 0.9445990324020386, avg_entr 0.11331293731927872, f1 0.8799999952316284
ep29_l0_test_time 0.5702764987945557
Test Epoch29 layer1 Acc 0.8808, AUC 0.9457303285598755, avg_entr 0.09974492341279984, f1 0.8808000087738037
ep29_l1_test_time 0.5656325817108154
Test Epoch29 layer2 Acc 0.8806, AUC 0.946616530418396, avg_entr 0.07530181854963303, f1 0.8805999755859375
ep29_l2_test_time 0.5722963809967041
Test Epoch29 layer3 Acc 0.8806, AUC 0.9427093267440796, avg_entr 0.033638324588537216, f1 0.8805999755859375
ep29_l3_test_time 0.5698766708374023
Test Epoch29 layer4 Acc 0.881, AUC 0.9433988928794861, avg_entr 0.02158677577972412, f1 0.8809999823570251
ep29_l4_test_time 0.5713906288146973
Best AUC tensor(0.8994) 6 1
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 290.27320551872253
Start Testing
Load ckpt at ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.891, AUC 0.953396201133728, avg_entr 0.1553589403629303, f1 0.890999972820282
l0_test_time 0.5624675750732422
Test layer1 Acc 0.8902, AUC 0.9536292552947998, avg_entr 0.14125198125839233, f1 0.8902000188827515
l1_test_time 0.5646460056304932
Test layer2 Acc 0.891, AUC 0.9543549418449402, avg_entr 0.12528002262115479, f1 0.890999972820282
l2_test_time 0.5667312145233154
Test layer3 Acc 0.8918, AUC 0.9552550315856934, avg_entr 0.09061422199010849, f1 0.8917999863624573
l3_test_time 0.5666346549987793
Test layer4 Acc 0.89, AUC 0.9529317021369934, avg_entr 0.05749092996120453, f1 0.8899999856948853
l4_test_time 0.5669565200805664
