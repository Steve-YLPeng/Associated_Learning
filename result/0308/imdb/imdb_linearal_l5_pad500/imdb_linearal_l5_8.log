total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 23.0255389213562
Start Training
gc 0
Train Epoch0 Acc 0.5169 (20676/40000), AUC 0.5258204936981201
ep0_train_time 12.00358271598816
Test Epoch0 layer0 Acc 0.792, AUC 0.8827525973320007, avg_entr 0.5736154317855835, f1 0.7920000553131104
ep0_l0_test_time 0.74613356590271
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.6742, AUC 0.851757287979126, avg_entr 0.6877659559249878, f1 0.6741999983787537
ep0_l1_test_time 0.739708662033081
Test Epoch0 layer2 Acc 0.6096, AUC 0.7882309556007385, avg_entr 0.6896757483482361, f1 0.6096000075340271
ep0_l2_test_time 0.74312424659729
Test Epoch0 layer3 Acc 0.509, AUC 0.7116565108299255, avg_entr 0.6907679438591003, f1 0.5090000033378601
ep0_l3_test_time 0.7475965023040771
Test Epoch0 layer4 Acc 0.525, AUC 0.7877655625343323, avg_entr 0.688850998878479, f1 0.5249999761581421
ep0_l4_test_time 0.7655136585235596
gc 0
Train Epoch1 Acc 0.7967 (31868/40000), AUC 0.8837978839874268
ep1_train_time 10.998145341873169
Test Epoch1 layer0 Acc 0.8624, AUC 0.9439741373062134, avg_entr 0.2873132526874542, f1 0.8623999953269958
ep1_l0_test_time 0.7272107601165771
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8694, AUC 0.9446530938148499, avg_entr 0.37727096676826477, f1 0.8694000244140625
ep1_l1_test_time 0.7546355724334717
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8808, AUC 0.945327877998352, avg_entr 0.24088630080223083, f1 0.8808000087738037
ep1_l2_test_time 0.7566986083984375
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.88, AUC 0.9456865787506104, avg_entr 0.24530288577079773, f1 0.8799999952316284
ep1_l3_test_time 0.7710776329040527
Test Epoch1 layer4 Acc 0.876, AUC 0.9452615976333618, avg_entr 0.23827433586120605, f1 0.8760000467300415
ep1_l4_test_time 0.751997709274292
gc 0
Train Epoch2 Acc 0.900075 (36003/40000), AUC 0.9623363614082336
ep2_train_time 10.972123146057129
Test Epoch2 layer0 Acc 0.8914, AUC 0.9549089074134827, avg_entr 0.23083384335041046, f1 0.8913999795913696
ep2_l0_test_time 0.7498674392700195
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8928, AUC 0.9557589292526245, avg_entr 0.22835087776184082, f1 0.892799973487854
ep2_l1_test_time 0.7445540428161621
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.8936, AUC 0.9559417963027954, avg_entr 0.19603189826011658, f1 0.8935999870300293
ep2_l2_test_time 0.7643640041351318
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer3 Acc 0.8946, AUC 0.9561041593551636, avg_entr 0.19215553998947144, f1 0.894599974155426
ep2_l3_test_time 0.7415580749511719
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer4 Acc 0.8946, AUC 0.9561144113540649, avg_entr 0.173818439245224, f1 0.894599974155426
ep2_l4_test_time 0.7432971000671387
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.92345 (36938/40000), AUC 0.975537896156311
ep3_train_time 8.815557479858398
Test Epoch3 layer0 Acc 0.887, AUC 0.9585236310958862, avg_entr 0.19163285195827484, f1 0.8870000243186951
ep3_l0_test_time 0.5551841259002686
Test Epoch3 layer1 Acc 0.892, AUC 0.9590068459510803, avg_entr 0.18214018642902374, f1 0.8920000195503235
ep3_l1_test_time 0.5544567108154297
Test Epoch3 layer2 Acc 0.8904, AUC 0.9591478109359741, avg_entr 0.15596887469291687, f1 0.8903999924659729
ep3_l2_test_time 0.5572741031646729
Test Epoch3 layer3 Acc 0.8906, AUC 0.9592622518539429, avg_entr 0.14570875465869904, f1 0.8906000256538391
ep3_l3_test_time 0.5637941360473633
Test Epoch3 layer4 Acc 0.8906, AUC 0.9592818021774292, avg_entr 0.12358226627111435, f1 0.8906000256538391
ep3_l4_test_time 0.5599887371063232
gc 0
Train Epoch4 Acc 0.933275 (37331/40000), AUC 0.981148898601532
ep4_train_time 6.754334926605225
Test Epoch4 layer0 Acc 0.8988, AUC 0.9591907858848572, avg_entr 0.17878152430057526, f1 0.8988000154495239
ep4_l0_test_time 0.5724222660064697
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.8962, AUC 0.9597061276435852, avg_entr 0.16796277463436127, f1 0.8962000012397766
ep4_l1_test_time 0.5684270858764648
Test Epoch4 layer2 Acc 0.8998, AUC 0.9600253701210022, avg_entr 0.1435614675283432, f1 0.8998000025749207
ep4_l2_test_time 0.5652682781219482
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer3 Acc 0.8996, AUC 0.9604549407958984, avg_entr 0.12353327870368958, f1 0.8996000289916992
ep4_l3_test_time 0.5695440769195557
Test Epoch4 layer4 Acc 0.9002, AUC 0.9606311321258545, avg_entr 0.09310390800237656, f1 0.9002000093460083
ep4_l4_test_time 0.562283992767334
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.941825 (37673/40000), AUC 0.9849694967269897
ep5_train_time 9.461423635482788
Test Epoch5 layer0 Acc 0.8944, AUC 0.9588484168052673, avg_entr 0.16076156497001648, f1 0.8944000005722046
ep5_l0_test_time 0.7379984855651855
Test Epoch5 layer1 Acc 0.8956, AUC 0.9594321250915527, avg_entr 0.149559885263443, f1 0.8956000208854675
ep5_l1_test_time 0.7501544952392578
Test Epoch5 layer2 Acc 0.8956, AUC 0.9599018096923828, avg_entr 0.12302941828966141, f1 0.8956000208854675
ep5_l2_test_time 0.7627077102661133
Test Epoch5 layer3 Acc 0.8966, AUC 0.9604159593582153, avg_entr 0.09430551528930664, f1 0.8966000080108643
ep5_l3_test_time 0.7431612014770508
Test Epoch5 layer4 Acc 0.896, AUC 0.960911214351654, avg_entr 0.06533500552177429, f1 0.8960000276565552
ep5_l4_test_time 0.7632739543914795
gc 0
Train Epoch6 Acc 0.94865 (37946/40000), AUC 0.9877195954322815
ep6_train_time 10.927946329116821
Test Epoch6 layer0 Acc 0.8918, AUC 0.9574445486068726, avg_entr 0.15229199826717377, f1 0.8917999863624573
ep6_l0_test_time 0.741182804107666
Test Epoch6 layer1 Acc 0.8938, AUC 0.9581858515739441, avg_entr 0.14119984209537506, f1 0.8938000202178955
ep6_l1_test_time 0.7628686428070068
Test Epoch6 layer2 Acc 0.8944, AUC 0.9588408470153809, avg_entr 0.11450953036546707, f1 0.8944000005722046
ep6_l2_test_time 0.7686495780944824
Test Epoch6 layer3 Acc 0.895, AUC 0.959524393081665, avg_entr 0.07919522374868393, f1 0.8949999809265137
ep6_l3_test_time 0.7426958084106445
Test Epoch6 layer4 Acc 0.8958, AUC 0.9589033126831055, avg_entr 0.05134974420070648, f1 0.895799994468689
ep6_l4_test_time 0.7720534801483154
gc 0
Train Epoch7 Acc 0.954525 (38181/40000), AUC 0.9892535209655762
ep7_train_time 10.958658218383789
Test Epoch7 layer0 Acc 0.8872, AUC 0.955925703048706, avg_entr 0.15188606083393097, f1 0.8871999979019165
ep7_l0_test_time 0.7516987323760986
Test Epoch7 layer1 Acc 0.891, AUC 0.9567631483078003, avg_entr 0.14023150503635406, f1 0.890999972820282
ep7_l1_test_time 0.7656528949737549
Test Epoch7 layer2 Acc 0.8866, AUC 0.957740843296051, avg_entr 0.11450794339179993, f1 0.8866000771522522
ep7_l2_test_time 0.7525637149810791
Test Epoch7 layer3 Acc 0.8878, AUC 0.9582228064537048, avg_entr 0.07345223426818848, f1 0.8877999782562256
ep7_l3_test_time 0.7327773571014404
Test Epoch7 layer4 Acc 0.888, AUC 0.9566794037818909, avg_entr 0.048807404935359955, f1 0.8880000114440918
ep7_l4_test_time 0.7379899024963379
gc 0
Train Epoch8 Acc 0.959 (38360/40000), AUC 0.9912295341491699
ep8_train_time 11.024835348129272
Test Epoch8 layer0 Acc 0.8926, AUC 0.954696774482727, avg_entr 0.13746950030326843, f1 0.8925999999046326
ep8_l0_test_time 0.7586696147918701
Test Epoch8 layer1 Acc 0.8924, AUC 0.9555382132530212, avg_entr 0.12620960175991058, f1 0.8923999667167664
ep8_l1_test_time 0.7464652061462402
Test Epoch8 layer2 Acc 0.89, AUC 0.9564827680587769, avg_entr 0.10130079090595245, f1 0.8899999856948853
ep8_l2_test_time 0.7486786842346191
Test Epoch8 layer3 Acc 0.8912, AUC 0.9567726850509644, avg_entr 0.05744871869683266, f1 0.8912000060081482
ep8_l3_test_time 0.7555687427520752
Test Epoch8 layer4 Acc 0.8914, AUC 0.9543062448501587, avg_entr 0.03623242676258087, f1 0.8913999795913696
ep8_l4_test_time 0.759260892868042
gc 0
Train Epoch9 Acc 0.963175 (38527/40000), AUC 0.9926413297653198
ep9_train_time 10.90082836151123
Test Epoch9 layer0 Acc 0.8904, AUC 0.9532938003540039, avg_entr 0.13537384569644928, f1 0.8903999924659729
ep9_l0_test_time 0.7630069255828857
Test Epoch9 layer1 Acc 0.8908, AUC 0.9542591571807861, avg_entr 0.1246604397892952, f1 0.8907999992370605
ep9_l1_test_time 0.7707960605621338
Test Epoch9 layer2 Acc 0.8904, AUC 0.9551160335540771, avg_entr 0.09754975885152817, f1 0.8903999924659729
ep9_l2_test_time 0.7621021270751953
Test Epoch9 layer3 Acc 0.8898, AUC 0.9551888704299927, avg_entr 0.05335206165909767, f1 0.8898000121116638
ep9_l3_test_time 0.7495424747467041
Test Epoch9 layer4 Acc 0.8896, AUC 0.9528965950012207, avg_entr 0.033103782683610916, f1 0.8895999193191528
ep9_l4_test_time 0.7469253540039062
gc 0
Train Epoch10 Acc 0.964725 (38589/40000), AUC 0.9931377172470093
ep10_train_time 11.006853580474854
Test Epoch10 layer0 Acc 0.89, AUC 0.9523171782493591, avg_entr 0.13097618520259857, f1 0.8899999856948853
ep10_l0_test_time 0.7736098766326904
Test Epoch10 layer1 Acc 0.8892, AUC 0.9533440470695496, avg_entr 0.11988406628370285, f1 0.88919997215271
ep10_l1_test_time 0.7691738605499268
Test Epoch10 layer2 Acc 0.8902, AUC 0.9540507793426514, avg_entr 0.0928693413734436, f1 0.8902000188827515
ep10_l2_test_time 0.7455308437347412
Test Epoch10 layer3 Acc 0.8898, AUC 0.9538264274597168, avg_entr 0.049741070717573166, f1 0.8898000121116638
ep10_l3_test_time 0.7450823783874512
Test Epoch10 layer4 Acc 0.8894, AUC 0.9522714614868164, avg_entr 0.03127577155828476, f1 0.8894000053405762
ep10_l4_test_time 0.7631452083587646
gc 0
Train Epoch11 Acc 0.966375 (38655/40000), AUC 0.9935671091079712
ep11_train_time 10.901721477508545
Test Epoch11 layer0 Acc 0.886, AUC 0.951191782951355, avg_entr 0.12870417535305023, f1 0.8859999775886536
ep11_l0_test_time 0.7504470348358154
Test Epoch11 layer1 Acc 0.8882, AUC 0.9523175358772278, avg_entr 0.11823364347219467, f1 0.888200044631958
ep11_l1_test_time 0.7594597339630127
Test Epoch11 layer2 Acc 0.8876, AUC 0.9530646800994873, avg_entr 0.0903598889708519, f1 0.8876000046730042
ep11_l2_test_time 0.7536375522613525
Test Epoch11 layer3 Acc 0.888, AUC 0.9523626565933228, avg_entr 0.04650769755244255, f1 0.8880000114440918
ep11_l3_test_time 0.7483718395233154
Test Epoch11 layer4 Acc 0.888, AUC 0.949404776096344, avg_entr 0.029562827199697495, f1 0.8880000114440918
ep11_l4_test_time 0.7316288948059082
gc 0
Train Epoch12 Acc 0.9674 (38696/40000), AUC 0.9940864443778992
ep12_train_time 11.022183418273926
Test Epoch12 layer0 Acc 0.8868, AUC 0.9501785039901733, avg_entr 0.12544895708560944, f1 0.8867999911308289
ep12_l0_test_time 0.7387979030609131
Test Epoch12 layer1 Acc 0.8874, AUC 0.9513716697692871, avg_entr 0.11506964266300201, f1 0.8873999714851379
ep12_l1_test_time 0.7405006885528564
Test Epoch12 layer2 Acc 0.887, AUC 0.9522466659545898, avg_entr 0.08785935491323471, f1 0.8870000243186951
ep12_l2_test_time 0.7473387718200684
Test Epoch12 layer3 Acc 0.8862, AUC 0.9512176513671875, avg_entr 0.043240662664175034, f1 0.8862000107765198
ep12_l3_test_time 0.7608954906463623
Test Epoch12 layer4 Acc 0.8866, AUC 0.9501959085464478, avg_entr 0.026842424646019936, f1 0.8866000771522522
ep12_l4_test_time 0.7799649238586426
gc 0
Train Epoch13 Acc 0.96965 (38786/40000), AUC 0.9947594404220581
ep13_train_time 10.99771761894226
Test Epoch13 layer0 Acc 0.8852, AUC 0.9496172070503235, avg_entr 0.1274053156375885, f1 0.8852000832557678
ep13_l0_test_time 0.7564377784729004
Test Epoch13 layer1 Acc 0.8854, AUC 0.9508347511291504, avg_entr 0.11624819040298462, f1 0.8853999972343445
ep13_l1_test_time 0.7452549934387207
Test Epoch13 layer2 Acc 0.8842, AUC 0.9517526626586914, avg_entr 0.08902022987604141, f1 0.8842000365257263
ep13_l2_test_time 0.7334284782409668
Test Epoch13 layer3 Acc 0.885, AUC 0.9501951932907104, avg_entr 0.04410403594374657, f1 0.8849999904632568
ep13_l3_test_time 0.7525625228881836
Test Epoch13 layer4 Acc 0.8844, AUC 0.9488275647163391, avg_entr 0.02754838950932026, f1 0.8844000101089478
ep13_l4_test_time 0.7494287490844727
gc 0
Train Epoch14 Acc 0.9702 (38808/40000), AUC 0.9950867891311646
ep14_train_time 10.94101858139038
Test Epoch14 layer0 Acc 0.8864, AUC 0.9489208459854126, avg_entr 0.12381673604249954, f1 0.8863999843597412
ep14_l0_test_time 0.7571861743927002
Test Epoch14 layer1 Acc 0.8868, AUC 0.9501032829284668, avg_entr 0.11281859129667282, f1 0.8867999911308289
ep14_l1_test_time 0.7514457702636719
Test Epoch14 layer2 Acc 0.885, AUC 0.9508414268493652, avg_entr 0.08430257439613342, f1 0.8849999904632568
ep14_l2_test_time 0.7624895572662354
Test Epoch14 layer3 Acc 0.8848, AUC 0.9493575096130371, avg_entr 0.04120134934782982, f1 0.8848000168800354
ep14_l3_test_time 0.7374317646026611
Test Epoch14 layer4 Acc 0.8852, AUC 0.9487978219985962, avg_entr 0.025496235117316246, f1 0.8852000832557678
ep14_l4_test_time 0.7492785453796387
gc 0
Train Epoch15 Acc 0.97105 (38842/40000), AUC 0.9952172040939331
ep15_train_time 10.940905094146729
Test Epoch15 layer0 Acc 0.8848, AUC 0.9483422636985779, avg_entr 0.12263154238462448, f1 0.8848000168800354
ep15_l0_test_time 0.7442290782928467
Test Epoch15 layer1 Acc 0.8856, AUC 0.9496082067489624, avg_entr 0.11202149838209152, f1 0.8855999708175659
ep15_l1_test_time 0.7415206432342529
Test Epoch15 layer2 Acc 0.8846, AUC 0.9504573941230774, avg_entr 0.08365936577320099, f1 0.8845999836921692
ep15_l2_test_time 0.7420041561126709
Test Epoch15 layer3 Acc 0.8848, AUC 0.9486064910888672, avg_entr 0.03962666168808937, f1 0.8848000168800354
ep15_l3_test_time 0.7444407939910889
Test Epoch15 layer4 Acc 0.8854, AUC 0.9478686451911926, avg_entr 0.024322232231497765, f1 0.8853999972343445
ep15_l4_test_time 0.7620935440063477
gc 0
Train Epoch16 Acc 0.971075 (38843/40000), AUC 0.9953300952911377
ep16_train_time 10.937660694122314
Test Epoch16 layer0 Acc 0.8836, AUC 0.9475593566894531, avg_entr 0.12037932127714157, f1 0.8835999965667725
ep16_l0_test_time 0.7329535484313965
Test Epoch16 layer1 Acc 0.8844, AUC 0.9488524198532104, avg_entr 0.10989682376384735, f1 0.8844000101089478
ep16_l1_test_time 0.7388749122619629
Test Epoch16 layer2 Acc 0.8832, AUC 0.9495187401771545, avg_entr 0.0809985026717186, f1 0.8831999897956848
ep16_l2_test_time 0.759361982345581
Test Epoch16 layer3 Acc 0.8832, AUC 0.9472509622573853, avg_entr 0.03845076635479927, f1 0.8831999897956848
ep16_l3_test_time 0.759162425994873
Test Epoch16 layer4 Acc 0.8832, AUC 0.9446865916252136, avg_entr 0.024371379986405373, f1 0.8831999897956848
ep16_l4_test_time 0.7620830535888672
gc 0
Train Epoch17 Acc 0.97235 (38894/40000), AUC 0.9955646991729736
ep17_train_time 10.970394849777222
Test Epoch17 layer0 Acc 0.883, AUC 0.9473928213119507, avg_entr 0.12054448574781418, f1 0.8830000162124634
ep17_l0_test_time 0.7469484806060791
Test Epoch17 layer1 Acc 0.8832, AUC 0.9487011432647705, avg_entr 0.1099432110786438, f1 0.8831999897956848
ep17_l1_test_time 0.777400016784668
Test Epoch17 layer2 Acc 0.8828, AUC 0.9494647979736328, avg_entr 0.08124645054340363, f1 0.8827999830245972
ep17_l2_test_time 0.754239559173584
Test Epoch17 layer3 Acc 0.883, AUC 0.9473552703857422, avg_entr 0.03773504123091698, f1 0.8830000162124634
ep17_l3_test_time 0.7443814277648926
Test Epoch17 layer4 Acc 0.8838, AUC 0.9462460279464722, avg_entr 0.023571530357003212, f1 0.8838000297546387
ep17_l4_test_time 0.7475931644439697
gc 0
Train Epoch18 Acc 0.972725 (38909/40000), AUC 0.9957280158996582
ep18_train_time 10.940379619598389
Test Epoch18 layer0 Acc 0.883, AUC 0.9469438791275024, avg_entr 0.11906509101390839, f1 0.8830000162124634
ep18_l0_test_time 0.753753662109375
Test Epoch18 layer1 Acc 0.8836, AUC 0.9482793807983398, avg_entr 0.10832154750823975, f1 0.8835999965667725
ep18_l1_test_time 0.7464940547943115
Test Epoch18 layer2 Acc 0.882, AUC 0.9489811658859253, avg_entr 0.07934167236089706, f1 0.8820000290870667
ep18_l2_test_time 0.7453420162200928
Test Epoch18 layer3 Acc 0.8828, AUC 0.946566104888916, avg_entr 0.037031788378953934, f1 0.8827999830245972
ep18_l3_test_time 0.7413506507873535
Test Epoch18 layer4 Acc 0.8832, AUC 0.9434065222740173, avg_entr 0.023388827219605446, f1 0.8831999897956848
ep18_l4_test_time 0.7497062683105469
gc 0
Train Epoch19 Acc 0.972825 (38913/40000), AUC 0.9957056045532227
ep19_train_time 10.984204769134521
Test Epoch19 layer0 Acc 0.8828, AUC 0.9467829465866089, avg_entr 0.11777287721633911, f1 0.8827999830245972
ep19_l0_test_time 0.7614781856536865
Test Epoch19 layer1 Acc 0.8834, AUC 0.9481227397918701, avg_entr 0.10729509592056274, f1 0.8834000825881958
ep19_l1_test_time 0.7543075084686279
Test Epoch19 layer2 Acc 0.8826, AUC 0.9488449096679688, avg_entr 0.07847198843955994, f1 0.8826000094413757
ep19_l2_test_time 0.7544300556182861
Test Epoch19 layer3 Acc 0.883, AUC 0.9464765191078186, avg_entr 0.035823188722133636, f1 0.8830000162124634
ep19_l3_test_time 0.7286741733551025
Test Epoch19 layer4 Acc 0.8834, AUC 0.9441090822219849, avg_entr 0.022707881405949593, f1 0.8834000825881958
ep19_l4_test_time 0.7594254016876221
gc 0
Train Epoch20 Acc 0.9729 (38916/40000), AUC 0.9957960844039917
ep20_train_time 11.02258563041687
Test Epoch20 layer0 Acc 0.881, AUC 0.9464548826217651, avg_entr 0.11801701784133911, f1 0.8809999823570251
ep20_l0_test_time 0.7672030925750732
Test Epoch20 layer1 Acc 0.881, AUC 0.9478121399879456, avg_entr 0.10732284933328629, f1 0.8809999823570251
ep20_l1_test_time 0.7327659130096436
Test Epoch20 layer2 Acc 0.8802, AUC 0.948534369468689, avg_entr 0.07858796417713165, f1 0.8802000284194946
ep20_l2_test_time 0.7457120418548584
Test Epoch20 layer3 Acc 0.8814, AUC 0.9459023475646973, avg_entr 0.03625749796628952, f1 0.8813999891281128
ep20_l3_test_time 0.7584905624389648
Test Epoch20 layer4 Acc 0.8816, AUC 0.9453681707382202, avg_entr 0.022891614586114883, f1 0.881600022315979
ep20_l4_test_time 0.7460842132568359
gc 0
Train Epoch21 Acc 0.97345 (38938/40000), AUC 0.9959489107131958
ep21_train_time 11.03265929222107
Test Epoch21 layer0 Acc 0.8812, AUC 0.9463670253753662, avg_entr 0.11722032725811005, f1 0.8812000155448914
ep21_l0_test_time 0.7442624568939209
Test Epoch21 layer1 Acc 0.881, AUC 0.9477488994598389, avg_entr 0.10649944096803665, f1 0.8809999823570251
ep21_l1_test_time 0.7522516250610352
Test Epoch21 layer2 Acc 0.88, AUC 0.948452353477478, avg_entr 0.07768899947404861, f1 0.8799999952316284
ep21_l2_test_time 0.7616081237792969
Test Epoch21 layer3 Acc 0.8802, AUC 0.9458374977111816, avg_entr 0.0351848341524601, f1 0.8802000284194946
ep21_l3_test_time 0.7419595718383789
Test Epoch21 layer4 Acc 0.8802, AUC 0.9457058906555176, avg_entr 0.021884938701987267, f1 0.8802000284194946
ep21_l4_test_time 0.740234375
gc 0
Train Epoch22 Acc 0.973375 (38935/40000), AUC 0.9960716962814331
ep22_train_time 10.950781345367432
Test Epoch22 layer0 Acc 0.881, AUC 0.9462180137634277, avg_entr 0.116652712225914, f1 0.8809999823570251
ep22_l0_test_time 0.7514894008636475
Test Epoch22 layer1 Acc 0.8812, AUC 0.9475958347320557, avg_entr 0.10590283572673798, f1 0.8812000155448914
ep22_l1_test_time 0.763838529586792
Test Epoch22 layer2 Acc 0.8796, AUC 0.9482872486114502, avg_entr 0.07682444900274277, f1 0.8795999884605408
ep22_l2_test_time 0.7510414123535156
Test Epoch22 layer3 Acc 0.88, AUC 0.9457287788391113, avg_entr 0.034608177840709686, f1 0.8799999952316284
ep22_l3_test_time 0.7533125877380371
Test Epoch22 layer4 Acc 0.8798, AUC 0.9458214044570923, avg_entr 0.02142401970922947, f1 0.879800021648407
ep22_l4_test_time 0.7442295551300049
gc 0
Train Epoch23 Acc 0.97355 (38942/40000), AUC 0.9960141181945801
ep23_train_time 10.96979570388794
Test Epoch23 layer0 Acc 0.8812, AUC 0.9460118412971497, avg_entr 0.11559637635946274, f1 0.8812000155448914
ep23_l0_test_time 0.7645766735076904
Test Epoch23 layer1 Acc 0.8822, AUC 0.9473944902420044, avg_entr 0.1050398200750351, f1 0.8822000026702881
ep23_l1_test_time 0.7383673191070557
Test Epoch23 layer2 Acc 0.8798, AUC 0.9480711221694946, avg_entr 0.07618513703346252, f1 0.879800021648407
ep23_l2_test_time 0.7740106582641602
Test Epoch23 layer3 Acc 0.8802, AUC 0.9454231858253479, avg_entr 0.03416237607598305, f1 0.8802000284194946
ep23_l3_test_time 0.7533278465270996
Test Epoch23 layer4 Acc 0.8806, AUC 0.9451316595077515, avg_entr 0.021337464451789856, f1 0.8805999755859375
ep23_l4_test_time 0.7416155338287354
gc 0
Train Epoch24 Acc 0.97405 (38962/40000), AUC 0.9960997104644775
ep24_train_time 10.96487283706665
Test Epoch24 layer0 Acc 0.8802, AUC 0.9459269046783447, avg_entr 0.11632849276065826, f1 0.8802000284194946
ep24_l0_test_time 0.7550489902496338
Test Epoch24 layer1 Acc 0.8804, AUC 0.9473380446434021, avg_entr 0.10561264306306839, f1 0.8804000020027161
ep24_l1_test_time 0.7728931903839111
Test Epoch24 layer2 Acc 0.8804, AUC 0.9480577707290649, avg_entr 0.07684142142534256, f1 0.8804000020027161
ep24_l2_test_time 0.7499969005584717
Test Epoch24 layer3 Acc 0.881, AUC 0.9451755285263062, avg_entr 0.035053808242082596, f1 0.8809999823570251
ep24_l3_test_time 0.7417299747467041
Test Epoch24 layer4 Acc 0.8808, AUC 0.9450931549072266, avg_entr 0.022065790370106697, f1 0.8808000087738037
ep24_l4_test_time 0.761631965637207
gc 0
Train Epoch25 Acc 0.973875 (38955/40000), AUC 0.9962522983551025
ep25_train_time 10.975493907928467
Test Epoch25 layer0 Acc 0.881, AUC 0.9458224177360535, avg_entr 0.11460908502340317, f1 0.8809999823570251
ep25_l0_test_time 0.7160401344299316
Test Epoch25 layer1 Acc 0.8814, AUC 0.9472241401672363, avg_entr 0.1039954349398613, f1 0.8813999891281128
ep25_l1_test_time 0.7683346271514893
Test Epoch25 layer2 Acc 0.8798, AUC 0.947900652885437, avg_entr 0.0751262977719307, f1 0.879800021648407
ep25_l2_test_time 0.7599139213562012
Test Epoch25 layer3 Acc 0.8796, AUC 0.945067822933197, avg_entr 0.033576443791389465, f1 0.8795999884605408
ep25_l3_test_time 0.7662885189056396
Test Epoch25 layer4 Acc 0.8794, AUC 0.9447551965713501, avg_entr 0.021016675978899002, f1 0.8794000148773193
ep25_l4_test_time 0.7544832229614258
gc 0
Train Epoch26 Acc 0.973975 (38959/40000), AUC 0.9962451457977295
ep26_train_time 11.016026735305786
Test Epoch26 layer0 Acc 0.8804, AUC 0.9456800222396851, avg_entr 0.11312583088874817, f1 0.8804000020027161
ep26_l0_test_time 0.7445039749145508
Test Epoch26 layer1 Acc 0.8814, AUC 0.947060227394104, avg_entr 0.1026608794927597, f1 0.8813999891281128
ep26_l1_test_time 0.7609124183654785
Test Epoch26 layer2 Acc 0.882, AUC 0.9476888179779053, avg_entr 0.07379574328660965, f1 0.8820000290870667
ep26_l2_test_time 0.7557897567749023
Test Epoch26 layer3 Acc 0.882, AUC 0.9446588754653931, avg_entr 0.03320933133363724, f1 0.8820000290870667
ep26_l3_test_time 0.7425622940063477
Test Epoch26 layer4 Acc 0.883, AUC 0.9448223114013672, avg_entr 0.021280517801642418, f1 0.8830000162124634
ep26_l4_test_time 0.7407841682434082
gc 0
Train Epoch27 Acc 0.973775 (38951/40000), AUC 0.9962673187255859
ep27_train_time 10.9774010181427
Test Epoch27 layer0 Acc 0.8812, AUC 0.9456554651260376, avg_entr 0.11361000686883926, f1 0.8812000155448914
ep27_l0_test_time 0.727492094039917
Test Epoch27 layer1 Acc 0.882, AUC 0.9470442533493042, avg_entr 0.10299361497163773, f1 0.8820000290870667
ep27_l1_test_time 0.7337937355041504
Test Epoch27 layer2 Acc 0.8792, AUC 0.9476968050003052, avg_entr 0.07416945695877075, f1 0.8791999816894531
ep27_l2_test_time 0.7457208633422852
Test Epoch27 layer3 Acc 0.8794, AUC 0.9448049068450928, avg_entr 0.03311289846897125, f1 0.8794000148773193
ep27_l3_test_time 0.7554030418395996
Test Epoch27 layer4 Acc 0.8802, AUC 0.9447723627090454, avg_entr 0.02082369476556778, f1 0.8802000284194946
ep27_l4_test_time 0.7339789867401123
gc 0
Train Epoch28 Acc 0.9738 (38952/40000), AUC 0.9962388277053833
ep28_train_time 10.935405969619751
Test Epoch28 layer0 Acc 0.8816, AUC 0.9456044435501099, avg_entr 0.11303088068962097, f1 0.881600022315979
ep28_l0_test_time 0.7526438236236572
Test Epoch28 layer1 Acc 0.8818, AUC 0.9469931125640869, avg_entr 0.10244980454444885, f1 0.8818000555038452
ep28_l1_test_time 0.7330441474914551
Test Epoch28 layer2 Acc 0.8788, AUC 0.9476497173309326, avg_entr 0.07357968389987946, f1 0.8787999749183655
ep28_l2_test_time 0.7655491828918457
Test Epoch28 layer3 Acc 0.8794, AUC 0.9448793530464172, avg_entr 0.03269589692354202, f1 0.8794000148773193
ep28_l3_test_time 0.7311515808105469
Test Epoch28 layer4 Acc 0.8796, AUC 0.9455369710922241, avg_entr 0.02049666829407215, f1 0.8795999884605408
ep28_l4_test_time 0.7407534122467041
gc 0
Train Epoch29 Acc 0.974175 (38967/40000), AUC 0.9962799549102783
ep29_train_time 10.948720932006836
Test Epoch29 layer0 Acc 0.8806, AUC 0.9455819129943848, avg_entr 0.1129249781370163, f1 0.8805999755859375
ep29_l0_test_time 0.7549912929534912
Test Epoch29 layer1 Acc 0.8806, AUC 0.9469864368438721, avg_entr 0.10228364169597626, f1 0.8805999755859375
ep29_l1_test_time 0.7588913440704346
Test Epoch29 layer2 Acc 0.8794, AUC 0.9476643800735474, avg_entr 0.07344451546669006, f1 0.8794000148773193
ep29_l2_test_time 0.7576038837432861
Test Epoch29 layer3 Acc 0.8794, AUC 0.9447906017303467, avg_entr 0.03258265554904938, f1 0.8794000148773193
ep29_l3_test_time 0.7489945888519287
Test Epoch29 layer4 Acc 0.8792, AUC 0.9448995590209961, avg_entr 0.020354511216282845, f1 0.8791999816894531
ep29_l4_test_time 0.7609012126922607
Best AUC tensor(0.9002) 4 4
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 435.14552569389343
Start Testing
Load ckpt at ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8948, AUC 0.955612301826477, avg_entr 0.18027758598327637, f1 0.8948000073432922
l0_test_time 0.7280027866363525
Test layer1 Acc 0.8966, AUC 0.9560832977294922, avg_entr 0.17045462131500244, f1 0.8966000080108643
l1_test_time 0.7407364845275879
Test layer2 Acc 0.8968, AUC 0.9564038515090942, avg_entr 0.147194966673851, f1 0.8967999815940857
l2_test_time 0.7592794895172119
Test layer3 Acc 0.8962, AUC 0.9569053053855896, avg_entr 0.12807922065258026, f1 0.8962000012397766
l3_test_time 0.75286865234375
Test layer4 Acc 0.8968, AUC 0.9571573734283447, avg_entr 0.09806479513645172, f1 0.8967999815940857
l4_test_time 0.7450504302978516
