total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 22.6220064163208
Start Training
gc 0
Train Epoch0 Acc 0.505325 (20213/40000), AUC 0.5198208093643188
ep0_train_time 12.44514513015747
Test Epoch0 layer0 Acc 0.8066, AUC 0.8864508867263794, avg_entr 0.5811266899108887, f1 0.8065999746322632
ep0_l0_test_time 0.7808709144592285
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.7662, AUC 0.8723499774932861, avg_entr 0.691189706325531, f1 0.766200065612793
ep0_l1_test_time 0.7894184589385986
Test Epoch0 layer2 Acc 0.7244, AUC 0.8482272028923035, avg_entr 0.6936500668525696, f1 0.7244000434875488
ep0_l2_test_time 0.7768216133117676
Test Epoch0 layer3 Acc 0.6756, AUC 0.7456672191619873, avg_entr 0.6944246292114258, f1 0.675599992275238
ep0_l3_test_time 0.7687361240386963
Test Epoch0 layer4 Acc 0.648, AUC 0.8167209625244141, avg_entr 0.6938220858573914, f1 0.6480000019073486
ep0_l4_test_time 0.755601167678833
gc 0
Train Epoch1 Acc 0.8163 (32652/40000), AUC 0.8897594213485718
ep1_train_time 11.321159839630127
Test Epoch1 layer0 Acc 0.8802, AUC 0.9452435970306396, avg_entr 0.29172930121421814, f1 0.8802000284194946
ep1_l0_test_time 0.7740750312805176
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8792, AUC 0.9458240270614624, avg_entr 0.36217933893203735, f1 0.8791999816894531
ep1_l1_test_time 0.7662646770477295
Test Epoch1 layer2 Acc 0.8814, AUC 0.9462270736694336, avg_entr 0.24246633052825928, f1 0.8813999891281128
ep1_l2_test_time 0.7749943733215332
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.8828, AUC 0.9464206099510193, avg_entr 0.2332274466753006, f1 0.8827999830245972
ep1_l3_test_time 0.762814998626709
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer4 Acc 0.8836, AUC 0.9465798735618591, avg_entr 0.2297644019126892, f1 0.8835999965667725
ep1_l4_test_time 0.7800402641296387
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.904925 (36197/40000), AUC 0.9643476009368896
ep2_train_time 11.255149126052856
Test Epoch2 layer0 Acc 0.8922, AUC 0.9552056789398193, avg_entr 0.22773577272891998, f1 0.8921999931335449
ep2_l0_test_time 0.7709426879882812
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.892, AUC 0.9559303522109985, avg_entr 0.215729221701622, f1 0.8920000195503235
ep2_l1_test_time 0.7750847339630127
Test Epoch2 layer2 Acc 0.8914, AUC 0.9560059309005737, avg_entr 0.19672776758670807, f1 0.8913999795913696
ep2_l2_test_time 0.777287483215332
Test Epoch2 layer3 Acc 0.8922, AUC 0.9564241170883179, avg_entr 0.18661779165267944, f1 0.8921999931335449
ep2_l3_test_time 0.7628655433654785
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer4 Acc 0.893, AUC 0.9565482139587402, avg_entr 0.1726217418909073, f1 0.8930000066757202
ep2_l4_test_time 0.7787833213806152
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.923175 (36927/40000), AUC 0.9756714105606079
ep3_train_time 11.23280954360962
Test Epoch3 layer0 Acc 0.9006, AUC 0.9583702683448792, avg_entr 0.1977814882993698, f1 0.900600016117096
ep3_l0_test_time 0.7882654666900635
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.9, AUC 0.9588890075683594, avg_entr 0.1806800365447998, f1 0.8999999761581421
ep3_l1_test_time 0.7783503532409668
Test Epoch3 layer2 Acc 0.9, AUC 0.9591475129127502, avg_entr 0.17247793078422546, f1 0.8999999761581421
ep3_l2_test_time 0.772592306137085
Test Epoch3 layer3 Acc 0.8974, AUC 0.9593981504440308, avg_entr 0.1561558097600937, f1 0.8974000215530396
ep3_l3_test_time 0.7659411430358887
Test Epoch3 layer4 Acc 0.8958, AUC 0.9595428705215454, avg_entr 0.13384154438972473, f1 0.895799994468689
ep3_l4_test_time 0.7855863571166992
gc 0
Train Epoch4 Acc 0.934275 (37371/40000), AUC 0.9814812541007996
ep4_train_time 11.31602168083191
Test Epoch4 layer0 Acc 0.8738, AUC 0.959048867225647, avg_entr 0.1750761717557907, f1 0.8737999796867371
ep4_l0_test_time 0.7804539203643799
Test Epoch4 layer1 Acc 0.8858, AUC 0.9595425128936768, avg_entr 0.1569565087556839, f1 0.8858000040054321
ep4_l1_test_time 0.7860019207000732
Test Epoch4 layer2 Acc 0.884, AUC 0.9598442316055298, avg_entr 0.14862872660160065, f1 0.8840000033378601
ep4_l2_test_time 0.7746717929840088
Test Epoch4 layer3 Acc 0.8868, AUC 0.960205078125, avg_entr 0.12695354223251343, f1 0.8867999911308289
ep4_l3_test_time 0.7669045925140381
Test Epoch4 layer4 Acc 0.885, AUC 0.9605610370635986, avg_entr 0.09929138422012329, f1 0.8849999904632568
ep4_l4_test_time 0.7741994857788086
gc 0
Train Epoch5 Acc 0.943175 (37727/40000), AUC 0.9852808117866516
ep5_train_time 11.286343812942505
Test Epoch5 layer0 Acc 0.898, AUC 0.9585243463516235, avg_entr 0.16491544246673584, f1 0.8980000019073486
ep5_l0_test_time 0.7746291160583496
Test Epoch5 layer1 Acc 0.8964, AUC 0.9590457677841187, avg_entr 0.14622311294078827, f1 0.896399974822998
ep5_l1_test_time 0.7755885124206543
Test Epoch5 layer2 Acc 0.8976, AUC 0.959519624710083, avg_entr 0.13543221354484558, f1 0.897599995136261
ep5_l2_test_time 0.8133366107940674
Test Epoch5 layer3 Acc 0.8976, AUC 0.9603006839752197, avg_entr 0.10373733192682266, f1 0.897599995136261
ep5_l3_test_time 0.7751369476318359
Test Epoch5 layer4 Acc 0.8986, AUC 0.9606019258499146, avg_entr 0.06927956640720367, f1 0.8985999822616577
ep5_l4_test_time 0.781121015548706
gc 0
Train Epoch6 Acc 0.94945 (37978/40000), AUC 0.9879007339477539
ep6_train_time 11.30323839187622
Test Epoch6 layer0 Acc 0.8982, AUC 0.9574596881866455, avg_entr 0.15607327222824097, f1 0.8981999754905701
ep6_l0_test_time 0.7570302486419678
Test Epoch6 layer1 Acc 0.8972, AUC 0.9581080675125122, avg_entr 0.1372523456811905, f1 0.8971999883651733
ep6_l1_test_time 0.7683513164520264
Test Epoch6 layer2 Acc 0.8966, AUC 0.9588890075683594, avg_entr 0.1251629739999771, f1 0.8966000080108643
ep6_l2_test_time 0.765998125076294
Test Epoch6 layer3 Acc 0.8966, AUC 0.9597081542015076, avg_entr 0.08733261376619339, f1 0.8966000080108643
ep6_l3_test_time 0.7706077098846436
Test Epoch6 layer4 Acc 0.8974, AUC 0.9587933421134949, avg_entr 0.05357729643583298, f1 0.8974000215530396
ep6_l4_test_time 0.7796356678009033
gc 0
Train Epoch7 Acc 0.9543 (38172/40000), AUC 0.9893752336502075
ep7_train_time 11.335650205612183
Test Epoch7 layer0 Acc 0.8936, AUC 0.9558951258659363, avg_entr 0.14504742622375488, f1 0.8935999870300293
ep7_l0_test_time 0.7707796096801758
Test Epoch7 layer1 Acc 0.8944, AUC 0.9565256237983704, avg_entr 0.1261032223701477, f1 0.8944000005722046
ep7_l1_test_time 0.7719559669494629
Test Epoch7 layer2 Acc 0.8952, AUC 0.9571725130081177, avg_entr 0.11317231506109238, f1 0.8952000141143799
ep7_l2_test_time 0.7762112617492676
Test Epoch7 layer3 Acc 0.8952, AUC 0.9575117826461792, avg_entr 0.07120257616043091, f1 0.8952000141143799
ep7_l3_test_time 0.7772512435913086
Test Epoch7 layer4 Acc 0.8958, AUC 0.9538403153419495, avg_entr 0.04327958822250366, f1 0.895799994468689
ep7_l4_test_time 0.7679393291473389
gc 0
Train Epoch8 Acc 0.958575 (38343/40000), AUC 0.990973711013794
ep8_train_time 11.328316926956177
Test Epoch8 layer0 Acc 0.8884, AUC 0.9535507559776306, avg_entr 0.13849391043186188, f1 0.8884000182151794
ep8_l0_test_time 0.7842955589294434
Test Epoch8 layer1 Acc 0.8894, AUC 0.9544806480407715, avg_entr 0.12012497335672379, f1 0.8894000053405762
ep8_l1_test_time 0.7970163822174072
Test Epoch8 layer2 Acc 0.8904, AUC 0.9553728699684143, avg_entr 0.10627175122499466, f1 0.8903999924659729
ep8_l2_test_time 0.7755687236785889
Test Epoch8 layer3 Acc 0.89, AUC 0.9553662538528442, avg_entr 0.059275127947330475, f1 0.8899999856948853
ep8_l3_test_time 0.803945779800415
Test Epoch8 layer4 Acc 0.8906, AUC 0.9510478973388672, avg_entr 0.03763793781399727, f1 0.8906000256538391
ep8_l4_test_time 0.7987041473388672
gc 0
Train Epoch9 Acc 0.96295 (38518/40000), AUC 0.9926415085792542
ep9_train_time 11.285078287124634
Test Epoch9 layer0 Acc 0.8898, AUC 0.9530697464942932, avg_entr 0.13522712886333466, f1 0.8898000121116638
ep9_l0_test_time 0.7705056667327881
Test Epoch9 layer1 Acc 0.8912, AUC 0.9541608095169067, avg_entr 0.11662489175796509, f1 0.8912000060081482
ep9_l1_test_time 0.7720472812652588
Test Epoch9 layer2 Acc 0.8926, AUC 0.9552635550498962, avg_entr 0.10104350000619888, f1 0.8925999999046326
ep9_l2_test_time 0.7643146514892578
Test Epoch9 layer3 Acc 0.892, AUC 0.9547269344329834, avg_entr 0.05465304106473923, f1 0.8920000195503235
ep9_l3_test_time 0.7783386707305908
Test Epoch9 layer4 Acc 0.8916, AUC 0.9506966471672058, avg_entr 0.03414078429341316, f1 0.8916000127792358
ep9_l4_test_time 0.7617321014404297
gc 0
Train Epoch10 Acc 0.964975 (38599/40000), AUC 0.9931710958480835
ep10_train_time 11.34266972541809
Test Epoch10 layer0 Acc 0.8866, AUC 0.9519767761230469, avg_entr 0.13171592354774475, f1 0.8866000771522522
ep10_l0_test_time 0.7597413063049316
Test Epoch10 layer1 Acc 0.8866, AUC 0.9531522989273071, avg_entr 0.11341898143291473, f1 0.8866000771522522
ep10_l1_test_time 0.7803692817687988
Test Epoch10 layer2 Acc 0.8884, AUC 0.9541468620300293, avg_entr 0.09772183746099472, f1 0.8884000182151794
ep10_l2_test_time 0.7658171653747559
Test Epoch10 layer3 Acc 0.8868, AUC 0.9531205892562866, avg_entr 0.049824729561805725, f1 0.8867999911308289
ep10_l3_test_time 0.7690880298614502
Test Epoch10 layer4 Acc 0.8876, AUC 0.9505395889282227, avg_entr 0.031018590554594994, f1 0.8876000046730042
ep10_l4_test_time 0.7726132869720459
gc 0
Train Epoch11 Acc 0.9666 (38664/40000), AUC 0.9937371611595154
ep11_train_time 11.352570533752441
Test Epoch11 layer0 Acc 0.8886, AUC 0.9509492516517639, avg_entr 0.13071946799755096, f1 0.8885999917984009
ep11_l0_test_time 0.7687714099884033
Test Epoch11 layer1 Acc 0.8878, AUC 0.9522587060928345, avg_entr 0.11237657815217972, f1 0.8877999782562256
ep11_l1_test_time 0.7661552429199219
Test Epoch11 layer2 Acc 0.8876, AUC 0.9533957242965698, avg_entr 0.09606058895587921, f1 0.8876000046730042
ep11_l2_test_time 0.7729411125183105
Test Epoch11 layer3 Acc 0.8864, AUC 0.9514342546463013, avg_entr 0.04828939959406853, f1 0.8863999843597412
ep11_l3_test_time 0.7810053825378418
Test Epoch11 layer4 Acc 0.8876, AUC 0.9489756226539612, avg_entr 0.02982645481824875, f1 0.8876000046730042
ep11_l4_test_time 0.7725620269775391
gc 0
Train Epoch12 Acc 0.96755 (38702/40000), AUC 0.994144082069397
ep12_train_time 11.237592220306396
Test Epoch12 layer0 Acc 0.887, AUC 0.9494448900222778, avg_entr 0.1274806261062622, f1 0.8870000243186951
ep12_l0_test_time 0.7739932537078857
Test Epoch12 layer1 Acc 0.887, AUC 0.9508378505706787, avg_entr 0.10958099365234375, f1 0.8870000243186951
ep12_l1_test_time 0.7627878189086914
Test Epoch12 layer2 Acc 0.886, AUC 0.9517868757247925, avg_entr 0.09252215921878815, f1 0.8859999775886536
ep12_l2_test_time 0.7752468585968018
Test Epoch12 layer3 Acc 0.8858, AUC 0.9496910572052002, avg_entr 0.044639814645051956, f1 0.8858000040054321
ep12_l3_test_time 0.7801847457885742
Test Epoch12 layer4 Acc 0.8864, AUC 0.9507514238357544, avg_entr 0.028022989630699158, f1 0.8863999843597412
ep12_l4_test_time 0.7846956253051758
gc 0
Train Epoch13 Acc 0.969475 (38779/40000), AUC 0.9949274063110352
ep13_train_time 11.35498309135437
Test Epoch13 layer0 Acc 0.884, AUC 0.9489644765853882, avg_entr 0.12852923572063446, f1 0.8840000033378601
ep13_l0_test_time 0.7683804035186768
Test Epoch13 layer1 Acc 0.886, AUC 0.9504331350326538, avg_entr 0.11065559089183807, f1 0.8859999775886536
ep13_l1_test_time 0.7719707489013672
Test Epoch13 layer2 Acc 0.8838, AUC 0.9515369534492493, avg_entr 0.09303555637598038, f1 0.8838000297546387
ep13_l2_test_time 0.7732408046722412
Test Epoch13 layer3 Acc 0.8848, AUC 0.9488912224769592, avg_entr 0.045951105654239655, f1 0.8848000168800354
ep13_l3_test_time 0.7954940795898438
Test Epoch13 layer4 Acc 0.8846, AUC 0.9486939907073975, avg_entr 0.029286101460456848, f1 0.8845999836921692
ep13_l4_test_time 0.7747159004211426
gc 0
Train Epoch14 Acc 0.96985 (38794/40000), AUC 0.9949291944503784
ep14_train_time 11.333120584487915
Test Epoch14 layer0 Acc 0.8854, AUC 0.9483664035797119, avg_entr 0.12523303925991058, f1 0.8853999972343445
ep14_l0_test_time 0.7837207317352295
Test Epoch14 layer1 Acc 0.8864, AUC 0.9498680830001831, avg_entr 0.10717599838972092, f1 0.8863999843597412
ep14_l1_test_time 0.7715888023376465
Test Epoch14 layer2 Acc 0.8854, AUC 0.9509272575378418, avg_entr 0.08928791433572769, f1 0.8853999972343445
ep14_l2_test_time 0.7665402889251709
Test Epoch14 layer3 Acc 0.8844, AUC 0.9480718374252319, avg_entr 0.042080894112586975, f1 0.8844000101089478
ep14_l3_test_time 0.7692546844482422
Test Epoch14 layer4 Acc 0.8846, AUC 0.9478482604026794, avg_entr 0.026150381192564964, f1 0.8845999836921692
ep14_l4_test_time 0.7740035057067871
gc 0
Train Epoch15 Acc 0.971125 (38845/40000), AUC 0.9950823187828064
ep15_train_time 11.343877077102661
Test Epoch15 layer0 Acc 0.8854, AUC 0.9478647708892822, avg_entr 0.12335069477558136, f1 0.8853999972343445
ep15_l0_test_time 0.7585768699645996
Test Epoch15 layer1 Acc 0.8858, AUC 0.9494000673294067, avg_entr 0.10554730147123337, f1 0.8858000040054321
ep15_l1_test_time 0.7659728527069092
Test Epoch15 layer2 Acc 0.8852, AUC 0.9504647254943848, avg_entr 0.08668109029531479, f1 0.8852000832557678
ep15_l2_test_time 0.7722160816192627
Test Epoch15 layer3 Acc 0.8844, AUC 0.9471298456192017, avg_entr 0.04077652096748352, f1 0.8844000101089478
ep15_l3_test_time 0.7689783573150635
Test Epoch15 layer4 Acc 0.8848, AUC 0.9475851655006409, avg_entr 0.02509491890668869, f1 0.8848000168800354
ep15_l4_test_time 0.7995700836181641
gc 0
Train Epoch16 Acc 0.971825 (38873/40000), AUC 0.9953556656837463
ep16_train_time 11.28019380569458
Test Epoch16 layer0 Acc 0.8836, AUC 0.9471529722213745, avg_entr 0.122749924659729, f1 0.8835999965667725
ep16_l0_test_time 0.7664647102355957
Test Epoch16 layer1 Acc 0.884, AUC 0.9487808346748352, avg_entr 0.10545729100704193, f1 0.8840000033378601
ep16_l1_test_time 0.788628339767456
Test Epoch16 layer2 Acc 0.8834, AUC 0.9498226046562195, avg_entr 0.08731038123369217, f1 0.8834000825881958
ep16_l2_test_time 0.7786569595336914
Test Epoch16 layer3 Acc 0.8832, AUC 0.9457796812057495, avg_entr 0.041442256420850754, f1 0.8831999897956848
ep16_l3_test_time 0.776932954788208
Test Epoch16 layer4 Acc 0.8824, AUC 0.9463679790496826, avg_entr 0.026699993759393692, f1 0.8823999762535095
ep16_l4_test_time 0.7983136177062988
gc 0
Train Epoch17 Acc 0.9727 (38908/40000), AUC 0.9955161213874817
ep17_train_time 11.26566457748413
Test Epoch17 layer0 Acc 0.8842, AUC 0.9467250108718872, avg_entr 0.12118582427501678, f1 0.8842000365257263
ep17_l0_test_time 0.7774739265441895
Test Epoch17 layer1 Acc 0.8844, AUC 0.9483469724655151, avg_entr 0.1034996435046196, f1 0.8844000101089478
ep17_l1_test_time 0.7792870998382568
Test Epoch17 layer2 Acc 0.8824, AUC 0.9493278861045837, avg_entr 0.08457067608833313, f1 0.8823999762535095
ep17_l2_test_time 0.774045467376709
Test Epoch17 layer3 Acc 0.8834, AUC 0.9452942609786987, avg_entr 0.038696642965078354, f1 0.8834000825881958
ep17_l3_test_time 0.7900424003601074
Test Epoch17 layer4 Acc 0.8838, AUC 0.9474661350250244, avg_entr 0.02347165159881115, f1 0.8838000297546387
ep17_l4_test_time 0.7818508148193359
gc 0
Train Epoch18 Acc 0.972925 (38917/40000), AUC 0.9955750703811646
ep18_train_time 11.31482744216919
Test Epoch18 layer0 Acc 0.8828, AUC 0.9464187026023865, avg_entr 0.12161897867918015, f1 0.8827999830245972
ep18_l0_test_time 0.7709856033325195
Test Epoch18 layer1 Acc 0.8832, AUC 0.9480913877487183, avg_entr 0.10418045520782471, f1 0.8831999897956848
ep18_l1_test_time 0.7693686485290527
Test Epoch18 layer2 Acc 0.8826, AUC 0.94913649559021, avg_entr 0.08525566756725311, f1 0.8826000094413757
ep18_l2_test_time 0.7829563617706299
Test Epoch18 layer3 Acc 0.8822, AUC 0.9452449083328247, avg_entr 0.039048511534929276, f1 0.8822000026702881
ep18_l3_test_time 0.7487943172454834
Test Epoch18 layer4 Acc 0.882, AUC 0.9462399482727051, avg_entr 0.024565439671278, f1 0.8820000290870667
ep18_l4_test_time 0.7768561840057373
gc 0
Train Epoch19 Acc 0.973025 (38921/40000), AUC 0.9956268072128296
ep19_train_time 11.284569025039673
Test Epoch19 layer0 Acc 0.8824, AUC 0.9461681246757507, avg_entr 0.12009290605783463, f1 0.8823999762535095
ep19_l0_test_time 0.76389479637146
Test Epoch19 layer1 Acc 0.8832, AUC 0.9478687047958374, avg_entr 0.10255661606788635, f1 0.8831999897956848
ep19_l1_test_time 0.7950263023376465
Test Epoch19 layer2 Acc 0.884, AUC 0.9488948583602905, avg_entr 0.0833912342786789, f1 0.8840000033378601
ep19_l2_test_time 0.7827396392822266
Test Epoch19 layer3 Acc 0.8832, AUC 0.9443693161010742, avg_entr 0.03783513233065605, f1 0.8831999897956848
ep19_l3_test_time 0.779695987701416
Test Epoch19 layer4 Acc 0.8832, AUC 0.9461091756820679, avg_entr 0.023298488929867744, f1 0.8831999897956848
ep19_l4_test_time 0.7773079872131348
gc 0
Train Epoch20 Acc 0.97335 (38934/40000), AUC 0.9957311749458313
ep20_train_time 11.249482154846191
Test Epoch20 layer0 Acc 0.8816, AUC 0.9457715749740601, avg_entr 0.1179775670170784, f1 0.881600022315979
ep20_l0_test_time 0.7666306495666504
Test Epoch20 layer1 Acc 0.8828, AUC 0.9474925994873047, avg_entr 0.10068386048078537, f1 0.8827999830245972
ep20_l1_test_time 0.797091007232666
Test Epoch20 layer2 Acc 0.883, AUC 0.9484695196151733, avg_entr 0.08151326328516006, f1 0.8830000162124634
ep20_l2_test_time 0.7637643814086914
Test Epoch20 layer3 Acc 0.8834, AUC 0.9439795613288879, avg_entr 0.03640453889966011, f1 0.8834000825881958
ep20_l3_test_time 0.7634625434875488
Test Epoch20 layer4 Acc 0.8834, AUC 0.9443166255950928, avg_entr 0.022539032623171806, f1 0.8834000825881958
ep20_l4_test_time 0.7734746932983398
gc 0
Train Epoch21 Acc 0.973475 (38939/40000), AUC 0.995853841304779
ep21_train_time 11.336780309677124
Test Epoch21 layer0 Acc 0.8832, AUC 0.9455760717391968, avg_entr 0.11788897961378098, f1 0.8831999897956848
ep21_l0_test_time 0.775376558303833
Test Epoch21 layer1 Acc 0.8836, AUC 0.9473187327384949, avg_entr 0.10064597427845001, f1 0.8835999965667725
ep21_l1_test_time 0.7959191799163818
Test Epoch21 layer2 Acc 0.8824, AUC 0.9483101963996887, avg_entr 0.08162317425012589, f1 0.8823999762535095
ep21_l2_test_time 0.762547492980957
Test Epoch21 layer3 Acc 0.8828, AUC 0.9437903165817261, avg_entr 0.03629513457417488, f1 0.8827999830245972
ep21_l3_test_time 0.7638394832611084
Test Epoch21 layer4 Acc 0.8832, AUC 0.9460224509239197, avg_entr 0.02227156050503254, f1 0.8831999897956848
ep21_l4_test_time 0.7610049247741699
gc 0
Train Epoch22 Acc 0.9737 (38948/40000), AUC 0.9959147572517395
ep22_train_time 11.31862497329712
Test Epoch22 layer0 Acc 0.883, AUC 0.9454518556594849, avg_entr 0.11746487021446228, f1 0.8830000162124634
ep22_l0_test_time 0.7697036266326904
Test Epoch22 layer1 Acc 0.8832, AUC 0.9471954703330994, avg_entr 0.10011529177427292, f1 0.8831999897956848
ep22_l1_test_time 0.7651786804199219
Test Epoch22 layer2 Acc 0.8826, AUC 0.9481667280197144, avg_entr 0.08079780638217926, f1 0.8826000094413757
ep22_l2_test_time 0.7949650287628174
Test Epoch22 layer3 Acc 0.883, AUC 0.943683385848999, avg_entr 0.03580957278609276, f1 0.8830000162124634
ep22_l3_test_time 0.7672328948974609
Test Epoch22 layer4 Acc 0.883, AUC 0.9454067945480347, avg_entr 0.02209540084004402, f1 0.8830000162124634
ep22_l4_test_time 0.7718164920806885
gc 0
Train Epoch23 Acc 0.973775 (38951/40000), AUC 0.9958524703979492
ep23_train_time 11.340192317962646
Test Epoch23 layer0 Acc 0.8826, AUC 0.9452763795852661, avg_entr 0.11691943556070328, f1 0.8826000094413757
ep23_l0_test_time 0.77413010597229
Test Epoch23 layer1 Acc 0.883, AUC 0.9470525979995728, avg_entr 0.0996321365237236, f1 0.8830000162124634
ep23_l1_test_time 0.7792065143585205
Test Epoch23 layer2 Acc 0.8824, AUC 0.9480249881744385, avg_entr 0.08016738295555115, f1 0.8823999762535095
ep23_l2_test_time 0.7660725116729736
Test Epoch23 layer3 Acc 0.8826, AUC 0.9434241056442261, avg_entr 0.03548466041684151, f1 0.8826000094413757
ep23_l3_test_time 0.7738304138183594
Test Epoch23 layer4 Acc 0.8826, AUC 0.9458757638931274, avg_entr 0.021954664960503578, f1 0.8826000094413757
ep23_l4_test_time 0.7817625999450684
gc 0
Train Epoch24 Acc 0.97355 (38942/40000), AUC 0.9960217475891113
ep24_train_time 11.276274919509888
Test Epoch24 layer0 Acc 0.8822, AUC 0.9451569318771362, avg_entr 0.11646295338869095, f1 0.8822000026702881
ep24_l0_test_time 0.7721645832061768
Test Epoch24 layer1 Acc 0.883, AUC 0.9469312429428101, avg_entr 0.09924925863742828, f1 0.8830000162124634
ep24_l1_test_time 0.7790741920471191
Test Epoch24 layer2 Acc 0.8824, AUC 0.9479137063026428, avg_entr 0.07990018278360367, f1 0.8823999762535095
ep24_l2_test_time 0.7872714996337891
Test Epoch24 layer3 Acc 0.8826, AUC 0.9433055520057678, avg_entr 0.03533725067973137, f1 0.8826000094413757
ep24_l3_test_time 0.7927513122558594
Test Epoch24 layer4 Acc 0.8832, AUC 0.9451944828033447, avg_entr 0.0221650879830122, f1 0.8831999897956848
ep24_l4_test_time 0.7835888862609863
gc 0
Train Epoch25 Acc 0.9741 (38964/40000), AUC 0.9960587024688721
ep25_train_time 11.359521627426147
Test Epoch25 layer0 Acc 0.8828, AUC 0.9450786113739014, avg_entr 0.1158808246254921, f1 0.8827999830245972
ep25_l0_test_time 0.7856824398040771
Test Epoch25 layer1 Acc 0.8826, AUC 0.9468597173690796, avg_entr 0.09864063560962677, f1 0.8826000094413757
ep25_l1_test_time 0.7799825668334961
Test Epoch25 layer2 Acc 0.882, AUC 0.9478421807289124, avg_entr 0.07920598238706589, f1 0.8820000290870667
ep25_l2_test_time 0.7747142314910889
Test Epoch25 layer3 Acc 0.8822, AUC 0.9433388113975525, avg_entr 0.03483964130282402, f1 0.8822000026702881
ep25_l3_test_time 0.7733771800994873
Test Epoch25 layer4 Acc 0.8824, AUC 0.9450951814651489, avg_entr 0.021720074117183685, f1 0.8823999762535095
ep25_l4_test_time 0.7837586402893066
gc 0
Train Epoch26 Acc 0.9745 (38980/40000), AUC 0.9960136413574219
ep26_train_time 11.343315362930298
Test Epoch26 layer0 Acc 0.8818, AUC 0.9449828863143921, avg_entr 0.11488033086061478, f1 0.8818000555038452
ep26_l0_test_time 0.7758724689483643
Test Epoch26 layer1 Acc 0.882, AUC 0.9467575550079346, avg_entr 0.09765123575925827, f1 0.8820000290870667
ep26_l1_test_time 0.775550365447998
Test Epoch26 layer2 Acc 0.8824, AUC 0.9477177858352661, avg_entr 0.07820259034633636, f1 0.8823999762535095
ep26_l2_test_time 0.7861695289611816
Test Epoch26 layer3 Acc 0.8828, AUC 0.9428800344467163, avg_entr 0.03428932651877403, f1 0.8827999830245972
ep26_l3_test_time 0.7780318260192871
Test Epoch26 layer4 Acc 0.8826, AUC 0.944730281829834, avg_entr 0.021354174241423607, f1 0.8826000094413757
ep26_l4_test_time 0.7868242263793945
gc 0
Train Epoch27 Acc 0.974125 (38965/40000), AUC 0.996117353439331
ep27_train_time 11.340231657028198
Test Epoch27 layer0 Acc 0.8822, AUC 0.9449222087860107, avg_entr 0.1150967925786972, f1 0.8822000026702881
ep27_l0_test_time 0.7739932537078857
Test Epoch27 layer1 Acc 0.8822, AUC 0.9467117190361023, avg_entr 0.09785019606351852, f1 0.8822000026702881
ep27_l1_test_time 0.7765381336212158
Test Epoch27 layer2 Acc 0.8824, AUC 0.947674036026001, avg_entr 0.07824701815843582, f1 0.8823999762535095
ep27_l2_test_time 0.7608034610748291
Test Epoch27 layer3 Acc 0.882, AUC 0.9430657625198364, avg_entr 0.0343804769217968, f1 0.8820000290870667
ep27_l3_test_time 0.7770941257476807
Test Epoch27 layer4 Acc 0.8826, AUC 0.9449455738067627, avg_entr 0.02149936556816101, f1 0.8826000094413757
ep27_l4_test_time 0.7792909145355225
gc 0
Train Epoch28 Acc 0.974425 (38977/40000), AUC 0.9960866570472717
ep28_train_time 11.348811149597168
Test Epoch28 layer0 Acc 0.882, AUC 0.9448847770690918, avg_entr 0.11478465795516968, f1 0.8820000290870667
ep28_l0_test_time 0.7686641216278076
Test Epoch28 layer1 Acc 0.883, AUC 0.9466689825057983, avg_entr 0.09756257385015488, f1 0.8830000162124634
ep28_l1_test_time 0.7653863430023193
Test Epoch28 layer2 Acc 0.8816, AUC 0.9476372599601746, avg_entr 0.07787992805242538, f1 0.881600022315979
ep28_l2_test_time 0.7668294906616211
Test Epoch28 layer3 Acc 0.8828, AUC 0.943091630935669, avg_entr 0.03420320898294449, f1 0.8827999830245972
ep28_l3_test_time 0.7715890407562256
Test Epoch28 layer4 Acc 0.8828, AUC 0.9456838369369507, avg_entr 0.021465322002768517, f1 0.8827999830245972
ep28_l4_test_time 0.7701342105865479
gc 0
Train Epoch29 Acc 0.974375 (38975/40000), AUC 0.9961251020431519
ep29_train_time 11.236925840377808
Test Epoch29 layer0 Acc 0.882, AUC 0.9448200464248657, avg_entr 0.1138010248541832, f1 0.8820000290870667
ep29_l0_test_time 0.7864360809326172
Test Epoch29 layer1 Acc 0.8834, AUC 0.9465982913970947, avg_entr 0.09662893414497375, f1 0.8834000825881958
ep29_l1_test_time 0.7705361843109131
Test Epoch29 layer2 Acc 0.8826, AUC 0.9475451707839966, avg_entr 0.07699844986200333, f1 0.8826000094413757
ep29_l2_test_time 0.7949492931365967
Test Epoch29 layer3 Acc 0.882, AUC 0.9427168369293213, avg_entr 0.033652082085609436, f1 0.8820000290870667
ep29_l3_test_time 0.7695786952972412
Test Epoch29 layer4 Acc 0.8826, AUC 0.9448070526123047, avg_entr 0.020923491567373276, f1 0.8826000094413757
ep29_l4_test_time 0.7858843803405762
Best AUC tensor(0.9006) 3 0
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 458.6078417301178
Start Testing
Load ckpt at ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8964, AUC 0.9559177756309509, avg_entr 0.1982613354921341, f1 0.896399974822998
l0_test_time 0.7621161937713623
Test layer1 Acc 0.8968, AUC 0.9561022520065308, avg_entr 0.1817578226327896, f1 0.8967999815940857
l1_test_time 0.7951414585113525
Test layer2 Acc 0.8972, AUC 0.9564059972763062, avg_entr 0.17429564893245697, f1 0.8971999883651733
l2_test_time 0.7993242740631104
Test layer3 Acc 0.896, AUC 0.9565720558166504, avg_entr 0.15889368951320648, f1 0.8960000276565552
l3_test_time 0.7861464023590088
Test layer4 Acc 0.8964, AUC 0.9567099809646606, avg_entr 0.13739585876464844, f1 0.896399974822998
l4_test_time 0.7759671211242676
