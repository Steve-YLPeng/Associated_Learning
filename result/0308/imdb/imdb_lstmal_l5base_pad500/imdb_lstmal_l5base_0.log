total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 24.308561325073242
Start Training
gc 0
Train Epoch0 Acc 0.506475 (20259/40000), AUC 0.5112918019294739
ep0_train_time 157.1568624973297
Test Epoch0 layer4 Acc 0.5228, AUC 0.6979595422744751, avg_entr 0.6826639771461487, f1 0.5228000283241272
ep0_l4_test_time 5.57978630065918
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.758725 (30349/40000), AUC 0.831043004989624
ep1_train_time 156.74165153503418
Test Epoch1 layer4 Acc 0.7378, AUC 0.8641706705093384, avg_entr 0.466138631105423, f1 0.7378000020980835
ep1_l4_test_time 5.513052940368652
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.8578 (34312/40000), AUC 0.918710470199585
ep2_train_time 157.06729102134705
Test Epoch2 layer4 Acc 0.7608, AUC 0.8945038914680481, avg_entr 0.05509897321462631, f1 0.7608000040054321
ep2_l4_test_time 5.542456865310669
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.90215 (36086/40000), AUC 0.9510576725006104
ep3_train_time 157.39169669151306
Test Epoch3 layer4 Acc 0.8718, AUC 0.9323300123214722, avg_entr 0.047753605991601944, f1 0.8718000650405884
ep3_l4_test_time 5.486969947814941
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.91445 (36578/40000), AUC 0.959604024887085
ep4_train_time 156.91886258125305
Test Epoch4 layer4 Acc 0.8766, AUC 0.9393398761749268, avg_entr 0.036290012300014496, f1 0.8766000270843506
ep4_l4_test_time 5.543250799179077
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.927875 (37115/40000), AUC 0.9721641540527344
ep5_train_time 156.93969821929932
Test Epoch5 layer4 Acc 0.8736, AUC 0.9335763454437256, avg_entr 0.05519520863890648, f1 0.8736000061035156
ep5_l4_test_time 5.538264751434326
gc 0
Train Epoch6 Acc 0.88955 (35582/40000), AUC 0.9486196041107178
ep6_train_time 156.99002742767334
Test Epoch6 layer4 Acc 0.8652, AUC 0.9244281053543091, avg_entr 0.02685057930648327, f1 0.8652000427246094
ep6_l4_test_time 5.490970611572266
gc 0
Train Epoch7 Acc 0.89855 (35942/40000), AUC 0.9554276466369629
ep7_train_time 157.383691072464
Test Epoch7 layer4 Acc 0.8574, AUC 0.9202466011047363, avg_entr 0.039741385728120804, f1 0.8574000000953674
ep7_l4_test_time 5.503137588500977
gc 0
Train Epoch8 Acc 0.92535 (37014/40000), AUC 0.9744826555252075
ep8_train_time 157.10382342338562
Test Epoch8 layer4 Acc 0.8712, AUC 0.9382600784301758, avg_entr 0.026320090517401695, f1 0.8712000846862793
ep8_l4_test_time 5.479274749755859
gc 0
Train Epoch9 Acc 0.9487 (37948/40000), AUC 0.9860154390335083
ep9_train_time 156.87239480018616
Test Epoch9 layer4 Acc 0.8758, AUC 0.9354875087738037, avg_entr 0.027133358642458916, f1 0.8758000135421753
ep9_l4_test_time 5.519660234451294
gc 0
Train Epoch10 Acc 0.954 (38160/40000), AUC 0.9883835315704346
ep10_train_time 156.80360007286072
Test Epoch10 layer4 Acc 0.8746, AUC 0.9383692145347595, avg_entr 0.02281295694410801, f1 0.8745999932289124
ep10_l4_test_time 5.583718538284302
gc 0
Train Epoch11 Acc 0.94895 (37958/40000), AUC 0.9860728979110718
ep11_train_time 157.5043501853943
Test Epoch11 layer4 Acc 0.87, AUC 0.9316688776016235, avg_entr 0.01871686428785324, f1 0.8700000047683716
ep11_l4_test_time 5.56916880607605
gc 0
Train Epoch12 Acc 0.95935 (38374/40000), AUC 0.9902732372283936
ep12_train_time 157.10507011413574
Test Epoch12 layer4 Acc 0.8666, AUC 0.9326491355895996, avg_entr 0.0205555260181427, f1 0.866599977016449
ep12_l4_test_time 5.515403985977173
gc 0
Train Epoch13 Acc 0.967325 (38693/40000), AUC 0.9938281178474426
ep13_train_time 156.99321341514587
Test Epoch13 layer4 Acc 0.8672, AUC 0.935211181640625, avg_entr 0.020316045731306076, f1 0.8672000169754028
ep13_l4_test_time 5.492829322814941
gc 0
Train Epoch14 Acc 0.9706 (38824/40000), AUC 0.9948093891143799
ep14_train_time 156.78796696662903
Test Epoch14 layer4 Acc 0.8642, AUC 0.9322633743286133, avg_entr 0.019454414024949074, f1 0.8641999959945679
ep14_l4_test_time 5.539380311965942
gc 0
Train Epoch15 Acc 0.972975 (38919/40000), AUC 0.9953136444091797
ep15_train_time 157.4263243675232
Test Epoch15 layer4 Acc 0.8634, AUC 0.9276896119117737, avg_entr 0.014430615119636059, f1 0.8634000420570374
ep15_l4_test_time 5.591282844543457
gc 0
Train Epoch16 Acc 0.974725 (38989/40000), AUC 0.9960335493087769
ep16_train_time 156.93682599067688
Test Epoch16 layer4 Acc 0.8586, AUC 0.9299947023391724, avg_entr 0.020447026938199997, f1 0.8586000204086304
ep16_l4_test_time 5.533553123474121
gc 0
Train Epoch17 Acc 0.975375 (39015/40000), AUC 0.9963390827178955
ep17_train_time 156.97516322135925
Test Epoch17 layer4 Acc 0.8578, AUC 0.9273551106452942, avg_entr 0.015625525265932083, f1 0.8578000068664551
ep17_l4_test_time 5.47825026512146
gc 0
Train Epoch18 Acc 0.97715 (39086/40000), AUC 0.9968297481536865
ep18_train_time 157.1429262161255
Test Epoch18 layer4 Acc 0.8574, AUC 0.9260138273239136, avg_entr 0.0201310645788908, f1 0.8574000000953674
ep18_l4_test_time 5.5226523876190186
gc 0
Train Epoch19 Acc 0.97915 (39166/40000), AUC 0.9971629977226257
ep19_train_time 157.53577399253845
Test Epoch19 layer4 Acc 0.853, AUC 0.924500584602356, avg_entr 0.017847849056124687, f1 0.8529999852180481
ep19_l4_test_time 5.546676158905029
gc 0
Train Epoch20 Acc 0.98025 (39210/40000), AUC 0.9977016448974609
ep20_train_time 157.08509373664856
Test Epoch20 layer4 Acc 0.8478, AUC 0.9232125878334045, avg_entr 0.02074718289077282, f1 0.8477999567985535
ep20_l4_test_time 5.591393232345581
gc 0
Train Epoch21 Acc 0.982625 (39305/40000), AUC 0.9979066848754883
ep21_train_time 156.75099658966064
Test Epoch21 layer4 Acc 0.8558, AUC 0.9230833053588867, avg_entr 0.015859514474868774, f1 0.8558000326156616
ep21_l4_test_time 5.530860424041748
gc 0
Train Epoch22 Acc 0.98245 (39298/40000), AUC 0.9979989528656006
ep22_train_time 157.10698628425598
Test Epoch22 layer4 Acc 0.855, AUC 0.9214036464691162, avg_entr 0.01634201593697071, f1 0.8550000190734863
ep22_l4_test_time 5.398304462432861
gc 0
Train Epoch23 Acc 0.983075 (39323/40000), AUC 0.9981957674026489
ep23_train_time 157.45726943016052
Test Epoch23 layer4 Acc 0.851, AUC 0.9177533388137817, avg_entr 0.014360062777996063, f1 0.8510000109672546
ep23_l4_test_time 5.509661674499512
gc 0
Train Epoch24 Acc 0.984525 (39381/40000), AUC 0.9984463453292847
ep24_train_time 156.85142064094543
Test Epoch24 layer4 Acc 0.8496, AUC 0.9178014993667603, avg_entr 0.017571019008755684, f1 0.8496000170707703
ep24_l4_test_time 5.575150966644287
gc 0
Train Epoch25 Acc 0.98505 (39402/40000), AUC 0.9985746145248413
ep25_train_time 157.00442624092102
Test Epoch25 layer4 Acc 0.8482, AUC 0.9150009155273438, avg_entr 0.017023667693138123, f1 0.8482000231742859
ep25_l4_test_time 5.638968467712402
gc 0
Train Epoch26 Acc 0.986125 (39445/40000), AUC 0.9987107515335083
ep26_train_time 157.12242817878723
Test Epoch26 layer4 Acc 0.8496, AUC 0.9138196706771851, avg_entr 0.01189335621893406, f1 0.8496000170707703
ep26_l4_test_time 5.363145112991333
gc 0
Train Epoch27 Acc 0.986375 (39455/40000), AUC 0.9987888336181641
ep27_train_time 157.37012481689453
Test Epoch27 layer4 Acc 0.8478, AUC 0.9134248495101929, avg_entr 0.011216835118830204, f1 0.8477999567985535
ep27_l4_test_time 5.591391563415527
gc 0
Train Epoch28 Acc 0.987475 (39499/40000), AUC 0.9988834261894226
ep28_train_time 156.97743248939514
Test Epoch28 layer4 Acc 0.8436, AUC 0.9111042022705078, avg_entr 0.014011653140187263, f1 0.8435999751091003
ep28_l4_test_time 5.472988128662109
gc 0
Train Epoch29 Acc 0.987275 (39491/40000), AUC 0.9989370107650757
ep29_train_time 156.88734817504883
Test Epoch29 layer4 Acc 0.843, AUC 0.9101207852363586, avg_entr 0.015614254400134087, f1 0.8429999947547913
ep29_l4_test_time 5.505192995071411
Best AUC tensor(0.8766) 4
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 4879.96190738678
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.8832, AUC 0.9556065797805786, avg_entr 0.17370425164699554, f1 0.8831999897956848
l0_test_time 0.7666304111480713
Test layer1 Acc 0.8722, AUC 0.9329262971878052, avg_entr 0.051578089594841, f1 0.872200071811676
l1_test_time 1.7946090698242188
Test layer2 Acc 0.8736, AUC 0.9346625804901123, avg_entr 0.04733970761299133, f1 0.8736000061035156
l2_test_time 3.041696071624756
Test layer3 Acc 0.875, AUC 0.9351688623428345, avg_entr 0.04906397685408592, f1 0.875
l3_test_time 4.294403553009033
Test layer4 Acc 0.8744, AUC 0.9352462291717529, avg_entr 0.04027703031897545, f1 0.8744000792503357
l4_test_time 5.5140721797943115
