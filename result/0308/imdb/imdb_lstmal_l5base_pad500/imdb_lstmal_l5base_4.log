total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 24.22876811027527
Start Training
gc 0
Train Epoch0 Acc 0.49975 (19990/40000), AUC 0.5061321258544922
ep0_train_time 157.6981496810913
Test Epoch0 layer4 Acc 0.5272, AUC 0.7045525312423706, avg_entr 0.6960903406143188, f1 0.5271999835968018
ep0_l4_test_time 5.6180419921875
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.787225 (31489/40000), AUC 0.8580606579780579
ep1_train_time 157.30930423736572
Test Epoch1 layer4 Acc 0.8666, AUC 0.9263421297073364, avg_entr 0.08747050166130066, f1 0.866599977016449
ep1_l4_test_time 5.5615763664245605
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.8827 (35308/40000), AUC 0.9336996078491211
ep2_train_time 157.17472004890442
Test Epoch2 layer4 Acc 0.8796, AUC 0.9388172626495361, avg_entr 0.05162905901670456, f1 0.8795999884605408
ep2_l4_test_time 5.538196563720703
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.882125 (35285/40000), AUC 0.9440431594848633
ep3_train_time 157.10923504829407
Test Epoch3 layer4 Acc 0.8842, AUC 0.9416431188583374, avg_entr 0.04723688215017319, f1 0.8842000365257263
ep3_l4_test_time 5.560286521911621
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.928775 (37151/40000), AUC 0.9708768129348755
ep4_train_time 157.55783820152283
Test Epoch4 layer4 Acc 0.8886, AUC 0.942802906036377, avg_entr 0.03557349368929863, f1 0.8885999917984009
ep4_l4_test_time 5.5933098793029785
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.94005 (37602/40000), AUC 0.9783492088317871
ep5_train_time 157.18065476417542
Test Epoch5 layer4 Acc 0.8866, AUC 0.9432013630867004, avg_entr 0.030185723677277565, f1 0.8866000771522522
ep5_l4_test_time 5.602593421936035
gc 0
Train Epoch6 Acc 0.947725 (37909/40000), AUC 0.9841446876525879
ep6_train_time 156.9525785446167
Test Epoch6 layer4 Acc 0.865, AUC 0.9426854252815247, avg_entr 0.03607260435819626, f1 0.8650000095367432
ep6_l4_test_time 5.594893217086792
gc 0
Train Epoch7 Acc 0.9534 (38136/40000), AUC 0.9870145320892334
ep7_train_time 157.07746529579163
Test Epoch7 layer4 Acc 0.8782, AUC 0.9447102546691895, avg_entr 0.032233405858278275, f1 0.8781999945640564
ep7_l4_test_time 5.561275482177734
gc 0
Train Epoch8 Acc 0.957275 (38291/40000), AUC 0.9895535707473755
ep8_train_time 157.5899531841278
Test Epoch8 layer4 Acc 0.8808, AUC 0.9416078329086304, avg_entr 0.027264999225735664, f1 0.8808000087738037
ep8_l4_test_time 5.597170829772949
gc 0
Train Epoch9 Acc 0.962425 (38497/40000), AUC 0.9911795854568481
ep9_train_time 157.14057517051697
Test Epoch9 layer4 Acc 0.8758, AUC 0.9407428503036499, avg_entr 0.03000425361096859, f1 0.8758000135421753
ep9_l4_test_time 5.598759174346924
gc 0
Train Epoch10 Acc 0.964875 (38595/40000), AUC 0.9920394420623779
ep10_train_time 157.0484538078308
Test Epoch10 layer4 Acc 0.8718, AUC 0.9372867345809937, avg_entr 0.02286450006067753, f1 0.8718000650405884
ep10_l4_test_time 5.595029830932617
gc 0
Train Epoch11 Acc 0.9682 (38728/40000), AUC 0.9933041334152222
ep11_train_time 157.11591720581055
Test Epoch11 layer4 Acc 0.8682, AUC 0.9361348152160645, avg_entr 0.024347782135009766, f1 0.8682000041007996
ep11_l4_test_time 5.564659118652344
gc 0
Train Epoch12 Acc 0.970325 (38813/40000), AUC 0.9944048523902893
ep12_train_time 157.5371961593628
Test Epoch12 layer4 Acc 0.8718, AUC 0.9342092871665955, avg_entr 0.023462727665901184, f1 0.8718000650405884
ep12_l4_test_time 5.588390827178955
gc 0
Train Epoch13 Acc 0.973425 (38937/40000), AUC 0.9955312013626099
ep13_train_time 156.80416774749756
Test Epoch13 layer4 Acc 0.8698, AUC 0.9318156242370605, avg_entr 0.01911824382841587, f1 0.8697999715805054
ep13_l4_test_time 5.589266538619995
gc 0
Train Epoch14 Acc 0.975325 (39013/40000), AUC 0.9958725571632385
ep14_train_time 157.20347332954407
Test Epoch14 layer4 Acc 0.864, AUC 0.9283986687660217, avg_entr 0.016429025679826736, f1 0.8640000224113464
ep14_l4_test_time 5.59049391746521
gc 0
Train Epoch15 Acc 0.97705 (39082/40000), AUC 0.9961123466491699
ep15_train_time 156.99922251701355
Test Epoch15 layer4 Acc 0.8634, AUC 0.9277650117874146, avg_entr 0.018672168254852295, f1 0.8634000420570374
ep15_l4_test_time 5.585405588150024
gc 0
Train Epoch16 Acc 0.978875 (39155/40000), AUC 0.996497631072998
ep16_train_time 157.42453265190125
Test Epoch16 layer4 Acc 0.8618, AUC 0.9275359511375427, avg_entr 0.013604867272078991, f1 0.8618000149726868
ep16_l4_test_time 5.634607315063477
gc 0
Train Epoch17 Acc 0.9801 (39204/40000), AUC 0.9970443248748779
ep17_train_time 157.37948393821716
Test Epoch17 layer4 Acc 0.8618, AUC 0.9254506230354309, avg_entr 0.014308563433587551, f1 0.8618000149726868
ep17_l4_test_time 5.567876577377319
gc 0
Train Epoch18 Acc 0.9815 (39260/40000), AUC 0.9975268840789795
ep18_train_time 156.85236620903015
Test Epoch18 layer4 Acc 0.8592, AUC 0.9256279468536377, avg_entr 0.017086252570152283, f1 0.8592000007629395
ep18_l4_test_time 5.600184440612793
gc 0
Train Epoch19 Acc 0.983075 (39323/40000), AUC 0.9977701306343079
ep19_train_time 157.15252470970154
Test Epoch19 layer4 Acc 0.8582, AUC 0.9233726859092712, avg_entr 0.012128043919801712, f1 0.858199954032898
ep19_l4_test_time 5.537224769592285
gc 0
Train Epoch20 Acc 0.983875 (39355/40000), AUC 0.9978849291801453
ep20_train_time 157.38066577911377
Test Epoch20 layer4 Acc 0.8562, AUC 0.9205291271209717, avg_entr 0.012948566116392612, f1 0.8561999797821045
ep20_l4_test_time 5.630559206008911
gc 0
Train Epoch21 Acc 0.9844 (39376/40000), AUC 0.998225748538971
ep21_train_time 157.04756593704224
Test Epoch21 layer4 Acc 0.8552, AUC 0.9181471467018127, avg_entr 0.013201412744820118, f1 0.8551999926567078
ep21_l4_test_time 5.622543573379517
gc 0
Train Epoch22 Acc 0.985775 (39431/40000), AUC 0.9983382225036621
ep22_train_time 157.29331493377686
Test Epoch22 layer4 Acc 0.8506, AUC 0.9211200475692749, avg_entr 0.015972286462783813, f1 0.8505999445915222
ep22_l4_test_time 5.559372186660767
gc 0
Train Epoch23 Acc 0.9868 (39472/40000), AUC 0.9985394477844238
ep23_train_time 157.24883222579956
Test Epoch23 layer4 Acc 0.8508, AUC 0.913629949092865, avg_entr 0.01167271751910448, f1 0.8507999777793884
ep23_l4_test_time 5.246385812759399
gc 0
Train Epoch24 Acc 0.9873 (39492/40000), AUC 0.9986668825149536
ep24_train_time 157.81720900535583
Test Epoch24 layer4 Acc 0.8504, AUC 0.9128669500350952, avg_entr 0.013445669785141945, f1 0.8503999710083008
ep24_l4_test_time 5.622886896133423
gc 0
Train Epoch25 Acc 0.98855 (39542/40000), AUC 0.9987962245941162
ep25_train_time 156.89893698692322
Test Epoch25 layer4 Acc 0.8478, AUC 0.9138887524604797, avg_entr 0.013527282513678074, f1 0.8477999567985535
ep25_l4_test_time 5.648899555206299
gc 0
Train Epoch26 Acc 0.9887 (39548/40000), AUC 0.9989588856697083
ep26_train_time 157.16611051559448
Test Epoch26 layer4 Acc 0.8384, AUC 0.9041334390640259, avg_entr 0.013693317770957947, f1 0.8384000658988953
ep26_l4_test_time 5.5392234325408936
gc 0
Train Epoch27 Acc 0.9896 (39584/40000), AUC 0.9988985061645508
ep27_train_time 157.56864857673645
Test Epoch27 layer4 Acc 0.8366, AUC 0.9063877463340759, avg_entr 0.013545980677008629, f1 0.8366000056266785
ep27_l4_test_time 5.265617847442627
gc 0
Train Epoch28 Acc 0.9888 (39552/40000), AUC 0.9988513588905334
ep28_train_time 157.58870649337769
Test Epoch28 layer4 Acc 0.8466, AUC 0.9040000438690186, avg_entr 0.012991836294531822, f1 0.8465999960899353
ep28_l4_test_time 5.532482862472534
gc 0
Train Epoch29 Acc 0.990825 (39633/40000), AUC 0.9991582632064819
ep29_train_time 157.08570861816406
Test Epoch29 layer4 Acc 0.841, AUC 0.9084206223487854, avg_entr 0.013410549610853195, f1 0.8410000205039978
ep29_l4_test_time 5.588276147842407
Best AUC tensor(0.8886) 4
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 4886.171007633209
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.8974, AUC 0.9548953175544739, avg_entr 0.17784488201141357, f1 0.8974000215530396
l0_test_time 0.7544045448303223
Test layer1 Acc 0.8842, AUC 0.9385052919387817, avg_entr 0.0515284538269043, f1 0.8842000365257263
l1_test_time 1.779374122619629
Test layer2 Acc 0.8858, AUC 0.939691960811615, avg_entr 0.042658720165491104, f1 0.8858000040054321
l2_test_time 3.0703299045562744
Test layer3 Acc 0.8852, AUC 0.9398382902145386, avg_entr 0.04218878969550133, f1 0.8852000832557678
l3_test_time 4.269240617752075
Test layer4 Acc 0.8844, AUC 0.9401805400848389, avg_entr 0.03822913393378258, f1 0.8844000101089478
l4_test_time 5.601362705230713
