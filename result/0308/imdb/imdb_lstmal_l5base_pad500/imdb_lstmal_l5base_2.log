total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 24.090556144714355
Start Training
gc 0
Train Epoch0 Acc 0.509125 (20365/40000), AUC 0.5300313234329224
ep0_train_time 157.5034830570221
Test Epoch0 layer4 Acc 0.6488, AUC 0.7307326793670654, avg_entr 0.6700193881988525, f1 0.6488000154495239
ep0_l4_test_time 5.6463942527771
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.762525 (30501/40000), AUC 0.8341649770736694
ep1_train_time 157.66749167442322
Test Epoch1 layer4 Acc 0.817, AUC 0.894652247428894, avg_entr 0.13907228410243988, f1 0.8169999718666077
ep1_l4_test_time 5.402698993682861
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.874925 (34997/40000), AUC 0.9222710132598877
ep2_train_time 157.43067169189453
Test Epoch2 layer4 Acc 0.8736, AUC 0.937333345413208, avg_entr 0.0434170700609684, f1 0.8736000061035156
ep2_l4_test_time 5.587464332580566
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9133 (36532/40000), AUC 0.9595128297805786
ep3_train_time 157.02040266990662
Test Epoch3 layer4 Acc 0.8472, AUC 0.9254617691040039, avg_entr 0.03258268162608147, f1 0.8471999764442444
ep3_l4_test_time 5.579456329345703
gc 0
Train Epoch4 Acc 0.9164 (36656/40000), AUC 0.9621292352676392
ep4_train_time 157.16467237472534
Test Epoch4 layer4 Acc 0.831, AUC 0.9340026378631592, avg_entr 0.1073894128203392, f1 0.8309999704360962
ep4_l4_test_time 5.57441782951355
gc 0
Train Epoch5 Acc 0.9381 (37524/40000), AUC 0.9768150448799133
ep5_train_time 157.603351354599
Test Epoch5 layer4 Acc 0.891, AUC 0.9481897354125977, avg_entr 0.031884465366601944, f1 0.890999972820282
ep5_l4_test_time 5.514923334121704
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.947 (37880/40000), AUC 0.984291672706604
ep6_train_time 157.33770728111267
Test Epoch6 layer4 Acc 0.8872, AUC 0.9493721723556519, avg_entr 0.033804360777139664, f1 0.8871999979019165
ep6_l4_test_time 5.593493461608887
gc 0
Train Epoch7 Acc 0.95325 (38130/40000), AUC 0.9875074028968811
ep7_train_time 157.15692257881165
Test Epoch7 layer4 Acc 0.8836, AUC 0.9476966261863708, avg_entr 0.034080345183610916, f1 0.8835999965667725
ep7_l4_test_time 5.569854259490967
gc 0
Train Epoch8 Acc 0.95775 (38310/40000), AUC 0.9897065758705139
ep8_train_time 157.05067038536072
Test Epoch8 layer4 Acc 0.882, AUC 0.9454946517944336, avg_entr 0.028756899759173393, f1 0.8820000290870667
ep8_l4_test_time 5.559488534927368
gc 0
Train Epoch9 Acc 0.9622 (38488/40000), AUC 0.9911739826202393
ep9_train_time 157.67629885673523
Test Epoch9 layer4 Acc 0.88, AUC 0.9423526525497437, avg_entr 0.023611322045326233, f1 0.8799999952316284
ep9_l4_test_time 5.6190345287323
gc 0
Train Epoch10 Acc 0.965225 (38609/40000), AUC 0.9925087690353394
ep10_train_time 156.98662734031677
Test Epoch10 layer4 Acc 0.8586, AUC 0.9248847961425781, avg_entr 0.02114367112517357, f1 0.8586000204086304
ep10_l4_test_time 5.639894723892212
gc 0
Train Epoch11 Acc 0.96905 (38762/40000), AUC 0.9935152530670166
ep11_train_time 157.03118085861206
Test Epoch11 layer4 Acc 0.8676, AUC 0.9379739761352539, avg_entr 0.02831435203552246, f1 0.8675999641418457
ep11_l4_test_time 5.57576847076416
gc 0
Train Epoch12 Acc 0.970725 (38829/40000), AUC 0.9945147037506104
ep12_train_time 156.96328806877136
Test Epoch12 layer4 Acc 0.866, AUC 0.9310334920883179, avg_entr 0.022497257217764854, f1 0.8659999966621399
ep12_l4_test_time 5.571816682815552
gc 0
Train Epoch13 Acc 0.965925 (38637/40000), AUC 0.9936070442199707
ep13_train_time 157.66506123542786
Test Epoch13 layer4 Acc 0.8696, AUC 0.9308758974075317, avg_entr 0.02264138124883175, f1 0.8695999383926392
ep13_l4_test_time 5.589622259140015
gc 0
Train Epoch14 Acc 0.97495 (38998/40000), AUC 0.9957181215286255
ep14_train_time 157.03784012794495
Test Epoch14 layer4 Acc 0.864, AUC 0.9321306943893433, avg_entr 0.018948914483189583, f1 0.8640000224113464
ep14_l4_test_time 5.562921524047852
gc 0
Train Epoch15 Acc 0.976575 (39063/40000), AUC 0.9965556859970093
ep15_train_time 157.14713859558105
Test Epoch15 layer4 Acc 0.8636, AUC 0.9305318593978882, avg_entr 0.017241479828953743, f1 0.8636000156402588
ep15_l4_test_time 5.583290100097656
gc 0
Train Epoch16 Acc 0.97895 (39158/40000), AUC 0.9969217777252197
ep16_train_time 157.32742619514465
Test Epoch16 layer4 Acc 0.8608, AUC 0.9279458522796631, avg_entr 0.02142026461660862, f1 0.86080002784729
ep16_l4_test_time 5.582895278930664
gc 0
Train Epoch17 Acc 0.97905 (39162/40000), AUC 0.9972320795059204
ep17_train_time 157.50540137290955
Test Epoch17 layer4 Acc 0.8598, AUC 0.92493736743927, avg_entr 0.014472010545432568, f1 0.8597999811172485
ep17_l4_test_time 5.5723137855529785
gc 0
Train Epoch18 Acc 0.981125 (39245/40000), AUC 0.9975379705429077
ep18_train_time 156.98144841194153
Test Epoch18 layer4 Acc 0.8592, AUC 0.9243258237838745, avg_entr 0.013703006319701672, f1 0.8592000007629395
ep18_l4_test_time 5.5500874519348145
gc 0
Train Epoch19 Acc 0.982125 (39285/40000), AUC 0.9976341724395752
ep19_train_time 157.27425622940063
Test Epoch19 layer4 Acc 0.8574, AUC 0.9215031266212463, avg_entr 0.015323708765208721, f1 0.8574000000953674
ep19_l4_test_time 5.597829818725586
gc 0
Train Epoch20 Acc 0.98265 (39306/40000), AUC 0.9978780746459961
ep20_train_time 156.98159790039062
Test Epoch20 layer4 Acc 0.8562, AUC 0.9181196689605713, avg_entr 0.015357798896729946, f1 0.8561999797821045
ep20_l4_test_time 5.606111526489258
gc 0
Train Epoch21 Acc 0.984325 (39373/40000), AUC 0.99814772605896
ep21_train_time 157.47062468528748
Test Epoch21 layer4 Acc 0.8528, AUC 0.9222047328948975, avg_entr 0.012268522754311562, f1 0.8528000116348267
ep21_l4_test_time 5.511819839477539
gc 0
Train Epoch22 Acc 0.9852 (39408/40000), AUC 0.9982436895370483
ep22_train_time 157.17123079299927
Test Epoch22 layer4 Acc 0.8514, AUC 0.9165297746658325, avg_entr 0.014390243217349052, f1 0.8514000177383423
ep22_l4_test_time 5.562486171722412
gc 0
Train Epoch23 Acc 0.986125 (39445/40000), AUC 0.9984471201896667
ep23_train_time 157.39610171318054
Test Epoch23 layer4 Acc 0.8444, AUC 0.9143121242523193, avg_entr 0.012760431505739689, f1 0.8443999886512756
ep23_l4_test_time 5.53911018371582
gc 0
Train Epoch24 Acc 0.9862 (39448/40000), AUC 0.9984625577926636
ep24_train_time 157.0562572479248
Test Epoch24 layer4 Acc 0.8498, AUC 0.9172351956367493, avg_entr 0.010569969192147255, f1 0.8497999906539917
ep24_l4_test_time 5.5828540325164795
gc 0
Train Epoch25 Acc 0.98785 (39514/40000), AUC 0.9987276792526245
ep25_train_time 157.47282218933105
Test Epoch25 layer4 Acc 0.8462, AUC 0.9130558967590332, avg_entr 0.013862757943570614, f1 0.8461999893188477
ep25_l4_test_time 5.627228498458862
gc 0
Train Epoch26 Acc 0.9873 (39492/40000), AUC 0.9987038373947144
ep26_train_time 157.1782250404358
Test Epoch26 layer4 Acc 0.8456, AUC 0.9093973636627197, avg_entr 0.00923795998096466, f1 0.8456000089645386
ep26_l4_test_time 5.503028631210327
gc 0
Train Epoch27 Acc 0.988525 (39541/40000), AUC 0.99892258644104
ep27_train_time 157.18142294883728
Test Epoch27 layer4 Acc 0.8372, AUC 0.9074184894561768, avg_entr 0.012093324214220047, f1 0.8371999859809875
ep27_l4_test_time 5.59154200553894
gc 0
Train Epoch28 Acc 0.98835 (39534/40000), AUC 0.998672604560852
ep28_train_time 157.25161218643188
Test Epoch28 layer4 Acc 0.8458, AUC 0.9094966650009155, avg_entr 0.012477966956794262, f1 0.84579998254776
ep28_l4_test_time 5.58379340171814
gc 0
Train Epoch29 Acc 0.9893 (39572/40000), AUC 0.9990154504776001
ep29_train_time 157.57057213783264
Test Epoch29 layer4 Acc 0.8446, AUC 0.9024969339370728, avg_entr 0.009685162454843521, f1 0.8446000814437866
ep29_l4_test_time 5.614641427993774
Best AUC tensor(0.8910) 5
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 4887.200990438461
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.8812, AUC 0.9549648761749268, avg_entr 0.15803290903568268, f1 0.8812000155448914
l0_test_time 0.7616786956787109
Test layer1 Acc 0.8788, AUC 0.9402046203613281, avg_entr 0.041783008724451065, f1 0.8787999749183655
l1_test_time 1.7847824096679688
Test layer2 Acc 0.8792, AUC 0.9418066740036011, avg_entr 0.03625641018152237, f1 0.8791999816894531
l2_test_time 3.0864429473876953
Test layer3 Acc 0.8794, AUC 0.9424450993537903, avg_entr 0.034701086580753326, f1 0.8794000148773193
l3_test_time 4.2985076904296875
Test layer4 Acc 0.8778, AUC 0.9423009157180786, avg_entr 0.032647695392370224, f1 0.8778000473976135
l4_test_time 5.550079584121704
