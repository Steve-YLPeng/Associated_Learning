total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 22.269521236419678
Start Training
gc 0
Train Epoch0 Acc 0.524425 (20977/40000), AUC 0.5522992014884949
ep0_train_time 78.79895830154419
Test Epoch0 layer4 Acc 0.725, AUC 0.7932405471801758, avg_entr 0.3150319457054138, f1 0.7250000238418579
ep0_l4_test_time 2.884037494659424
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.8105 (32420/40000), AUC 0.8650119304656982
ep1_train_time 79.01478052139282
Test Epoch1 layer4 Acc 0.8452, AUC 0.913515031337738, avg_entr 0.11129196733236313, f1 0.8452000021934509
ep1_l4_test_time 2.8532803058624268
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.871025 (34841/40000), AUC 0.9220767617225647
ep2_train_time 79.00949788093567
Test Epoch2 layer4 Acc 0.864, AUC 0.9337604641914368, avg_entr 0.06020067259669304, f1 0.8640000224113464
ep2_l4_test_time 2.874333620071411
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9062 (36248/40000), AUC 0.9536041021347046
ep3_train_time 78.92601537704468
Test Epoch3 layer4 Acc 0.88, AUC 0.9436113834381104, avg_entr 0.049352485686540604, f1 0.8799999952316284
ep3_l4_test_time 2.8777823448181152
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.91285 (36514/40000), AUC 0.9628958702087402
ep4_train_time 78.97334337234497
Test Epoch4 layer4 Acc 0.887, AUC 0.9418379068374634, avg_entr 0.03592688962817192, f1 0.8870000243186951
ep4_l4_test_time 2.864100933074951
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.93855 (37542/40000), AUC 0.9787561893463135
ep5_train_time 78.89009284973145
Test Epoch5 layer4 Acc 0.89, AUC 0.9456877708435059, avg_entr 0.03966519236564636, f1 0.8899999856948853
ep5_l4_test_time 2.8855037689208984
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.947325 (37893/40000), AUC 0.9841723442077637
ep6_train_time 78.90285801887512
Test Epoch6 layer4 Acc 0.8812, AUC 0.943703293800354, avg_entr 0.030773639678955078, f1 0.8812000155448914
ep6_l4_test_time 2.850473403930664
gc 0
Train Epoch7 Acc 0.9526 (38104/40000), AUC 0.9872697591781616
ep7_train_time 78.93958187103271
Test Epoch7 layer4 Acc 0.867, AUC 0.939623236656189, avg_entr 0.0518467091023922, f1 0.8669999837875366
ep7_l4_test_time 2.8727669715881348
gc 0
Train Epoch8 Acc 0.956575 (38263/40000), AUC 0.9886990785598755
ep8_train_time 78.86056303977966
Test Epoch8 layer4 Acc 0.876, AUC 0.942935585975647, avg_entr 0.04357457906007767, f1 0.8760000467300415
ep8_l4_test_time 2.8774993419647217
gc 0
Train Epoch9 Acc 0.961575 (38463/40000), AUC 0.9910261631011963
ep9_train_time 78.89025497436523
Test Epoch9 layer4 Acc 0.8772, AUC 0.9351879358291626, avg_entr 0.022665563970804214, f1 0.8772000074386597
ep9_l4_test_time 2.8625648021698
gc 0
Train Epoch10 Acc 0.965225 (38609/40000), AUC 0.9922735095024109
ep10_train_time 78.85927867889404
Test Epoch10 layer4 Acc 0.87, AUC 0.9344801902770996, avg_entr 0.023698750883340836, f1 0.8700000047683716
ep10_l4_test_time 2.8800241947174072
gc 0
Train Epoch11 Acc 0.967225 (38689/40000), AUC 0.9933159351348877
ep11_train_time 78.89708137512207
Test Epoch11 layer4 Acc 0.8684, AUC 0.9370352029800415, avg_entr 0.02985832840204239, f1 0.868399977684021
ep11_l4_test_time 2.8500237464904785
gc 0
Train Epoch12 Acc 0.9707 (38828/40000), AUC 0.994351863861084
ep12_train_time 78.8692581653595
Test Epoch12 layer4 Acc 0.8686, AUC 0.9320218563079834, avg_entr 0.020399490371346474, f1 0.8686000108718872
ep12_l4_test_time 2.868025302886963
gc 0
Train Epoch13 Acc 0.971625 (38865/40000), AUC 0.9947929382324219
ep13_train_time 78.96879196166992
Test Epoch13 layer4 Acc 0.8496, AUC 0.917926549911499, avg_entr 0.033775001764297485, f1 0.8496000170707703
ep13_l4_test_time 2.876106023788452
gc 0
Train Epoch14 Acc 0.972675 (38907/40000), AUC 0.9952590465545654
ep14_train_time 78.88292717933655
Test Epoch14 layer4 Acc 0.8602, AUC 0.9254142045974731, avg_entr 0.015852661803364754, f1 0.8601999878883362
ep14_l4_test_time 2.8646774291992188
gc 0
Train Epoch15 Acc 0.976275 (39051/40000), AUC 0.9962043166160583
ep15_train_time 78.9364116191864
Test Epoch15 layer4 Acc 0.8498, AUC 0.9275329113006592, avg_entr 0.026955727487802505, f1 0.8497999906539917
ep15_l4_test_time 2.880458354949951
gc 0
Train Epoch16 Acc 0.9769 (39076/40000), AUC 0.9963715076446533
ep16_train_time 78.99009609222412
Test Epoch16 layer4 Acc 0.8582, AUC 0.9257116317749023, avg_entr 0.015589883551001549, f1 0.858199954032898
ep16_l4_test_time 2.8541836738586426
gc 0
Train Epoch17 Acc 0.9795 (39180/40000), AUC 0.9971473217010498
ep17_train_time 78.88254308700562
Test Epoch17 layer4 Acc 0.8514, AUC 0.9235032200813293, avg_entr 0.020184330642223358, f1 0.8514000177383423
ep17_l4_test_time 2.869807720184326
gc 0
Train Epoch18 Acc 0.9796 (39184/40000), AUC 0.9972580671310425
ep18_train_time 78.84799718856812
Test Epoch18 layer4 Acc 0.847, AUC 0.9202721118927002, avg_entr 0.02273791842162609, f1 0.847000002861023
ep18_l4_test_time 2.87874174118042
gc 0
Train Epoch19 Acc 0.98185 (39274/40000), AUC 0.9977669715881348
ep19_train_time 78.93444991111755
Test Epoch19 layer4 Acc 0.8532, AUC 0.9201688766479492, avg_entr 0.014169611036777496, f1 0.8532000184059143
ep19_l4_test_time 2.8616485595703125
gc 0
Train Epoch20 Acc 0.982725 (39309/40000), AUC 0.9979958534240723
ep20_train_time 78.87724900245667
Test Epoch20 layer4 Acc 0.8486, AUC 0.9218568801879883, avg_entr 0.01732225902378559, f1 0.8485999703407288
ep20_l4_test_time 2.879504442214966
gc 0
Train Epoch21 Acc 0.984025 (39361/40000), AUC 0.9981555938720703
ep21_train_time 78.89352536201477
Test Epoch21 layer4 Acc 0.845, AUC 0.9087734222412109, avg_entr 0.015497247688472271, f1 0.8449999690055847
ep21_l4_test_time 2.853940010070801
gc 0
Train Epoch22 Acc 0.98425 (39370/40000), AUC 0.9983192682266235
ep22_train_time 79.02644300460815
Test Epoch22 layer4 Acc 0.848, AUC 0.9130941033363342, avg_entr 0.011081895790994167, f1 0.8479999899864197
ep22_l4_test_time 2.8685824871063232
gc 0
Train Epoch23 Acc 0.98545 (39418/40000), AUC 0.9985140562057495
ep23_train_time 78.8565559387207
Test Epoch23 layer4 Acc 0.8462, AUC 0.9147255420684814, avg_entr 0.01616578735411167, f1 0.8461999893188477
ep23_l4_test_time 2.8785157203674316
gc 0
Train Epoch24 Acc 0.9868 (39472/40000), AUC 0.9984000325202942
ep24_train_time 78.92459726333618
Test Epoch24 layer4 Acc 0.8478, AUC 0.9129934310913086, avg_entr 0.014852549880743027, f1 0.8477999567985535
ep24_l4_test_time 2.8601303100585938
gc 0
Train Epoch25 Acc 0.984875 (39395/40000), AUC 0.998331606388092
ep25_train_time 78.89935994148254
Test Epoch25 layer4 Acc 0.8436, AUC 0.9090221524238586, avg_entr 0.013595310971140862, f1 0.8435999751091003
ep25_l4_test_time 2.8794145584106445
gc 0
Train Epoch26 Acc 0.98655 (39462/40000), AUC 0.9986573457717896
ep26_train_time 78.92813539505005
Test Epoch26 layer4 Acc 0.8442, AUC 0.9104122519493103, avg_entr 0.012954055331647396, f1 0.8442000150680542
ep26_l4_test_time 2.8491384983062744
gc 0
Train Epoch27 Acc 0.986375 (39455/40000), AUC 0.9984992742538452
ep27_train_time 78.92542171478271
Test Epoch27 layer4 Acc 0.8414, AUC 0.9121309518814087, avg_entr 0.014799591153860092, f1 0.8414000272750854
ep27_l4_test_time 2.867152452468872
gc 0
Train Epoch28 Acc 0.987625 (39505/40000), AUC 0.9985827803611755
ep28_train_time 78.88045406341553
Test Epoch28 layer4 Acc 0.8416, AUC 0.9073656797409058, avg_entr 0.012014382518827915, f1 0.8416000008583069
ep28_l4_test_time 2.876570463180542
gc 0
Train Epoch29 Acc 0.9894 (39576/40000), AUC 0.9990078210830688
ep29_train_time 78.93669056892395
Test Epoch29 layer4 Acc 0.8358, AUC 0.9067150354385376, avg_entr 0.012040886096656322, f1 0.8357999920845032
ep29_l4_test_time 2.864011526107788
Best AUC tensor(0.8900) 5
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 2455.3146102428436
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.8952, AUC 0.9546490907669067, avg_entr 0.16879317164421082, f1 0.8952000141143799
l0_test_time 0.5471324920654297
Test layer1 Acc 0.8802, AUC 0.9394240379333496, avg_entr 0.049875952303409576, f1 0.8802000284194946
l1_test_time 1.0494656562805176
Test layer2 Acc 0.88, AUC 0.9407991170883179, avg_entr 0.042829595506191254, f1 0.8799999952316284
l2_test_time 1.647890567779541
Test layer3 Acc 0.8784, AUC 0.9402505159378052, avg_entr 0.04054630175232887, f1 0.8784000277519226
l3_test_time 2.257063388824463
Test layer4 Acc 0.879, AUC 0.9407572746276855, avg_entr 0.042689647525548935, f1 0.8790000081062317
l4_test_time 2.861372232437134
