total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 21.660096883773804
Start Training
gc 0
Train Epoch0 Acc 0.509525 (20381/40000), AUC 0.5161882638931274
ep0_train_time 79.06626415252686
Test Epoch0 layer4 Acc 0.6664, AUC 0.7463276982307434, avg_entr 0.6704350113868713, f1 0.6664000153541565
ep0_l4_test_time 2.924154043197632
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.79225 (31690/40000), AUC 0.8570221662521362
ep1_train_time 79.27581310272217
Test Epoch1 layer4 Acc 0.8172, AUC 0.8955519795417786, avg_entr 0.11874072253704071, f1 0.8172000050544739
ep1_l4_test_time 2.898566961288452
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.876075 (35043/40000), AUC 0.9287762641906738
ep2_train_time 79.1975371837616
Test Epoch2 layer4 Acc 0.8808, AUC 0.9386516213417053, avg_entr 0.053008440881967545, f1 0.8808000087738037
ep2_l4_test_time 2.904331922531128
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.913 (36520/40000), AUC 0.9609452486038208
ep3_train_time 79.22916293144226
Test Epoch3 layer4 Acc 0.8604, AUC 0.9250423908233643, avg_entr 0.033619385212659836, f1 0.8604000210762024
ep3_l4_test_time 2.898094892501831
gc 0
Train Epoch4 Acc 0.926 (37040/40000), AUC 0.9705666303634644
ep4_train_time 79.09268450737
Test Epoch4 layer4 Acc 0.8722, AUC 0.9473162889480591, avg_entr 0.060001783072948456, f1 0.872200071811676
ep4_l4_test_time 2.8986635208129883
gc 0
Train Epoch5 Acc 0.940975 (37639/40000), AUC 0.9811714887619019
ep5_train_time 79.1217291355133
Test Epoch5 layer4 Acc 0.8894, AUC 0.9502719640731812, avg_entr 0.03572367876768112, f1 0.8894000053405762
ep5_l4_test_time 2.921665906906128
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.948725 (37949/40000), AUC 0.9860187768936157
ep6_train_time 79.15442681312561
Test Epoch6 layer4 Acc 0.8866, AUC 0.9477324485778809, avg_entr 0.026575641706585884, f1 0.8866000771522522
ep6_l4_test_time 2.8908779621124268
gc 0
Train Epoch7 Acc 0.95405 (38162/40000), AUC 0.9881898164749146
ep7_train_time 79.1390688419342
Test Epoch7 layer4 Acc 0.8814, AUC 0.9478579759597778, avg_entr 0.04457749053835869, f1 0.8813999891281128
ep7_l4_test_time 2.8978607654571533
gc 0
Train Epoch8 Acc 0.9591 (38364/40000), AUC 0.9898278713226318
ep8_train_time 79.1423614025116
Test Epoch8 layer4 Acc 0.88, AUC 0.9445587992668152, avg_entr 0.03020569495856762, f1 0.8799999952316284
ep8_l4_test_time 2.899404764175415
gc 0
Train Epoch9 Acc 0.962275 (38491/40000), AUC 0.991775393486023
ep9_train_time 79.09614038467407
Test Epoch9 layer4 Acc 0.8818, AUC 0.9437320232391357, avg_entr 0.02635878324508667, f1 0.8818000555038452
ep9_l4_test_time 2.8989217281341553
gc 0
Train Epoch10 Acc 0.965525 (38621/40000), AUC 0.9932036399841309
ep10_train_time 79.12337946891785
Test Epoch10 layer4 Acc 0.866, AUC 0.9372063875198364, avg_entr 0.02569560520350933, f1 0.8659999966621399
ep10_l4_test_time 2.920276403427124
gc 0
Train Epoch11 Acc 0.968175 (38727/40000), AUC 0.9936384558677673
ep11_train_time 79.12998366355896
Test Epoch11 layer4 Acc 0.8658, AUC 0.9393138885498047, avg_entr 0.025959821417927742, f1 0.8658000826835632
ep11_l4_test_time 2.891798257827759
gc 0
Train Epoch12 Acc 0.971525 (38861/40000), AUC 0.9946662187576294
ep12_train_time 79.12046718597412
Test Epoch12 layer4 Acc 0.872, AUC 0.9376363158226013, avg_entr 0.01797996647655964, f1 0.871999979019165
ep12_l4_test_time 2.9000232219696045
gc 0
Train Epoch13 Acc 0.974075 (38963/40000), AUC 0.9957616329193115
ep13_train_time 79.10346698760986
Test Epoch13 layer4 Acc 0.8694, AUC 0.933578372001648, avg_entr 0.016292868182063103, f1 0.8694000244140625
ep13_l4_test_time 2.89703369140625
gc 0
Train Epoch14 Acc 0.97605 (39042/40000), AUC 0.9962931275367737
ep14_train_time 79.14822149276733
Test Epoch14 layer4 Acc 0.8658, AUC 0.935373067855835, avg_entr 0.022634487599134445, f1 0.8658000826835632
ep14_l4_test_time 2.9070215225219727
gc 0
Train Epoch15 Acc 0.9774 (39096/40000), AUC 0.9964656233787537
ep15_train_time 79.19340252876282
Test Epoch15 layer4 Acc 0.8664, AUC 0.9307730197906494, avg_entr 0.015638018026947975, f1 0.8664000034332275
ep15_l4_test_time 2.9165098667144775
gc 0
Train Epoch16 Acc 0.979025 (39161/40000), AUC 0.9969720840454102
ep16_train_time 79.25634217262268
Test Epoch16 layer4 Acc 0.8592, AUC 0.9304949045181274, avg_entr 0.019679447636008263, f1 0.8592000007629395
ep16_l4_test_time 2.8916940689086914
gc 0
Train Epoch17 Acc 0.98065 (39226/40000), AUC 0.9972690343856812
ep17_train_time 79.21428060531616
Test Epoch17 layer4 Acc 0.8628, AUC 0.9256726503372192, avg_entr 0.01185295544564724, f1 0.8628000020980835
ep17_l4_test_time 2.907578945159912
gc 0
Train Epoch18 Acc 0.98105 (39242/40000), AUC 0.9973617792129517
ep18_train_time 79.2350389957428
Test Epoch18 layer4 Acc 0.8592, AUC 0.9250673055648804, avg_entr 0.016146663576364517, f1 0.8592000007629395
ep18_l4_test_time 2.9042911529541016
gc 0
Train Epoch19 Acc 0.9828 (39312/40000), AUC 0.9978361129760742
ep19_train_time 79.2183244228363
Test Epoch19 layer4 Acc 0.8538, AUC 0.9261481761932373, avg_entr 0.01833069697022438, f1 0.8537999987602234
ep19_l4_test_time 2.8993988037109375
gc 0
Train Epoch20 Acc 0.983975 (39359/40000), AUC 0.9979095458984375
ep20_train_time 79.16834330558777
Test Epoch20 layer4 Acc 0.849, AUC 0.922822117805481, avg_entr 0.010885062627494335, f1 0.8489999771118164
ep20_l4_test_time 2.9179952144622803
gc 0
Train Epoch21 Acc 0.98465 (39386/40000), AUC 0.9982091188430786
ep21_train_time 79.26700925827026
Test Epoch21 layer4 Acc 0.8502, AUC 0.9234643578529358, avg_entr 0.015415213070809841, f1 0.8501999974250793
ep21_l4_test_time 2.8893134593963623
gc 0
Train Epoch22 Acc 0.985825 (39433/40000), AUC 0.9982280731201172
ep22_train_time 79.44382667541504
Test Epoch22 layer4 Acc 0.8526, AUC 0.9207944869995117, avg_entr 0.014468283392488956, f1 0.8525999784469604
ep22_l4_test_time 2.9124367237091064
gc 0
Train Epoch23 Acc 0.98525 (39410/40000), AUC 0.9982422590255737
ep23_train_time 79.34864830970764
Test Epoch23 layer4 Acc 0.8482, AUC 0.9160724878311157, avg_entr 0.01559791062027216, f1 0.8482000231742859
ep23_l4_test_time 2.8974568843841553
gc 0
Train Epoch24 Acc 0.986725 (39469/40000), AUC 0.9986069202423096
ep24_train_time 79.35727548599243
Test Epoch24 layer4 Acc 0.8454, AUC 0.912879467010498, avg_entr 0.009794398210942745, f1 0.8453999757766724
ep24_l4_test_time 2.9023942947387695
gc 0
Train Epoch25 Acc 0.9876 (39504/40000), AUC 0.9986249208450317
ep25_train_time 79.29563927650452
Test Epoch25 layer4 Acc 0.843, AUC 0.9126688241958618, avg_entr 0.018114697188138962, f1 0.8429999947547913
ep25_l4_test_time 2.923462390899658
gc 0
Train Epoch26 Acc 0.98795 (39518/40000), AUC 0.9987127780914307
ep26_train_time 79.32326745986938
Test Epoch26 layer4 Acc 0.843, AUC 0.9085487127304077, avg_entr 0.012701992876827717, f1 0.8429999947547913
ep26_l4_test_time 2.891298770904541
gc 0
Train Epoch27 Acc 0.9891 (39564/40000), AUC 0.998960018157959
ep27_train_time 79.24628973007202
Test Epoch27 layer4 Acc 0.8442, AUC 0.9099483489990234, avg_entr 0.010980230756103992, f1 0.8442000150680542
ep27_l4_test_time 2.899317502975464
gc 0
Train Epoch28 Acc 0.989125 (39565/40000), AUC 0.9990577697753906
ep28_train_time 79.29633212089539
Test Epoch28 layer4 Acc 0.845, AUC 0.9059486389160156, avg_entr 0.01111348532140255, f1 0.8449999690055847
ep28_l4_test_time 2.899332046508789
gc 0
Train Epoch29 Acc 0.990525 (39621/40000), AUC 0.9990624189376831
ep29_train_time 79.32137537002563
Test Epoch29 layer4 Acc 0.843, AUC 0.9050197601318359, avg_entr 0.008536139503121376, f1 0.8429999947547913
ep29_l4_test_time 2.8998982906341553
Best AUC tensor(0.8894) 5
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 2465.0339965820312
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.8794, AUC 0.9545586109161377, avg_entr 0.15742136538028717, f1 0.8794000148773193
l0_test_time 0.5487685203552246
Test layer1 Acc 0.8836, AUC 0.94590824842453, avg_entr 0.05416008457541466, f1 0.8835999965667725
l1_test_time 1.0459251403808594
Test layer2 Acc 0.8852, AUC 0.9461565017700195, avg_entr 0.04319954290986061, f1 0.8852000832557678
l2_test_time 1.666804552078247
Test layer3 Acc 0.8844, AUC 0.9457013607025146, avg_entr 0.045048054307699203, f1 0.8844000101089478
l3_test_time 2.27830171585083
Test layer4 Acc 0.8834, AUC 0.9462132453918457, avg_entr 0.04070388153195381, f1 0.8834000825881958
l4_test_time 2.896733045578003
