total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 24.252089977264404
Start Training
gc 0
Train Epoch0 Acc 0.512625 (20505/40000), AUC 0.5168784856796265
ep0_train_time 157.51941108703613
Test Epoch0 layer4 Acc 0.6012, AUC 0.7208666801452637, avg_entr 0.6849612593650818, f1 0.6011999845504761
ep0_l4_test_time 5.6693274974823
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.77995 (31198/40000), AUC 0.8432360887527466
ep1_train_time 157.20947098731995
Test Epoch1 layer4 Acc 0.8274, AUC 0.89363032579422, avg_entr 0.12076235562562943, f1 0.8274000287055969
ep1_l4_test_time 5.556339502334595
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.8249 (32996/40000), AUC 0.8931559324264526
ep2_train_time 157.9828805923462
Test Epoch2 layer4 Acc 0.8372, AUC 0.9042075872421265, avg_entr 0.0739133208990097, f1 0.8371999859809875
ep2_l4_test_time 5.540425062179565
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.879375 (35175/40000), AUC 0.9338226914405823
ep3_train_time 157.54507040977478
Test Epoch3 layer4 Acc 0.863, AUC 0.9281454086303711, avg_entr 0.048650823533535004, f1 0.8629999756813049
ep3_l4_test_time 5.581300735473633
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.91485 (36594/40000), AUC 0.9601645469665527
ep4_train_time 157.10733079910278
Test Epoch4 layer4 Acc 0.846, AUC 0.9283230304718018, avg_entr 0.06273705512285233, f1 0.8460000157356262
ep4_l4_test_time 5.641086101531982
gc 0
Train Epoch5 Acc 0.912025 (36481/40000), AUC 0.9598127603530884
ep5_train_time 157.2293655872345
Test Epoch5 layer4 Acc 0.8838, AUC 0.9373012781143188, avg_entr 0.04406863451004028, f1 0.8838000297546387
ep5_l4_test_time 5.671140193939209
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.928175 (37127/40000), AUC 0.9672704935073853
ep6_train_time 157.69506883621216
Test Epoch6 layer4 Acc 0.8782, AUC 0.9312927722930908, avg_entr 0.030143795534968376, f1 0.8781999945640564
ep6_l4_test_time 5.529603004455566
gc 0
Train Epoch7 Acc 0.920625 (36825/40000), AUC 0.9672792553901672
ep7_train_time 157.48711705207825
Test Epoch7 layer4 Acc 0.7794, AUC 0.9043564796447754, avg_entr 0.04332226142287254, f1 0.7794000506401062
ep7_l4_test_time 5.589076519012451
gc 0
Train Epoch8 Acc 0.8074 (32296/40000), AUC 0.8871667385101318
ep8_train_time 157.26361560821533
Test Epoch8 layer4 Acc 0.8366, AUC 0.9242035150527954, avg_entr 0.09395851194858551, f1 0.8366000056266785
ep8_l4_test_time 5.585535287857056
gc 0
Train Epoch9 Acc 0.9134 (36536/40000), AUC 0.9537179470062256
ep9_train_time 157.23738884925842
Test Epoch9 layer4 Acc 0.8672, AUC 0.9217004179954529, avg_entr 0.01793568953871727, f1 0.8672000169754028
ep9_l4_test_time 5.620390892028809
gc 0
Train Epoch10 Acc 0.9397 (37588/40000), AUC 0.9792544841766357
ep10_train_time 157.86765098571777
Test Epoch10 layer4 Acc 0.8674, AUC 0.9225581884384155, avg_entr 0.0188096072524786, f1 0.8673999905586243
ep10_l4_test_time 5.63068151473999
gc 0
Train Epoch11 Acc 0.947375 (37895/40000), AUC 0.981726884841919
ep11_train_time 157.34716510772705
Test Epoch11 layer4 Acc 0.8556, AUC 0.9168363213539124, avg_entr 0.022432055324316025, f1 0.8555999994277954
ep11_l4_test_time 5.553261756896973
gc 0
Train Epoch12 Acc 0.96 (38400/40000), AUC 0.9900497198104858
ep12_train_time 157.319194316864
Test Epoch12 layer4 Acc 0.8652, AUC 0.9223341941833496, avg_entr 0.01851523481309414, f1 0.8652000427246094
ep12_l4_test_time 5.591789245605469
gc 0
Train Epoch13 Acc 0.963375 (38535/40000), AUC 0.9923971891403198
ep13_train_time 157.36478114128113
Test Epoch13 layer4 Acc 0.8656, AUC 0.9274721741676331, avg_entr 0.022055357694625854, f1 0.8655999898910522
ep13_l4_test_time 5.550285577774048
gc 0
Train Epoch14 Acc 0.968075 (38723/40000), AUC 0.9937870502471924
ep14_train_time 157.59525060653687
Test Epoch14 layer4 Acc 0.8674, AUC 0.92930006980896, avg_entr 0.020035145804286003, f1 0.8673999905586243
ep14_l4_test_time 5.579571723937988
gc 0
Train Epoch15 Acc 0.97065 (38826/40000), AUC 0.9945924282073975
ep15_train_time 157.32120060920715
Test Epoch15 layer4 Acc 0.8594, AUC 0.9214865565299988, avg_entr 0.01576807349920273, f1 0.8593999743461609
ep15_l4_test_time 5.612630844116211
gc 0
Train Epoch16 Acc 0.97095 (38838/40000), AUC 0.9950923919677734
ep16_train_time 157.36613249778748
Test Epoch16 layer4 Acc 0.8596, AUC 0.9272180795669556, avg_entr 0.017253011465072632, f1 0.8596000075340271
ep16_l4_test_time 5.548333168029785
gc 0
Train Epoch17 Acc 0.9748 (38992/40000), AUC 0.9961551427841187
ep17_train_time 157.25949835777283
Test Epoch17 layer4 Acc 0.8548, AUC 0.9190807938575745, avg_entr 0.017647363245487213, f1 0.8547999858856201
ep17_l4_test_time 5.56246542930603
gc 0
Train Epoch18 Acc 0.9766 (39064/40000), AUC 0.9965567588806152
ep18_train_time 157.74008321762085
Test Epoch18 layer4 Acc 0.8554, AUC 0.9210015535354614, avg_entr 0.015041029080748558, f1 0.855400025844574
ep18_l4_test_time 5.662364721298218
gc 0
Train Epoch19 Acc 0.9774 (39096/40000), AUC 0.9969024658203125
ep19_train_time 157.31023788452148
Test Epoch19 layer4 Acc 0.8554, AUC 0.9204975366592407, avg_entr 0.015737082809209824, f1 0.855400025844574
ep19_l4_test_time 5.548683404922485
gc 0
Train Epoch20 Acc 0.978925 (39157/40000), AUC 0.9973922967910767
ep20_train_time 157.33582520484924
Test Epoch20 layer4 Acc 0.8498, AUC 0.9216734170913696, avg_entr 0.021832870319485664, f1 0.8497999906539917
ep20_l4_test_time 5.647382974624634
gc 0
Train Epoch21 Acc 0.981775 (39271/40000), AUC 0.9977719783782959
ep21_train_time 157.40962028503418
Test Epoch21 layer4 Acc 0.8502, AUC 0.9160324931144714, avg_entr 0.013870906084775925, f1 0.8501999974250793
ep21_l4_test_time 5.532291650772095
gc 0
Train Epoch22 Acc 0.980775 (39231/40000), AUC 0.9976118803024292
ep22_train_time 157.86932492256165
Test Epoch22 layer4 Acc 0.8504, AUC 0.9189797639846802, avg_entr 0.019777728244662285, f1 0.8503999710083008
ep22_l4_test_time 5.577890634536743
gc 0
Train Epoch23 Acc 0.9835 (39340/40000), AUC 0.9980294704437256
ep23_train_time 157.23209261894226
Test Epoch23 layer4 Acc 0.8486, AUC 0.9170953035354614, avg_entr 0.015683861449360847, f1 0.8485999703407288
ep23_l4_test_time 5.573215484619141
gc 0
Train Epoch24 Acc 0.984925 (39397/40000), AUC 0.9983736276626587
ep24_train_time 157.23292064666748
Test Epoch24 layer4 Acc 0.8496, AUC 0.9149128198623657, avg_entr 0.012468259781599045, f1 0.8496000170707703
ep24_l4_test_time 5.600286483764648
gc 0
Train Epoch25 Acc 0.98455 (39382/40000), AUC 0.9982725381851196
ep25_train_time 157.4634234905243
Test Epoch25 layer4 Acc 0.8484, AUC 0.9115357398986816, avg_entr 0.012559217400848866, f1 0.8483999967575073
ep25_l4_test_time 5.589206695556641
gc 0
Train Epoch26 Acc 0.984875 (39395/40000), AUC 0.9983056783676147
ep26_train_time 157.95841813087463
Test Epoch26 layer4 Acc 0.8394, AUC 0.9125306606292725, avg_entr 0.016044680029153824, f1 0.8393999934196472
ep26_l4_test_time 5.587411880493164
gc 0
Train Epoch27 Acc 0.986325 (39453/40000), AUC 0.998583197593689
ep27_train_time 157.4113473892212
Test Epoch27 layer4 Acc 0.843, AUC 0.9131231307983398, avg_entr 0.015368239022791386, f1 0.8429999947547913
ep27_l4_test_time 5.571613073348999
gc 0
Train Epoch28 Acc 0.988325 (39533/40000), AUC 0.9989062547683716
ep28_train_time 157.5408751964569
Test Epoch28 layer4 Acc 0.8424, AUC 0.911320686340332, avg_entr 0.014022807590663433, f1 0.8424000144004822
ep28_l4_test_time 5.523138761520386
gc 0
Train Epoch29 Acc 0.98695 (39478/40000), AUC 0.9988260269165039
ep29_train_time 157.36463165283203
Test Epoch29 layer4 Acc 0.8356, AUC 0.9086935520172119, avg_entr 0.014550859108567238, f1 0.8356000185012817
ep29_l4_test_time 5.575585842132568
Best AUC tensor(0.8838) 5
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 4893.007583856583
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.886, AUC 0.9545681476593018, avg_entr 0.1625608205795288, f1 0.8859999775886536
l0_test_time 0.7706220149993896
Test layer1 Acc 0.8766, AUC 0.9352247714996338, avg_entr 0.05199861899018288, f1 0.8766000270843506
l1_test_time 1.761725664138794
Test layer2 Acc 0.877, AUC 0.9357298016548157, avg_entr 0.044062744826078415, f1 0.8769999742507935
l2_test_time 3.077810525894165
Test layer3 Acc 0.8772, AUC 0.9360933899879456, avg_entr 0.04225873574614525, f1 0.8772000074386597
l3_test_time 4.31398868560791
Test layer4 Acc 0.8764, AUC 0.936220645904541, avg_entr 0.04430292174220085, f1 0.8763999938964844
l4_test_time 5.55977725982666
