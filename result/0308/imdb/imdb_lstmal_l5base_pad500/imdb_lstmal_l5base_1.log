total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 24.34804129600525
Start Training
gc 0
Train Epoch0 Acc 0.511775 (20471/40000), AUC 0.5215005874633789
ep0_train_time 157.80928921699524
Test Epoch0 layer4 Acc 0.6676, AUC 0.7881035804748535, avg_entr 0.46012696623802185, f1 0.6675999760627747
ep0_l4_test_time 5.394109010696411
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.7803 (31212/40000), AUC 0.8422694206237793
ep1_train_time 157.60232043266296
Test Epoch1 layer4 Acc 0.8302, AUC 0.9042199850082397, avg_entr 0.19568732380867004, f1 0.8302000164985657
ep1_l4_test_time 5.561316728591919
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.8642 (34568/40000), AUC 0.9258793592453003
ep2_train_time 157.10065817832947
Test Epoch2 layer4 Acc 0.8664, AUC 0.9257552623748779, avg_entr 0.07283340394496918, f1 0.8664000034332275
ep2_l4_test_time 5.530595779418945
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.8827 (35308/40000), AUC 0.9406695365905762
ep3_train_time 157.1255373954773
Test Epoch3 layer4 Acc 0.8864, AUC 0.9425145387649536, avg_entr 0.051971904933452606, f1 0.8863999843597412
ep3_l4_test_time 5.565986633300781
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.927625 (37105/40000), AUC 0.9718077182769775
ep4_train_time 157.73300909996033
Test Epoch4 layer4 Acc 0.8898, AUC 0.9496479630470276, avg_entr 0.05485110357403755, f1 0.8898000121116638
ep4_l4_test_time 5.271548271179199
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.929525 (37181/40000), AUC 0.973615288734436
ep5_train_time 157.42940211296082
Test Epoch5 layer4 Acc 0.8776, AUC 0.9450953006744385, avg_entr 0.05286680907011032, f1 0.8776000142097473
ep5_l4_test_time 5.602085590362549
gc 0
Train Epoch6 Acc 0.938525 (37541/40000), AUC 0.9792433977127075
ep6_train_time 157.1642129421234
Test Epoch6 layer4 Acc 0.8776, AUC 0.9436200857162476, avg_entr 0.06642170250415802, f1 0.8776000142097473
ep6_l4_test_time 5.547519207000732
gc 0
Train Epoch7 Acc 0.93695 (37478/40000), AUC 0.9765995740890503
ep7_train_time 157.1785225868225
Test Epoch7 layer4 Acc 0.8806, AUC 0.9388754367828369, avg_entr 0.03426700085401535, f1 0.8805999755859375
ep7_l4_test_time 5.557072401046753
gc 0
Train Epoch8 Acc 0.95255 (38102/40000), AUC 0.9865455031394958
ep8_train_time 157.86846375465393
Test Epoch8 layer4 Acc 0.8664, AUC 0.9408774375915527, avg_entr 0.035267069935798645, f1 0.8664000034332275
ep8_l4_test_time 5.448100328445435
gc 0
Train Epoch9 Acc 0.958825 (38353/40000), AUC 0.9892759919166565
ep9_train_time 157.34016585350037
Test Epoch9 layer4 Acc 0.8738, AUC 0.937373697757721, avg_entr 0.0358300656080246, f1 0.8737999796867371
ep9_l4_test_time 5.638246059417725
gc 0
Train Epoch10 Acc 0.9627 (38508/40000), AUC 0.9916305541992188
ep10_train_time 157.21206736564636
Test Epoch10 layer4 Acc 0.8702, AUC 0.9369939565658569, avg_entr 0.03745947405695915, f1 0.870199978351593
ep10_l4_test_time 5.564927577972412
gc 0
Train Epoch11 Acc 0.96585 (38634/40000), AUC 0.992900550365448
ep11_train_time 157.29520654678345
Test Epoch11 layer4 Acc 0.8732, AUC 0.9357706308364868, avg_entr 0.027873730286955833, f1 0.873199999332428
ep11_l4_test_time 5.592795133590698
gc 0
Train Epoch12 Acc 0.970325 (38813/40000), AUC 0.9945483207702637
ep12_train_time 157.62590217590332
Test Epoch12 layer4 Acc 0.8674, AUC 0.9333148002624512, avg_entr 0.02688591368496418, f1 0.8673999905586243
ep12_l4_test_time 5.570451498031616
gc 0
Train Epoch13 Acc 0.971575 (38863/40000), AUC 0.9950217604637146
ep13_train_time 157.11743235588074
Test Epoch13 layer4 Acc 0.8672, AUC 0.9319653511047363, avg_entr 0.028630608692765236, f1 0.8672000169754028
ep13_l4_test_time 5.6094160079956055
gc 0
Train Epoch14 Acc 0.974075 (38963/40000), AUC 0.995701014995575
ep14_train_time 157.4041817188263
Test Epoch14 layer4 Acc 0.8664, AUC 0.9285871386528015, avg_entr 0.023912277072668076, f1 0.8664000034332275
ep14_l4_test_time 5.619263648986816
gc 0
Train Epoch15 Acc 0.9753 (39012/40000), AUC 0.9964054822921753
ep15_train_time 156.9616940021515
Test Epoch15 layer4 Acc 0.8606, AUC 0.9256618618965149, avg_entr 0.020227152854204178, f1 0.8605999946594238
ep15_l4_test_time 5.589871168136597
gc 0
Train Epoch16 Acc 0.976425 (39057/40000), AUC 0.9963065385818481
ep16_train_time 157.68819546699524
Test Epoch16 layer4 Acc 0.8614, AUC 0.925426185131073, avg_entr 0.023160165175795555, f1 0.8614000082015991
ep16_l4_test_time 5.618388891220093
gc 0
Train Epoch17 Acc 0.9776 (39104/40000), AUC 0.9965040683746338
ep17_train_time 157.19878888130188
Test Epoch17 layer4 Acc 0.8604, AUC 0.9228743314743042, avg_entr 0.022113369777798653, f1 0.8604000210762024
ep17_l4_test_time 5.616587400436401
gc 0
Train Epoch18 Acc 0.9802 (39208/40000), AUC 0.997252345085144
ep18_train_time 156.95466685295105
Test Epoch18 layer4 Acc 0.8516, AUC 0.9222931861877441, avg_entr 0.02219425141811371, f1 0.8515999913215637
ep18_l4_test_time 5.567307710647583
gc 0
Train Epoch19 Acc 0.981175 (39247/40000), AUC 0.9973703026771545
ep19_train_time 157.26945161819458
Test Epoch19 layer4 Acc 0.8524, AUC 0.91573166847229, avg_entr 0.01602652668952942, f1 0.852400004863739
ep19_l4_test_time 5.555612802505493
gc 0
Train Epoch20 Acc 0.9825 (39300/40000), AUC 0.9977216124534607
ep20_train_time 157.6535849571228
Test Epoch20 layer4 Acc 0.8496, AUC 0.9180428385734558, avg_entr 0.01776605285704136, f1 0.8496000170707703
ep20_l4_test_time 5.607787847518921
gc 0
Train Epoch21 Acc 0.983825 (39353/40000), AUC 0.9977408051490784
ep21_train_time 157.1834454536438
Test Epoch21 layer4 Acc 0.8516, AUC 0.914976179599762, avg_entr 0.014566101133823395, f1 0.8515999913215637
ep21_l4_test_time 5.57564640045166
gc 0
Train Epoch22 Acc 0.98415 (39366/40000), AUC 0.9980783462524414
ep22_train_time 157.0501561164856
Test Epoch22 layer4 Acc 0.8522, AUC 0.9155138731002808, avg_entr 0.014310293830931187, f1 0.8521999716758728
ep22_l4_test_time 5.583930969238281
gc 0
Train Epoch23 Acc 0.98455 (39382/40000), AUC 0.9982963800430298
ep23_train_time 157.32038927078247
Test Epoch23 layer4 Acc 0.8448, AUC 0.9141756296157837, avg_entr 0.01611551269888878, f1 0.8447999358177185
ep23_l4_test_time 5.564749002456665
gc 0
Train Epoch24 Acc 0.985625 (39425/40000), AUC 0.9983104467391968
ep24_train_time 157.5327661037445
Test Epoch24 layer4 Acc 0.8472, AUC 0.9112222194671631, avg_entr 0.014708015136420727, f1 0.8471999764442444
ep24_l4_test_time 5.6002302169799805
gc 0
Train Epoch25 Acc 0.986875 (39475/40000), AUC 0.9986028075218201
ep25_train_time 157.11607789993286
Test Epoch25 layer4 Acc 0.829, AUC 0.9067402482032776, avg_entr 0.018552204594016075, f1 0.8289999961853027
ep25_l4_test_time 5.615645408630371
gc 0
Train Epoch26 Acc 0.98705 (39482/40000), AUC 0.9984183311462402
ep26_train_time 157.31140065193176
Test Epoch26 layer4 Acc 0.8476, AUC 0.9048042297363281, avg_entr 0.012668710201978683, f1 0.847599983215332
ep26_l4_test_time 5.580132246017456
gc 0
Train Epoch27 Acc 0.98805 (39522/40000), AUC 0.9987115263938904
ep27_train_time 157.24947023391724
Test Epoch27 layer4 Acc 0.8442, AUC 0.9075091481208801, avg_entr 0.013873486779630184, f1 0.8442000150680542
ep27_l4_test_time 5.561087608337402
gc 0
Train Epoch28 Acc 0.98825 (39530/40000), AUC 0.998878002166748
ep28_train_time 157.52473664283752
Test Epoch28 layer4 Acc 0.8404, AUC 0.9035719633102417, avg_entr 0.01648673601448536, f1 0.840399980545044
ep28_l4_test_time 5.5584022998809814
gc 0
Train Epoch29 Acc 0.98945 (39578/40000), AUC 0.998965859413147
ep29_train_time 157.12789964675903
Test Epoch29 layer4 Acc 0.841, AUC 0.9024916887283325, avg_entr 0.012368827126920223, f1 0.8410000205039978
ep29_l4_test_time 5.5966877937316895
Best AUC tensor(0.8898) 4
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 4888.852592945099
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.8918, AUC 0.9553285837173462, avg_entr 0.18019503355026245, f1 0.8917999863624573
l0_test_time 0.7822959423065186
Test layer1 Acc 0.8834, AUC 0.9436812400817871, avg_entr 0.05816610902547836, f1 0.8834000825881958
l1_test_time 1.744307041168213
Test layer2 Acc 0.8852, AUC 0.9442673325538635, avg_entr 0.05810456722974777, f1 0.8852000832557678
l2_test_time 3.089818000793457
Test layer3 Acc 0.8852, AUC 0.9438887238502502, avg_entr 0.056295305490493774, f1 0.8852000832557678
l3_test_time 4.363637447357178
Test layer4 Acc 0.885, AUC 0.9439065456390381, avg_entr 0.0575893260538578, f1 0.8849999904632568
l4_test_time 5.573386192321777
