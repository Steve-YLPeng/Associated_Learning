total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 23.843578338623047
Start Training
gc 0
Train Epoch0 Acc 0.5072 (20288/40000), AUC 0.5165389776229858
ep0_train_time 155.78162813186646
Test Epoch0 layer0 Acc 0.764, AUC 0.8908921480178833, avg_entr 0.5493749976158142, f1 0.7639999985694885
ep0_l0_test_time 0.7719831466674805
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.6152, AUC 0.6498024463653564, avg_entr 0.6643505096435547, f1 0.6151999831199646
ep0_l1_test_time 1.7805514335632324
Test Epoch0 layer2 Acc 0.6112, AUC 0.6866317987442017, avg_entr 0.6395308375358582, f1 0.6111999750137329
ep0_l2_test_time 2.98685622215271
Test Epoch0 layer3 Acc 0.5652, AUC 0.6972614526748657, avg_entr 0.6719454526901245, f1 0.5651999711990356
ep0_l3_test_time 4.2527031898498535
Test Epoch0 layer4 Acc 0.5032, AUC 0.715193510055542, avg_entr 0.6366086006164551, f1 0.5031999945640564
ep0_l4_test_time 5.470291614532471
gc 0
Train Epoch1 Acc 0.773875 (30955/40000), AUC 0.8423894643783569
ep1_train_time 155.52947854995728
Test Epoch1 layer0 Acc 0.8516, AUC 0.9452049732208252, avg_entr 0.2829231321811676, f1 0.8515999913215637
ep1_l0_test_time 0.7943675518035889
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8258, AUC 0.8897755146026611, avg_entr 0.287675678730011, f1 0.8258000016212463
ep1_l1_test_time 1.7724573612213135
Test Epoch1 layer2 Acc 0.8276, AUC 0.8908437490463257, avg_entr 0.2911108732223511, f1 0.8276000022888184
ep1_l2_test_time 2.932495594024658
Test Epoch1 layer3 Acc 0.8308, AUC 0.8987129926681519, avg_entr 0.28062066435813904, f1 0.8307999968528748
ep1_l3_test_time 4.221174478530884
Test Epoch1 layer4 Acc 0.831, AUC 0.9014651775360107, avg_entr 0.284820556640625, f1 0.8309999704360962
ep1_l4_test_time 5.351569414138794
gc 0
Train Epoch2 Acc 0.79625 (31850/40000), AUC 0.8681488037109375
ep2_train_time 155.50534892082214
Test Epoch2 layer0 Acc 0.8956, AUC 0.9556047916412354, avg_entr 0.22859525680541992, f1 0.8956000208854675
ep2_l0_test_time 0.7746493816375732
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8006, AUC 0.88313227891922, avg_entr 0.09362728893756866, f1 0.800599992275238
ep2_l1_test_time 1.785367488861084
Test Epoch2 layer2 Acc 0.8038, AUC 0.8859066963195801, avg_entr 0.09156285971403122, f1 0.8037999868392944
ep2_l2_test_time 2.965533971786499
Test Epoch2 layer3 Acc 0.7976, AUC 0.8885037302970886, avg_entr 0.07706897705793381, f1 0.7976000308990479
ep2_l3_test_time 4.22630763053894
Test Epoch2 layer4 Acc 0.7954, AUC 0.8884487152099609, avg_entr 0.07147768884897232, f1 0.795400083065033
ep2_l4_test_time 5.3137288093566895
gc 0
Train Epoch3 Acc 0.8808 (35232/40000), AUC 0.9257991909980774
ep3_train_time 153.375230550766
Test Epoch3 layer0 Acc 0.896, AUC 0.9583456516265869, avg_entr 0.1968340277671814, f1 0.8960000276565552
ep3_l0_test_time 0.5545129776000977
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.8662, AUC 0.9186229705810547, avg_entr 0.08283399790525436, f1 0.8661999702453613
ep3_l1_test_time 1.0636143684387207
Test Epoch3 layer2 Acc 0.8646, AUC 0.9197795391082764, avg_entr 0.06969024240970612, f1 0.8646000027656555
ep3_l2_test_time 1.6626663208007812
Test Epoch3 layer3 Acc 0.8648, AUC 0.9229671359062195, avg_entr 0.05558878928422928, f1 0.8648000359535217
ep3_l3_test_time 2.2775826454162598
Test Epoch3 layer4 Acc 0.8658, AUC 0.9228390455245972, avg_entr 0.05390309914946556, f1 0.8658000826835632
ep3_l4_test_time 2.8993289470672607
gc 0
Train Epoch4 Acc 0.8956 (35824/40000), AUC 0.9517416954040527
ep4_train_time 148.73046612739563
Test Epoch4 layer0 Acc 0.8998, AUC 0.9592313170433044, avg_entr 0.17870482802391052, f1 0.8998000025749207
ep4_l0_test_time 0.7611610889434814
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.8744, AUC 0.929865837097168, avg_entr 0.05888666957616806, f1 0.8744000792503357
ep4_l1_test_time 1.774669885635376
Test Epoch4 layer2 Acc 0.8724, AUC 0.9311201572418213, avg_entr 0.04810671508312225, f1 0.8723999857902527
ep4_l2_test_time 2.944488763809204
Test Epoch4 layer3 Acc 0.8742, AUC 0.9335715174674988, avg_entr 0.041194889694452286, f1 0.8741999864578247
ep4_l3_test_time 4.173909425735474
Test Epoch4 layer4 Acc 0.8734, AUC 0.934086263179779, avg_entr 0.038358528167009354, f1 0.8733999729156494
ep4_l4_test_time 5.414692640304565
gc 0
Train Epoch5 Acc 0.929575 (37183/40000), AUC 0.9725946187973022
ep5_train_time 155.63684225082397
Test Epoch5 layer0 Acc 0.8986, AUC 0.9588189125061035, avg_entr 0.1668277233839035, f1 0.8985999822616577
ep5_l0_test_time 0.7680134773254395
Test Epoch5 layer1 Acc 0.8848, AUC 0.9419906735420227, avg_entr 0.06849239766597748, f1 0.8848000168800354
ep5_l1_test_time 1.7700505256652832
Test Epoch5 layer2 Acc 0.8876, AUC 0.9426746368408203, avg_entr 0.05516580119729042, f1 0.8876000046730042
ep5_l2_test_time 2.9700679779052734
Test Epoch5 layer3 Acc 0.8864, AUC 0.943073034286499, avg_entr 0.05329133942723274, f1 0.8863999843597412
ep5_l3_test_time 4.253268718719482
Test Epoch5 layer4 Acc 0.8862, AUC 0.9430277347564697, avg_entr 0.05050358176231384, f1 0.8862000107765198
ep5_l4_test_time 5.517316818237305
gc 0
Train Epoch6 Acc 0.94285 (37714/40000), AUC 0.9813247919082642
ep6_train_time 155.61782884597778
Test Epoch6 layer0 Acc 0.8968, AUC 0.9576885104179382, avg_entr 0.15261432528495789, f1 0.8967999815940857
ep6_l0_test_time 0.7536382675170898
Test Epoch6 layer1 Acc 0.8844, AUC 0.9460729360580444, avg_entr 0.05553363636136055, f1 0.8844000101089478
ep6_l1_test_time 1.7807488441467285
Test Epoch6 layer2 Acc 0.885, AUC 0.9462406635284424, avg_entr 0.04217223823070526, f1 0.8849999904632568
ep6_l2_test_time 2.9336776733398438
Test Epoch6 layer3 Acc 0.8846, AUC 0.9466328620910645, avg_entr 0.039270125329494476, f1 0.8845999836921692
ep6_l3_test_time 4.210318088531494
Test Epoch6 layer4 Acc 0.8844, AUC 0.9467760324478149, avg_entr 0.037502873688936234, f1 0.8844000101089478
ep6_l4_test_time 5.411923408508301
gc 0
Train Epoch7 Acc 0.95185 (38074/40000), AUC 0.9865756034851074
ep7_train_time 155.67630910873413
Test Epoch7 layer0 Acc 0.8966, AUC 0.9562263488769531, avg_entr 0.14363479614257812, f1 0.8966000080108643
ep7_l0_test_time 0.7690269947052002
Test Epoch7 layer1 Acc 0.8832, AUC 0.9454212188720703, avg_entr 0.04401985928416252, f1 0.8831999897956848
ep7_l1_test_time 1.776238203048706
Test Epoch7 layer2 Acc 0.88, AUC 0.9456712007522583, avg_entr 0.03286789357662201, f1 0.8799999952316284
ep7_l2_test_time 2.960223913192749
Test Epoch7 layer3 Acc 0.8796, AUC 0.9457036256790161, avg_entr 0.032581817358732224, f1 0.8795999884605408
ep7_l3_test_time 4.238262414932251
Test Epoch7 layer4 Acc 0.8792, AUC 0.9455884099006653, avg_entr 0.03217918798327446, f1 0.8791999816894531
ep7_l4_test_time 5.457852602005005
gc 0
Train Epoch8 Acc 0.950875 (38035/40000), AUC 0.9853066802024841
ep8_train_time 155.6888153553009
Test Epoch8 layer0 Acc 0.8924, AUC 0.9543869495391846, avg_entr 0.13778136670589447, f1 0.8923999667167664
ep8_l0_test_time 0.7730364799499512
Test Epoch8 layer1 Acc 0.8844, AUC 0.9416720867156982, avg_entr 0.03681793063879013, f1 0.8844000101089478
ep8_l1_test_time 1.7386856079101562
Test Epoch8 layer2 Acc 0.8832, AUC 0.9418589472770691, avg_entr 0.028937451541423798, f1 0.8831999897956848
ep8_l2_test_time 2.9710888862609863
Test Epoch8 layer3 Acc 0.8836, AUC 0.9418190121650696, avg_entr 0.02790326252579689, f1 0.8835999965667725
ep8_l3_test_time 4.231460332870483
Test Epoch8 layer4 Acc 0.8836, AUC 0.9412997961044312, avg_entr 0.026482507586479187, f1 0.8835999965667725
ep8_l4_test_time 5.489122629165649
gc 0
Train Epoch9 Acc 0.96075 (38430/40000), AUC 0.9907534718513489
ep9_train_time 155.77062153816223
Test Epoch9 layer0 Acc 0.8934, AUC 0.9534547328948975, avg_entr 0.13527074456214905, f1 0.8934000134468079
ep9_l0_test_time 0.7966837882995605
Test Epoch9 layer1 Acc 0.8832, AUC 0.940290093421936, avg_entr 0.029676619917154312, f1 0.8831999897956848
ep9_l1_test_time 1.7874863147735596
Test Epoch9 layer2 Acc 0.8834, AUC 0.9405585527420044, avg_entr 0.023630069568753242, f1 0.8834000825881958
ep9_l2_test_time 2.9468517303466797
Test Epoch9 layer3 Acc 0.8834, AUC 0.9404458999633789, avg_entr 0.025553952902555466, f1 0.8834000825881958
ep9_l3_test_time 4.210040330886841
Test Epoch9 layer4 Acc 0.8834, AUC 0.9402599334716797, avg_entr 0.025549810379743576, f1 0.8834000825881958
ep9_l4_test_time 5.4315125942230225
gc 0
Train Epoch10 Acc 0.963 (38520/40000), AUC 0.9918983578681946
ep10_train_time 155.72157979011536
Test Epoch10 layer0 Acc 0.8906, AUC 0.9525820016860962, avg_entr 0.13373705744743347, f1 0.8906000256538391
ep10_l0_test_time 0.7688181400299072
Test Epoch10 layer1 Acc 0.8828, AUC 0.9422621726989746, avg_entr 0.03458121418952942, f1 0.8827999830245972
ep10_l1_test_time 1.7869179248809814
Test Epoch10 layer2 Acc 0.8832, AUC 0.9423418045043945, avg_entr 0.02748696878552437, f1 0.8831999897956848
ep10_l2_test_time 2.9671547412872314
Test Epoch10 layer3 Acc 0.8832, AUC 0.9423797130584717, avg_entr 0.027444979175925255, f1 0.8831999897956848
ep10_l3_test_time 4.26050877571106
Test Epoch10 layer4 Acc 0.8832, AUC 0.9422553777694702, avg_entr 0.026304705068469048, f1 0.8831999897956848
ep10_l4_test_time 5.53762674331665
gc 0
Train Epoch11 Acc 0.96625 (38650/40000), AUC 0.9933758974075317
ep11_train_time 155.67451548576355
Test Epoch11 layer0 Acc 0.89, AUC 0.9513428211212158, avg_entr 0.12962742149829865, f1 0.8899999856948853
ep11_l0_test_time 0.7546825408935547
Test Epoch11 layer1 Acc 0.8816, AUC 0.9400426149368286, avg_entr 0.029716074466705322, f1 0.881600022315979
ep11_l1_test_time 1.7697217464447021
Test Epoch11 layer2 Acc 0.881, AUC 0.9400053024291992, avg_entr 0.02286204881966114, f1 0.8809999823570251
ep11_l2_test_time 2.939112424850464
Test Epoch11 layer3 Acc 0.8818, AUC 0.9400946497917175, avg_entr 0.02280709706246853, f1 0.8818000555038452
ep11_l3_test_time 4.208308458328247
Test Epoch11 layer4 Acc 0.8816, AUC 0.9400123357772827, avg_entr 0.022234637290239334, f1 0.881600022315979
ep11_l4_test_time 5.316929817199707
gc 0
Train Epoch12 Acc 0.9663 (38652/40000), AUC 0.9934334754943848
ep12_train_time 155.67200636863708
Test Epoch12 layer0 Acc 0.8838, AUC 0.9501391649246216, avg_entr 0.125694140791893, f1 0.8838000297546387
ep12_l0_test_time 0.7662086486816406
Test Epoch12 layer1 Acc 0.8704, AUC 0.9375006556510925, avg_entr 0.03319782763719559, f1 0.8704000115394592
ep12_l1_test_time 1.763016700744629
Test Epoch12 layer2 Acc 0.8722, AUC 0.9373226165771484, avg_entr 0.02564135380089283, f1 0.872200071811676
ep12_l2_test_time 2.9662065505981445
Test Epoch12 layer3 Acc 0.8712, AUC 0.9366434812545776, avg_entr 0.02635345421731472, f1 0.8712000846862793
ep12_l3_test_time 4.223645210266113
Test Epoch12 layer4 Acc 0.8714, AUC 0.9366617202758789, avg_entr 0.025981994345784187, f1 0.871399998664856
ep12_l4_test_time 5.416065454483032
gc 0
Train Epoch13 Acc 0.9695 (38780/40000), AUC 0.9945791363716125
ep13_train_time 155.740567445755
Test Epoch13 layer0 Acc 0.8868, AUC 0.9496426582336426, avg_entr 0.12495887279510498, f1 0.8867999911308289
ep13_l0_test_time 0.7751283645629883
Test Epoch13 layer1 Acc 0.8788, AUC 0.9399117231369019, avg_entr 0.03119938261806965, f1 0.8787999749183655
ep13_l1_test_time 1.756049633026123
Test Epoch13 layer2 Acc 0.8792, AUC 0.9401987791061401, avg_entr 0.024178635329008102, f1 0.8791999816894531
ep13_l2_test_time 2.9456632137298584
Test Epoch13 layer3 Acc 0.8782, AUC 0.9402198791503906, avg_entr 0.023709123954176903, f1 0.8781999945640564
ep13_l3_test_time 4.189291954040527
Test Epoch13 layer4 Acc 0.8792, AUC 0.9404209852218628, avg_entr 0.022600358352065086, f1 0.8791999816894531
ep13_l4_test_time 5.452707767486572
gc 0
Train Epoch14 Acc 0.970625 (38825/40000), AUC 0.9950041770935059
ep14_train_time 155.78758239746094
Test Epoch14 layer0 Acc 0.8842, AUC 0.9491759538650513, avg_entr 0.12403294444084167, f1 0.8842000365257263
ep14_l0_test_time 0.7634372711181641
Test Epoch14 layer1 Acc 0.8766, AUC 0.9369118809700012, avg_entr 0.02493150345981121, f1 0.8766000270843506
ep14_l1_test_time 1.786120891571045
Test Epoch14 layer2 Acc 0.8768, AUC 0.9373481869697571, avg_entr 0.019934870302677155, f1 0.876800000667572
ep14_l2_test_time 2.940631628036499
Test Epoch14 layer3 Acc 0.876, AUC 0.9372449517250061, avg_entr 0.019836246967315674, f1 0.8760000467300415
ep14_l3_test_time 4.202413082122803
Test Epoch14 layer4 Acc 0.877, AUC 0.9375096559524536, avg_entr 0.019126398488879204, f1 0.8769999742507935
ep14_l4_test_time 5.359611511230469
gc 0
Train Epoch15 Acc 0.9728 (38912/40000), AUC 0.9953977465629578
ep15_train_time 138.24288129806519
Test Epoch15 layer0 Acc 0.885, AUC 0.9486979246139526, avg_entr 0.12431071698665619, f1 0.8849999904632568
ep15_l0_test_time 0.7787752151489258
Test Epoch15 layer1 Acc 0.8766, AUC 0.9378811717033386, avg_entr 0.028558239340782166, f1 0.8766000270843506
ep15_l1_test_time 1.7429492473602295
Test Epoch15 layer2 Acc 0.8768, AUC 0.9383091926574707, avg_entr 0.02243444137275219, f1 0.876800000667572
ep15_l2_test_time 2.9728641510009766
Test Epoch15 layer3 Acc 0.8762, AUC 0.9383487701416016, avg_entr 0.022561175748705864, f1 0.8762000203132629
ep15_l3_test_time 4.246049165725708
Test Epoch15 layer4 Acc 0.8768, AUC 0.9385879635810852, avg_entr 0.02168523520231247, f1 0.876800000667572
ep15_l4_test_time 5.528458595275879
gc 0
Train Epoch16 Acc 0.973075 (38923/40000), AUC 0.9955587387084961
ep16_train_time 155.62369012832642
Test Epoch16 layer0 Acc 0.8836, AUC 0.9479466676712036, avg_entr 0.12157866358757019, f1 0.8835999965667725
ep16_l0_test_time 0.773618221282959
Test Epoch16 layer1 Acc 0.8752, AUC 0.9353971481323242, avg_entr 0.023567667230963707, f1 0.8751999735832214
ep16_l1_test_time 1.7736461162567139
Test Epoch16 layer2 Acc 0.8754, AUC 0.9361402988433838, avg_entr 0.01852000132203102, f1 0.8754000067710876
ep16_l2_test_time 2.9544787406921387
Test Epoch16 layer3 Acc 0.8754, AUC 0.9360839128494263, avg_entr 0.018117504194378853, f1 0.8754000067710876
ep16_l3_test_time 4.211742877960205
Test Epoch16 layer4 Acc 0.8754, AUC 0.9364598989486694, avg_entr 0.017470087856054306, f1 0.8754000067710876
ep16_l4_test_time 5.41271448135376
gc 0
Train Epoch17 Acc 0.973375 (38935/40000), AUC 0.9957072138786316
ep17_train_time 155.73972821235657
Test Epoch17 layer0 Acc 0.8844, AUC 0.947763204574585, avg_entr 0.1212431788444519, f1 0.8844000101089478
ep17_l0_test_time 0.7875101566314697
Test Epoch17 layer1 Acc 0.8752, AUC 0.9355125427246094, avg_entr 0.025201566517353058, f1 0.8751999735832214
ep17_l1_test_time 1.7710528373718262
Test Epoch17 layer2 Acc 0.8752, AUC 0.9362750053405762, avg_entr 0.020508263260126114, f1 0.8751999735832214
ep17_l2_test_time 2.979602336883545
Test Epoch17 layer3 Acc 0.8752, AUC 0.9361435174942017, avg_entr 0.020381489768624306, f1 0.8751999735832214
ep17_l3_test_time 4.225512742996216
Test Epoch17 layer4 Acc 0.8758, AUC 0.9367245435714722, avg_entr 0.019916407763957977, f1 0.8758000135421753
ep17_l4_test_time 5.439267873764038
gc 0
Train Epoch18 Acc 0.974225 (38969/40000), AUC 0.9958898425102234
ep18_train_time 155.816166639328
Test Epoch18 layer0 Acc 0.8822, AUC 0.947406530380249, avg_entr 0.11920948326587677, f1 0.8822000026702881
ep18_l0_test_time 0.7836761474609375
Test Epoch18 layer1 Acc 0.873, AUC 0.9361417889595032, avg_entr 0.0248076394200325, f1 0.8730000257492065
ep18_l1_test_time 1.782325267791748
Test Epoch18 layer2 Acc 0.8742, AUC 0.9370988607406616, avg_entr 0.01915316842496395, f1 0.8741999864578247
ep18_l2_test_time 2.9625439643859863
Test Epoch18 layer3 Acc 0.8744, AUC 0.9371191263198853, avg_entr 0.019122783094644547, f1 0.8744000792503357
ep18_l3_test_time 4.235552072525024
Test Epoch18 layer4 Acc 0.8746, AUC 0.9372793436050415, avg_entr 0.01807529479265213, f1 0.8745999932289124
ep18_l4_test_time 5.448686361312866
gc 0
Train Epoch19 Acc 0.975025 (39001/40000), AUC 0.9961025714874268
ep19_train_time 155.85250043869019
Test Epoch19 layer0 Acc 0.8816, AUC 0.947094202041626, avg_entr 0.11859243363142014, f1 0.881600022315979
ep19_l0_test_time 0.7609775066375732
Test Epoch19 layer1 Acc 0.8748, AUC 0.9345393180847168, avg_entr 0.02343488112092018, f1 0.8748000264167786
ep19_l1_test_time 1.7703235149383545
Test Epoch19 layer2 Acc 0.875, AUC 0.9352409243583679, avg_entr 0.018660077825188637, f1 0.875
ep19_l2_test_time 2.925445318222046
Test Epoch19 layer3 Acc 0.8756, AUC 0.9354888796806335, avg_entr 0.018337354063987732, f1 0.8756000399589539
ep19_l3_test_time 4.2058470249176025
Test Epoch19 layer4 Acc 0.8748, AUC 0.935588002204895, avg_entr 0.017708323895931244, f1 0.8748000264167786
ep19_l4_test_time 5.433523178100586
gc 0
Train Epoch20 Acc 0.975425 (39017/40000), AUC 0.9961618781089783
ep20_train_time 155.964702129364
Test Epoch20 layer0 Acc 0.8822, AUC 0.9468188285827637, avg_entr 0.11807692795991898, f1 0.8822000026702881
ep20_l0_test_time 0.7665848731994629
Test Epoch20 layer1 Acc 0.875, AUC 0.934589684009552, avg_entr 0.02509736642241478, f1 0.875
ep20_l1_test_time 1.7814123630523682
Test Epoch20 layer2 Acc 0.8752, AUC 0.9352548718452454, avg_entr 0.020608343183994293, f1 0.8751999735832214
ep20_l2_test_time 2.97550106048584
Test Epoch20 layer3 Acc 0.8744, AUC 0.9352928400039673, avg_entr 0.020380057394504547, f1 0.8744000792503357
ep20_l3_test_time 4.1969990730285645
Test Epoch20 layer4 Acc 0.8748, AUC 0.9359180927276611, avg_entr 0.019888192415237427, f1 0.8748000264167786
ep20_l4_test_time 5.527599573135376
gc 0
Train Epoch21 Acc 0.97575 (39030/40000), AUC 0.9962602257728577
ep21_train_time 155.75569915771484
Test Epoch21 layer0 Acc 0.8802, AUC 0.9466599225997925, avg_entr 0.11692918837070465, f1 0.8802000284194946
ep21_l0_test_time 0.7827725410461426
Test Epoch21 layer1 Acc 0.8726, AUC 0.9346703290939331, avg_entr 0.025474820286035538, f1 0.8726000189781189
ep21_l1_test_time 1.7639694213867188
Test Epoch21 layer2 Acc 0.8734, AUC 0.9355321526527405, avg_entr 0.020688507705926895, f1 0.8733999729156494
ep21_l2_test_time 2.9454102516174316
Test Epoch21 layer3 Acc 0.8736, AUC 0.9355685710906982, avg_entr 0.02047029696404934, f1 0.8736000061035156
ep21_l3_test_time 4.223974704742432
Test Epoch21 layer4 Acc 0.8734, AUC 0.9360575079917908, avg_entr 0.019765092059969902, f1 0.8733999729156494
ep21_l4_test_time 5.41079044342041
gc 0
Train Epoch22 Acc 0.97605 (39042/40000), AUC 0.9963648915290833
ep22_train_time 155.79667115211487
Test Epoch22 layer0 Acc 0.8816, AUC 0.9465605020523071, avg_entr 0.11744791269302368, f1 0.881600022315979
ep22_l0_test_time 0.7860729694366455
Test Epoch22 layer1 Acc 0.8744, AUC 0.9337558746337891, avg_entr 0.024700311943888664, f1 0.8744000792503357
ep22_l1_test_time 1.7629616260528564
Test Epoch22 layer2 Acc 0.8746, AUC 0.934455156326294, avg_entr 0.020097624510526657, f1 0.8745999932289124
ep22_l2_test_time 2.9413533210754395
Test Epoch22 layer3 Acc 0.8738, AUC 0.9344651699066162, avg_entr 0.019923536106944084, f1 0.8737999796867371
ep22_l3_test_time 4.238793611526489
Test Epoch22 layer4 Acc 0.8734, AUC 0.935225784778595, avg_entr 0.019487688317894936, f1 0.8733999729156494
ep22_l4_test_time 5.4531402587890625
gc 0
Train Epoch23 Acc 0.97615 (39046/40000), AUC 0.9963901042938232
ep23_train_time 155.7894515991211
Test Epoch23 layer0 Acc 0.8806, AUC 0.9463880658149719, avg_entr 0.115872323513031, f1 0.8805999755859375
ep23_l0_test_time 0.7873930931091309
Test Epoch23 layer1 Acc 0.8716, AUC 0.9343280792236328, avg_entr 0.024935390800237656, f1 0.8715999722480774
ep23_l1_test_time 1.7583301067352295
Test Epoch23 layer2 Acc 0.8722, AUC 0.9353108406066895, avg_entr 0.019947951659560204, f1 0.872200071811676
ep23_l2_test_time 2.9458529949188232
Test Epoch23 layer3 Acc 0.872, AUC 0.9354662895202637, avg_entr 0.019763942807912827, f1 0.871999979019165
ep23_l3_test_time 4.2368483543396
Test Epoch23 layer4 Acc 0.8716, AUC 0.9354965686798096, avg_entr 0.019322138279676437, f1 0.8715999722480774
ep23_l4_test_time 5.50872540473938
gc 0
Train Epoch24 Acc 0.9767 (39068/40000), AUC 0.9965335130691528
ep24_train_time 155.91806936264038
Test Epoch24 layer0 Acc 0.8804, AUC 0.9462301731109619, avg_entr 0.11477143317461014, f1 0.8804000020027161
ep24_l0_test_time 0.7982528209686279
Test Epoch24 layer1 Acc 0.8716, AUC 0.9325317144393921, avg_entr 0.022715548053383827, f1 0.8715999722480774
ep24_l1_test_time 1.7332143783569336
Test Epoch24 layer2 Acc 0.8728, AUC 0.9336719512939453, avg_entr 0.01807127147912979, f1 0.8727999925613403
ep24_l2_test_time 2.9484035968780518
Test Epoch24 layer3 Acc 0.8718, AUC 0.9340630769729614, avg_entr 0.01804385706782341, f1 0.8718000650405884
ep24_l3_test_time 4.225771188735962
Test Epoch24 layer4 Acc 0.8726, AUC 0.9338216781616211, avg_entr 0.017526598647236824, f1 0.8726000189781189
ep24_l4_test_time 5.42746901512146
gc 0
Train Epoch25 Acc 0.976925 (39077/40000), AUC 0.9965579509735107
ep25_train_time 155.76934909820557
Test Epoch25 layer0 Acc 0.8802, AUC 0.9461508989334106, avg_entr 0.11472521722316742, f1 0.8802000284194946
ep25_l0_test_time 0.7525982856750488
Test Epoch25 layer1 Acc 0.8746, AUC 0.9340671896934509, avg_entr 0.02493230253458023, f1 0.8745999932289124
ep25_l1_test_time 1.7626221179962158
Test Epoch25 layer2 Acc 0.8742, AUC 0.9348493814468384, avg_entr 0.0202272180467844, f1 0.8741999864578247
ep25_l2_test_time 2.989870548248291
Test Epoch25 layer3 Acc 0.8746, AUC 0.9350686073303223, avg_entr 0.019925659522414207, f1 0.8745999932289124
ep25_l3_test_time 4.249455690383911
Test Epoch25 layer4 Acc 0.8738, AUC 0.9355955123901367, avg_entr 0.019321614876389503, f1 0.8737999796867371
ep25_l4_test_time 5.517113924026489
gc 0
Train Epoch26 Acc 0.977 (39080/40000), AUC 0.9965842962265015
ep26_train_time 137.86119437217712
Test Epoch26 layer0 Acc 0.8806, AUC 0.9461264610290527, avg_entr 0.11415120959281921, f1 0.8805999755859375
ep26_l0_test_time 0.7552587985992432
Test Epoch26 layer1 Acc 0.8712, AUC 0.9336493015289307, avg_entr 0.02340342476963997, f1 0.8712000846862793
ep26_l1_test_time 1.7736964225769043
Test Epoch26 layer2 Acc 0.8722, AUC 0.9345781207084656, avg_entr 0.01859436370432377, f1 0.872200071811676
ep26_l2_test_time 2.942620277404785
Test Epoch26 layer3 Acc 0.8728, AUC 0.9350654482841492, avg_entr 0.018419889733195305, f1 0.8727999925613403
ep26_l3_test_time 4.2214508056640625
Test Epoch26 layer4 Acc 0.872, AUC 0.9348340034484863, avg_entr 0.01809672638773918, f1 0.871999979019165
ep26_l4_test_time 5.430506706237793
gc 0
Train Epoch27 Acc 0.97715 (39086/40000), AUC 0.9966225624084473
ep27_train_time 156.06740808486938
Test Epoch27 layer0 Acc 0.8802, AUC 0.9460629224777222, avg_entr 0.11403826624155045, f1 0.8802000284194946
ep27_l0_test_time 0.7735278606414795
Test Epoch27 layer1 Acc 0.872, AUC 0.932921290397644, avg_entr 0.02264271304011345, f1 0.871999979019165
ep27_l1_test_time 1.7871439456939697
Test Epoch27 layer2 Acc 0.8738, AUC 0.93382328748703, avg_entr 0.018118390813469887, f1 0.8737999796867371
ep27_l2_test_time 2.9792704582214355
Test Epoch27 layer3 Acc 0.874, AUC 0.9341781735420227, avg_entr 0.01778663881123066, f1 0.8740000128746033
ep27_l3_test_time 4.218077182769775
Test Epoch27 layer4 Acc 0.8738, AUC 0.9343799352645874, avg_entr 0.017120594158768654, f1 0.8737999796867371
ep27_l4_test_time 5.416743993759155
gc 0
Train Epoch28 Acc 0.977125 (39085/40000), AUC 0.9966478943824768
ep28_train_time 156.0383141040802
Test Epoch28 layer0 Acc 0.8796, AUC 0.9459797739982605, avg_entr 0.11325906962156296, f1 0.8795999884605408
ep28_l0_test_time 0.7778370380401611
Test Epoch28 layer1 Acc 0.873, AUC 0.9336836338043213, avg_entr 0.02408710867166519, f1 0.8730000257492065
ep28_l1_test_time 1.7706890106201172
Test Epoch28 layer2 Acc 0.8736, AUC 0.9346022009849548, avg_entr 0.019380545243620872, f1 0.8736000061035156
ep28_l2_test_time 2.9921135902404785
Test Epoch28 layer3 Acc 0.8734, AUC 0.9348071813583374, avg_entr 0.01905118301510811, f1 0.8733999729156494
ep28_l3_test_time 4.248267650604248
Test Epoch28 layer4 Acc 0.873, AUC 0.9352139234542847, avg_entr 0.01843556948006153, f1 0.8730000257492065
ep28_l4_test_time 5.5360190868377686
gc 0
Train Epoch29 Acc 0.977225 (39089/40000), AUC 0.99667888879776
ep29_train_time 156.0239520072937
Test Epoch29 layer0 Acc 0.8798, AUC 0.945941150188446, avg_entr 0.11315795034170151, f1 0.879800021648407
ep29_l0_test_time 0.7797279357910156
Test Epoch29 layer1 Acc 0.8722, AUC 0.9330754280090332, avg_entr 0.022551430389285088, f1 0.872200071811676
ep29_l1_test_time 1.7906467914581299
Test Epoch29 layer2 Acc 0.8728, AUC 0.933869481086731, avg_entr 0.01795309968292713, f1 0.8727999925613403
ep29_l2_test_time 2.9696085453033447
Test Epoch29 layer3 Acc 0.873, AUC 0.9344063997268677, avg_entr 0.0175480879843235, f1 0.8730000257492065
ep29_l3_test_time 4.158870697021484
Test Epoch29 layer4 Acc 0.8718, AUC 0.9342470169067383, avg_entr 0.01726483553647995, f1 0.8718000650405884
ep29_l4_test_time 5.453280210494995
Best AUC tensor(0.8998) 4 0
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 5078.300340652466
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.8968, AUC 0.9558395147323608, avg_entr 0.17983029782772064, f1 0.8967999815940857
l0_test_time 0.7812638282775879
Test layer1 Acc 0.8744, AUC 0.9292835593223572, avg_entr 0.06016223132610321, f1 0.8744000792503357
l1_test_time 1.7810041904449463
Test layer2 Acc 0.874, AUC 0.9302125573158264, avg_entr 0.04998817294836044, f1 0.8740000128746033
l2_test_time 2.9585766792297363
Test layer3 Acc 0.8718, AUC 0.931999146938324, avg_entr 0.04314734786748886, f1 0.8718000650405884
l3_test_time 4.223705530166626
Test layer4 Acc 0.87, AUC 0.9308366775512695, avg_entr 0.04035172238945961, f1 0.8700000047683716
l4_test_time 5.435849189758301
