total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 23.996341943740845
Start Training
gc 0
Train Epoch0 Acc 0.513975 (20559/40000), AUC 0.5208362936973572
ep0_train_time 143.17350459098816
Test Epoch0 layer0 Acc 0.8022, AUC 0.8930448293685913, avg_entr 0.5515551567077637, f1 0.8022000193595886
ep0_l0_test_time 0.5689349174499512
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.6032, AUC 0.6476173400878906, avg_entr 0.6570448875427246, f1 0.6032000184059143
ep0_l1_test_time 1.0599091053009033
Test Epoch0 layer2 Acc 0.6218, AUC 0.666179358959198, avg_entr 0.671378493309021, f1 0.6218000054359436
ep0_l2_test_time 1.6777336597442627
Test Epoch0 layer3 Acc 0.612, AUC 0.7302482724189758, avg_entr 0.6317614316940308, f1 0.6119999885559082
ep0_l3_test_time 2.2821755409240723
Test Epoch0 layer4 Acc 0.5484, AUC 0.7427182197570801, avg_entr 0.6014159321784973, f1 0.5483999848365784
ep0_l4_test_time 5.299839019775391
gc 0
Train Epoch1 Acc 0.80265 (32106/40000), AUC 0.860468327999115
ep1_train_time 154.95151615142822
Test Epoch1 layer0 Acc 0.8812, AUC 0.9465399980545044, avg_entr 0.2908163070678711, f1 0.8812000155448914
ep1_l0_test_time 0.770371675491333
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.7514, AUC 0.845494270324707, avg_entr 0.3465941548347473, f1 0.7513999938964844
ep1_l1_test_time 1.7637391090393066
Test Epoch1 layer2 Acc 0.7754, AUC 0.8586224913597107, avg_entr 0.4224730432033539, f1 0.775399923324585
ep1_l2_test_time 2.938774347305298
Test Epoch1 layer3 Acc 0.7786, AUC 0.8653706312179565, avg_entr 0.4594603478908539, f1 0.7785999774932861
ep1_l3_test_time 4.216996908187866
Test Epoch1 layer4 Acc 0.763, AUC 0.8644052743911743, avg_entr 0.49809423089027405, f1 0.7630000114440918
ep1_l4_test_time 5.490808010101318
gc 0
Train Epoch2 Acc 0.872825 (34913/40000), AUC 0.9224147796630859
ep2_train_time 154.7784562110901
Test Epoch2 layer0 Acc 0.8936, AUC 0.9549885988235474, avg_entr 0.22714738547801971, f1 0.8935999870300293
ep2_l0_test_time 0.7678544521331787
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8714, AUC 0.9275363683700562, avg_entr 0.06042368337512016, f1 0.871399998664856
ep2_l1_test_time 1.7465527057647705
Test Epoch2 layer2 Acc 0.872, AUC 0.9301885962486267, avg_entr 0.06071409955620766, f1 0.871999979019165
ep2_l2_test_time 2.941617488861084
Test Epoch2 layer3 Acc 0.8716, AUC 0.9316093921661377, avg_entr 0.04623187705874443, f1 0.8715999722480774
ep2_l3_test_time 4.207436561584473
Test Epoch2 layer4 Acc 0.8694, AUC 0.9314531087875366, avg_entr 0.05974157154560089, f1 0.8694000244140625
ep2_l4_test_time 5.432953119277954
gc 0
Train Epoch3 Acc 0.909475 (36379/40000), AUC 0.9542322754859924
ep3_train_time 154.95376324653625
Test Epoch3 layer0 Acc 0.8956, AUC 0.957900881767273, avg_entr 0.1979321986436844, f1 0.8956000208854675
ep3_l0_test_time 0.7599420547485352
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.879, AUC 0.9301296472549438, avg_entr 0.049544863402843475, f1 0.8790000081062317
ep3_l1_test_time 1.7405893802642822
Test Epoch3 layer2 Acc 0.8766, AUC 0.9349015951156616, avg_entr 0.047166697680950165, f1 0.8766000270843506
ep3_l2_test_time 2.964416980743408
Test Epoch3 layer3 Acc 0.8764, AUC 0.9353189468383789, avg_entr 0.036511532962322235, f1 0.8763999938964844
ep3_l3_test_time 4.157331228256226
Test Epoch3 layer4 Acc 0.876, AUC 0.935352087020874, avg_entr 0.04326563701033592, f1 0.8760000467300415
ep3_l4_test_time 5.494662523269653
gc 0
Train Epoch4 Acc 0.9168 (36672/40000), AUC 0.9620950818061829
ep4_train_time 154.96589136123657
Test Epoch4 layer0 Acc 0.8946, AUC 0.9585584402084351, avg_entr 0.17562025785446167, f1 0.894599974155426
ep4_l0_test_time 0.7782597541809082
Test Epoch4 layer1 Acc 0.8874, AUC 0.9423651099205017, avg_entr 0.046127378940582275, f1 0.8873999714851379
ep4_l1_test_time 1.7496495246887207
Test Epoch4 layer2 Acc 0.8862, AUC 0.9429488182067871, avg_entr 0.03757840394973755, f1 0.8862000107765198
ep4_l2_test_time 2.9445741176605225
Test Epoch4 layer3 Acc 0.8868, AUC 0.9432631731033325, avg_entr 0.030525092035531998, f1 0.8867999911308289
ep4_l3_test_time 4.204196453094482
Test Epoch4 layer4 Acc 0.8866, AUC 0.9431148767471313, avg_entr 0.03095066174864769, f1 0.8866000771522522
ep4_l4_test_time 5.522705793380737
gc 0
Train Epoch5 Acc 0.938675 (37547/40000), AUC 0.9777066707611084
ep5_train_time 154.92685747146606
Test Epoch5 layer0 Acc 0.8952, AUC 0.957675576210022, avg_entr 0.16371755301952362, f1 0.8952000141143799
ep5_l0_test_time 0.7482984066009521
Test Epoch5 layer1 Acc 0.8898, AUC 0.9435305595397949, avg_entr 0.04167751595377922, f1 0.8898000121116638
ep5_l1_test_time 1.7589521408081055
Test Epoch5 layer2 Acc 0.8904, AUC 0.943892776966095, avg_entr 0.03243344649672508, f1 0.8903999924659729
ep5_l2_test_time 3.03387451171875
Test Epoch5 layer3 Acc 0.8908, AUC 0.9442945718765259, avg_entr 0.0274024847894907, f1 0.8907999992370605
ep5_l3_test_time 4.206581115722656
Test Epoch5 layer4 Acc 0.8908, AUC 0.9440302848815918, avg_entr 0.027673697099089622, f1 0.8907999992370605
ep5_l4_test_time 5.540789365768433
gc 0
Train Epoch6 Acc 0.947675 (37907/40000), AUC 0.9829331636428833
ep6_train_time 154.9794201850891
Test Epoch6 layer0 Acc 0.8846, AUC 0.9564952850341797, avg_entr 0.16177767515182495, f1 0.8845999836921692
ep6_l0_test_time 0.768479585647583
Test Epoch6 layer1 Acc 0.8856, AUC 0.944244921207428, avg_entr 0.03820633515715599, f1 0.8855999708175659
ep6_l1_test_time 1.7482938766479492
Test Epoch6 layer2 Acc 0.8868, AUC 0.9442132711410522, avg_entr 0.030473699793219566, f1 0.8867999911308289
ep6_l2_test_time 2.9632749557495117
Test Epoch6 layer3 Acc 0.8874, AUC 0.9444812536239624, avg_entr 0.026090215891599655, f1 0.8873999714851379
ep6_l3_test_time 4.1269848346710205
Test Epoch6 layer4 Acc 0.8874, AUC 0.9442148208618164, avg_entr 0.027242623269557953, f1 0.8873999714851379
ep6_l4_test_time 5.4596168994903564
gc 0
Train Epoch7 Acc 0.954175 (38167/40000), AUC 0.9869883060455322
ep7_train_time 154.91730642318726
Test Epoch7 layer0 Acc 0.8956, AUC 0.9552266597747803, avg_entr 0.14512626826763153, f1 0.8956000208854675
ep7_l0_test_time 0.7599072456359863
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 7
Test Epoch7 layer1 Acc 0.88, AUC 0.9425681233406067, avg_entr 0.042182713747024536, f1 0.8799999952316284
ep7_l1_test_time 1.7542142868041992
Test Epoch7 layer2 Acc 0.8812, AUC 0.9426023364067078, avg_entr 0.032828789204359055, f1 0.8812000155448914
ep7_l2_test_time 2.9611284732818604
Test Epoch7 layer3 Acc 0.8808, AUC 0.9427362680435181, avg_entr 0.02834249846637249, f1 0.8808000087738037
ep7_l3_test_time 4.193545579910278
Test Epoch7 layer4 Acc 0.8812, AUC 0.9426509737968445, avg_entr 0.028785955160856247, f1 0.8812000155448914
ep7_l4_test_time 5.457981109619141
gc 0
Train Epoch8 Acc 0.954325 (38173/40000), AUC 0.9863191246986389
ep8_train_time 154.94967007637024
Test Epoch8 layer0 Acc 0.8916, AUC 0.9530917406082153, avg_entr 0.13981325924396515, f1 0.8916000127792358
ep8_l0_test_time 0.7807528972625732
Test Epoch8 layer1 Acc 0.8816, AUC 0.9411065578460693, avg_entr 0.03054225817322731, f1 0.881600022315979
ep8_l1_test_time 1.7301537990570068
Test Epoch8 layer2 Acc 0.8798, AUC 0.9413747787475586, avg_entr 0.024111038073897362, f1 0.879800021648407
ep8_l2_test_time 2.974095106124878
Test Epoch8 layer3 Acc 0.8788, AUC 0.9417445659637451, avg_entr 0.021299773827195168, f1 0.8787999749183655
ep8_l3_test_time 4.199792385101318
Test Epoch8 layer4 Acc 0.8778, AUC 0.9416095614433289, avg_entr 0.02215196006000042, f1 0.8778000473976135
ep8_l4_test_time 5.495936870574951
gc 0
Train Epoch9 Acc 0.959825 (38393/40000), AUC 0.9900435209274292
ep9_train_time 154.8484160900116
Test Epoch9 layer0 Acc 0.888, AUC 0.9523401260375977, avg_entr 0.1342613399028778, f1 0.8880000114440918
ep9_l0_test_time 0.7702898979187012
Test Epoch9 layer1 Acc 0.8796, AUC 0.9426600933074951, avg_entr 0.03582443296909332, f1 0.8795999884605408
ep9_l1_test_time 1.7402324676513672
Test Epoch9 layer2 Acc 0.8802, AUC 0.9425278902053833, avg_entr 0.028669141232967377, f1 0.8802000284194946
ep9_l2_test_time 2.9478907585144043
Test Epoch9 layer3 Acc 0.88, AUC 0.9428550601005554, avg_entr 0.025779470801353455, f1 0.8799999952316284
ep9_l3_test_time 4.145218133926392
Test Epoch9 layer4 Acc 0.8798, AUC 0.9426429271697998, avg_entr 0.027197333052754402, f1 0.879800021648407
ep9_l4_test_time 5.498267889022827
gc 0
Train Epoch10 Acc 0.9649 (38596/40000), AUC 0.9919830560684204
ep10_train_time 154.73107242584229
Test Epoch10 layer0 Acc 0.8886, AUC 0.9512154459953308, avg_entr 0.13505242764949799, f1 0.8885999917984009
ep10_l0_test_time 0.7884058952331543
Test Epoch10 layer1 Acc 0.878, AUC 0.9417058229446411, avg_entr 0.029837511479854584, f1 0.878000020980835
ep10_l1_test_time 1.7507805824279785
Test Epoch10 layer2 Acc 0.8774, AUC 0.9417027235031128, avg_entr 0.023695966228842735, f1 0.8773999810218811
ep10_l2_test_time 3.0160090923309326
Test Epoch10 layer3 Acc 0.8774, AUC 0.942177414894104, avg_entr 0.021436011418700218, f1 0.8773999810218811
ep10_l3_test_time 4.22924017906189
Test Epoch10 layer4 Acc 0.8766, AUC 0.9418529272079468, avg_entr 0.022963762283325195, f1 0.8766000270843506
ep10_l4_test_time 5.530152082443237
gc 0
Train Epoch11 Acc 0.9674 (38696/40000), AUC 0.993783712387085
ep11_train_time 137.45799160003662
Test Epoch11 layer0 Acc 0.8886, AUC 0.9502049088478088, avg_entr 0.13114777207374573, f1 0.8885999917984009
ep11_l0_test_time 0.751600980758667
Test Epoch11 layer1 Acc 0.876, AUC 0.9394334554672241, avg_entr 0.032862577587366104, f1 0.8760000467300415
ep11_l1_test_time 1.7614173889160156
Test Epoch11 layer2 Acc 0.8774, AUC 0.9394868016242981, avg_entr 0.02648056671023369, f1 0.8773999810218811
ep11_l2_test_time 2.9407660961151123
Test Epoch11 layer3 Acc 0.8764, AUC 0.9396569132804871, avg_entr 0.024090200662612915, f1 0.8763999938964844
ep11_l3_test_time 4.1906421184539795
Test Epoch11 layer4 Acc 0.8768, AUC 0.9393357634544373, avg_entr 0.024738389998674393, f1 0.876800000667572
ep11_l4_test_time 5.463721513748169
gc 0
Train Epoch12 Acc 0.96915 (38766/40000), AUC 0.9942201375961304
ep12_train_time 155.04431700706482
Test Epoch12 layer0 Acc 0.8882, AUC 0.9489325284957886, avg_entr 0.1283409744501114, f1 0.888200044631958
ep12_l0_test_time 0.7583575248718262
Test Epoch12 layer1 Acc 0.8744, AUC 0.9394489526748657, avg_entr 0.031679604202508926, f1 0.8744000792503357
ep12_l1_test_time 1.7568302154541016
Test Epoch12 layer2 Acc 0.875, AUC 0.9395490884780884, avg_entr 0.02522326074540615, f1 0.875
ep12_l2_test_time 2.946343421936035
Test Epoch12 layer3 Acc 0.873, AUC 0.9398812055587769, avg_entr 0.02279054932296276, f1 0.8730000257492065
ep12_l3_test_time 4.10798192024231
Test Epoch12 layer4 Acc 0.8756, AUC 0.939634382724762, avg_entr 0.023662621155381203, f1 0.8756000399589539
ep12_l4_test_time 5.462843179702759
gc 0
Train Epoch13 Acc 0.9716 (38864/40000), AUC 0.994666337966919
ep13_train_time 155.13691449165344
Test Epoch13 layer0 Acc 0.8842, AUC 0.948260486125946, avg_entr 0.12777723371982574, f1 0.8842000365257263
ep13_l0_test_time 0.7659924030303955
Test Epoch13 layer1 Acc 0.8726, AUC 0.9358080625534058, avg_entr 0.025717513635754585, f1 0.8726000189781189
ep13_l1_test_time 1.758432149887085
Test Epoch13 layer2 Acc 0.8732, AUC 0.9366310834884644, avg_entr 0.01983497105538845, f1 0.873199999332428
ep13_l2_test_time 2.8920581340789795
Test Epoch13 layer3 Acc 0.8728, AUC 0.9371495246887207, avg_entr 0.01787600852549076, f1 0.8727999925613403
ep13_l3_test_time 4.186167001724243
Test Epoch13 layer4 Acc 0.8738, AUC 0.9369574785232544, avg_entr 0.019508522003889084, f1 0.8737999796867371
ep13_l4_test_time 5.495430946350098
gc 0
Train Epoch14 Acc 0.972 (38880/40000), AUC 0.9950790405273438
ep14_train_time 155.09628319740295
Test Epoch14 layer0 Acc 0.8834, AUC 0.947646975517273, avg_entr 0.12530842423439026, f1 0.8834000825881958
ep14_l0_test_time 0.7668297290802002
Test Epoch14 layer1 Acc 0.8744, AUC 0.9355432987213135, avg_entr 0.025184115394949913, f1 0.8744000792503357
ep14_l1_test_time 1.747743844985962
Test Epoch14 layer2 Acc 0.875, AUC 0.9361557960510254, avg_entr 0.02033577300608158, f1 0.875
ep14_l2_test_time 2.9192962646484375
Test Epoch14 layer3 Acc 0.8748, AUC 0.9362951517105103, avg_entr 0.01865781657397747, f1 0.8748000264167786
ep14_l3_test_time 4.213421106338501
Test Epoch14 layer4 Acc 0.8746, AUC 0.9361261129379272, avg_entr 0.020253337919712067, f1 0.8745999932289124
ep14_l4_test_time 5.488559722900391
gc 0
Train Epoch15 Acc 0.973525 (38941/40000), AUC 0.995560884475708
ep15_train_time 155.0361442565918
Test Epoch15 layer0 Acc 0.8828, AUC 0.9469271898269653, avg_entr 0.12351056188344955, f1 0.8827999830245972
ep15_l0_test_time 0.74442458152771
Test Epoch15 layer1 Acc 0.8704, AUC 0.9346190690994263, avg_entr 0.026216527447104454, f1 0.8704000115394592
ep15_l1_test_time 1.7461843490600586
Test Epoch15 layer2 Acc 0.8712, AUC 0.9350990653038025, avg_entr 0.0205893125385046, f1 0.8712000846862793
ep15_l2_test_time 2.9984922409057617
Test Epoch15 layer3 Acc 0.8706, AUC 0.9349842071533203, avg_entr 0.018883243203163147, f1 0.8705999851226807
ep15_l3_test_time 4.205877304077148
Test Epoch15 layer4 Acc 0.8714, AUC 0.9348098635673523, avg_entr 0.019878173246979713, f1 0.871399998664856
ep15_l4_test_time 5.560772895812988
gc 0
Train Epoch16 Acc 0.97395 (38958/40000), AUC 0.9957515001296997
ep16_train_time 155.17439079284668
Test Epoch16 layer0 Acc 0.881, AUC 0.9463233947753906, avg_entr 0.1213514655828476, f1 0.8809999823570251
ep16_l0_test_time 0.7651593685150146
Test Epoch16 layer1 Acc 0.8712, AUC 0.9348686337471008, avg_entr 0.026963580399751663, f1 0.8712000846862793
ep16_l1_test_time 1.7358050346374512
Test Epoch16 layer2 Acc 0.8722, AUC 0.9355782270431519, avg_entr 0.019858069717884064, f1 0.872200071811676
ep16_l2_test_time 2.9516825675964355
Test Epoch16 layer3 Acc 0.8718, AUC 0.9356224536895752, avg_entr 0.01768801547586918, f1 0.8718000650405884
ep16_l3_test_time 4.2083210945129395
Test Epoch16 layer4 Acc 0.8716, AUC 0.935491681098938, avg_entr 0.019205331802368164, f1 0.8715999722480774
ep16_l4_test_time 5.46449613571167
gc 0
Train Epoch17 Acc 0.974375 (38975/40000), AUC 0.9957832098007202
ep17_train_time 154.87907123565674
Test Epoch17 layer0 Acc 0.8816, AUC 0.9460753202438354, avg_entr 0.12231554090976715, f1 0.881600022315979
ep17_l0_test_time 0.7592926025390625
Test Epoch17 layer1 Acc 0.8706, AUC 0.9340610504150391, avg_entr 0.02546466700732708, f1 0.8705999851226807
ep17_l1_test_time 1.7544965744018555
Test Epoch17 layer2 Acc 0.8708, AUC 0.9350303411483765, avg_entr 0.019355975091457367, f1 0.8708000183105469
ep17_l2_test_time 2.9924724102020264
Test Epoch17 layer3 Acc 0.87, AUC 0.9351210594177246, avg_entr 0.01724070869386196, f1 0.8700000047683716
ep17_l3_test_time 4.205852031707764
Test Epoch17 layer4 Acc 0.8702, AUC 0.9349900484085083, avg_entr 0.01825573295354843, f1 0.870199978351593
ep17_l4_test_time 5.465494632720947
gc 0
Train Epoch18 Acc 0.974875 (38995/40000), AUC 0.9959630966186523
ep18_train_time 154.9676604270935
Test Epoch18 layer0 Acc 0.8808, AUC 0.9458054304122925, avg_entr 0.12140493094921112, f1 0.8808000087738037
ep18_l0_test_time 0.7544853687286377
Test Epoch18 layer1 Acc 0.8688, AUC 0.9331696033477783, avg_entr 0.02505476400256157, f1 0.8687999844551086
ep18_l1_test_time 1.7505128383636475
Test Epoch18 layer2 Acc 0.869, AUC 0.934371292591095, avg_entr 0.019369665533304214, f1 0.8690000176429749
ep18_l2_test_time 2.889528274536133
Test Epoch18 layer3 Acc 0.8694, AUC 0.9349807500839233, avg_entr 0.01754401996731758, f1 0.8694000244140625
ep18_l3_test_time 4.187241554260254
Test Epoch18 layer4 Acc 0.868, AUC 0.934613049030304, avg_entr 0.018283963203430176, f1 0.8679999709129333
ep18_l4_test_time 5.505580425262451
gc 0
Train Epoch19 Acc 0.976125 (39045/40000), AUC 0.9961761236190796
ep19_train_time 154.969712972641
Test Epoch19 layer0 Acc 0.8808, AUC 0.9454905986785889, avg_entr 0.11874663084745407, f1 0.8808000087738037
ep19_l0_test_time 0.771306037902832
Test Epoch19 layer1 Acc 0.8682, AUC 0.9320197701454163, avg_entr 0.025809941813349724, f1 0.8682000041007996
ep19_l1_test_time 1.7564895153045654
Test Epoch19 layer2 Acc 0.8686, AUC 0.9329125881195068, avg_entr 0.019986281171441078, f1 0.8686000108718872
ep19_l2_test_time 2.9774229526519775
Test Epoch19 layer3 Acc 0.8682, AUC 0.9328320622444153, avg_entr 0.01787019520998001, f1 0.8682000041007996
ep19_l3_test_time 4.221004247665405
Test Epoch19 layer4 Acc 0.8704, AUC 0.9326333999633789, avg_entr 0.019229454919695854, f1 0.8704000115394592
ep19_l4_test_time 5.4742138385772705
gc 0
Train Epoch20 Acc 0.9755 (39020/40000), AUC 0.9962846040725708
ep20_train_time 155.02276182174683
Test Epoch20 layer0 Acc 0.8794, AUC 0.9451473355293274, avg_entr 0.11843319982290268, f1 0.8794000148773193
ep20_l0_test_time 0.7648906707763672
Test Epoch20 layer1 Acc 0.8686, AUC 0.9325700998306274, avg_entr 0.024275900796055794, f1 0.8686000108718872
ep20_l1_test_time 1.7739183902740479
Test Epoch20 layer2 Acc 0.8692, AUC 0.9335894584655762, avg_entr 0.017978565767407417, f1 0.8691999912261963
ep20_l2_test_time 3.0121874809265137
Test Epoch20 layer3 Acc 0.8684, AUC 0.9339358806610107, avg_entr 0.016072724014520645, f1 0.868399977684021
ep20_l3_test_time 4.20726752281189
Test Epoch20 layer4 Acc 0.869, AUC 0.9338078498840332, avg_entr 0.017562203109264374, f1 0.8690000176429749
ep20_l4_test_time 5.5300140380859375
gc 0
Train Epoch21 Acc 0.976125 (39045/40000), AUC 0.9963829517364502
ep21_train_time 155.02499055862427
Test Epoch21 layer0 Acc 0.879, AUC 0.9450474977493286, avg_entr 0.11857574433088303, f1 0.8790000081062317
ep21_l0_test_time 0.7655136585235596
Test Epoch21 layer1 Acc 0.8692, AUC 0.9321041703224182, avg_entr 0.024836594238877296, f1 0.8691999912261963
ep21_l1_test_time 1.742513656616211
Test Epoch21 layer2 Acc 0.8704, AUC 0.9330289959907532, avg_entr 0.018140429630875587, f1 0.8704000115394592
ep21_l2_test_time 2.8627419471740723
Test Epoch21 layer3 Acc 0.8704, AUC 0.9332784414291382, avg_entr 0.016396790742874146, f1 0.8704000115394592
ep21_l3_test_time 4.19557523727417
Test Epoch21 layer4 Acc 0.8692, AUC 0.9331051707267761, avg_entr 0.016853192821145058, f1 0.8691999912261963
ep21_l4_test_time 5.474986791610718
gc 0
Train Epoch22 Acc 0.976225 (39049/40000), AUC 0.9964162111282349
ep22_train_time 137.67667055130005
Test Epoch22 layer0 Acc 0.8792, AUC 0.9448924660682678, avg_entr 0.1176753044128418, f1 0.8791999816894531
ep22_l0_test_time 0.7526583671569824
Test Epoch22 layer1 Acc 0.8678, AUC 0.9323148727416992, avg_entr 0.02353687211871147, f1 0.8677999973297119
ep22_l1_test_time 1.7658026218414307
Test Epoch22 layer2 Acc 0.868, AUC 0.9333474636077881, avg_entr 0.017207080498337746, f1 0.8679999709129333
ep22_l2_test_time 2.9479589462280273
Test Epoch22 layer3 Acc 0.8682, AUC 0.9338165521621704, avg_entr 0.015394667163491249, f1 0.8682000041007996
ep22_l3_test_time 4.204862833023071
Test Epoch22 layer4 Acc 0.8682, AUC 0.9336906671524048, avg_entr 0.015815570950508118, f1 0.8682000041007996
ep22_l4_test_time 5.419676065444946
gc 0
Train Epoch23 Acc 0.9768 (39072/40000), AUC 0.9965935945510864
ep23_train_time 155.16952228546143
Test Epoch23 layer0 Acc 0.8802, AUC 0.9447654485702515, avg_entr 0.1165199801325798, f1 0.8802000284194946
ep23_l0_test_time 0.7711412906646729
Test Epoch23 layer1 Acc 0.8686, AUC 0.9320536255836487, avg_entr 0.02414741739630699, f1 0.8686000108718872
ep23_l1_test_time 1.7453851699829102
Test Epoch23 layer2 Acc 0.869, AUC 0.9329621195793152, avg_entr 0.018096238374710083, f1 0.8690000176429749
ep23_l2_test_time 2.9763967990875244
Test Epoch23 layer3 Acc 0.869, AUC 0.9334182739257812, avg_entr 0.01637490838766098, f1 0.8690000176429749
ep23_l3_test_time 4.200294733047485
Test Epoch23 layer4 Acc 0.8686, AUC 0.9333045482635498, avg_entr 0.017312075942754745, f1 0.8686000108718872
ep23_l4_test_time 5.4789862632751465
gc 0
Train Epoch24 Acc 0.976925 (39077/40000), AUC 0.9966081380844116
ep24_train_time 155.19125366210938
Test Epoch24 layer0 Acc 0.878, AUC 0.944527268409729, avg_entr 0.11554907262325287, f1 0.878000020980835
ep24_l0_test_time 0.7591567039489746
Test Epoch24 layer1 Acc 0.8704, AUC 0.9317662119865417, avg_entr 0.024390647187829018, f1 0.8704000115394592
ep24_l1_test_time 1.708061695098877
Test Epoch24 layer2 Acc 0.869, AUC 0.9325644969940186, avg_entr 0.01864010840654373, f1 0.8690000176429749
ep24_l2_test_time 3.0267717838287354
Test Epoch24 layer3 Acc 0.8692, AUC 0.9328514337539673, avg_entr 0.01680203154683113, f1 0.8691999912261963
ep24_l3_test_time 4.201627492904663
Test Epoch24 layer4 Acc 0.8704, AUC 0.9327540993690491, avg_entr 0.017687804996967316, f1 0.8704000115394592
ep24_l4_test_time 5.498401403427124
gc 0
Train Epoch25 Acc 0.97695 (39078/40000), AUC 0.9965981841087341
ep25_train_time 155.28975915908813
Test Epoch25 layer0 Acc 0.8798, AUC 0.9445603489875793, avg_entr 0.11561276763677597, f1 0.879800021648407
ep25_l0_test_time 0.7662434577941895
Test Epoch25 layer1 Acc 0.8678, AUC 0.9317026734352112, avg_entr 0.023760711774230003, f1 0.8677999973297119
ep25_l1_test_time 1.7573826313018799
Test Epoch25 layer2 Acc 0.8684, AUC 0.9326496720314026, avg_entr 0.017786381766200066, f1 0.868399977684021
ep25_l2_test_time 3.017423152923584
Test Epoch25 layer3 Acc 0.8686, AUC 0.9330825805664062, avg_entr 0.016069727018475533, f1 0.8686000108718872
ep25_l3_test_time 4.21909761428833
Test Epoch25 layer4 Acc 0.8692, AUC 0.9329745769500732, avg_entr 0.016764620319008827, f1 0.8691999912261963
ep25_l4_test_time 5.424635410308838
gc 0
Train Epoch26 Acc 0.977575 (39103/40000), AUC 0.996630847454071
ep26_train_time 155.061993598938
Test Epoch26 layer0 Acc 0.8788, AUC 0.9444907307624817, avg_entr 0.11553409695625305, f1 0.8787999749183655
ep26_l0_test_time 0.7566022872924805
Test Epoch26 layer1 Acc 0.8688, AUC 0.9314900636672974, avg_entr 0.023356983438134193, f1 0.8687999844551086
ep26_l1_test_time 1.751081943511963
Test Epoch26 layer2 Acc 0.8688, AUC 0.9324020147323608, avg_entr 0.01783253252506256, f1 0.8687999844551086
ep26_l2_test_time 2.9533140659332275
Test Epoch26 layer3 Acc 0.8686, AUC 0.932831883430481, avg_entr 0.016139017418026924, f1 0.8686000108718872
ep26_l3_test_time 4.1908955574035645
Test Epoch26 layer4 Acc 0.869, AUC 0.9328134655952454, avg_entr 0.01690841279923916, f1 0.8690000176429749
ep26_l4_test_time 5.501114845275879
gc 0
Train Epoch27 Acc 0.9775 (39100/40000), AUC 0.9966967701911926
ep27_train_time 155.10649394989014
Test Epoch27 layer0 Acc 0.8794, AUC 0.9444321393966675, avg_entr 0.11487772315740585, f1 0.8794000148773193
ep27_l0_test_time 0.7705178260803223
Test Epoch27 layer1 Acc 0.868, AUC 0.9316774606704712, avg_entr 0.023582547903060913, f1 0.8679999709129333
ep27_l1_test_time 1.7104196548461914
Test Epoch27 layer2 Acc 0.869, AUC 0.9325175285339355, avg_entr 0.017653534188866615, f1 0.8690000176429749
ep27_l2_test_time 2.946998357772827
Test Epoch27 layer3 Acc 0.8692, AUC 0.9329342842102051, avg_entr 0.015953827649354935, f1 0.8691999912261963
ep27_l3_test_time 4.196950197219849
Test Epoch27 layer4 Acc 0.8682, AUC 0.9328272342681885, avg_entr 0.017018474638462067, f1 0.8682000041007996
ep27_l4_test_time 5.46929144859314
gc 0
Train Epoch28 Acc 0.9776 (39104/40000), AUC 0.9967077970504761
ep28_train_time 154.95715045928955
Test Epoch28 layer0 Acc 0.8796, AUC 0.9443640112876892, avg_entr 0.11450272053480148, f1 0.8795999884605408
ep28_l0_test_time 0.760169267654419
Test Epoch28 layer1 Acc 0.867, AUC 0.9315584897994995, avg_entr 0.02307775802910328, f1 0.8669999837875366
ep28_l1_test_time 1.7302236557006836
Test Epoch28 layer2 Acc 0.8682, AUC 0.9325592517852783, avg_entr 0.017302675172686577, f1 0.8682000041007996
ep28_l2_test_time 2.951610565185547
Test Epoch28 layer3 Acc 0.8676, AUC 0.9331117868423462, avg_entr 0.0156969353556633, f1 0.8675999641418457
ep28_l3_test_time 4.220566749572754
Test Epoch28 layer4 Acc 0.8684, AUC 0.9330191612243652, avg_entr 0.016108136624097824, f1 0.868399977684021
ep28_l4_test_time 5.404547452926636
gc 0
Train Epoch29 Acc 0.9776 (39104/40000), AUC 0.9967613816261292
ep29_train_time 155.0249056816101
Test Epoch29 layer0 Acc 0.8794, AUC 0.9443222284317017, avg_entr 0.11399713158607483, f1 0.8794000148773193
ep29_l0_test_time 0.7666361331939697
Test Epoch29 layer1 Acc 0.869, AUC 0.9312710762023926, avg_entr 0.02301890030503273, f1 0.8690000176429749
ep29_l1_test_time 1.7523653507232666
Test Epoch29 layer2 Acc 0.8696, AUC 0.9321393370628357, avg_entr 0.017402760684490204, f1 0.8695999383926392
ep29_l2_test_time 3.015892505645752
Test Epoch29 layer3 Acc 0.8694, AUC 0.9325897693634033, avg_entr 0.015849020332098007, f1 0.8694000244140625
ep29_l3_test_time 4.196412086486816
Test Epoch29 layer4 Acc 0.8686, AUC 0.9324997067451477, avg_entr 0.016482913866639137, f1 0.8686000108718872
ep29_l4_test_time 5.4763970375061035
Best AUC tensor(0.8956) 7 0
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 5055.513632059097
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.8864, AUC 0.9507492780685425, avg_entr 0.1466325968503952, f1 0.8863999843597412
l0_test_time 0.7581577301025391
Test layer1 Acc 0.8744, AUC 0.9374811053276062, avg_entr 0.044409919530153275, f1 0.8744000792503357
l1_test_time 1.7290146350860596
Test layer2 Acc 0.8748, AUC 0.9378421902656555, avg_entr 0.03427043929696083, f1 0.8748000264167786
l2_test_time 3.0086236000061035
Test layer3 Acc 0.8746, AUC 0.9380452632904053, avg_entr 0.029972663149237633, f1 0.8745999932289124
l3_test_time 4.1442437171936035
Test layer4 Acc 0.876, AUC 0.9387766122817993, avg_entr 0.030518054962158203, f1 0.8760000467300415
l4_test_time 5.470932483673096
