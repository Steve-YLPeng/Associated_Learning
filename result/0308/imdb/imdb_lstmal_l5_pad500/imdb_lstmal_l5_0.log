total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 23.317272186279297
Start Training
gc 0
Train Epoch0 Acc 0.526 (21040/40000), AUC 0.539007306098938
ep0_train_time 155.4288547039032
Test Epoch0 layer0 Acc 0.7844, AUC 0.888590931892395, avg_entr 0.5604901313781738, f1 0.7843999266624451
ep0_l0_test_time 0.7576160430908203
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.6072, AUC 0.653649091720581, avg_entr 0.661021888256073, f1 0.607200026512146
ep0_l1_test_time 1.7807447910308838
Test Epoch0 layer2 Acc 0.6806, AUC 0.741936206817627, avg_entr 0.6192771196365356, f1 0.6805999875068665
ep0_l2_test_time 2.9601075649261475
Test Epoch0 layer3 Acc 0.671, AUC 0.7555315494537354, avg_entr 0.5879155993461609, f1 0.6710000038146973
ep0_l3_test_time 4.23409104347229
Test Epoch0 layer4 Acc 0.6636, AUC 0.7643851041793823, avg_entr 0.5323691368103027, f1 0.6636000275611877
ep0_l4_test_time 5.5082690715789795
gc 0
Train Epoch1 Acc 0.803675 (32147/40000), AUC 0.859815239906311
ep1_train_time 155.16293692588806
Test Epoch1 layer0 Acc 0.8698, AUC 0.945440411567688, avg_entr 0.28612852096557617, f1 0.8697999715805054
ep1_l0_test_time 0.7292261123657227
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8402, AUC 0.8985334038734436, avg_entr 0.14775238931179047, f1 0.8402000069618225
ep1_l1_test_time 1.7981023788452148
Test Epoch1 layer2 Acc 0.8416, AUC 0.9050424098968506, avg_entr 0.12808828055858612, f1 0.8416000008583069
ep1_l2_test_time 2.947157144546509
Test Epoch1 layer3 Acc 0.8414, AUC 0.9059951305389404, avg_entr 0.11979759484529495, f1 0.8414000272750854
ep1_l3_test_time 4.130841493606567
Test Epoch1 layer4 Acc 0.841, AUC 0.9067052006721497, avg_entr 0.14913944900035858, f1 0.8410000205039978
ep1_l4_test_time 5.409318208694458
gc 0
Train Epoch2 Acc 0.872 (34880/40000), AUC 0.9253189563751221
ep2_train_time 155.12285232543945
Test Epoch2 layer0 Acc 0.8918, AUC 0.955310583114624, avg_entr 0.22664125263690948, f1 0.8917999863624573
ep2_l0_test_time 0.7690112590789795
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8468, AUC 0.9195486903190613, avg_entr 0.05588582903146744, f1 0.8468000292778015
ep2_l1_test_time 1.7845594882965088
Test Epoch2 layer2 Acc 0.849, AUC 0.9219579696655273, avg_entr 0.05144822224974632, f1 0.8489999771118164
ep2_l2_test_time 2.970331907272339
Test Epoch2 layer3 Acc 0.8492, AUC 0.9216996431350708, avg_entr 0.04639888182282448, f1 0.8492000102996826
ep2_l3_test_time 4.197486639022827
Test Epoch2 layer4 Acc 0.8494, AUC 0.9202476739883423, avg_entr 0.056079521775245667, f1 0.849399983882904
ep2_l4_test_time 5.381170034408569
gc 0
Train Epoch3 Acc 0.885725 (35429/40000), AUC 0.941848635673523
ep3_train_time 155.3872992992401
Test Epoch3 layer0 Acc 0.8974, AUC 0.958098828792572, avg_entr 0.19601254165172577, f1 0.8974000215530396
ep3_l0_test_time 0.7538192272186279
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.8792, AUC 0.9322526454925537, avg_entr 0.06067046523094177, f1 0.8791999816894531
ep3_l1_test_time 1.7697110176086426
Test Epoch3 layer2 Acc 0.8774, AUC 0.9361283183097839, avg_entr 0.06318320333957672, f1 0.8773999810218811
ep3_l2_test_time 2.9534361362457275
Test Epoch3 layer3 Acc 0.8756, AUC 0.9367480278015137, avg_entr 0.05918259173631668, f1 0.8756000399589539
ep3_l3_test_time 4.2221839427948
Test Epoch3 layer4 Acc 0.8744, AUC 0.9368935823440552, avg_entr 0.06552237272262573, f1 0.8744000792503357
ep3_l4_test_time 5.43610405921936
gc 0
Train Epoch4 Acc 0.91535 (36614/40000), AUC 0.9591723084449768
ep4_train_time 155.23615670204163
Test Epoch4 layer0 Acc 0.897, AUC 0.9586125612258911, avg_entr 0.17512524127960205, f1 0.8970000147819519
ep4_l0_test_time 0.7628731727600098
Test Epoch4 layer1 Acc 0.8788, AUC 0.9364067316055298, avg_entr 0.04787493124604225, f1 0.8787999749183655
ep4_l1_test_time 1.789163589477539
Test Epoch4 layer2 Acc 0.88, AUC 0.9397075176239014, avg_entr 0.045657604932785034, f1 0.8799999952316284
ep4_l2_test_time 2.9330568313598633
Test Epoch4 layer3 Acc 0.8794, AUC 0.9403921365737915, avg_entr 0.039936237037181854, f1 0.8794000148773193
ep4_l3_test_time 4.2102251052856445
Test Epoch4 layer4 Acc 0.8798, AUC 0.9399480819702148, avg_entr 0.0413772277534008, f1 0.879800021648407
ep4_l4_test_time 5.358141660690308
gc 0
Train Epoch5 Acc 0.933025 (37321/40000), AUC 0.9728692770004272
ep5_train_time 155.21693682670593
Test Epoch5 layer0 Acc 0.897, AUC 0.9581708908081055, avg_entr 0.16114862263202667, f1 0.8970000147819519
ep5_l0_test_time 0.7667491436004639
Test Epoch5 layer1 Acc 0.884, AUC 0.9361680746078491, avg_entr 0.04053793102502823, f1 0.8840000033378601
ep5_l1_test_time 1.720318078994751
Test Epoch5 layer2 Acc 0.884, AUC 0.9385040998458862, avg_entr 0.03948882967233658, f1 0.8840000033378601
ep5_l2_test_time 2.99419903755188
Test Epoch5 layer3 Acc 0.8824, AUC 0.93888258934021, avg_entr 0.03625413030385971, f1 0.8823999762535095
ep5_l3_test_time 4.223727703094482
Test Epoch5 layer4 Acc 0.8826, AUC 0.938990592956543, avg_entr 0.03768997639417648, f1 0.8826000094413757
ep5_l4_test_time 5.523433446884155
gc 0
Train Epoch6 Acc 0.941025 (37641/40000), AUC 0.9792856574058533
ep6_train_time 145.32615613937378
Test Epoch6 layer0 Acc 0.8956, AUC 0.956896185874939, avg_entr 0.15500229597091675, f1 0.8956000208854675
ep6_l0_test_time 0.574235200881958
Test Epoch6 layer1 Acc 0.8814, AUC 0.9423848390579224, avg_entr 0.04201202839612961, f1 0.8813999891281128
ep6_l1_test_time 1.0712389945983887
Test Epoch6 layer2 Acc 0.8828, AUC 0.944244921207428, avg_entr 0.03617582470178604, f1 0.8827999830245972
ep6_l2_test_time 1.667992353439331
Test Epoch6 layer3 Acc 0.8832, AUC 0.9450522661209106, avg_entr 0.03167262300848961, f1 0.8831999897956848
ep6_l3_test_time 2.2684667110443115
Test Epoch6 layer4 Acc 0.8824, AUC 0.9448069930076599, avg_entr 0.032528601586818695, f1 0.8823999762535095
ep6_l4_test_time 2.9815917015075684
gc 0
Train Epoch7 Acc 0.94935 (37974/40000), AUC 0.9846251010894775
ep7_train_time 155.09516501426697
Test Epoch7 layer0 Acc 0.8914, AUC 0.9548913240432739, avg_entr 0.1435961127281189, f1 0.8913999795913696
ep7_l0_test_time 0.7765908241271973
Test Epoch7 layer1 Acc 0.8476, AUC 0.9250051975250244, avg_entr 0.027348965406417847, f1 0.847599983215332
ep7_l1_test_time 1.8550076484680176
Test Epoch7 layer2 Acc 0.8482, AUC 0.9266495704650879, avg_entr 0.02365022897720337, f1 0.8482000231742859
ep7_l2_test_time 2.9668238162994385
Test Epoch7 layer3 Acc 0.8484, AUC 0.9280675053596497, avg_entr 0.022252129390835762, f1 0.8483999967575073
ep7_l3_test_time 4.203661680221558
Test Epoch7 layer4 Acc 0.8482, AUC 0.926802933216095, avg_entr 0.02450571022927761, f1 0.8482000231742859
ep7_l4_test_time 5.385897636413574
gc 0
Train Epoch8 Acc 0.950675 (38027/40000), AUC 0.9826802611351013
ep8_train_time 154.9909017086029
Test Epoch8 layer0 Acc 0.891, AUC 0.9535784721374512, avg_entr 0.13881395757198334, f1 0.890999972820282
ep8_l0_test_time 0.7863633632659912
Test Epoch8 layer1 Acc 0.879, AUC 0.9400908946990967, avg_entr 0.03411251679062843, f1 0.8790000081062317
ep8_l1_test_time 1.775362253189087
Test Epoch8 layer2 Acc 0.8794, AUC 0.9405436515808105, avg_entr 0.030051320791244507, f1 0.8794000148773193
ep8_l2_test_time 2.9293718338012695
Test Epoch8 layer3 Acc 0.8802, AUC 0.9412170648574829, avg_entr 0.026892535388469696, f1 0.8802000284194946
ep8_l3_test_time 4.223630666732788
Test Epoch8 layer4 Acc 0.8796, AUC 0.9409711360931396, avg_entr 0.02676713652908802, f1 0.8795999884605408
ep8_l4_test_time 5.436708927154541
gc 0
Train Epoch9 Acc 0.957475 (38299/40000), AUC 0.987995982170105
ep9_train_time 155.04266119003296
Test Epoch9 layer0 Acc 0.8864, AUC 0.9524469375610352, avg_entr 0.13346488773822784, f1 0.8863999843597412
ep9_l0_test_time 0.760955810546875
Test Epoch9 layer1 Acc 0.876, AUC 0.9349797964096069, avg_entr 0.025555698201060295, f1 0.8760000467300415
ep9_l1_test_time 1.778259515762329
Test Epoch9 layer2 Acc 0.8772, AUC 0.9352288842201233, avg_entr 0.0233517587184906, f1 0.8772000074386597
ep9_l2_test_time 2.939990520477295
Test Epoch9 layer3 Acc 0.8764, AUC 0.9360281229019165, avg_entr 0.022157473489642143, f1 0.8763999938964844
ep9_l3_test_time 4.1900622844696045
Test Epoch9 layer4 Acc 0.8764, AUC 0.9356414675712585, avg_entr 0.023263974115252495, f1 0.8763999938964844
ep9_l4_test_time 5.427552938461304
gc 0
Train Epoch10 Acc 0.9486 (37944/40000), AUC 0.9843490123748779
ep10_train_time 155.17892456054688
Test Epoch10 layer0 Acc 0.8884, AUC 0.951654851436615, avg_entr 0.13356471061706543, f1 0.8884000182151794
ep10_l0_test_time 0.755622386932373
Test Epoch10 layer1 Acc 0.8752, AUC 0.9372150897979736, avg_entr 0.02854624018073082, f1 0.8751999735832214
ep10_l1_test_time 1.7759556770324707
Test Epoch10 layer2 Acc 0.877, AUC 0.9365367889404297, avg_entr 0.023284265771508217, f1 0.8769999742507935
ep10_l2_test_time 2.9823293685913086
Test Epoch10 layer3 Acc 0.8766, AUC 0.9382201433181763, avg_entr 0.02029144950211048, f1 0.8766000270843506
ep10_l3_test_time 4.211324691772461
Test Epoch10 layer4 Acc 0.8764, AUC 0.9370761513710022, avg_entr 0.02055087499320507, f1 0.8763999938964844
ep10_l4_test_time 5.483661651611328
gc 0
Train Epoch11 Acc 0.9641 (38564/40000), AUC 0.992159366607666
ep11_train_time 155.20682859420776
Test Epoch11 layer0 Acc 0.884, AUC 0.9504692554473877, avg_entr 0.12770117819309235, f1 0.8840000033378601
ep11_l0_test_time 0.7746007442474365
Test Epoch11 layer1 Acc 0.8748, AUC 0.9358639121055603, avg_entr 0.03108653612434864, f1 0.8748000264167786
ep11_l1_test_time 1.7863719463348389
Test Epoch11 layer2 Acc 0.8748, AUC 0.9359470009803772, avg_entr 0.02808806672692299, f1 0.8748000264167786
ep11_l2_test_time 2.9307894706726074
Test Epoch11 layer3 Acc 0.875, AUC 0.937114417552948, avg_entr 0.025180544704198837, f1 0.875
ep11_l3_test_time 4.20792031288147
Test Epoch11 layer4 Acc 0.8746, AUC 0.936603844165802, avg_entr 0.024956734851002693, f1 0.8745999932289124
ep11_l4_test_time 5.400004863739014
gc 0
Train Epoch12 Acc 0.96675 (38670/40000), AUC 0.9926879405975342
ep12_train_time 154.97631692886353
Test Epoch12 layer0 Acc 0.8846, AUC 0.9495292901992798, avg_entr 0.12531931698322296, f1 0.8845999836921692
ep12_l0_test_time 0.7501566410064697
Test Epoch12 layer1 Acc 0.8722, AUC 0.9357657432556152, avg_entr 0.03571020066738129, f1 0.872200071811676
ep12_l1_test_time 1.8141663074493408
Test Epoch12 layer2 Acc 0.8718, AUC 0.9364454746246338, avg_entr 0.029758676886558533, f1 0.8718000650405884
ep12_l2_test_time 2.9649367332458496
Test Epoch12 layer3 Acc 0.872, AUC 0.9367779493331909, avg_entr 0.026832757517695427, f1 0.871999979019165
ep12_l3_test_time 4.213554620742798
Test Epoch12 layer4 Acc 0.871, AUC 0.9365042448043823, avg_entr 0.02693421021103859, f1 0.8709999918937683
ep12_l4_test_time 5.412922620773315
gc 0
Train Epoch13 Acc 0.96945 (38778/40000), AUC 0.9935687780380249
ep13_train_time 155.05757212638855
Test Epoch13 layer0 Acc 0.886, AUC 0.9488396048545837, avg_entr 0.12589004635810852, f1 0.8859999775886536
ep13_l0_test_time 0.7480390071868896
Test Epoch13 layer1 Acc 0.8716, AUC 0.9347732067108154, avg_entr 0.030359387397766113, f1 0.8715999722480774
ep13_l1_test_time 1.7866311073303223
Test Epoch13 layer2 Acc 0.871, AUC 0.9349216222763062, avg_entr 0.02423681877553463, f1 0.8709999918937683
ep13_l2_test_time 2.956092357635498
Test Epoch13 layer3 Acc 0.8722, AUC 0.9352356195449829, avg_entr 0.021996235474944115, f1 0.872200071811676
ep13_l3_test_time 4.136311292648315
Test Epoch13 layer4 Acc 0.8712, AUC 0.9346807599067688, avg_entr 0.02241900935769081, f1 0.8712000846862793
ep13_l4_test_time 5.452235460281372
gc 0
Train Epoch14 Acc 0.970375 (38815/40000), AUC 0.9942229390144348
ep14_train_time 155.0306258201599
Test Epoch14 layer0 Acc 0.8858, AUC 0.9481185674667358, avg_entr 0.12380166351795197, f1 0.8858000040054321
ep14_l0_test_time 0.752537727355957
Test Epoch14 layer1 Acc 0.87, AUC 0.9356763362884521, avg_entr 0.031898193061351776, f1 0.8700000047683716
ep14_l1_test_time 1.770935297012329
Test Epoch14 layer2 Acc 0.8702, AUC 0.9362978935241699, avg_entr 0.026030538603663445, f1 0.870199978351593
ep14_l2_test_time 2.905869722366333
Test Epoch14 layer3 Acc 0.8704, AUC 0.9364742040634155, avg_entr 0.02378379926085472, f1 0.8704000115394592
ep14_l3_test_time 4.186765432357788
Test Epoch14 layer4 Acc 0.871, AUC 0.9359926581382751, avg_entr 0.024210307747125626, f1 0.8709999918937683
ep14_l4_test_time 5.419092893600464
gc 0
Train Epoch15 Acc 0.9714 (38856/40000), AUC 0.9946671724319458
ep15_train_time 137.61316013336182
Test Epoch15 layer0 Acc 0.8822, AUC 0.9475721120834351, avg_entr 0.12172381579875946, f1 0.8822000026702881
ep15_l0_test_time 0.7649767398834229
Test Epoch15 layer1 Acc 0.8706, AUC 0.9345294237136841, avg_entr 0.03007681854069233, f1 0.8705999851226807
ep15_l1_test_time 1.7625195980072021
Test Epoch15 layer2 Acc 0.8702, AUC 0.935208797454834, avg_entr 0.023971864953637123, f1 0.870199978351593
ep15_l2_test_time 3.007308006286621
Test Epoch15 layer3 Acc 0.8696, AUC 0.9352281093597412, avg_entr 0.021942514926195145, f1 0.8695999383926392
ep15_l3_test_time 4.212808609008789
Test Epoch15 layer4 Acc 0.8688, AUC 0.9348764419555664, avg_entr 0.022532278671860695, f1 0.8687999844551086
ep15_l4_test_time 5.494072675704956
gc 0
Train Epoch16 Acc 0.972125 (38885/40000), AUC 0.9948251247406006
ep16_train_time 154.99115777015686
Test Epoch16 layer0 Acc 0.8842, AUC 0.9468768835067749, avg_entr 0.12125815451145172, f1 0.8842000365257263
ep16_l0_test_time 0.7664437294006348
Test Epoch16 layer1 Acc 0.8698, AUC 0.932765007019043, avg_entr 0.02626442350447178, f1 0.8697999715805054
ep16_l1_test_time 1.7558655738830566
Test Epoch16 layer2 Acc 0.8688, AUC 0.9333754181861877, avg_entr 0.020710980519652367, f1 0.8687999844551086
ep16_l2_test_time 2.9483535289764404
Test Epoch16 layer3 Acc 0.8684, AUC 0.9336867332458496, avg_entr 0.019252365455031395, f1 0.868399977684021
ep16_l3_test_time 4.198859691619873
Test Epoch16 layer4 Acc 0.8684, AUC 0.9331392049789429, avg_entr 0.01949915662407875, f1 0.868399977684021
ep16_l4_test_time 5.398693084716797
gc 0
Train Epoch17 Acc 0.973525 (38941/40000), AUC 0.9951101541519165
ep17_train_time 155.0496153831482
Test Epoch17 layer0 Acc 0.8814, AUC 0.9466692805290222, avg_entr 0.11974233388900757, f1 0.8813999891281128
ep17_l0_test_time 0.7676033973693848
Test Epoch17 layer1 Acc 0.8692, AUC 0.9345146417617798, avg_entr 0.030595015734434128, f1 0.8691999912261963
ep17_l1_test_time 1.7789700031280518
Test Epoch17 layer2 Acc 0.8688, AUC 0.9353779554367065, avg_entr 0.024411950260400772, f1 0.8687999844551086
ep17_l2_test_time 2.9834890365600586
Test Epoch17 layer3 Acc 0.8692, AUC 0.9352845549583435, avg_entr 0.022451238706707954, f1 0.8691999912261963
ep17_l3_test_time 4.2166197299957275
Test Epoch17 layer4 Acc 0.869, AUC 0.93452388048172, avg_entr 0.02256862446665764, f1 0.8690000176429749
ep17_l4_test_time 5.399736404418945
gc 0
Train Epoch18 Acc 0.973775 (38951/40000), AUC 0.9952292442321777
ep18_train_time 155.08402919769287
Test Epoch18 layer0 Acc 0.883, AUC 0.9463977813720703, avg_entr 0.11961948126554489, f1 0.8830000162124634
ep18_l0_test_time 0.7680015563964844
Test Epoch18 layer1 Acc 0.867, AUC 0.9334650039672852, avg_entr 0.03495151922106743, f1 0.8669999837875366
ep18_l1_test_time 1.7706305980682373
Test Epoch18 layer2 Acc 0.865, AUC 0.9341323971748352, avg_entr 0.028044668957591057, f1 0.8650000095367432
ep18_l2_test_time 2.9560999870300293
Test Epoch18 layer3 Acc 0.8638, AUC 0.9340068101882935, avg_entr 0.025843435898423195, f1 0.8637999892234802
ep18_l3_test_time 4.1924262046813965
Test Epoch18 layer4 Acc 0.8644, AUC 0.9325498938560486, avg_entr 0.02671002224087715, f1 0.8644000291824341
ep18_l4_test_time 5.461252212524414
gc 0
Train Epoch19 Acc 0.97465 (38986/40000), AUC 0.9955031871795654
ep19_train_time 155.12796998023987
Test Epoch19 layer0 Acc 0.8824, AUC 0.9461377263069153, avg_entr 0.11878950148820877, f1 0.8823999762535095
ep19_l0_test_time 0.7590363025665283
Test Epoch19 layer1 Acc 0.8666, AUC 0.932049036026001, avg_entr 0.026377933099865913, f1 0.866599977016449
ep19_l1_test_time 1.7867209911346436
Test Epoch19 layer2 Acc 0.8674, AUC 0.9326454997062683, avg_entr 0.02090158499777317, f1 0.8673999905586243
ep19_l2_test_time 2.947871446609497
Test Epoch19 layer3 Acc 0.8676, AUC 0.9323443174362183, avg_entr 0.019505538046360016, f1 0.8675999641418457
ep19_l3_test_time 4.1914355754852295
Test Epoch19 layer4 Acc 0.867, AUC 0.9320023655891418, avg_entr 0.01959257200360298, f1 0.8669999837875366
ep19_l4_test_time 5.365790605545044
gc 0
Train Epoch20 Acc 0.975425 (39017/40000), AUC 0.9956110119819641
ep20_train_time 155.01041722297668
Test Epoch20 layer0 Acc 0.8812, AUC 0.9457617998123169, avg_entr 0.11715292930603027, f1 0.8812000155448914
ep20_l0_test_time 0.7555668354034424
Test Epoch20 layer1 Acc 0.8684, AUC 0.9323681592941284, avg_entr 0.028272202238440514, f1 0.868399977684021
ep20_l1_test_time 1.7496280670166016
Test Epoch20 layer2 Acc 0.868, AUC 0.9334450364112854, avg_entr 0.022072171792387962, f1 0.8679999709129333
ep20_l2_test_time 2.9994819164276123
Test Epoch20 layer3 Acc 0.8674, AUC 0.9335628747940063, avg_entr 0.020162008702754974, f1 0.8673999905586243
ep20_l3_test_time 4.186564922332764
Test Epoch20 layer4 Acc 0.8674, AUC 0.9327487349510193, avg_entr 0.020284708589315414, f1 0.8673999905586243
ep20_l4_test_time 5.509784460067749
gc 0
Train Epoch21 Acc 0.975575 (39023/40000), AUC 0.9956154823303223
ep21_train_time 155.0005078315735
Test Epoch21 layer0 Acc 0.8808, AUC 0.945625901222229, avg_entr 0.11694006621837616, f1 0.8808000087738037
ep21_l0_test_time 0.7521183490753174
Test Epoch21 layer1 Acc 0.8686, AUC 0.9318574666976929, avg_entr 0.025802752003073692, f1 0.8686000108718872
ep21_l1_test_time 1.8170950412750244
Test Epoch21 layer2 Acc 0.8668, AUC 0.9326720833778381, avg_entr 0.020118791610002518, f1 0.8668000102043152
ep21_l2_test_time 2.9421651363372803
Test Epoch21 layer3 Acc 0.8672, AUC 0.9327715039253235, avg_entr 0.0186412762850523, f1 0.8672000169754028
ep21_l3_test_time 4.175279140472412
Test Epoch21 layer4 Acc 0.8666, AUC 0.9319413900375366, avg_entr 0.018821069970726967, f1 0.866599977016449
ep21_l4_test_time 5.4138407707214355
gc 0
Train Epoch22 Acc 0.97565 (39026/40000), AUC 0.9957349300384521
ep22_train_time 155.13661694526672
Test Epoch22 layer0 Acc 0.881, AUC 0.9455268383026123, avg_entr 0.1163831427693367, f1 0.8809999823570251
ep22_l0_test_time 0.7585396766662598
Test Epoch22 layer1 Acc 0.8676, AUC 0.9321936368942261, avg_entr 0.026501117274165154, f1 0.8675999641418457
ep22_l1_test_time 1.7418177127838135
Test Epoch22 layer2 Acc 0.8686, AUC 0.9329739212989807, avg_entr 0.02021915651857853, f1 0.8686000108718872
ep22_l2_test_time 2.9673984050750732
Test Epoch22 layer3 Acc 0.868, AUC 0.9331556558609009, avg_entr 0.018707938492298126, f1 0.8679999709129333
ep22_l3_test_time 4.197713136672974
Test Epoch22 layer4 Acc 0.8666, AUC 0.9321736097335815, avg_entr 0.01865803636610508, f1 0.866599977016449
ep22_l4_test_time 5.401295185089111
gc 0
Train Epoch23 Acc 0.976125 (39045/40000), AUC 0.9958545565605164
ep23_train_time 154.9137818813324
Test Epoch23 layer0 Acc 0.8806, AUC 0.9453576803207397, avg_entr 0.11633837968111038, f1 0.8805999755859375
ep23_l0_test_time 0.7555830478668213
Test Epoch23 layer1 Acc 0.8662, AUC 0.9327232241630554, avg_entr 0.028346670791506767, f1 0.8661999702453613
ep23_l1_test_time 1.7735466957092285
Test Epoch23 layer2 Acc 0.8658, AUC 0.933599591255188, avg_entr 0.02209278754889965, f1 0.8658000826835632
ep23_l2_test_time 2.9475409984588623
Test Epoch23 layer3 Acc 0.8658, AUC 0.9334651231765747, avg_entr 0.020537985488772392, f1 0.8658000826835632
ep23_l3_test_time 4.1805055141448975
Test Epoch23 layer4 Acc 0.8658, AUC 0.9326835870742798, avg_entr 0.020442012697458267, f1 0.8658000826835632
ep23_l4_test_time 5.480292081832886
gc 0
Train Epoch24 Acc 0.9762 (39048/40000), AUC 0.9958964586257935
ep24_train_time 137.34952640533447
Test Epoch24 layer0 Acc 0.8812, AUC 0.9452331066131592, avg_entr 0.11557736992835999, f1 0.8812000155448914
ep24_l0_test_time 0.7618060111999512
Test Epoch24 layer1 Acc 0.8684, AUC 0.9320303201675415, avg_entr 0.025895291939377785, f1 0.868399977684021
ep24_l1_test_time 1.7878987789154053
Test Epoch24 layer2 Acc 0.8676, AUC 0.932787299156189, avg_entr 0.01981356367468834, f1 0.8675999641418457
ep24_l2_test_time 2.9487242698669434
Test Epoch24 layer3 Acc 0.8678, AUC 0.9327211976051331, avg_entr 0.018258612602949142, f1 0.8677999973297119
ep24_l3_test_time 4.188395977020264
Test Epoch24 layer4 Acc 0.8666, AUC 0.9319618940353394, avg_entr 0.018543798476457596, f1 0.866599977016449
ep24_l4_test_time 5.384665250778198
gc 0
Train Epoch25 Acc 0.976475 (39059/40000), AUC 0.9959298372268677
ep25_train_time 155.02508211135864
Test Epoch25 layer0 Acc 0.8796, AUC 0.9451537728309631, avg_entr 0.11458051949739456, f1 0.8795999884605408
ep25_l0_test_time 0.7739803791046143
Test Epoch25 layer1 Acc 0.8688, AUC 0.9319088459014893, avg_entr 0.026078222319483757, f1 0.8687999844551086
ep25_l1_test_time 1.7709205150604248
Test Epoch25 layer2 Acc 0.8676, AUC 0.9326601028442383, avg_entr 0.020255545154213905, f1 0.8675999641418457
ep25_l2_test_time 3.001593589782715
Test Epoch25 layer3 Acc 0.8676, AUC 0.9328031539916992, avg_entr 0.018743859604001045, f1 0.8675999641418457
ep25_l3_test_time 4.232357025146484
Test Epoch25 layer4 Acc 0.8666, AUC 0.931838870048523, avg_entr 0.018868746235966682, f1 0.866599977016449
ep25_l4_test_time 5.477693557739258
gc 0
Train Epoch26 Acc 0.976325 (39053/40000), AUC 0.9959830045700073
ep26_train_time 154.99187564849854
Test Epoch26 layer0 Acc 0.88, AUC 0.9450844526290894, avg_entr 0.11470958590507507, f1 0.8799999952316284
ep26_l0_test_time 0.7697165012359619
Test Epoch26 layer1 Acc 0.8678, AUC 0.931970477104187, avg_entr 0.02581820636987686, f1 0.8677999973297119
ep26_l1_test_time 1.7790801525115967
Test Epoch26 layer2 Acc 0.8676, AUC 0.932742178440094, avg_entr 0.02007785066962242, f1 0.8675999641418457
ep26_l2_test_time 2.9202356338500977
Test Epoch26 layer3 Acc 0.8682, AUC 0.9327466487884521, avg_entr 0.018639450892806053, f1 0.8682000041007996
ep26_l3_test_time 4.201143026351929
Test Epoch26 layer4 Acc 0.8666, AUC 0.9320578575134277, avg_entr 0.01881704479455948, f1 0.866599977016449
ep26_l4_test_time 5.397800445556641
gc 0
Train Epoch27 Acc 0.976625 (39065/40000), AUC 0.9960857629776001
ep27_train_time 155.30984807014465
Test Epoch27 layer0 Acc 0.8802, AUC 0.9450042247772217, avg_entr 0.11429078131914139, f1 0.8802000284194946
ep27_l0_test_time 0.7819690704345703
Test Epoch27 layer1 Acc 0.866, AUC 0.9316266775131226, avg_entr 0.024409154430031776, f1 0.8659999966621399
ep27_l1_test_time 1.766538143157959
Test Epoch27 layer2 Acc 0.867, AUC 0.9323965311050415, avg_entr 0.018430201336741447, f1 0.8669999837875366
ep27_l2_test_time 2.9846911430358887
Test Epoch27 layer3 Acc 0.8674, AUC 0.9322654008865356, avg_entr 0.017105037346482277, f1 0.8673999905586243
ep27_l3_test_time 4.166576385498047
Test Epoch27 layer4 Acc 0.8662, AUC 0.9315738081932068, avg_entr 0.017434293404221535, f1 0.8661999702453613
ep27_l4_test_time 5.376499176025391
gc 0
Train Epoch28 Acc 0.976625 (39065/40000), AUC 0.9960246086120605
ep28_train_time 155.14295554161072
Test Epoch28 layer0 Acc 0.8802, AUC 0.9449542760848999, avg_entr 0.1137772724032402, f1 0.8802000284194946
ep28_l0_test_time 0.7600021362304688
Test Epoch28 layer1 Acc 0.8664, AUC 0.9314769506454468, avg_entr 0.024711646139621735, f1 0.8664000034332275
ep28_l1_test_time 1.7531805038452148
Test Epoch28 layer2 Acc 0.8672, AUC 0.9322872757911682, avg_entr 0.01902875490486622, f1 0.8672000169754028
ep28_l2_test_time 2.941544532775879
Test Epoch28 layer3 Acc 0.8674, AUC 0.9323580861091614, avg_entr 0.01771543174982071, f1 0.8673999905586243
ep28_l3_test_time 4.220920562744141
Test Epoch28 layer4 Acc 0.8662, AUC 0.9315139651298523, avg_entr 0.017918534576892853, f1 0.8661999702453613
ep28_l4_test_time 5.4248082637786865
gc 0
Train Epoch29 Acc 0.9769 (39076/40000), AUC 0.996025562286377
ep29_train_time 155.28064131736755
Test Epoch29 layer0 Acc 0.8802, AUC 0.9449038505554199, avg_entr 0.11338841915130615, f1 0.8802000284194946
ep29_l0_test_time 0.7625620365142822
Test Epoch29 layer1 Acc 0.8662, AUC 0.932132363319397, avg_entr 0.026172203943133354, f1 0.8661999702453613
ep29_l1_test_time 1.8104255199432373
Test Epoch29 layer2 Acc 0.8658, AUC 0.9330457448959351, avg_entr 0.02046782895922661, f1 0.8658000826835632
ep29_l2_test_time 2.8903493881225586
Test Epoch29 layer3 Acc 0.8654, AUC 0.932932436466217, avg_entr 0.019127672538161278, f1 0.865399956703186
ep29_l3_test_time 4.205855131149292
Test Epoch29 layer4 Acc 0.8644, AUC 0.9321349859237671, avg_entr 0.01922847330570221, f1 0.8644000291824341
ep29_l4_test_time 5.4292566776275635
Best AUC tensor(0.8974) 3 0
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 5057.372104406357
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.8954, AUC 0.9552344083786011, avg_entr 0.19608667492866516, f1 0.8953999876976013
l0_test_time 0.7636246681213379
Test layer1 Acc 0.8746, AUC 0.9339906573295593, avg_entr 0.06048908084630966, f1 0.8745999932289124
l1_test_time 1.764920949935913
Test layer2 Acc 0.875, AUC 0.9375348091125488, avg_entr 0.06240067631006241, f1 0.875
l2_test_time 2.9470114707946777
Test layer3 Acc 0.8746, AUC 0.9386978149414062, avg_entr 0.05842204764485359, f1 0.8745999932289124
l3_test_time 4.2062976360321045
Test layer4 Acc 0.8728, AUC 0.9380851984024048, avg_entr 0.0645364373922348, f1 0.8727999925613403
l4_test_time 5.439413070678711
