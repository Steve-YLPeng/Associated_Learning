total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 21.695538759231567
Start Training
gc 0
Train Epoch0 Acc 0.503625 (20145/40000), AUC 0.5081993341445923
ep0_train_time 79.02064275741577
Test Epoch0 layer0 Acc 0.8116, AUC 0.887283444404602, avg_entr 0.580581545829773, f1 0.8116000294685364
ep0_l0_test_time 0.5494129657745361
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.5954, AUC 0.6427121162414551, avg_entr 0.6708707213401794, f1 0.5953999757766724
ep0_l1_test_time 1.0560646057128906
Test Epoch0 layer2 Acc 0.5896, AUC 0.676882266998291, avg_entr 0.6675381064414978, f1 0.5896000266075134
ep0_l2_test_time 1.679265022277832
Test Epoch0 layer3 Acc 0.635, AUC 0.7053090333938599, avg_entr 0.6857160925865173, f1 0.6349999904632568
ep0_l3_test_time 2.2909982204437256
Test Epoch0 layer4 Acc 0.6192, AUC 0.7062647342681885, avg_entr 0.6859161853790283, f1 0.6191999912261963
ep0_l4_test_time 2.9296278953552246
gc 0
Train Epoch1 Acc 0.802525 (32101/40000), AUC 0.8583580851554871
ep1_train_time 79.20461797714233
Test Epoch1 layer0 Acc 0.8682, AUC 0.9456183910369873, avg_entr 0.286969929933548, f1 0.8682000041007996
ep1_l0_test_time 0.5636246204376221
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.7996, AUC 0.8775255680084229, avg_entr 0.17031781375408173, f1 0.7996000051498413
ep1_l1_test_time 1.0791206359863281
Test Epoch1 layer2 Acc 0.8038, AUC 0.882080078125, avg_entr 0.2138509303331375, f1 0.8037999868392944
ep1_l2_test_time 1.6782400608062744
Test Epoch1 layer3 Acc 0.8178, AUC 0.8899809122085571, avg_entr 0.3014107048511505, f1 0.817799985408783
ep1_l3_test_time 2.2866642475128174
Test Epoch1 layer4 Acc 0.8138, AUC 0.8905239105224609, avg_entr 0.2561243176460266, f1 0.8137999773025513
ep1_l4_test_time 2.9023540019989014
gc 0
Train Epoch2 Acc 0.878275 (35131/40000), AUC 0.9348580837249756
ep2_train_time 79.23856163024902
Test Epoch2 layer0 Acc 0.8854, AUC 0.955337643623352, avg_entr 0.22335757315158844, f1 0.8853999972343445
ep2_l0_test_time 0.5564007759094238
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.885, AUC 0.9382611513137817, avg_entr 0.059318751096725464, f1 0.8849999904632568
ep2_l1_test_time 1.070669174194336
Test Epoch2 layer2 Acc 0.8854, AUC 0.9385446310043335, avg_entr 0.054125767201185226, f1 0.8853999972343445
ep2_l2_test_time 1.677476167678833
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 2
Test Epoch2 layer3 Acc 0.8866, AUC 0.9401661157608032, avg_entr 0.05998561531305313, f1 0.8866000771522522
ep2_l3_test_time 2.285160779953003
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 2
Test Epoch2 layer4 Acc 0.884, AUC 0.9392999410629272, avg_entr 0.057734522968530655, f1 0.8840000033378601
ep2_l4_test_time 2.9082555770874023
gc 0
Train Epoch3 Acc 0.909525 (36381/40000), AUC 0.9572718739509583
ep3_train_time 79.14755177497864
Test Epoch3 layer0 Acc 0.8972, AUC 0.9588022232055664, avg_entr 0.19754759967327118, f1 0.8971999883651733
ep3_l0_test_time 0.5582447052001953
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.893, AUC 0.9443234205245972, avg_entr 0.05596008151769638, f1 0.8930000066757202
ep3_l1_test_time 1.0635218620300293
Test Epoch3 layer2 Acc 0.8922, AUC 0.9452129602432251, avg_entr 0.044533368200063705, f1 0.8921999931335449
ep3_l2_test_time 1.676018476486206
Test Epoch3 layer3 Acc 0.894, AUC 0.9461159110069275, avg_entr 0.04104866459965706, f1 0.8939999938011169
ep3_l3_test_time 2.2903594970703125
Test Epoch3 layer4 Acc 0.8908, AUC 0.9452604055404663, avg_entr 0.042093340307474136, f1 0.8907999992370605
ep3_l4_test_time 2.904554605484009
gc 0
Train Epoch4 Acc 0.92145 (36858/40000), AUC 0.9646190404891968
ep4_train_time 79.17655277252197
Test Epoch4 layer0 Acc 0.8984, AUC 0.9592382907867432, avg_entr 0.17779842019081116, f1 0.8984000086784363
ep4_l0_test_time 0.5546047687530518
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.885, AUC 0.9410426616668701, avg_entr 0.04990452900528908, f1 0.8849999904632568
ep4_l1_test_time 1.0559015274047852
Test Epoch4 layer2 Acc 0.8858, AUC 0.9420806169509888, avg_entr 0.04220004752278328, f1 0.8858000040054321
ep4_l2_test_time 1.6678106784820557
Test Epoch4 layer3 Acc 0.8858, AUC 0.9427063465118408, avg_entr 0.04423653334379196, f1 0.8858000040054321
ep4_l3_test_time 2.2893459796905518
Test Epoch4 layer4 Acc 0.8842, AUC 0.9420719146728516, avg_entr 0.04439392685890198, f1 0.8842000365257263
ep4_l4_test_time 2.9057810306549072
gc 0
Train Epoch5 Acc 0.936675 (37467/40000), AUC 0.9733924865722656
ep5_train_time 79.11158728599548
Test Epoch5 layer0 Acc 0.8916, AUC 0.9585540294647217, avg_entr 0.16247764229774475, f1 0.8916000127792358
ep5_l0_test_time 0.555635929107666
Test Epoch5 layer1 Acc 0.8804, AUC 0.936133861541748, avg_entr 0.034443449229002, f1 0.8804000020027161
ep5_l1_test_time 1.053745985031128
Test Epoch5 layer2 Acc 0.8762, AUC 0.9374977350234985, avg_entr 0.03532090410590172, f1 0.8762000203132629
ep5_l2_test_time 1.6725597381591797
Test Epoch5 layer3 Acc 0.8732, AUC 0.9394030570983887, avg_entr 0.05234416574239731, f1 0.873199999332428
ep5_l3_test_time 2.2877607345581055
Test Epoch5 layer4 Acc 0.8762, AUC 0.9382647275924683, avg_entr 0.04502688720822334, f1 0.8762000203132629
ep5_l4_test_time 2.925234794616699
gc 0
Train Epoch6 Acc 0.946 (37840/40000), AUC 0.9813029170036316
ep6_train_time 79.12812757492065
Test Epoch6 layer0 Acc 0.8956, AUC 0.9574716091156006, avg_entr 0.15291865170001984, f1 0.8956000208854675
ep6_l0_test_time 0.5766322612762451
Test Epoch6 layer1 Acc 0.8888, AUC 0.9429113864898682, avg_entr 0.0395519956946373, f1 0.8888000249862671
ep6_l1_test_time 1.0600016117095947
Test Epoch6 layer2 Acc 0.8878, AUC 0.943807065486908, avg_entr 0.03323490545153618, f1 0.8877999782562256
ep6_l2_test_time 1.6659348011016846
Test Epoch6 layer3 Acc 0.8882, AUC 0.9439386129379272, avg_entr 0.03403545171022415, f1 0.888200044631958
ep6_l3_test_time 2.276740550994873
Test Epoch6 layer4 Acc 0.887, AUC 0.9437321424484253, avg_entr 0.03301731124520302, f1 0.8870000243186951
ep6_l4_test_time 2.897888660430908
gc 0
Train Epoch7 Acc 0.952 (38080/40000), AUC 0.986111044883728
ep7_train_time 79.17484259605408
Test Epoch7 layer0 Acc 0.8984, AUC 0.9558445811271667, avg_entr 0.1466803401708603, f1 0.8984000086784363
ep7_l0_test_time 0.5513780117034912
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 7
Test Epoch7 layer1 Acc 0.8852, AUC 0.9408627152442932, avg_entr 0.0391792356967926, f1 0.8852000832557678
ep7_l1_test_time 1.064330816268921
Test Epoch7 layer2 Acc 0.8862, AUC 0.9415377974510193, avg_entr 0.03142687305808067, f1 0.8862000107765198
ep7_l2_test_time 1.6730175018310547
Test Epoch7 layer3 Acc 0.886, AUC 0.9412108063697815, avg_entr 0.03308284282684326, f1 0.8859999775886536
ep7_l3_test_time 2.2804510593414307
Test Epoch7 layer4 Acc 0.884, AUC 0.9412721395492554, avg_entr 0.03235095366835594, f1 0.8840000033378601
ep7_l4_test_time 2.9032371044158936
gc 0
Train Epoch8 Acc 0.957425 (38297/40000), AUC 0.988938570022583
ep8_train_time 79.21167850494385
Test Epoch8 layer0 Acc 0.894, AUC 0.9541813135147095, avg_entr 0.1395740658044815, f1 0.8939999938011169
ep8_l0_test_time 0.5502884387969971
Test Epoch8 layer1 Acc 0.8796, AUC 0.9414477348327637, avg_entr 0.03606381267309189, f1 0.8795999884605408
ep8_l1_test_time 1.0551700592041016
Test Epoch8 layer2 Acc 0.879, AUC 0.9417971968650818, avg_entr 0.030806342139840126, f1 0.8790000081062317
ep8_l2_test_time 1.6668956279754639
Test Epoch8 layer3 Acc 0.879, AUC 0.9421448707580566, avg_entr 0.032519981265068054, f1 0.8790000081062317
ep8_l3_test_time 2.276005268096924
Test Epoch8 layer4 Acc 0.8806, AUC 0.9408036470413208, avg_entr 0.03070106729865074, f1 0.8805999755859375
ep8_l4_test_time 2.90021014213562
gc 0
Train Epoch9 Acc 0.962075 (38483/40000), AUC 0.9908241033554077
ep9_train_time 79.15721368789673
Test Epoch9 layer0 Acc 0.8936, AUC 0.9531687498092651, avg_entr 0.13512437045574188, f1 0.8935999870300293
ep9_l0_test_time 0.5508551597595215
Test Epoch9 layer1 Acc 0.8804, AUC 0.9394541382789612, avg_entr 0.03320237249135971, f1 0.8804000020027161
ep9_l1_test_time 1.0532875061035156
Test Epoch9 layer2 Acc 0.8804, AUC 0.9397839307785034, avg_entr 0.025544364005327225, f1 0.8804000020027161
ep9_l2_test_time 1.6692683696746826
Test Epoch9 layer3 Acc 0.8808, AUC 0.9397091269493103, avg_entr 0.0263353418558836, f1 0.8808000087738037
ep9_l3_test_time 2.2827467918395996
Test Epoch9 layer4 Acc 0.8814, AUC 0.9392893314361572, avg_entr 0.025818904861807823, f1 0.8813999891281128
ep9_l4_test_time 2.9073314666748047
gc 0
Train Epoch10 Acc 0.964325 (38573/40000), AUC 0.9920750856399536
ep10_train_time 79.15658378601074
Test Epoch10 layer0 Acc 0.893, AUC 0.9523416757583618, avg_entr 0.13109643757343292, f1 0.8930000066757202
ep10_l0_test_time 0.5522563457489014
Test Epoch10 layer1 Acc 0.8798, AUC 0.9394643306732178, avg_entr 0.036807745695114136, f1 0.879800021648407
ep10_l1_test_time 1.0505805015563965
Test Epoch10 layer2 Acc 0.8808, AUC 0.9398766756057739, avg_entr 0.0294058658182621, f1 0.8808000087738037
ep10_l2_test_time 1.6707022190093994
Test Epoch10 layer3 Acc 0.8798, AUC 0.9396684765815735, avg_entr 0.029172150418162346, f1 0.879800021648407
ep10_l3_test_time 2.2892773151397705
Test Epoch10 layer4 Acc 0.8814, AUC 0.9392589330673218, avg_entr 0.029502300545573235, f1 0.8813999891281128
ep10_l4_test_time 2.9251978397369385
gc 0
Train Epoch11 Acc 0.966075 (38643/40000), AUC 0.9928122758865356
ep11_train_time 79.21938824653625
Test Epoch11 layer0 Acc 0.8884, AUC 0.9510434865951538, avg_entr 0.1291130930185318, f1 0.8884000182151794
ep11_l0_test_time 0.5502581596374512
Test Epoch11 layer1 Acc 0.8768, AUC 0.9394137859344482, avg_entr 0.03642755001783371, f1 0.876800000667572
ep11_l1_test_time 1.0503523349761963
Test Epoch11 layer2 Acc 0.8768, AUC 0.9397953748703003, avg_entr 0.028919817879796028, f1 0.876800000667572
ep11_l2_test_time 1.6631922721862793
Test Epoch11 layer3 Acc 0.8776, AUC 0.9399378299713135, avg_entr 0.02905244752764702, f1 0.8776000142097473
ep11_l3_test_time 2.2713141441345215
Test Epoch11 layer4 Acc 0.876, AUC 0.9392492771148682, avg_entr 0.02880580723285675, f1 0.8760000467300415
ep11_l4_test_time 2.8959672451019287
gc 0
Train Epoch12 Acc 0.9684 (38736/40000), AUC 0.9937686920166016
ep12_train_time 79.13772988319397
Test Epoch12 layer0 Acc 0.888, AUC 0.950059175491333, avg_entr 0.12752516567707062, f1 0.8880000114440918
ep12_l0_test_time 0.555788516998291
Test Epoch12 layer1 Acc 0.8752, AUC 0.9374934434890747, avg_entr 0.031079845502972603, f1 0.8751999735832214
ep12_l1_test_time 1.0592186450958252
Test Epoch12 layer2 Acc 0.8752, AUC 0.9380042552947998, avg_entr 0.02450510673224926, f1 0.8751999735832214
ep12_l2_test_time 1.673447608947754
Test Epoch12 layer3 Acc 0.8752, AUC 0.9381905794143677, avg_entr 0.024207929149270058, f1 0.8751999735832214
ep12_l3_test_time 2.2787013053894043
Test Epoch12 layer4 Acc 0.8754, AUC 0.9373000860214233, avg_entr 0.023829735815525055, f1 0.8754000067710876
ep12_l4_test_time 2.900489091873169
gc 0
Train Epoch13 Acc 0.970425 (38817/40000), AUC 0.9942758083343506
ep13_train_time 79.17678833007812
Test Epoch13 layer0 Acc 0.8896, AUC 0.9494496583938599, avg_entr 0.12562227249145508, f1 0.8895999193191528
ep13_l0_test_time 0.5493087768554688
Test Epoch13 layer1 Acc 0.8744, AUC 0.938502311706543, avg_entr 0.034512169659137726, f1 0.8744000792503357
ep13_l1_test_time 1.0531001091003418
Test Epoch13 layer2 Acc 0.8744, AUC 0.9388889074325562, avg_entr 0.026072515174746513, f1 0.8744000792503357
ep13_l2_test_time 1.6661934852600098
Test Epoch13 layer3 Acc 0.8746, AUC 0.9389414191246033, avg_entr 0.02665448561310768, f1 0.8745999932289124
ep13_l3_test_time 2.2787575721740723
Test Epoch13 layer4 Acc 0.874, AUC 0.9381495714187622, avg_entr 0.02482450380921364, f1 0.8740000128746033
ep13_l4_test_time 2.904151201248169
gc 0
Train Epoch14 Acc 0.97115 (38846/40000), AUC 0.9946962594985962
ep14_train_time 79.15007281303406
Test Epoch14 layer0 Acc 0.886, AUC 0.9488848447799683, avg_entr 0.12542378902435303, f1 0.8859999775886536
ep14_l0_test_time 0.5561172962188721
Test Epoch14 layer1 Acc 0.874, AUC 0.9364724159240723, avg_entr 0.02952452003955841, f1 0.8740000128746033
ep14_l1_test_time 1.050673246383667
Test Epoch14 layer2 Acc 0.8744, AUC 0.9369257688522339, avg_entr 0.023028023540973663, f1 0.8744000792503357
ep14_l2_test_time 1.669060468673706
Test Epoch14 layer3 Acc 0.8738, AUC 0.9369628429412842, avg_entr 0.023518702015280724, f1 0.8737999796867371
ep14_l3_test_time 2.286318302154541
Test Epoch14 layer4 Acc 0.8734, AUC 0.9363591074943542, avg_entr 0.022387826815247536, f1 0.8733999729156494
ep14_l4_test_time 2.9013147354125977
gc 0
Train Epoch15 Acc 0.97195 (38878/40000), AUC 0.9951950907707214
ep15_train_time 79.20724606513977
Test Epoch15 layer0 Acc 0.8872, AUC 0.9481889009475708, avg_entr 0.12207912653684616, f1 0.8871999979019165
ep15_l0_test_time 0.5475716590881348
Test Epoch15 layer1 Acc 0.872, AUC 0.9361461400985718, avg_entr 0.03173082694411278, f1 0.871999979019165
ep15_l1_test_time 1.0466327667236328
Test Epoch15 layer2 Acc 0.8736, AUC 0.9363601207733154, avg_entr 0.023469261825084686, f1 0.8736000061035156
ep15_l2_test_time 1.671515703201294
Test Epoch15 layer3 Acc 0.8742, AUC 0.9363418817520142, avg_entr 0.023368939757347107, f1 0.8741999864578247
ep15_l3_test_time 2.2845122814178467
Test Epoch15 layer4 Acc 0.8742, AUC 0.9360771775245667, avg_entr 0.022364260628819466, f1 0.8741999864578247
ep15_l4_test_time 2.921452045440674
gc 0
Train Epoch16 Acc 0.972775 (38911/40000), AUC 0.9953811168670654
ep16_train_time 79.12633943557739
Test Epoch16 layer0 Acc 0.8866, AUC 0.9475721120834351, avg_entr 0.12041838467121124, f1 0.8866000771522522
ep16_l0_test_time 0.5535602569580078
Test Epoch16 layer1 Acc 0.8722, AUC 0.9366393685340881, avg_entr 0.03024914860725403, f1 0.872200071811676
ep16_l1_test_time 1.0494985580444336
Test Epoch16 layer2 Acc 0.872, AUC 0.9371635913848877, avg_entr 0.02422667294740677, f1 0.871999979019165
ep16_l2_test_time 1.6677017211914062
Test Epoch16 layer3 Acc 0.8722, AUC 0.93723064661026, avg_entr 0.02424534782767296, f1 0.872200071811676
ep16_l3_test_time 2.2722091674804688
Test Epoch16 layer4 Acc 0.8714, AUC 0.9364507794380188, avg_entr 0.023502035066485405, f1 0.871399998664856
ep16_l4_test_time 2.8901078701019287
gc 0
Train Epoch17 Acc 0.973725 (38949/40000), AUC 0.9954822063446045
ep17_train_time 79.13953042030334
Test Epoch17 layer0 Acc 0.8848, AUC 0.9473702311515808, avg_entr 0.12043255567550659, f1 0.8848000168800354
ep17_l0_test_time 0.5560529232025146
Test Epoch17 layer1 Acc 0.8718, AUC 0.9350582361221313, avg_entr 0.027958715334534645, f1 0.8718000650405884
ep17_l1_test_time 1.061455488204956
Test Epoch17 layer2 Acc 0.8732, AUC 0.9355496764183044, avg_entr 0.02203957363963127, f1 0.873199999332428
ep17_l2_test_time 1.6878931522369385
Test Epoch17 layer3 Acc 0.8724, AUC 0.9354084730148315, avg_entr 0.02221227064728737, f1 0.8723999857902527
ep17_l3_test_time 2.2832560539245605
Test Epoch17 layer4 Acc 0.872, AUC 0.9350532293319702, avg_entr 0.02134723961353302, f1 0.871999979019165
ep17_l4_test_time 2.9014790058135986
gc 0
Train Epoch18 Acc 0.9743 (38972/40000), AUC 0.9957070350646973
ep18_train_time 79.13069796562195
Test Epoch18 layer0 Acc 0.8838, AUC 0.9470807909965515, avg_entr 0.11944811791181564, f1 0.8838000297546387
ep18_l0_test_time 0.5499637126922607
Test Epoch18 layer1 Acc 0.873, AUC 0.9333416819572449, avg_entr 0.02557559125125408, f1 0.8730000257492065
ep18_l1_test_time 1.0637314319610596
Test Epoch18 layer2 Acc 0.874, AUC 0.9340826869010925, avg_entr 0.0195845328271389, f1 0.8740000128746033
ep18_l2_test_time 1.6709790229797363
Test Epoch18 layer3 Acc 0.8746, AUC 0.9336190819740295, avg_entr 0.019767753779888153, f1 0.8745999932289124
ep18_l3_test_time 2.271901845932007
Test Epoch18 layer4 Acc 0.8742, AUC 0.9335606098175049, avg_entr 0.01911301724612713, f1 0.8741999864578247
ep18_l4_test_time 2.9006357192993164
gc 0
Train Epoch19 Acc 0.974675 (38987/40000), AUC 0.9959088563919067
ep19_train_time 79.15749907493591
Test Epoch19 layer0 Acc 0.8832, AUC 0.9467573165893555, avg_entr 0.11923886835575104, f1 0.8831999897956848
ep19_l0_test_time 0.5540530681610107
Test Epoch19 layer1 Acc 0.8724, AUC 0.9346292614936829, avg_entr 0.0277347844094038, f1 0.8723999857902527
ep19_l1_test_time 1.0500521659851074
Test Epoch19 layer2 Acc 0.8716, AUC 0.9351004362106323, avg_entr 0.021772408857941628, f1 0.8715999722480774
ep19_l2_test_time 1.6678171157836914
Test Epoch19 layer3 Acc 0.8718, AUC 0.9351059198379517, avg_entr 0.021343320608139038, f1 0.8718000650405884
ep19_l3_test_time 2.278249502182007
Test Epoch19 layer4 Acc 0.8718, AUC 0.9346399307250977, avg_entr 0.020218078047037125, f1 0.8718000650405884
ep19_l4_test_time 2.9046213626861572
gc 0
Train Epoch20 Acc 0.97475 (38990/40000), AUC 0.9960064888000488
ep20_train_time 79.10285687446594
Test Epoch20 layer0 Acc 0.8836, AUC 0.9464328289031982, avg_entr 0.11806216835975647, f1 0.8835999965667725
ep20_l0_test_time 0.5481016635894775
Test Epoch20 layer1 Acc 0.8696, AUC 0.9346100091934204, avg_entr 0.027336932718753815, f1 0.8695999383926392
ep20_l1_test_time 1.055974006652832
Test Epoch20 layer2 Acc 0.8702, AUC 0.9351989030838013, avg_entr 0.021057723090052605, f1 0.870199978351593
ep20_l2_test_time 1.6689765453338623
Test Epoch20 layer3 Acc 0.8698, AUC 0.9353865385055542, avg_entr 0.02068541944026947, f1 0.8697999715805054
ep20_l3_test_time 2.2832303047180176
Test Epoch20 layer4 Acc 0.8698, AUC 0.934599757194519, avg_entr 0.01951010525226593, f1 0.8697999715805054
ep20_l4_test_time 2.9223101139068604
gc 0
Train Epoch21 Acc 0.975375 (39015/40000), AUC 0.9961414337158203
ep21_train_time 79.18563795089722
Test Epoch21 layer0 Acc 0.883, AUC 0.9463207125663757, avg_entr 0.11827538162469864, f1 0.8830000162124634
ep21_l0_test_time 0.5480926036834717
Test Epoch21 layer1 Acc 0.8702, AUC 0.9347398281097412, avg_entr 0.027588054537773132, f1 0.870199978351593
ep21_l1_test_time 1.0515336990356445
Test Epoch21 layer2 Acc 0.87, AUC 0.9352909922599792, avg_entr 0.021246595308184624, f1 0.8700000047683716
ep21_l2_test_time 1.662663221359253
Test Epoch21 layer3 Acc 0.8692, AUC 0.9354525804519653, avg_entr 0.02091730572283268, f1 0.8691999912261963
ep21_l3_test_time 2.2729721069335938
Test Epoch21 layer4 Acc 0.8698, AUC 0.9346455335617065, avg_entr 0.019649861380457878, f1 0.8697999715805054
ep21_l4_test_time 2.898627758026123
gc 0
Train Epoch22 Acc 0.9757 (39028/40000), AUC 0.9961887001991272
ep22_train_time 79.1212248802185
Test Epoch22 layer0 Acc 0.8816, AUC 0.9461448192596436, avg_entr 0.11607808619737625, f1 0.881600022315979
ep22_l0_test_time 0.5504982471466064
Test Epoch22 layer1 Acc 0.8684, AUC 0.9336830377578735, avg_entr 0.028119482100009918, f1 0.868399977684021
ep22_l1_test_time 1.0602807998657227
Test Epoch22 layer2 Acc 0.8702, AUC 0.9339838027954102, avg_entr 0.020779212936758995, f1 0.870199978351593
ep22_l2_test_time 1.6725807189941406
Test Epoch22 layer3 Acc 0.8704, AUC 0.9338862299919128, avg_entr 0.02042851783335209, f1 0.8704000115394592
ep22_l3_test_time 2.271904706954956
Test Epoch22 layer4 Acc 0.8682, AUC 0.9337500333786011, avg_entr 0.019841628149151802, f1 0.8682000041007996
ep22_l4_test_time 2.8997719287872314
gc 0
Train Epoch23 Acc 0.975825 (39033/40000), AUC 0.996196448802948
ep23_train_time 79.1812629699707
Test Epoch23 layer0 Acc 0.883, AUC 0.9460108280181885, avg_entr 0.11668094247579575, f1 0.8830000162124634
ep23_l0_test_time 0.5507597923278809
Test Epoch23 layer1 Acc 0.8706, AUC 0.935102105140686, avg_entr 0.028786905109882355, f1 0.8705999851226807
ep23_l1_test_time 1.055048942565918
Test Epoch23 layer2 Acc 0.8706, AUC 0.9355322122573853, avg_entr 0.022255418822169304, f1 0.8705999851226807
ep23_l2_test_time 1.6655662059783936
Test Epoch23 layer3 Acc 0.8704, AUC 0.935757040977478, avg_entr 0.021718276664614677, f1 0.8704000115394592
ep23_l3_test_time 2.2775731086730957
Test Epoch23 layer4 Acc 0.8704, AUC 0.9349421262741089, avg_entr 0.020540224388241768, f1 0.8704000115394592
ep23_l4_test_time 2.89900541305542
gc 0
Train Epoch24 Acc 0.97615 (39046/40000), AUC 0.9963215589523315
ep24_train_time 79.11002612113953
Test Epoch24 layer0 Acc 0.8814, AUC 0.9458798766136169, avg_entr 0.11484678834676743, f1 0.8813999891281128
ep24_l0_test_time 0.5552704334259033
Test Epoch24 layer1 Acc 0.8714, AUC 0.9333409667015076, avg_entr 0.025527523830533028, f1 0.871399998664856
ep24_l1_test_time 1.0513200759887695
Test Epoch24 layer2 Acc 0.8708, AUC 0.9339622259140015, avg_entr 0.01913333684206009, f1 0.8708000183105469
ep24_l2_test_time 1.6673798561096191
Test Epoch24 layer3 Acc 0.8698, AUC 0.9339244365692139, avg_entr 0.019118811935186386, f1 0.8697999715805054
ep24_l3_test_time 2.2774770259857178
Test Epoch24 layer4 Acc 0.871, AUC 0.9334490299224854, avg_entr 0.018292471766471863, f1 0.8709999918937683
ep24_l4_test_time 2.909822940826416
gc 0
Train Epoch25 Acc 0.9763 (39052/40000), AUC 0.9963581562042236
ep25_train_time 79.14628028869629
Test Epoch25 layer0 Acc 0.8812, AUC 0.9457885026931763, avg_entr 0.11447198688983917, f1 0.8812000155448914
ep25_l0_test_time 0.5552775859832764
Test Epoch25 layer1 Acc 0.87, AUC 0.9339626431465149, avg_entr 0.026472872123122215, f1 0.8700000047683716
ep25_l1_test_time 1.04502534866333
Test Epoch25 layer2 Acc 0.8704, AUC 0.9345535635948181, avg_entr 0.020331567153334618, f1 0.8704000115394592
ep25_l2_test_time 1.671403169631958
Test Epoch25 layer3 Acc 0.8702, AUC 0.9347953796386719, avg_entr 0.01991063915193081, f1 0.870199978351593
ep25_l3_test_time 2.2827911376953125
Test Epoch25 layer4 Acc 0.87, AUC 0.9340417385101318, avg_entr 0.018996644765138626, f1 0.8700000047683716
ep25_l4_test_time 2.9242351055145264
gc 0
Train Epoch26 Acc 0.976475 (39059/40000), AUC 0.9963958263397217
ep26_train_time 79.1968605518341
Test Epoch26 layer0 Acc 0.8824, AUC 0.94575035572052, avg_entr 0.11509327590465546, f1 0.8823999762535095
ep26_l0_test_time 0.5578312873840332
Test Epoch26 layer1 Acc 0.8702, AUC 0.9341372847557068, avg_entr 0.02653167024254799, f1 0.870199978351593
ep26_l1_test_time 1.0545885562896729
Test Epoch26 layer2 Acc 0.8696, AUC 0.9347165822982788, avg_entr 0.020460132509469986, f1 0.8695999383926392
ep26_l2_test_time 1.6681361198425293
Test Epoch26 layer3 Acc 0.869, AUC 0.9350011944770813, avg_entr 0.019923200830817223, f1 0.8690000176429749
ep26_l3_test_time 2.268362045288086
Test Epoch26 layer4 Acc 0.8682, AUC 0.9341589212417603, avg_entr 0.018881574273109436, f1 0.8682000041007996
ep26_l4_test_time 2.8944432735443115
gc 0
Train Epoch27 Acc 0.9764 (39056/40000), AUC 0.9963809847831726
ep27_train_time 79.1159827709198
Test Epoch27 layer0 Acc 0.8816, AUC 0.9456473588943481, avg_entr 0.11335422098636627, f1 0.881600022315979
ep27_l0_test_time 0.5485613346099854
Test Epoch27 layer1 Acc 0.8714, AUC 0.9332431554794312, avg_entr 0.025454483926296234, f1 0.871399998664856
ep27_l1_test_time 1.0600395202636719
Test Epoch27 layer2 Acc 0.8704, AUC 0.9339331388473511, avg_entr 0.019253049045801163, f1 0.8704000115394592
ep27_l2_test_time 1.6714859008789062
Test Epoch27 layer3 Acc 0.8704, AUC 0.9340218305587769, avg_entr 0.019123096019029617, f1 0.8704000115394592
ep27_l3_test_time 2.281813621520996
Test Epoch27 layer4 Acc 0.8712, AUC 0.9333953857421875, avg_entr 0.01836423948407173, f1 0.8712000846862793
ep27_l4_test_time 2.9008188247680664
gc 0
Train Epoch28 Acc 0.976575 (39063/40000), AUC 0.9963710308074951
ep28_train_time 79.2718813419342
Test Epoch28 layer0 Acc 0.8814, AUC 0.9455798864364624, avg_entr 0.11304184794425964, f1 0.8813999891281128
ep28_l0_test_time 0.5567524433135986
Test Epoch28 layer1 Acc 0.8704, AUC 0.9338205456733704, avg_entr 0.026582039892673492, f1 0.8704000115394592
ep28_l1_test_time 1.0649044513702393
Test Epoch28 layer2 Acc 0.8712, AUC 0.9344310760498047, avg_entr 0.020356418564915657, f1 0.8712000846862793
ep28_l2_test_time 1.6715006828308105
Test Epoch28 layer3 Acc 0.8702, AUC 0.9346092939376831, avg_entr 0.019966986030340195, f1 0.870199978351593
ep28_l3_test_time 2.2937614917755127
Test Epoch28 layer4 Acc 0.8694, AUC 0.9339264631271362, avg_entr 0.018940234556794167, f1 0.8694000244140625
ep28_l4_test_time 2.904078483581543
gc 0
Train Epoch29 Acc 0.9765 (39060/40000), AUC 0.9964894652366638
ep29_train_time 79.10074758529663
Test Epoch29 layer0 Acc 0.8822, AUC 0.9455768465995789, avg_entr 0.11327715963125229, f1 0.8822000026702881
ep29_l0_test_time 0.5643134117126465
Test Epoch29 layer1 Acc 0.8692, AUC 0.9333333373069763, avg_entr 0.02512388490140438, f1 0.8691999912261963
ep29_l1_test_time 1.0575578212738037
Test Epoch29 layer2 Acc 0.869, AUC 0.9338893890380859, avg_entr 0.018965838477015495, f1 0.8690000176429749
ep29_l2_test_time 1.6722283363342285
Test Epoch29 layer3 Acc 0.8692, AUC 0.9339672327041626, avg_entr 0.018457194790244102, f1 0.8691999912261963
ep29_l3_test_time 2.286985158920288
Test Epoch29 layer4 Acc 0.8694, AUC 0.9333866238594055, avg_entr 0.017814064398407936, f1 0.8694000244140625
ep29_l4_test_time 2.9023334980010986
Best AUC tensor(0.8984) 7 0
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 2630.8005368709564
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.889, AUC 0.9514544010162354, avg_entr 0.1487414836883545, f1 0.8889999985694885
l0_test_time 0.5528082847595215
Test layer1 Acc 0.8744, AUC 0.9348440766334534, avg_entr 0.039491694420576096, f1 0.8744000792503357
l1_test_time 1.0490162372589111
Test layer2 Acc 0.8738, AUC 0.9352956414222717, avg_entr 0.03355136886239052, f1 0.8737999796867371
l2_test_time 1.6638569831848145
Test layer3 Acc 0.873, AUC 0.9355805516242981, avg_entr 0.03574816882610321, f1 0.8730000257492065
l3_test_time 2.269441843032837
Test layer4 Acc 0.8732, AUC 0.9361912608146667, avg_entr 0.03434916213154793, f1 0.873199999332428
l4_test_time 2.895320415496826
