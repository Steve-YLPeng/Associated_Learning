total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 24.2454731464386
Start Training
gc 0
Train Epoch0 Acc 0.52445 (20978/40000), AUC 0.5418182015419006
ep0_train_time 155.1079080104828
Test Epoch0 layer0 Acc 0.812, AUC 0.8919678926467896, avg_entr 0.5521067380905151, f1 0.8119999766349792
ep0_l0_test_time 0.7449600696563721
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.604, AUC 0.654542088508606, avg_entr 0.6453955769538879, f1 0.6039999723434448
ep0_l1_test_time 1.7572557926177979
Test Epoch0 layer2 Acc 0.7158, AUC 0.8087416887283325, avg_entr 0.44302159547805786, f1 0.7157999873161316
ep0_l2_test_time 3.0315380096435547
Test Epoch0 layer3 Acc 0.7098, AUC 0.821940541267395, avg_entr 0.289340615272522, f1 0.7098000049591064
ep0_l3_test_time 4.1777520179748535
Test Epoch0 layer4 Acc 0.7108, AUC 0.8284899592399597, avg_entr 0.29715055227279663, f1 0.7107999920845032
ep0_l4_test_time 5.492623329162598
gc 0
Train Epoch1 Acc 0.7952 (31808/40000), AUC 0.8612996935844421
ep1_train_time 155.1136772632599
Test Epoch1 layer0 Acc 0.8716, AUC 0.9461770057678223, avg_entr 0.2890578508377075, f1 0.8715999722480774
ep1_l0_test_time 0.750755786895752
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.7408, AUC 0.8289161920547485, avg_entr 0.2968122065067291, f1 0.7408000230789185
ep1_l1_test_time 1.7470083236694336
Test Epoch1 layer2 Acc 0.838, AUC 0.90682053565979, avg_entr 0.12828552722930908, f1 0.8379999995231628
ep1_l2_test_time 2.907012939453125
Test Epoch1 layer3 Acc 0.8388, AUC 0.9066643714904785, avg_entr 0.13665717840194702, f1 0.8388000130653381
ep1_l3_test_time 4.2178778648376465
Test Epoch1 layer4 Acc 0.8408, AUC 0.9076237082481384, avg_entr 0.12537828087806702, f1 0.8408000469207764
ep1_l4_test_time 5.3890204429626465
gc 0
Train Epoch2 Acc 0.78455 (31382/40000), AUC 0.8564009070396423
ep2_train_time 155.07863974571228
Test Epoch2 layer0 Acc 0.8868, AUC 0.9553430080413818, avg_entr 0.22485746443271637, f1 0.8867999911308289
ep2_l0_test_time 0.7391166687011719
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.751, AUC 0.8266292214393616, avg_entr 0.32266175746917725, f1 0.7509999871253967
ep2_l1_test_time 1.7603740692138672
Test Epoch2 layer2 Acc 0.846, AUC 0.913754940032959, avg_entr 0.14775995910167694, f1 0.8460000157356262
ep2_l2_test_time 2.951542854309082
Test Epoch2 layer3 Acc 0.8516, AUC 0.9161595106124878, avg_entr 0.09601547569036484, f1 0.8515999913215637
ep2_l3_test_time 4.221595287322998
Test Epoch2 layer4 Acc 0.8524, AUC 0.9176504611968994, avg_entr 0.0885653868317604, f1 0.852400004863739
ep2_l4_test_time 5.428570508956909
gc 0
Train Epoch3 Acc 0.893625 (35745/40000), AUC 0.9464825391769409
ep3_train_time 155.10186886787415
Test Epoch3 layer0 Acc 0.892, AUC 0.9583098292350769, avg_entr 0.20227858424186707, f1 0.8920000195503235
ep3_l0_test_time 0.7504215240478516
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.8772, AUC 0.9297032356262207, avg_entr 0.053022149950265884, f1 0.8772000074386597
ep3_l1_test_time 1.7365634441375732
Test Epoch3 layer2 Acc 0.876, AUC 0.9348448514938354, avg_entr 0.04409940913319588, f1 0.8760000467300415
ep3_l2_test_time 2.956270694732666
Test Epoch3 layer3 Acc 0.876, AUC 0.9349782466888428, avg_entr 0.03897631913423538, f1 0.8760000467300415
ep3_l3_test_time 4.209940433502197
Test Epoch3 layer4 Acc 0.8764, AUC 0.9359961748123169, avg_entr 0.036350611597299576, f1 0.8763999938964844
ep3_l4_test_time 5.43001127243042
gc 0
Train Epoch4 Acc 0.838125 (33525/40000), AUC 0.9125924110412598
ep4_train_time 154.97385931015015
Test Epoch4 layer0 Acc 0.8996, AUC 0.9591745138168335, avg_entr 0.1788867861032486, f1 0.8996000289916992
ep4_l0_test_time 0.7625014781951904
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.8702, AUC 0.9219827055931091, avg_entr 0.048952482640743256, f1 0.870199978351593
ep4_l1_test_time 1.7576744556427002
Test Epoch4 layer2 Acc 0.8702, AUC 0.9287342429161072, avg_entr 0.047904741019010544, f1 0.870199978351593
ep4_l2_test_time 2.956878185272217
Test Epoch4 layer3 Acc 0.8698, AUC 0.9292076826095581, avg_entr 0.03717956691980362, f1 0.8697999715805054
ep4_l3_test_time 4.204915523529053
Test Epoch4 layer4 Acc 0.8676, AUC 0.928534209728241, avg_entr 0.03589344024658203, f1 0.8675999641418457
ep4_l4_test_time 5.35321307182312
gc 0
Train Epoch5 Acc 0.9089 (36356/40000), AUC 0.9571974277496338
ep5_train_time 137.7414767742157
Test Epoch5 layer0 Acc 0.8964, AUC 0.9584636688232422, avg_entr 0.16375009715557098, f1 0.896399974822998
ep5_l0_test_time 0.7442648410797119
Test Epoch5 layer1 Acc 0.872, AUC 0.9266388416290283, avg_entr 0.04016421362757683, f1 0.871999979019165
ep5_l1_test_time 1.7471089363098145
Test Epoch5 layer2 Acc 0.8708, AUC 0.9313194751739502, avg_entr 0.033265601843595505, f1 0.8708000183105469
ep5_l2_test_time 2.9878554344177246
Test Epoch5 layer3 Acc 0.8702, AUC 0.9312760233879089, avg_entr 0.02616828866302967, f1 0.870199978351593
ep5_l3_test_time 4.206255674362183
Test Epoch5 layer4 Acc 0.8708, AUC 0.9303203821182251, avg_entr 0.025171590968966484, f1 0.8708000183105469
ep5_l4_test_time 5.4388532638549805
gc 0
Train Epoch6 Acc 0.935775 (37431/40000), AUC 0.9763329029083252
ep6_train_time 155.09965825080872
Test Epoch6 layer0 Acc 0.897, AUC 0.957512378692627, avg_entr 0.15397100150585175, f1 0.8970000147819519
ep6_l0_test_time 0.7466883659362793
Test Epoch6 layer1 Acc 0.8766, AUC 0.9375690221786499, avg_entr 0.060483288019895554, f1 0.8766000270843506
ep6_l1_test_time 1.7500269412994385
Test Epoch6 layer2 Acc 0.8782, AUC 0.9414111375808716, avg_entr 0.046947818249464035, f1 0.8781999945640564
ep6_l2_test_time 2.8884921073913574
Test Epoch6 layer3 Acc 0.8796, AUC 0.9409595727920532, avg_entr 0.040401145815849304, f1 0.8795999884605408
ep6_l3_test_time 4.215165853500366
Test Epoch6 layer4 Acc 0.8796, AUC 0.9411881566047668, avg_entr 0.038869090378284454, f1 0.8795999884605408
ep6_l4_test_time 5.393718481063843
gc 0
Train Epoch7 Acc 0.946425 (37857/40000), AUC 0.9833251237869263
ep7_train_time 154.99421167373657
Test Epoch7 layer0 Acc 0.8964, AUC 0.9559715986251831, avg_entr 0.14795458316802979, f1 0.896399974822998
ep7_l0_test_time 0.7473797798156738
Test Epoch7 layer1 Acc 0.8784, AUC 0.9407122135162354, avg_entr 0.06937280297279358, f1 0.8784000277519226
ep7_l1_test_time 1.747981071472168
Test Epoch7 layer2 Acc 0.879, AUC 0.9439108371734619, avg_entr 0.05059518665075302, f1 0.8790000081062317
ep7_l2_test_time 2.9541633129119873
Test Epoch7 layer3 Acc 0.8792, AUC 0.9436706304550171, avg_entr 0.045297447592020035, f1 0.8791999816894531
ep7_l3_test_time 4.2033491134643555
Test Epoch7 layer4 Acc 0.879, AUC 0.9439645409584045, avg_entr 0.04328310862183571, f1 0.8790000081062317
ep7_l4_test_time 5.402366876602173
gc 0
Train Epoch8 Acc 0.95355 (38142/40000), AUC 0.9870775938034058
ep8_train_time 154.96118998527527
Test Epoch8 layer0 Acc 0.8916, AUC 0.9536551237106323, avg_entr 0.1386404037475586, f1 0.8916000127792358
ep8_l0_test_time 0.7574329376220703
Test Epoch8 layer1 Acc 0.8612, AUC 0.9337337017059326, avg_entr 0.048752278089523315, f1 0.8612000346183777
ep8_l1_test_time 1.7455334663391113
Test Epoch8 layer2 Acc 0.8616, AUC 0.9376274347305298, avg_entr 0.03281845524907112, f1 0.8615999817848206
ep8_l2_test_time 2.949263334274292
Test Epoch8 layer3 Acc 0.8624, AUC 0.9370427131652832, avg_entr 0.029463205486536026, f1 0.8623999953269958
ep8_l3_test_time 4.223259449005127
Test Epoch8 layer4 Acc 0.8626, AUC 0.9376707077026367, avg_entr 0.02896891161799431, f1 0.8626000285148621
ep8_l4_test_time 5.4512104988098145
gc 0
Train Epoch9 Acc 0.955775 (38231/40000), AUC 0.9882160425186157
ep9_train_time 155.05815863609314
Test Epoch9 layer0 Acc 0.8912, AUC 0.9530217051506042, avg_entr 0.13579189777374268, f1 0.8912000060081482
ep9_l0_test_time 0.7389206886291504
Test Epoch9 layer1 Acc 0.877, AUC 0.9334124326705933, avg_entr 0.032053835690021515, f1 0.8769999742507935
ep9_l1_test_time 1.7466022968292236
Test Epoch9 layer2 Acc 0.8758, AUC 0.9354358911514282, avg_entr 0.02343573048710823, f1 0.8758000135421753
ep9_l2_test_time 2.9473843574523926
Test Epoch9 layer3 Acc 0.8752, AUC 0.9352673888206482, avg_entr 0.021915588527917862, f1 0.8751999735832214
ep9_l3_test_time 4.231796503067017
Test Epoch9 layer4 Acc 0.8754, AUC 0.9348034858703613, avg_entr 0.02210397459566593, f1 0.8754000067710876
ep9_l4_test_time 5.362263917922974
gc 0
Train Epoch10 Acc 0.961275 (38451/40000), AUC 0.9908138513565063
ep10_train_time 155.1117866039276
Test Epoch10 layer0 Acc 0.8862, AUC 0.9522514343261719, avg_entr 0.1316988170146942, f1 0.8862000107765198
ep10_l0_test_time 0.7786531448364258
Test Epoch10 layer1 Acc 0.8822, AUC 0.938351035118103, avg_entr 0.03793724253773689, f1 0.8822000026702881
ep10_l1_test_time 1.7470407485961914
Test Epoch10 layer2 Acc 0.8786, AUC 0.9402024149894714, avg_entr 0.028664276003837585, f1 0.878600001335144
ep10_l2_test_time 3.021864891052246
Test Epoch10 layer3 Acc 0.878, AUC 0.9398873448371887, avg_entr 0.027385329827666283, f1 0.878000020980835
ep10_l3_test_time 4.187988042831421
Test Epoch10 layer4 Acc 0.878, AUC 0.9398913383483887, avg_entr 0.028761981055140495, f1 0.878000020980835
ep10_l4_test_time 5.494767189025879
gc 0
Train Epoch11 Acc 0.96475 (38590/40000), AUC 0.9917615652084351
ep11_train_time 155.2039840221405
Test Epoch11 layer0 Acc 0.8878, AUC 0.9507710933685303, avg_entr 0.13121888041496277, f1 0.8877999782562256
ep11_l0_test_time 0.7538108825683594
Test Epoch11 layer1 Acc 0.8748, AUC 0.9346850514411926, avg_entr 0.029861191287636757, f1 0.8748000264167786
ep11_l1_test_time 1.7293405532836914
Test Epoch11 layer2 Acc 0.8764, AUC 0.9362881183624268, avg_entr 0.022042490541934967, f1 0.8763999938964844
ep11_l2_test_time 2.9314260482788086
Test Epoch11 layer3 Acc 0.875, AUC 0.9363275766372681, avg_entr 0.020274106413125992, f1 0.875
ep11_l3_test_time 4.199433326721191
Test Epoch11 layer4 Acc 0.8748, AUC 0.9353717565536499, avg_entr 0.020622601732611656, f1 0.8748000264167786
ep11_l4_test_time 5.381944894790649
gc 0
Train Epoch12 Acc 0.9672 (38688/40000), AUC 0.9933674931526184
ep12_train_time 155.0484836101532
Test Epoch12 layer0 Acc 0.887, AUC 0.949927568435669, avg_entr 0.12867353856563568, f1 0.8870000243186951
ep12_l0_test_time 0.7389588356018066
Test Epoch12 layer1 Acc 0.8768, AUC 0.9386951923370361, avg_entr 0.03804399445652962, f1 0.876800000667572
ep12_l1_test_time 1.7509002685546875
Test Epoch12 layer2 Acc 0.8776, AUC 0.9399425983428955, avg_entr 0.027961980551481247, f1 0.8776000142097473
ep12_l2_test_time 2.9631896018981934
Test Epoch12 layer3 Acc 0.878, AUC 0.9397286176681519, avg_entr 0.025725198909640312, f1 0.878000020980835
ep12_l3_test_time 4.220464468002319
Test Epoch12 layer4 Acc 0.8778, AUC 0.9397385120391846, avg_entr 0.026355251669883728, f1 0.8778000473976135
ep12_l4_test_time 5.421255350112915
gc 0
Train Epoch13 Acc 0.96915 (38766/40000), AUC 0.994504451751709
ep13_train_time 155.16082549095154
Test Epoch13 layer0 Acc 0.8858, AUC 0.9491174221038818, avg_entr 0.12665247917175293, f1 0.8858000040054321
ep13_l0_test_time 0.7567777633666992
Test Epoch13 layer1 Acc 0.874, AUC 0.934434175491333, avg_entr 0.03367409482598305, f1 0.8740000128746033
ep13_l1_test_time 1.74428129196167
Test Epoch13 layer2 Acc 0.8724, AUC 0.9360270500183105, avg_entr 0.024492602795362473, f1 0.8723999857902527
ep13_l2_test_time 2.908724308013916
Test Epoch13 layer3 Acc 0.8722, AUC 0.9358689785003662, avg_entr 0.022114386782050133, f1 0.872200071811676
ep13_l3_test_time 4.2288525104522705
Test Epoch13 layer4 Acc 0.8718, AUC 0.9358658790588379, avg_entr 0.022869067266583443, f1 0.8718000650405884
ep13_l4_test_time 5.42000150680542
gc 0
Train Epoch14 Acc 0.9698 (38792/40000), AUC 0.9941959977149963
ep14_train_time 155.00613975524902
Test Epoch14 layer0 Acc 0.885, AUC 0.9485610723495483, avg_entr 0.12496113032102585, f1 0.8849999904632568
ep14_l0_test_time 0.7430181503295898
Test Epoch14 layer1 Acc 0.874, AUC 0.9361099004745483, avg_entr 0.032384153455495834, f1 0.8740000128746033
ep14_l1_test_time 1.7387876510620117
Test Epoch14 layer2 Acc 0.8728, AUC 0.937777578830719, avg_entr 0.02461903728544712, f1 0.8727999925613403
ep14_l2_test_time 2.961595296859741
Test Epoch14 layer3 Acc 0.873, AUC 0.9377110004425049, avg_entr 0.022880081087350845, f1 0.8730000257492065
ep14_l3_test_time 4.2143471240997314
Test Epoch14 layer4 Acc 0.8732, AUC 0.9375648498535156, avg_entr 0.024292144924402237, f1 0.873199999332428
ep14_l4_test_time 5.3313093185424805
gc 0
Train Epoch15 Acc 0.964775 (38591/40000), AUC 0.9924362897872925
ep15_train_time 137.87958550453186
Test Epoch15 layer0 Acc 0.8846, AUC 0.9480194449424744, avg_entr 0.12353295832872391, f1 0.8845999836921692
ep15_l0_test_time 0.7189319133758545
Test Epoch15 layer1 Acc 0.8726, AUC 0.937314510345459, avg_entr 0.034895773977041245, f1 0.8726000189781189
ep15_l1_test_time 1.7442209720611572
Test Epoch15 layer2 Acc 0.8728, AUC 0.9380849599838257, avg_entr 0.025804754346609116, f1 0.8727999925613403
ep15_l2_test_time 3.0190060138702393
Test Epoch15 layer3 Acc 0.8732, AUC 0.9386954307556152, avg_entr 0.0238192118704319, f1 0.873199999332428
ep15_l3_test_time 4.230043172836304
Test Epoch15 layer4 Acc 0.8726, AUC 0.9384305477142334, avg_entr 0.02479102835059166, f1 0.8726000189781189
ep15_l4_test_time 5.429941177368164
gc 0
Train Epoch16 Acc 0.971675 (38867/40000), AUC 0.9954062700271606
ep16_train_time 154.8923020362854
Test Epoch16 layer0 Acc 0.8844, AUC 0.9474263191223145, avg_entr 0.12356416136026382, f1 0.8844000101089478
ep16_l0_test_time 0.754833459854126
Test Epoch16 layer1 Acc 0.8676, AUC 0.9318343997001648, avg_entr 0.03346176818013191, f1 0.8675999641418457
ep16_l1_test_time 1.757594108581543
Test Epoch16 layer2 Acc 0.8692, AUC 0.9337097406387329, avg_entr 0.02556787058711052, f1 0.8691999912261963
ep16_l2_test_time 2.9114930629730225
Test Epoch16 layer3 Acc 0.8688, AUC 0.9334553480148315, avg_entr 0.02371245063841343, f1 0.8687999844551086
ep16_l3_test_time 4.21551775932312
Test Epoch16 layer4 Acc 0.8684, AUC 0.9332930445671082, avg_entr 0.02515716850757599, f1 0.868399977684021
ep16_l4_test_time 5.389498233795166
gc 0
Train Epoch17 Acc 0.9729 (38916/40000), AUC 0.9956509470939636
ep17_train_time 154.88395357131958
Test Epoch17 layer0 Acc 0.8828, AUC 0.9470785856246948, avg_entr 0.12243100255727768, f1 0.8827999830245972
ep17_l0_test_time 0.7383804321289062
Test Epoch17 layer1 Acc 0.8704, AUC 0.9352442622184753, avg_entr 0.030946899205446243, f1 0.8704000115394592
ep17_l1_test_time 1.7503821849822998
Test Epoch17 layer2 Acc 0.8704, AUC 0.9365851879119873, avg_entr 0.023146677762269974, f1 0.8704000115394592
ep17_l2_test_time 2.97930645942688
Test Epoch17 layer3 Acc 0.871, AUC 0.9366245269775391, avg_entr 0.021132610738277435, f1 0.8709999918937683
ep17_l3_test_time 4.151927471160889
Test Epoch17 layer4 Acc 0.8706, AUC 0.9365922212600708, avg_entr 0.021978961303830147, f1 0.8705999851226807
ep17_l4_test_time 5.402675151824951
gc 0
Train Epoch18 Acc 0.9729 (38916/40000), AUC 0.9958590269088745
ep18_train_time 154.87186336517334
Test Epoch18 layer0 Acc 0.8828, AUC 0.9468175172805786, avg_entr 0.12166662514209747, f1 0.8827999830245972
ep18_l0_test_time 0.7478077411651611
Test Epoch18 layer1 Acc 0.871, AUC 0.9345473051071167, avg_entr 0.02941087633371353, f1 0.8709999918937683
ep18_l1_test_time 1.7385179996490479
Test Epoch18 layer2 Acc 0.8712, AUC 0.9361733794212341, avg_entr 0.02230250835418701, f1 0.8712000846862793
ep18_l2_test_time 2.9363584518432617
Test Epoch18 layer3 Acc 0.871, AUC 0.9361425638198853, avg_entr 0.020488068461418152, f1 0.8709999918937683
ep18_l3_test_time 4.210877180099487
Test Epoch18 layer4 Acc 0.8712, AUC 0.9362393021583557, avg_entr 0.021663805469870567, f1 0.8712000846862793
ep18_l4_test_time 5.44054388999939
gc 0
Train Epoch19 Acc 0.973975 (38959/40000), AUC 0.9959579706192017
ep19_train_time 154.850168466568
Test Epoch19 layer0 Acc 0.8814, AUC 0.9464694261550903, avg_entr 0.12084003537893295, f1 0.8813999891281128
ep19_l0_test_time 0.7540092468261719
Test Epoch19 layer1 Acc 0.87, AUC 0.9343554973602295, avg_entr 0.028362151235342026, f1 0.8700000047683716
ep19_l1_test_time 1.7377867698669434
Test Epoch19 layer2 Acc 0.8712, AUC 0.9360884428024292, avg_entr 0.022004589438438416, f1 0.8712000846862793
ep19_l2_test_time 2.947908401489258
Test Epoch19 layer3 Acc 0.8704, AUC 0.9360839128494263, avg_entr 0.020354269072413445, f1 0.8704000115394592
ep19_l3_test_time 4.193334102630615
Test Epoch19 layer4 Acc 0.8712, AUC 0.9360304474830627, avg_entr 0.021544519811868668, f1 0.8712000846862793
ep19_l4_test_time 5.415555477142334
gc 0
Train Epoch20 Acc 0.97415 (38966/40000), AUC 0.996162474155426
ep20_train_time 154.75588393211365
Test Epoch20 layer0 Acc 0.8812, AUC 0.9461946487426758, avg_entr 0.11897778511047363, f1 0.8812000155448914
ep20_l0_test_time 0.7540524005889893
Test Epoch20 layer1 Acc 0.8694, AUC 0.9343942403793335, avg_entr 0.02972402423620224, f1 0.8694000244140625
ep20_l1_test_time 1.746514081954956
Test Epoch20 layer2 Acc 0.8702, AUC 0.9360149502754211, avg_entr 0.022438088431954384, f1 0.870199978351593
ep20_l2_test_time 3.0151844024658203
Test Epoch20 layer3 Acc 0.8702, AUC 0.9361323714256287, avg_entr 0.020604535937309265, f1 0.870199978351593
ep20_l3_test_time 4.226911544799805
Test Epoch20 layer4 Acc 0.87, AUC 0.9360095858573914, avg_entr 0.022007236257195473, f1 0.8700000047683716
ep20_l4_test_time 5.3928728103637695
gc 0
Train Epoch21 Acc 0.974675 (38987/40000), AUC 0.9962178468704224
ep21_train_time 154.89047169685364
Test Epoch21 layer0 Acc 0.882, AUC 0.945990800857544, avg_entr 0.11819017678499222, f1 0.8820000290870667
ep21_l0_test_time 0.7507262229919434
Test Epoch21 layer1 Acc 0.8696, AUC 0.9323617815971375, avg_entr 0.027107181027531624, f1 0.8695999383926392
ep21_l1_test_time 1.7571361064910889
Test Epoch21 layer2 Acc 0.8696, AUC 0.9345935583114624, avg_entr 0.02013271488249302, f1 0.8695999383926392
ep21_l2_test_time 2.948381185531616
Test Epoch21 layer3 Acc 0.87, AUC 0.9344447255134583, avg_entr 0.018417557701468468, f1 0.8700000047683716
ep21_l3_test_time 4.162793159484863
Test Epoch21 layer4 Acc 0.8698, AUC 0.9346215128898621, avg_entr 0.020047690719366074, f1 0.8697999715805054
ep21_l4_test_time 5.364053249359131
gc 0
Train Epoch22 Acc 0.97515 (39006/40000), AUC 0.9962334632873535
ep22_train_time 154.89117670059204
Test Epoch22 layer0 Acc 0.8812, AUC 0.9458988904953003, avg_entr 0.11841548979282379, f1 0.8812000155448914
ep22_l0_test_time 0.758660078048706
Test Epoch22 layer1 Acc 0.8692, AUC 0.9336755275726318, avg_entr 0.027875609695911407, f1 0.8691999912261963
ep22_l1_test_time 1.7042036056518555
Test Epoch22 layer2 Acc 0.8694, AUC 0.9356389045715332, avg_entr 0.02134324051439762, f1 0.8694000244140625
ep22_l2_test_time 2.9663286209106445
Test Epoch22 layer3 Acc 0.87, AUC 0.9356753826141357, avg_entr 0.01974538341164589, f1 0.8700000047683716
ep22_l3_test_time 4.223669052124023
Test Epoch22 layer4 Acc 0.8698, AUC 0.9356518983840942, avg_entr 0.02099684253334999, f1 0.8697999715805054
ep22_l4_test_time 5.4291205406188965
gc 0
Train Epoch23 Acc 0.975025 (39001/40000), AUC 0.996392011642456
ep23_train_time 154.8944022655487
Test Epoch23 layer0 Acc 0.882, AUC 0.9457098245620728, avg_entr 0.11691728234291077, f1 0.8820000290870667
ep23_l0_test_time 0.7481346130371094
Test Epoch23 layer1 Acc 0.869, AUC 0.932794988155365, avg_entr 0.026639489457011223, f1 0.8690000176429749
ep23_l1_test_time 1.7612483501434326
Test Epoch23 layer2 Acc 0.8692, AUC 0.9349929094314575, avg_entr 0.021308215335011482, f1 0.8691999912261963
ep23_l2_test_time 2.9636683464050293
Test Epoch23 layer3 Acc 0.8698, AUC 0.9350786805152893, avg_entr 0.019793612882494926, f1 0.8697999715805054
ep23_l3_test_time 4.237115144729614
Test Epoch23 layer4 Acc 0.8692, AUC 0.9349709749221802, avg_entr 0.0210421085357666, f1 0.8691999912261963
ep23_l4_test_time 5.448298692703247
gc 0
Train Epoch24 Acc 0.97555 (39022/40000), AUC 0.9964224100112915
ep24_train_time 154.71691036224365
Test Epoch24 layer0 Acc 0.8808, AUC 0.9456039667129517, avg_entr 0.11648932844400406, f1 0.8808000087738037
ep24_l0_test_time 0.7481129169464111
Test Epoch24 layer1 Acc 0.868, AUC 0.9333459138870239, avg_entr 0.029097722843289375, f1 0.8679999709129333
ep24_l1_test_time 1.7423126697540283
Test Epoch24 layer2 Acc 0.8684, AUC 0.9353775382041931, avg_entr 0.022310370579361916, f1 0.868399977684021
ep24_l2_test_time 2.9484703540802
Test Epoch24 layer3 Acc 0.8684, AUC 0.9353064298629761, avg_entr 0.02053394354879856, f1 0.868399977684021
ep24_l3_test_time 4.2137720584869385
Test Epoch24 layer4 Acc 0.8692, AUC 0.9353837966918945, avg_entr 0.021857311949133873, f1 0.8691999912261963
ep24_l4_test_time 5.382641553878784
gc 0
Train Epoch25 Acc 0.975825 (39033/40000), AUC 0.9965451955795288
ep25_train_time 129.008718252182
Test Epoch25 layer0 Acc 0.881, AUC 0.9455190300941467, avg_entr 0.11616018414497375, f1 0.8809999823570251
ep25_l0_test_time 0.7200939655303955
Test Epoch25 layer1 Acc 0.8672, AUC 0.9331282377243042, avg_entr 0.029215509071946144, f1 0.8672000169754028
ep25_l1_test_time 1.6466865539550781
Test Epoch25 layer2 Acc 0.8682, AUC 0.9354748129844666, avg_entr 0.02224677801132202, f1 0.8682000041007996
ep25_l2_test_time 2.7532994747161865
Test Epoch25 layer3 Acc 0.8682, AUC 0.9353616833686829, avg_entr 0.02047639898955822, f1 0.8682000041007996
ep25_l3_test_time 3.901275396347046
Test Epoch25 layer4 Acc 0.867, AUC 0.9354093074798584, avg_entr 0.021959006786346436, f1 0.8669999837875366
ep25_l4_test_time 5.0126330852508545
gc 0
Train Epoch26 Acc 0.975725 (39029/40000), AUC 0.9965450763702393
ep26_train_time 142.33509850502014
Test Epoch26 layer0 Acc 0.8802, AUC 0.9454745054244995, avg_entr 0.11603011190891266, f1 0.8802000284194946
ep26_l0_test_time 0.7171337604522705
Test Epoch26 layer1 Acc 0.8684, AUC 0.9327916502952576, avg_entr 0.027778882533311844, f1 0.868399977684021
ep26_l1_test_time 1.666248083114624
Test Epoch26 layer2 Acc 0.8684, AUC 0.9350430965423584, avg_entr 0.021347127854824066, f1 0.868399977684021
ep26_l2_test_time 2.741424083709717
Test Epoch26 layer3 Acc 0.8678, AUC 0.9349541664123535, avg_entr 0.019698940217494965, f1 0.8677999973297119
ep26_l3_test_time 3.914755344390869
Test Epoch26 layer4 Acc 0.8692, AUC 0.9350694417953491, avg_entr 0.02108580432832241, f1 0.8691999912261963
ep26_l4_test_time 4.9638683795928955
gc 0
Train Epoch27 Acc 0.976075 (39043/40000), AUC 0.9965442419052124
ep27_train_time 130.80150842666626
Test Epoch27 layer0 Acc 0.881, AUC 0.9453738331794739, avg_entr 0.11515859514474869, f1 0.8809999823570251
ep27_l0_test_time 0.7241220474243164
Test Epoch27 layer1 Acc 0.868, AUC 0.9330708980560303, avg_entr 0.027526458725333214, f1 0.8679999709129333
ep27_l1_test_time 1.6663198471069336
Test Epoch27 layer2 Acc 0.8682, AUC 0.9353526830673218, avg_entr 0.021223196759819984, f1 0.8682000041007996
ep27_l2_test_time 2.746218681335449
Test Epoch27 layer3 Acc 0.869, AUC 0.9353166818618774, avg_entr 0.019514484331011772, f1 0.8690000176429749
ep27_l3_test_time 3.914612293243408
Test Epoch27 layer4 Acc 0.869, AUC 0.9352810382843018, avg_entr 0.021080341190099716, f1 0.8690000176429749
ep27_l4_test_time 5.002390623092651
gc 0
Train Epoch28 Acc 0.975975 (39039/40000), AUC 0.9965968132019043
ep28_train_time 142.3991343975067
Test Epoch28 layer0 Acc 0.8808, AUC 0.9453413486480713, avg_entr 0.11469372361898422, f1 0.8808000087738037
ep28_l0_test_time 0.7103602886199951
Test Epoch28 layer1 Acc 0.8692, AUC 0.9324635863304138, avg_entr 0.0267341211438179, f1 0.8691999912261963
ep28_l1_test_time 1.6483511924743652
Test Epoch28 layer2 Acc 0.8686, AUC 0.9349339008331299, avg_entr 0.02056039497256279, f1 0.8686000108718872
ep28_l2_test_time 2.6964008808135986
Test Epoch28 layer3 Acc 0.868, AUC 0.9348646998405457, avg_entr 0.01887715421617031, f1 0.8679999709129333
ep28_l3_test_time 3.9201385974884033
Test Epoch28 layer4 Acc 0.8686, AUC 0.9349567890167236, avg_entr 0.02031143568456173, f1 0.8686000108718872
ep28_l4_test_time 5.036777973175049
gc 0
Train Epoch29 Acc 0.9763 (39052/40000), AUC 0.9966563582420349
ep29_train_time 131.1301052570343
Test Epoch29 layer0 Acc 0.8796, AUC 0.9453158974647522, avg_entr 0.11472741514444351, f1 0.8795999884605408
ep29_l0_test_time 0.7148051261901855
Test Epoch29 layer1 Acc 0.8688, AUC 0.9321154952049255, avg_entr 0.026529889553785324, f1 0.8687999844551086
ep29_l1_test_time 1.660707712173462
Test Epoch29 layer2 Acc 0.8692, AUC 0.9346156120300293, avg_entr 0.020192189142107964, f1 0.8691999912261963
ep29_l2_test_time 2.7252743244171143
Test Epoch29 layer3 Acc 0.8684, AUC 0.9345072507858276, avg_entr 0.018496131524443626, f1 0.868399977684021
ep29_l3_test_time 3.8421790599823
Test Epoch29 layer4 Acc 0.8684, AUC 0.9346683025360107, avg_entr 0.01972699724137783, f1 0.868399977684021
ep29_l4_test_time 5.005440711975098
Best AUC tensor(0.8996) 4 0
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 4964.698224544525
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.8944, AUC 0.955951988697052, avg_entr 0.1794367879629135, f1 0.8944000005722046
l0_test_time 0.712031364440918
Test layer1 Acc 0.873, AUC 0.9255417585372925, avg_entr 0.05082057788968086, f1 0.8730000257492065
l1_test_time 1.6612164974212646
Test layer2 Acc 0.8676, AUC 0.930446207523346, avg_entr 0.04992866516113281, f1 0.8675999641418457
l2_test_time 2.7361679077148438
Test layer3 Acc 0.868, AUC 0.9305480718612671, avg_entr 0.03980190306901932, f1 0.8679999709129333
l3_test_time 3.9136722087860107
Test layer4 Acc 0.8672, AUC 0.929874062538147, avg_entr 0.03857486695051193, f1 0.8672000169754028
l4_test_time 4.98865008354187
