total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 24.32829236984253
Start Training
gc 0
Train Epoch0 Acc 0.511475 (20459/40000), AUC 0.5321011543273926
ep0_train_time 158.89419221878052
Test Epoch0 layer0 Acc 0.8144, AUC 0.8893107175827026, avg_entr 0.5672084093093872, f1 0.8144000172615051
ep0_l0_test_time 0.7784037590026855
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.6122, AUC 0.6553606986999512, avg_entr 0.6614837050437927, f1 0.6122000217437744
ep0_l1_test_time 1.79339599609375
Test Epoch0 layer2 Acc 0.6324, AUC 0.6916621923446655, avg_entr 0.6481602787971497, f1 0.6323999762535095
ep0_l2_test_time 3.0169003009796143
Test Epoch0 layer3 Acc 0.6256, AUC 0.7167277336120605, avg_entr 0.661594808101654, f1 0.6255999803543091
ep0_l3_test_time 4.17191219329834
Test Epoch0 layer4 Acc 0.6326, AUC 0.7283269166946411, avg_entr 0.6685164570808411, f1 0.6326000094413757
ep0_l4_test_time 5.673075914382935
gc 0
Train Epoch1 Acc 0.81805 (32722/40000), AUC 0.8733670711517334
ep1_train_time 158.90300393104553
Test Epoch1 layer0 Acc 0.8794, AUC 0.9463921785354614, avg_entr 0.2958061993122101, f1 0.8794000148773193
ep1_l0_test_time 0.7741310596466064
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.843, AUC 0.9075590372085571, avg_entr 0.13517124950885773, f1 0.8429999947547913
ep1_l1_test_time 1.796083688735962
Test Epoch1 layer2 Acc 0.8428, AUC 0.9138728380203247, avg_entr 0.11030549556016922, f1 0.8428000211715698
ep1_l2_test_time 3.0716140270233154
Test Epoch1 layer3 Acc 0.8442, AUC 0.9155880212783813, avg_entr 0.11031408607959747, f1 0.8442000150680542
ep1_l3_test_time 4.335186004638672
Test Epoch1 layer4 Acc 0.844, AUC 0.915166974067688, avg_entr 0.1335238218307495, f1 0.8439999222755432
ep1_l4_test_time 5.594977617263794
gc 0
Train Epoch2 Acc 0.890825 (35633/40000), AUC 0.9389638900756836
ep2_train_time 158.59184741973877
Test Epoch2 layer0 Acc 0.8916, AUC 0.9553232789039612, avg_entr 0.23162473738193512, f1 0.8916000127792358
ep2_l0_test_time 0.7685813903808594
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.885, AUC 0.943443238735199, avg_entr 0.08763214200735092, f1 0.8849999904632568
ep2_l1_test_time 1.7934060096740723
Test Epoch2 layer2 Acc 0.8876, AUC 0.9453078508377075, avg_entr 0.0875595211982727, f1 0.8876000046730042
ep2_l2_test_time 3.092757225036621
Test Epoch2 layer3 Acc 0.8886, AUC 0.9458160400390625, avg_entr 0.08535462617874146, f1 0.8885999917984009
ep2_l3_test_time 4.340701580047607
Test Epoch2 layer4 Acc 0.8874, AUC 0.9454877972602844, avg_entr 0.09412914514541626, f1 0.8873999714851379
ep2_l4_test_time 5.599050760269165
gc 0
Train Epoch3 Acc 0.91595 (36638/40000), AUC 0.9605791568756104
ep3_train_time 158.75922107696533
Test Epoch3 layer0 Acc 0.8984, AUC 0.9582293033599854, avg_entr 0.19918940961360931, f1 0.8984000086784363
ep3_l0_test_time 0.7203588485717773
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.8932, AUC 0.9485459327697754, avg_entr 0.05507497116923332, f1 0.8931999802589417
ep3_l1_test_time 1.1413874626159668
Test Epoch3 layer2 Acc 0.8926, AUC 0.949128270149231, avg_entr 0.04725788161158562, f1 0.8925999999046326
ep3_l2_test_time 1.684471607208252
Test Epoch3 layer3 Acc 0.8934, AUC 0.9495084285736084, avg_entr 0.040613364428281784, f1 0.8934000134468079
ep3_l3_test_time 2.303600549697876
Test Epoch3 layer4 Acc 0.893, AUC 0.9492352604866028, avg_entr 0.04670267924666405, f1 0.8930000066757202
ep3_l4_test_time 2.965916395187378
gc 0
Train Epoch4 Acc 0.932075 (37283/40000), AUC 0.9729229211807251
ep4_train_time 146.37978601455688
Test Epoch4 layer0 Acc 0.8978, AUC 0.9586092233657837, avg_entr 0.18199393153190613, f1 0.8978000283241272
ep4_l0_test_time 0.767542839050293
Test Epoch4 layer1 Acc 0.8788, AUC 0.9457360506057739, avg_entr 0.052372924983501434, f1 0.8787999749183655
ep4_l1_test_time 1.7822613716125488
Test Epoch4 layer2 Acc 0.8804, AUC 0.9464102387428284, avg_entr 0.044702742248773575, f1 0.8804000020027161
ep4_l2_test_time 3.123167037963867
Test Epoch4 layer3 Acc 0.8772, AUC 0.9468679428100586, avg_entr 0.040373727679252625, f1 0.8772000074386597
ep4_l3_test_time 4.356375217437744
Test Epoch4 layer4 Acc 0.8788, AUC 0.9463469386100769, avg_entr 0.043650221079587936, f1 0.8787999749183655
ep4_l4_test_time 5.639435529708862
gc 0
Train Epoch5 Acc 0.939525 (37581/40000), AUC 0.9787062406539917
ep5_train_time 158.71181535720825
Test Epoch5 layer0 Acc 0.8944, AUC 0.9581236839294434, avg_entr 0.16459666192531586, f1 0.8944000005722046
ep5_l0_test_time 0.7640533447265625
Test Epoch5 layer1 Acc 0.8846, AUC 0.9459491968154907, avg_entr 0.04479951038956642, f1 0.8845999836921692
ep5_l1_test_time 1.7940282821655273
Test Epoch5 layer2 Acc 0.884, AUC 0.9463618993759155, avg_entr 0.03803699463605881, f1 0.8840000033378601
ep5_l2_test_time 3.1194512844085693
Test Epoch5 layer3 Acc 0.8824, AUC 0.9469926357269287, avg_entr 0.0343647263944149, f1 0.8823999762535095
ep5_l3_test_time 4.34281063079834
Test Epoch5 layer4 Acc 0.8842, AUC 0.9462727308273315, avg_entr 0.03538917750120163, f1 0.8842000365257263
ep5_l4_test_time 5.421556234359741
gc 0
Train Epoch6 Acc 0.948725 (37949/40000), AUC 0.9831509590148926
ep6_train_time 158.9343602657318
Test Epoch6 layer0 Acc 0.8944, AUC 0.9568643569946289, avg_entr 0.15536625683307648, f1 0.8944000005722046
ep6_l0_test_time 0.7680346965789795
Test Epoch6 layer1 Acc 0.8876, AUC 0.9470590353012085, avg_entr 0.042191166430711746, f1 0.8876000046730042
ep6_l1_test_time 1.7946836948394775
Test Epoch6 layer2 Acc 0.8876, AUC 0.9468557834625244, avg_entr 0.0343579538166523, f1 0.8876000046730042
ep6_l2_test_time 3.074106454849243
Test Epoch6 layer3 Acc 0.8878, AUC 0.9470919966697693, avg_entr 0.03097420744597912, f1 0.8877999782562256
ep6_l3_test_time 4.36742639541626
Test Epoch6 layer4 Acc 0.8866, AUC 0.9467845559120178, avg_entr 0.03360576927661896, f1 0.8866000771522522
ep6_l4_test_time 5.638368844985962
gc 0
Train Epoch7 Acc 0.9503 (38012/40000), AUC 0.9862910509109497
ep7_train_time 158.43990325927734
Test Epoch7 layer0 Acc 0.8962, AUC 0.9552491307258606, avg_entr 0.1474313735961914, f1 0.8962000012397766
ep7_l0_test_time 0.7645773887634277
Test Epoch7 layer1 Acc 0.7412, AUC 0.9191262722015381, avg_entr 0.15275274217128754, f1 0.7411999702453613
ep7_l1_test_time 1.794874906539917
Test Epoch7 layer2 Acc 0.7688, AUC 0.920758843421936, avg_entr 0.14811594784259796, f1 0.7688000202178955
ep7_l2_test_time 3.1002237796783447
Test Epoch7 layer3 Acc 0.7578, AUC 0.9211797714233398, avg_entr 0.13255110383033752, f1 0.7577999830245972
ep7_l3_test_time 4.3169286251068115
Test Epoch7 layer4 Acc 0.7954, AUC 0.9207797646522522, avg_entr 0.18786238133907318, f1 0.795400083065033
ep7_l4_test_time 5.630890607833862
gc 0
Train Epoch8 Acc 0.9464 (37856/40000), AUC 0.9838384985923767
ep8_train_time 158.71785593032837
Test Epoch8 layer0 Acc 0.889, AUC 0.9537348747253418, avg_entr 0.14433805644512177, f1 0.8889999985694885
ep8_l0_test_time 0.7987327575683594
Test Epoch8 layer1 Acc 0.8752, AUC 0.9402683973312378, avg_entr 0.04364991933107376, f1 0.8751999735832214
ep8_l1_test_time 1.7865774631500244
Test Epoch8 layer2 Acc 0.8756, AUC 0.9413301944732666, avg_entr 0.03082641027867794, f1 0.8756000399589539
ep8_l2_test_time 2.848451852798462
Test Epoch8 layer3 Acc 0.874, AUC 0.941378116607666, avg_entr 0.02758062072098255, f1 0.8740000128746033
ep8_l3_test_time 4.271031618118286
Test Epoch8 layer4 Acc 0.8744, AUC 0.9411672353744507, avg_entr 0.029821433126926422, f1 0.8744000792503357
ep8_l4_test_time 5.623085260391235
gc 0
Train Epoch9 Acc 0.961475 (38459/40000), AUC 0.9908556938171387
ep9_train_time 158.78875017166138
Test Epoch9 layer0 Acc 0.8896, AUC 0.95276939868927, avg_entr 0.13667510449886322, f1 0.8895999193191528
ep9_l0_test_time 0.7635908126831055
Test Epoch9 layer1 Acc 0.875, AUC 0.9402434825897217, avg_entr 0.05023695155978203, f1 0.875
ep9_l1_test_time 1.7894926071166992
Test Epoch9 layer2 Acc 0.8742, AUC 0.9403448104858398, avg_entr 0.0345911830663681, f1 0.8741999864578247
ep9_l2_test_time 3.094525098800659
Test Epoch9 layer3 Acc 0.8748, AUC 0.9406063556671143, avg_entr 0.030099088326096535, f1 0.8748000264167786
ep9_l3_test_time 4.363556385040283
Test Epoch9 layer4 Acc 0.8744, AUC 0.9400275945663452, avg_entr 0.03257744759321213, f1 0.8744000792503357
ep9_l4_test_time 5.599488735198975
gc 0
Train Epoch10 Acc 0.963675 (38547/40000), AUC 0.9918513298034668
ep10_train_time 158.40099501609802
Test Epoch10 layer0 Acc 0.8898, AUC 0.9516502022743225, avg_entr 0.13379675149917603, f1 0.8898000121116638
ep10_l0_test_time 0.7674961090087891
Test Epoch10 layer1 Acc 0.8728, AUC 0.9408950209617615, avg_entr 0.05337731912732124, f1 0.8727999925613403
ep10_l1_test_time 1.79665207862854
Test Epoch10 layer2 Acc 0.8728, AUC 0.941611111164093, avg_entr 0.036498915404081345, f1 0.8727999925613403
ep10_l2_test_time 3.125636100769043
Test Epoch10 layer3 Acc 0.8728, AUC 0.9413658976554871, avg_entr 0.03149927407503128, f1 0.8727999925613403
ep10_l3_test_time 4.380622148513794
Test Epoch10 layer4 Acc 0.8712, AUC 0.9411758184432983, avg_entr 0.035209350287914276, f1 0.8712000846862793
ep10_l4_test_time 5.642082929611206
gc 0
Train Epoch11 Acc 0.9652 (38608/40000), AUC 0.9924346208572388
ep11_train_time 158.45144820213318
Test Epoch11 layer0 Acc 0.8878, AUC 0.9504262804985046, avg_entr 0.13171328604221344, f1 0.8877999782562256
ep11_l0_test_time 0.7775223255157471
Test Epoch11 layer1 Acc 0.8714, AUC 0.9376184344291687, avg_entr 0.03846190869808197, f1 0.871399998664856
ep11_l1_test_time 1.7886192798614502
Test Epoch11 layer2 Acc 0.8714, AUC 0.9383291602134705, avg_entr 0.026237769052386284, f1 0.871399998664856
ep11_l2_test_time 3.0728759765625
Test Epoch11 layer3 Acc 0.8712, AUC 0.9383119344711304, avg_entr 0.023574836552143097, f1 0.8712000846862793
ep11_l3_test_time 4.348246335983276
Test Epoch11 layer4 Acc 0.8724, AUC 0.9377851486206055, avg_entr 0.025223473086953163, f1 0.8723999857902527
ep11_l4_test_time 5.602586030960083
gc 0
Train Epoch12 Acc 0.968025 (38721/40000), AUC 0.9936671257019043
ep12_train_time 158.70505452156067
Test Epoch12 layer0 Acc 0.885, AUC 0.949375569820404, avg_entr 0.13077080249786377, f1 0.8849999904632568
ep12_l0_test_time 0.7697868347167969
Test Epoch12 layer1 Acc 0.8706, AUC 0.9381982088088989, avg_entr 0.04099806025624275, f1 0.8705999851226807
ep12_l1_test_time 1.7898516654968262
Test Epoch12 layer2 Acc 0.8714, AUC 0.9389204978942871, avg_entr 0.027526315301656723, f1 0.871399998664856
ep12_l2_test_time 3.0859532356262207
Test Epoch12 layer3 Acc 0.871, AUC 0.9387454986572266, avg_entr 0.025401432067155838, f1 0.8709999918937683
ep12_l3_test_time 4.32750129699707
Test Epoch12 layer4 Acc 0.8704, AUC 0.93824702501297, avg_entr 0.02658594585955143, f1 0.8704000115394592
ep12_l4_test_time 5.3829264640808105
gc 0
Train Epoch13 Acc 0.9701 (38804/40000), AUC 0.9943028092384338
ep13_train_time 158.61669993400574
Test Epoch13 layer0 Acc 0.885, AUC 0.9486867189407349, avg_entr 0.1268109381198883, f1 0.8849999904632568
ep13_l0_test_time 0.7776939868927002
Test Epoch13 layer1 Acc 0.8706, AUC 0.9385309219360352, avg_entr 0.04386427626013756, f1 0.8705999851226807
ep13_l1_test_time 1.794438123703003
Test Epoch13 layer2 Acc 0.8702, AUC 0.9389415383338928, avg_entr 0.029930761083960533, f1 0.870199978351593
ep13_l2_test_time 3.114628553390503
Test Epoch13 layer3 Acc 0.8688, AUC 0.9387231469154358, avg_entr 0.02694685384631157, f1 0.8687999844551086
ep13_l3_test_time 4.331935167312622
Test Epoch13 layer4 Acc 0.8708, AUC 0.9382361173629761, avg_entr 0.029914462938904762, f1 0.8708000183105469
ep13_l4_test_time 5.601724624633789
gc 0
Train Epoch14 Acc 0.970675 (38827/40000), AUC 0.9947507381439209
ep14_train_time 158.33403396606445
Test Epoch14 layer0 Acc 0.8834, AUC 0.9482579827308655, avg_entr 0.12493718415498734, f1 0.8834000825881958
ep14_l0_test_time 0.755389928817749
Test Epoch14 layer1 Acc 0.8704, AUC 0.9379849433898926, avg_entr 0.039952076971530914, f1 0.8704000115394592
ep14_l1_test_time 1.7829315662384033
Test Epoch14 layer2 Acc 0.8684, AUC 0.9383184313774109, avg_entr 0.02737906575202942, f1 0.868399977684021
ep14_l2_test_time 3.0989203453063965
Test Epoch14 layer3 Acc 0.8694, AUC 0.9380848407745361, avg_entr 0.024964699521660805, f1 0.8694000244140625
ep14_l3_test_time 4.373607158660889
Test Epoch14 layer4 Acc 0.8694, AUC 0.9376391172409058, avg_entr 0.026848824694752693, f1 0.8694000244140625
ep14_l4_test_time 5.588656902313232
gc 0
Train Epoch15 Acc 0.9722 (38888/40000), AUC 0.9951828718185425
ep15_train_time 158.7686538696289
Test Epoch15 layer0 Acc 0.8824, AUC 0.9474462270736694, avg_entr 0.12493078410625458, f1 0.8823999762535095
ep15_l0_test_time 0.773482084274292
Test Epoch15 layer1 Acc 0.8682, AUC 0.9370644092559814, avg_entr 0.03641786053776741, f1 0.8682000041007996
ep15_l1_test_time 1.7860605716705322
Test Epoch15 layer2 Acc 0.8684, AUC 0.9372683763504028, avg_entr 0.02529686503112316, f1 0.868399977684021
ep15_l2_test_time 3.045884609222412
Test Epoch15 layer3 Acc 0.8692, AUC 0.937057614326477, avg_entr 0.023125439882278442, f1 0.8691999912261963
ep15_l3_test_time 4.148707151412964
Test Epoch15 layer4 Acc 0.8668, AUC 0.9364843368530273, avg_entr 0.02429373748600483, f1 0.8668000102043152
ep15_l4_test_time 5.6280107498168945
gc 0
Train Epoch16 Acc 0.973325 (38933/40000), AUC 0.9956696629524231
ep16_train_time 158.62450051307678
Test Epoch16 layer0 Acc 0.8824, AUC 0.9470429420471191, avg_entr 0.1249111220240593, f1 0.8823999762535095
ep16_l0_test_time 0.7643201351165771
Test Epoch16 layer1 Acc 0.8674, AUC 0.934851884841919, avg_entr 0.030168969184160233, f1 0.8673999905586243
ep16_l1_test_time 1.787271499633789
Test Epoch16 layer2 Acc 0.8676, AUC 0.9350886344909668, avg_entr 0.020841483026742935, f1 0.8675999641418457
ep16_l2_test_time 3.1155288219451904
Test Epoch16 layer3 Acc 0.8674, AUC 0.9349973201751709, avg_entr 0.019704941660165787, f1 0.8673999905586243
ep16_l3_test_time 4.313173532485962
Test Epoch16 layer4 Acc 0.868, AUC 0.9342799186706543, avg_entr 0.020480480045080185, f1 0.8679999709129333
ep16_l4_test_time 5.611901044845581
gc 0
Train Epoch17 Acc 0.974125 (38965/40000), AUC 0.9957181215286255
ep17_train_time 158.42697477340698
Test Epoch17 layer0 Acc 0.8832, AUC 0.9466786980628967, avg_entr 0.12162420898675919, f1 0.8831999897956848
ep17_l0_test_time 0.7615208625793457
Test Epoch17 layer1 Acc 0.8668, AUC 0.9364376068115234, avg_entr 0.03753169625997543, f1 0.8668000102043152
ep17_l1_test_time 1.790842056274414
Test Epoch17 layer2 Acc 0.867, AUC 0.9365408420562744, avg_entr 0.025974091142416, f1 0.8669999837875366
ep17_l2_test_time 3.079780340194702
Test Epoch17 layer3 Acc 0.8666, AUC 0.9363272190093994, avg_entr 0.023837193846702576, f1 0.866599977016449
ep17_l3_test_time 4.332505226135254
Test Epoch17 layer4 Acc 0.8662, AUC 0.9356862902641296, avg_entr 0.026140820235013962, f1 0.8661999702453613
ep17_l4_test_time 5.638962745666504
gc 0
Train Epoch18 Acc 0.9746 (38984/40000), AUC 0.9958407878875732
ep18_train_time 158.67529487609863
Test Epoch18 layer0 Acc 0.8824, AUC 0.9463622570037842, avg_entr 0.12071610987186432, f1 0.8823999762535095
ep18_l0_test_time 0.7099170684814453
Test Epoch18 layer1 Acc 0.8666, AUC 0.9348819851875305, avg_entr 0.0276995450258255, f1 0.866599977016449
ep18_l1_test_time 1.6567957401275635
Test Epoch18 layer2 Acc 0.8672, AUC 0.9349504709243774, avg_entr 0.018555378541350365, f1 0.8672000169754028
ep18_l2_test_time 3.1007466316223145
Test Epoch18 layer3 Acc 0.8684, AUC 0.9349029064178467, avg_entr 0.01745625212788582, f1 0.868399977684021
ep18_l3_test_time 4.324052810668945
Test Epoch18 layer4 Acc 0.8664, AUC 0.9337737560272217, avg_entr 0.018688593059778214, f1 0.8664000034332275
ep18_l4_test_time 5.60096287727356
gc 0
Train Epoch19 Acc 0.9749 (38996/40000), AUC 0.9959899187088013
ep19_train_time 158.58933401107788
Test Epoch19 layer0 Acc 0.8812, AUC 0.9460626840591431, avg_entr 0.12011141330003738, f1 0.8812000155448914
ep19_l0_test_time 0.7772901058197021
Test Epoch19 layer1 Acc 0.8678, AUC 0.9347277879714966, avg_entr 0.031052816659212112, f1 0.8677999973297119
ep19_l1_test_time 1.7791869640350342
Test Epoch19 layer2 Acc 0.8656, AUC 0.9349833726882935, avg_entr 0.02130986377596855, f1 0.8655999898910522
ep19_l2_test_time 3.1115949153900146
Test Epoch19 layer3 Acc 0.8668, AUC 0.9347257614135742, avg_entr 0.019873762503266335, f1 0.8668000102043152
ep19_l3_test_time 4.366536378860474
Test Epoch19 layer4 Acc 0.8664, AUC 0.9340335130691528, avg_entr 0.021222472190856934, f1 0.8664000034332275
ep19_l4_test_time 5.633953809738159
gc 0
Train Epoch20 Acc 0.97565 (39026/40000), AUC 0.9961625337600708
ep20_train_time 158.2984266281128
Test Epoch20 layer0 Acc 0.8804, AUC 0.9458209872245789, avg_entr 0.11921507865190506, f1 0.8804000020027161
ep20_l0_test_time 0.7701578140258789
Test Epoch20 layer1 Acc 0.8658, AUC 0.9334320425987244, avg_entr 0.02956189587712288, f1 0.8658000826835632
ep20_l1_test_time 1.7912921905517578
Test Epoch20 layer2 Acc 0.8656, AUC 0.9335985779762268, avg_entr 0.0211891271173954, f1 0.8655999898910522
ep20_l2_test_time 3.1059207916259766
Test Epoch20 layer3 Acc 0.8682, AUC 0.9334731101989746, avg_entr 0.01991695538163185, f1 0.8682000041007996
ep20_l3_test_time 4.410353899002075
Test Epoch20 layer4 Acc 0.8656, AUC 0.9327003955841064, avg_entr 0.020292146131396294, f1 0.8655999898910522
ep20_l4_test_time 5.6398279666900635
gc 0
Train Epoch21 Acc 0.975575 (39023/40000), AUC 0.9961700439453125
ep21_train_time 158.34307742118835
Test Epoch21 layer0 Acc 0.8796, AUC 0.9456604719161987, avg_entr 0.11864645034074783, f1 0.8795999884605408
ep21_l0_test_time 0.7723701000213623
Test Epoch21 layer1 Acc 0.8668, AUC 0.9337352514266968, avg_entr 0.027331646531820297, f1 0.8668000102043152
ep21_l1_test_time 1.7927212715148926
Test Epoch21 layer2 Acc 0.8672, AUC 0.9338854551315308, avg_entr 0.01825311966240406, f1 0.8672000169754028
ep21_l2_test_time 3.0996861457824707
Test Epoch21 layer3 Acc 0.8666, AUC 0.9337307214736938, avg_entr 0.016926178708672523, f1 0.866599977016449
ep21_l3_test_time 4.351837396621704
Test Epoch21 layer4 Acc 0.8666, AUC 0.9327597618103027, avg_entr 0.018734708428382874, f1 0.866599977016449
ep21_l4_test_time 5.580193758010864
gc 0
Train Epoch22 Acc 0.9761 (39044/40000), AUC 0.9963432550430298
ep22_train_time 138.29587721824646
Test Epoch22 layer0 Acc 0.8798, AUC 0.9454945921897888, avg_entr 0.11797374486923218, f1 0.879800021648407
ep22_l0_test_time 0.7654340267181396
Test Epoch22 layer1 Acc 0.8656, AUC 0.9338512420654297, avg_entr 0.03061186894774437, f1 0.8655999898910522
ep22_l1_test_time 1.7927818298339844
Test Epoch22 layer2 Acc 0.8654, AUC 0.934066116809845, avg_entr 0.021605122834444046, f1 0.865399956703186
ep22_l2_test_time 3.08039927482605
Test Epoch22 layer3 Acc 0.8666, AUC 0.9339748024940491, avg_entr 0.020300328731536865, f1 0.866599977016449
ep22_l3_test_time 4.332441329956055
Test Epoch22 layer4 Acc 0.8656, AUC 0.933059573173523, avg_entr 0.020935865119099617, f1 0.8655999898910522
ep22_l4_test_time 5.618063688278198
gc 0
Train Epoch23 Acc 0.9764 (39056/40000), AUC 0.9963585138320923
ep23_train_time 158.61239004135132
Test Epoch23 layer0 Acc 0.8796, AUC 0.9453338980674744, avg_entr 0.11774919182062149, f1 0.8795999884605408
ep23_l0_test_time 0.765521764755249
Test Epoch23 layer1 Acc 0.8662, AUC 0.9338767528533936, avg_entr 0.028862768784165382, f1 0.8661999702453613
ep23_l1_test_time 1.773371934890747
Test Epoch23 layer2 Acc 0.8656, AUC 0.9339853525161743, avg_entr 0.01988668367266655, f1 0.8655999898910522
ep23_l2_test_time 2.9354450702667236
Test Epoch23 layer3 Acc 0.8658, AUC 0.933889627456665, avg_entr 0.018656624481081963, f1 0.8658000826835632
ep23_l3_test_time 4.178916692733765
Test Epoch23 layer4 Acc 0.8654, AUC 0.9328128099441528, avg_entr 0.01975078694522381, f1 0.865399956703186
ep23_l4_test_time 5.630383014678955
gc 0
Train Epoch24 Acc 0.9766 (39064/40000), AUC 0.996391236782074
ep24_train_time 158.66839838027954
Test Epoch24 layer0 Acc 0.8786, AUC 0.9452040195465088, avg_entr 0.11674268543720245, f1 0.878600001335144
ep24_l0_test_time 0.76279616355896
Test Epoch24 layer1 Acc 0.866, AUC 0.9334360361099243, avg_entr 0.028467727825045586, f1 0.8659999966621399
ep24_l1_test_time 1.7852933406829834
Test Epoch24 layer2 Acc 0.865, AUC 0.933664083480835, avg_entr 0.019691023975610733, f1 0.8650000095367432
ep24_l2_test_time 3.1054515838623047
Test Epoch24 layer3 Acc 0.8656, AUC 0.933565616607666, avg_entr 0.01857568509876728, f1 0.8655999898910522
ep24_l3_test_time 4.349024057388306
Test Epoch24 layer4 Acc 0.866, AUC 0.9324808120727539, avg_entr 0.019607650116086006, f1 0.8659999966621399
ep24_l4_test_time 5.645121812820435
gc 0
Train Epoch25 Acc 0.97705 (39082/40000), AUC 0.9964128732681274
ep25_train_time 158.3189537525177
Test Epoch25 layer0 Acc 0.8804, AUC 0.9451154470443726, avg_entr 0.11594600975513458, f1 0.8804000020027161
ep25_l0_test_time 0.7734601497650146
Test Epoch25 layer1 Acc 0.8658, AUC 0.9332016706466675, avg_entr 0.029291564598679543, f1 0.8658000826835632
ep25_l1_test_time 1.7864956855773926
Test Epoch25 layer2 Acc 0.8638, AUC 0.9334214925765991, avg_entr 0.0207059308886528, f1 0.8637999892234802
ep25_l2_test_time 3.096670627593994
Test Epoch25 layer3 Acc 0.8658, AUC 0.9334014654159546, avg_entr 0.019692007452249527, f1 0.8658000826835632
ep25_l3_test_time 4.431943893432617
Test Epoch25 layer4 Acc 0.865, AUC 0.9323409795761108, avg_entr 0.0202370323240757, f1 0.8650000095367432
ep25_l4_test_time 5.63924765586853
gc 0
Train Epoch26 Acc 0.97715 (39086/40000), AUC 0.9963634014129639
ep26_train_time 158.52647161483765
Test Epoch26 layer0 Acc 0.8788, AUC 0.9450598359107971, avg_entr 0.11587438732385635, f1 0.8787999749183655
ep26_l0_test_time 0.7426838874816895
Test Epoch26 layer1 Acc 0.8654, AUC 0.933597207069397, avg_entr 0.026484601199626923, f1 0.865399956703186
ep26_l1_test_time 1.7559075355529785
Test Epoch26 layer2 Acc 0.8666, AUC 0.9337313175201416, avg_entr 0.018150806427001953, f1 0.866599977016449
ep26_l2_test_time 3.122920513153076
Test Epoch26 layer3 Acc 0.8658, AUC 0.9336259961128235, avg_entr 0.016959870234131813, f1 0.8658000826835632
ep26_l3_test_time 4.318431377410889
Test Epoch26 layer4 Acc 0.8664, AUC 0.9324477910995483, avg_entr 0.018183866515755653, f1 0.8664000034332275
ep26_l4_test_time 5.631612300872803
gc 0
Train Epoch27 Acc 0.977075 (39083/40000), AUC 0.996457576751709
ep27_train_time 158.65910816192627
Test Epoch27 layer0 Acc 0.879, AUC 0.9450185298919678, avg_entr 0.11573978513479233, f1 0.8790000081062317
ep27_l0_test_time 0.7725460529327393
Test Epoch27 layer1 Acc 0.8662, AUC 0.9333687424659729, avg_entr 0.02774992398917675, f1 0.8661999702453613
ep27_l1_test_time 1.7930395603179932
Test Epoch27 layer2 Acc 0.8652, AUC 0.9335859417915344, avg_entr 0.019113918766379356, f1 0.8652000427246094
ep27_l2_test_time 3.0926766395568848
Test Epoch27 layer3 Acc 0.8654, AUC 0.9335161447525024, avg_entr 0.01808140054345131, f1 0.865399956703186
ep27_l3_test_time 4.3338799476623535
Test Epoch27 layer4 Acc 0.865, AUC 0.9324277639389038, avg_entr 0.019175808876752853, f1 0.8650000095367432
ep27_l4_test_time 5.486322402954102
gc 0
Train Epoch28 Acc 0.977225 (39089/40000), AUC 0.9964972138404846
ep28_train_time 158.49773287773132
Test Epoch28 layer0 Acc 0.8778, AUC 0.9449345469474792, avg_entr 0.11484978348016739, f1 0.8778000473976135
ep28_l0_test_time 0.7599310874938965
Test Epoch28 layer1 Acc 0.8654, AUC 0.9331708550453186, avg_entr 0.029332345351576805, f1 0.865399956703186
ep28_l1_test_time 1.7948238849639893
Test Epoch28 layer2 Acc 0.8642, AUC 0.9333887100219727, avg_entr 0.02080257050693035, f1 0.8641999959945679
ep28_l2_test_time 3.098430871963501
Test Epoch28 layer3 Acc 0.866, AUC 0.9333515167236328, avg_entr 0.019632605835795403, f1 0.8659999966621399
ep28_l3_test_time 4.32650899887085
Test Epoch28 layer4 Acc 0.8642, AUC 0.9323114156723022, avg_entr 0.020365914329886436, f1 0.8641999959945679
ep28_l4_test_time 5.595807313919067
gc 0
Train Epoch29 Acc 0.97725 (39090/40000), AUC 0.9965023398399353
ep29_train_time 158.30929970741272
Test Epoch29 layer0 Acc 0.8786, AUC 0.9449025392532349, avg_entr 0.11463046818971634, f1 0.878600001335144
ep29_l0_test_time 0.7627434730529785
Test Epoch29 layer1 Acc 0.8652, AUC 0.933097779750824, avg_entr 0.027780432254076004, f1 0.8652000427246094
ep29_l1_test_time 1.79237699508667
Test Epoch29 layer2 Acc 0.8652, AUC 0.9332815408706665, avg_entr 0.019149085506796837, f1 0.8652000427246094
ep29_l2_test_time 3.0818421840667725
Test Epoch29 layer3 Acc 0.8642, AUC 0.9332308173179626, avg_entr 0.01813925988972187, f1 0.8641999959945679
ep29_l3_test_time 4.347625017166138
Test Epoch29 layer4 Acc 0.8658, AUC 0.9321127533912659, avg_entr 0.01898368075489998, f1 0.8658000826835632
ep29_l4_test_time 5.631705045700073
Best AUC tensor(0.8984) 3 0
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 5186.996574163437
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.8922, AUC 0.9552980661392212, avg_entr 0.19946062564849854, f1 0.8921999931335449
l0_test_time 0.769010066986084
Test layer1 Acc 0.888, AUC 0.9443604946136475, avg_entr 0.05789519101381302, f1 0.8880000114440918
l1_test_time 1.788968801498413
Test layer2 Acc 0.886, AUC 0.944095253944397, avg_entr 0.048861514776945114, f1 0.8859999775886536
l2_test_time 3.1034598350524902
Test layer3 Acc 0.8854, AUC 0.9442611932754517, avg_entr 0.041620783507823944, f1 0.8853999972343445
l3_test_time 4.310047626495361
Test layer4 Acc 0.888, AUC 0.9438555240631104, avg_entr 0.04847290366888046, f1 0.8880000114440918
l4_test_time 5.662952899932861
