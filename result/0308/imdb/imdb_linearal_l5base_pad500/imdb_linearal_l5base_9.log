total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 22.79901361465454
Start Training
gc 0
Train Epoch0 Acc 0.497475 (19899/40000), AUC 0.500656008720398
ep0_train_time 11.968595027923584
Test Epoch0 layer4 Acc 0.6752, AUC 0.81251060962677, avg_entr 0.6889408826828003, f1 0.6751999855041504
ep0_l4_test_time 0.7800750732421875
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.823625 (32945/40000), AUC 0.9039818048477173
ep1_train_time 11.114229202270508
Test Epoch1 layer4 Acc 0.8774, AUC 0.9472432732582092, avg_entr 0.23542678356170654, f1 0.8773999810218811
ep1_l4_test_time 0.7559192180633545
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9053 (36212/40000), AUC 0.9654370546340942
ep2_train_time 11.106903791427612
Test Epoch2 layer4 Acc 0.891, AUC 0.9567148685455322, avg_entr 0.1541295051574707, f1 0.890999972820282
ep2_l4_test_time 0.7537741661071777
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.92425 (36970/40000), AUC 0.9762672781944275
ep3_train_time 11.144993305206299
Test Epoch3 layer4 Acc 0.9006, AUC 0.9594751596450806, avg_entr 0.11528531461954117, f1 0.900600016117096
ep3_l4_test_time 0.7705392837524414
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.934525 (37381/40000), AUC 0.9816603660583496
ep4_train_time 11.113434791564941
Test Epoch4 layer4 Acc 0.8966, AUC 0.9605807065963745, avg_entr 0.08419809490442276, f1 0.8966000080108643
ep4_l4_test_time 0.7894408702850342
gc 0
Train Epoch5 Acc 0.944075 (37763/40000), AUC 0.985541582107544
ep5_train_time 11.158291816711426
Test Epoch5 layer4 Acc 0.8856, AUC 0.9587018489837646, avg_entr 0.05819141864776611, f1 0.8855999708175659
ep5_l4_test_time 0.7646417617797852
gc 0
Train Epoch6 Acc 0.95025 (38010/40000), AUC 0.987507700920105
ep6_train_time 11.171136617660522
Test Epoch6 layer4 Acc 0.8974, AUC 0.9566614031791687, avg_entr 0.04539741203188896, f1 0.8974000215530396
ep6_l4_test_time 0.7694137096405029
gc 0
Train Epoch7 Acc 0.9548 (38192/40000), AUC 0.9893449544906616
ep7_train_time 11.075439453125
Test Epoch7 layer4 Acc 0.8982, AUC 0.9555079936981201, avg_entr 0.03941633179783821, f1 0.8981999754905701
ep7_l4_test_time 0.7736034393310547
gc 0
Train Epoch8 Acc 0.960025 (38401/40000), AUC 0.9914147257804871
ep8_train_time 11.092164516448975
Test Epoch8 layer4 Acc 0.8938, AUC 0.9536313414573669, avg_entr 0.03204343840479851, f1 0.8938000202178955
ep8_l4_test_time 0.7636115550994873
gc 0
Train Epoch9 Acc 0.963175 (38527/40000), AUC 0.9923728704452515
ep9_train_time 11.143609046936035
Test Epoch9 layer4 Acc 0.8932, AUC 0.9512197971343994, avg_entr 0.028737759217619896, f1 0.8931999802589417
ep9_l4_test_time 0.7559492588043213
gc 0
Train Epoch10 Acc 0.965325 (38613/40000), AUC 0.993564248085022
ep10_train_time 10.649758577346802
Test Epoch10 layer4 Acc 0.883, AUC 0.9491850137710571, avg_entr 0.025369731709361076, f1 0.8830000162124634
ep10_l4_test_time 0.768660306930542
gc 0
Train Epoch11 Acc 0.96825 (38730/40000), AUC 0.9941781759262085
ep11_train_time 11.085063934326172
Test Epoch11 layer4 Acc 0.8826, AUC 0.9469263553619385, avg_entr 0.023457232862710953, f1 0.8826000094413757
ep11_l4_test_time 0.756906270980835
gc 0
Train Epoch12 Acc 0.970825 (38833/40000), AUC 0.9949941635131836
ep12_train_time 11.082643270492554
Test Epoch12 layer4 Acc 0.882, AUC 0.9468843936920166, avg_entr 0.022518374025821686, f1 0.8820000290870667
ep12_l4_test_time 0.7641665935516357
gc 0
Train Epoch13 Acc 0.972875 (38915/40000), AUC 0.9957066774368286
ep13_train_time 11.051940202713013
Test Epoch13 layer4 Acc 0.8786, AUC 0.9433438777923584, avg_entr 0.02174598164856434, f1 0.878600001335144
ep13_l4_test_time 0.7597434520721436
gc 0
Train Epoch14 Acc 0.9746 (38984/40000), AUC 0.9962454438209534
ep14_train_time 11.165499687194824
Test Epoch14 layer4 Acc 0.8748, AUC 0.9390294551849365, avg_entr 0.020154397934675217, f1 0.8748000264167786
ep14_l4_test_time 0.7713947296142578
gc 0
Train Epoch15 Acc 0.9757 (39028/40000), AUC 0.9966101050376892
ep15_train_time 11.092947006225586
Test Epoch15 layer4 Acc 0.8684, AUC 0.9366899728775024, avg_entr 0.020046161487698555, f1 0.868399977684021
ep15_l4_test_time 0.733729362487793
gc 0
Train Epoch16 Acc 0.9771 (39084/40000), AUC 0.9969582557678223
ep16_train_time 11.268834590911865
Test Epoch16 layer4 Acc 0.861, AUC 0.9337894916534424, avg_entr 0.021022604778409004, f1 0.8610000014305115
ep16_l4_test_time 0.7672221660614014
gc 0
Train Epoch17 Acc 0.9788 (39152/40000), AUC 0.9972090721130371
ep17_train_time 11.237667322158813
Test Epoch17 layer4 Acc 0.8658, AUC 0.9305016994476318, avg_entr 0.017704233527183533, f1 0.8658000826835632
ep17_l4_test_time 0.7820494174957275
gc 0
Train Epoch18 Acc 0.979425 (39177/40000), AUC 0.997571587562561
ep18_train_time 11.220465660095215
Test Epoch18 layer4 Acc 0.8636, AUC 0.9278082847595215, avg_entr 0.016779262572526932, f1 0.8636000156402588
ep18_l4_test_time 0.7720346450805664
gc 0
Train Epoch19 Acc 0.980075 (39203/40000), AUC 0.9976474046707153
ep19_train_time 11.167485475540161
Test Epoch19 layer4 Acc 0.8588, AUC 0.9245283007621765, avg_entr 0.016413614153862, f1 0.8587999939918518
ep19_l4_test_time 0.7558720111846924
gc 0
Train Epoch20 Acc 0.98185 (39274/40000), AUC 0.997954249382019
ep20_train_time 11.132331848144531
Test Epoch20 layer4 Acc 0.8594, AUC 0.9208531975746155, avg_entr 0.017122512683272362, f1 0.8593999743461609
ep20_l4_test_time 0.7688517570495605
gc 0
Train Epoch21 Acc 0.983575 (39343/40000), AUC 0.9981123208999634
ep21_train_time 10.787911891937256
Test Epoch21 layer4 Acc 0.8558, AUC 0.9190376996994019, avg_entr 0.01818937063217163, f1 0.8558000326156616
ep21_l4_test_time 0.7786009311676025
gc 0
Train Epoch22 Acc 0.983425 (39337/40000), AUC 0.9983385801315308
ep22_train_time 11.20469045639038
Test Epoch22 layer4 Acc 0.8536, AUC 0.9184742569923401, avg_entr 0.014291969127953053, f1 0.853600025177002
ep22_l4_test_time 0.7779481410980225
gc 0
Train Epoch23 Acc 0.98385 (39354/40000), AUC 0.998462438583374
ep23_train_time 11.1549391746521
Test Epoch23 layer4 Acc 0.8528, AUC 0.9166305065155029, avg_entr 0.01582731492817402, f1 0.8528000116348267
ep23_l4_test_time 0.777923583984375
gc 0
Train Epoch24 Acc 0.984925 (39397/40000), AUC 0.9985430240631104
ep24_train_time 11.176831483840942
Test Epoch24 layer4 Acc 0.8486, AUC 0.9117591381072998, avg_entr 0.013948390260338783, f1 0.8485999703407288
ep24_l4_test_time 0.7752795219421387
gc 0
Train Epoch25 Acc 0.98595 (39438/40000), AUC 0.9987658262252808
ep25_train_time 11.137854099273682
Test Epoch25 layer4 Acc 0.8442, AUC 0.9112915396690369, avg_entr 0.013178750872612, f1 0.8442000150680542
ep25_l4_test_time 0.7711200714111328
gc 0
Train Epoch26 Acc 0.985975 (39439/40000), AUC 0.9986660480499268
ep26_train_time 11.112125635147095
Test Epoch26 layer4 Acc 0.8422, AUC 0.9092904925346375, avg_entr 0.012430129572749138, f1 0.842199981212616
ep26_l4_test_time 0.7510225772857666
gc 0
Train Epoch27 Acc 0.986325 (39453/40000), AUC 0.9988386631011963
ep27_train_time 11.057026863098145
Test Epoch27 layer4 Acc 0.8404, AUC 0.9050819873809814, avg_entr 0.012851239182054996, f1 0.840399980545044
ep27_l4_test_time 0.7543389797210693
gc 0
Train Epoch28 Acc 0.98695 (39478/40000), AUC 0.9989416599273682
ep28_train_time 11.12988829612732
Test Epoch28 layer4 Acc 0.8426, AUC 0.9046502113342285, avg_entr 0.012439044192433357, f1 0.8426000475883484
ep28_l4_test_time 0.7586674690246582
gc 0
Train Epoch29 Acc 0.987275 (39491/40000), AUC 0.9989086389541626
ep29_train_time 11.068785905838013
Test Epoch29 layer4 Acc 0.8406, AUC 0.9027331471443176, avg_entr 0.01388771366328001, f1 0.8405999541282654
ep29_l4_test_time 0.7581610679626465
Best AUC tensor(0.9006) 3
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 358.6443591117859
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8962, AUC 0.9553995132446289, avg_entr 0.19606804847717285, f1 0.8962000012397766
l0_test_time 0.7641746997833252
Test layer1 Acc 0.8962, AUC 0.9555613994598389, avg_entr 0.17671220004558563, f1 0.8962000012397766
l1_test_time 0.7701239585876465
Test layer2 Acc 0.895, AUC 0.9558181762695312, avg_entr 0.15449689328670502, f1 0.8949999809265137
l2_test_time 0.7730057239532471
Test layer3 Acc 0.8942, AUC 0.9559755921363831, avg_entr 0.14243271946907043, f1 0.8942000269889832
l3_test_time 0.7689321041107178
Test layer4 Acc 0.895, AUC 0.9564607739448547, avg_entr 0.11758434772491455, f1 0.8949999809265137
l4_test_time 0.7627360820770264
