total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 23.2393536567688
Start Training
gc 0
Train Epoch0 Acc 0.509 (20360/40000), AUC 0.5271707773208618
ep0_train_time 13.918123245239258
Test Epoch0 layer4 Acc 0.52, AUC 0.870187520980835, avg_entr 0.6928061246871948, f1 0.5199999809265137
ep0_l4_test_time 0.8245415687561035
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.808725 (32349/40000), AUC 0.8920060396194458
ep1_train_time 11.728904724121094
Test Epoch1 layer4 Acc 0.8228, AUC 0.9461239576339722, avg_entr 0.21696911752223969, f1 0.8227999806404114
ep1_l4_test_time 0.7632601261138916
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9035 (36140/40000), AUC 0.964202880859375
ep2_train_time 11.3843092918396
Test Epoch2 layer4 Acc 0.8894, AUC 0.955967366695404, avg_entr 0.16892029345035553, f1 0.8894000053405762
ep2_l4_test_time 0.7195858955383301
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.920425 (36817/40000), AUC 0.9745842218399048
ep3_train_time 13.643657684326172
Test Epoch3 layer4 Acc 0.896, AUC 0.9594477415084839, avg_entr 0.12712910771369934, f1 0.8960000276565552
ep3_l4_test_time 0.8132596015930176
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.93315 (37326/40000), AUC 0.9810910224914551
ep4_train_time 12.678125619888306
Test Epoch4 layer4 Acc 0.9008, AUC 0.9606306552886963, avg_entr 0.09516797214746475, f1 0.9007999897003174
ep4_l4_test_time 0.8015384674072266
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.94215 (37686/40000), AUC 0.9848300218582153
ep5_train_time 12.591542482376099
Test Epoch5 layer4 Acc 0.9016, AUC 0.9607420563697815, avg_entr 0.07079647481441498, f1 0.9016000032424927
ep5_l4_test_time 0.856947660446167
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.948275 (37931/40000), AUC 0.9873286485671997
ep6_train_time 12.641580581665039
Test Epoch6 layer4 Acc 0.893, AUC 0.957993745803833, avg_entr 0.058200135827064514, f1 0.8930000066757202
ep6_l4_test_time 0.8563251495361328
gc 0
Train Epoch7 Acc 0.954375 (38175/40000), AUC 0.989159345626831
ep7_train_time 12.6185302734375
Test Epoch7 layer4 Acc 0.8974, AUC 0.9550584554672241, avg_entr 0.04414834454655647, f1 0.8974000215530396
ep7_l4_test_time 0.8270244598388672
gc 0
Train Epoch8 Acc 0.958175 (38327/40000), AUC 0.99058598279953
ep8_train_time 12.634810209274292
Test Epoch8 layer4 Acc 0.8822, AUC 0.9503464698791504, avg_entr 0.037536460906267166, f1 0.8822000026702881
ep8_l4_test_time 0.8533585071563721
gc 0
Train Epoch9 Acc 0.963225 (38529/40000), AUC 0.9916788935661316
ep9_train_time 12.716500520706177
Test Epoch9 layer4 Acc 0.8896, AUC 0.9462580680847168, avg_entr 0.03529873117804527, f1 0.8895999193191528
ep9_l4_test_time 0.8256247043609619
gc 0
Train Epoch10 Acc 0.965125 (38605/40000), AUC 0.9932859539985657
ep10_train_time 12.629640579223633
Test Epoch10 layer4 Acc 0.889, AUC 0.9481549263000488, avg_entr 0.030436376109719276, f1 0.8889999985694885
ep10_l4_test_time 0.8192729949951172
gc 0
Train Epoch11 Acc 0.967 (38680/40000), AUC 0.9938182830810547
ep11_train_time 12.683416366577148
Test Epoch11 layer4 Acc 0.8822, AUC 0.9440885186195374, avg_entr 0.029003096744418144, f1 0.8822000026702881
ep11_l4_test_time 0.8200232982635498
gc 0
Train Epoch12 Acc 0.9699 (38796/40000), AUC 0.9945825934410095
ep12_train_time 12.032469987869263
Test Epoch12 layer4 Acc 0.8838, AUC 0.9451285004615784, avg_entr 0.026019824668765068, f1 0.8838000297546387
ep12_l4_test_time 0.7955095767974854
gc 0
Train Epoch13 Acc 0.97185 (38874/40000), AUC 0.9953009486198425
ep13_train_time 11.550241231918335
Test Epoch13 layer4 Acc 0.879, AUC 0.9435489773750305, avg_entr 0.023591481149196625, f1 0.8790000081062317
ep13_l4_test_time 0.7671506404876709
gc 0
Train Epoch14 Acc 0.974 (38960/40000), AUC 0.9959425926208496
ep14_train_time 13.364169836044312
Test Epoch14 layer4 Acc 0.874, AUC 0.9406599402427673, avg_entr 0.022581830620765686, f1 0.8740000128746033
ep14_l4_test_time 0.9410624504089355
gc 0
Train Epoch15 Acc 0.975675 (39027/40000), AUC 0.9960797429084778
ep15_train_time 12.723634004592896
Test Epoch15 layer4 Acc 0.8746, AUC 0.939703106880188, avg_entr 0.02133277617394924, f1 0.8745999932289124
ep15_l4_test_time 0.848851203918457
gc 0
Train Epoch16 Acc 0.9771 (39084/40000), AUC 0.9965916872024536
ep16_train_time 12.572374820709229
Test Epoch16 layer4 Acc 0.87, AUC 0.9332144260406494, avg_entr 0.02008279785513878, f1 0.8700000047683716
ep16_l4_test_time 0.8455958366394043
gc 0
Train Epoch17 Acc 0.978775 (39151/40000), AUC 0.9969022274017334
ep17_train_time 12.680723190307617
Test Epoch17 layer4 Acc 0.8698, AUC 0.931885838508606, avg_entr 0.020572111010551453, f1 0.8697999715805054
ep17_l4_test_time 0.8229732513427734
gc 0
Train Epoch18 Acc 0.97975 (39190/40000), AUC 0.9971551895141602
ep18_train_time 12.591460466384888
Test Epoch18 layer4 Acc 0.8646, AUC 0.9330557584762573, avg_entr 0.018841106444597244, f1 0.8646000027656555
ep18_l4_test_time 0.8548824787139893
gc 0
Train Epoch19 Acc 0.980725 (39229/40000), AUC 0.9974441528320312
ep19_train_time 12.701077461242676
Test Epoch19 layer4 Acc 0.8624, AUC 0.92841637134552, avg_entr 0.018616046756505966, f1 0.8623999953269958
ep19_l4_test_time 0.8400757312774658
gc 0
Train Epoch20 Acc 0.981775 (39271/40000), AUC 0.9976321458816528
ep20_train_time 12.631486415863037
Test Epoch20 layer4 Acc 0.859, AUC 0.9283725023269653, avg_entr 0.016177257522940636, f1 0.859000027179718
ep20_l4_test_time 0.8270668983459473
gc 0
Train Epoch21 Acc 0.983075 (39323/40000), AUC 0.998075008392334
ep21_train_time 12.658423900604248
Test Epoch21 layer4 Acc 0.8568, AUC 0.9259076118469238, avg_entr 0.017042608931660652, f1 0.8568000793457031
ep21_l4_test_time 0.8494892120361328
gc 0
Train Epoch22 Acc 0.983925 (39357/40000), AUC 0.9982082843780518
ep22_train_time 12.576215267181396
Test Epoch22 layer4 Acc 0.855, AUC 0.9233181476593018, avg_entr 0.015970934182405472, f1 0.8550000190734863
ep22_l4_test_time 0.805905818939209
gc 0
Train Epoch23 Acc 0.98355 (39342/40000), AUC 0.998195469379425
ep23_train_time 11.752193927764893
Test Epoch23 layer4 Acc 0.855, AUC 0.9204490184783936, avg_entr 0.016738757491111755, f1 0.8550000190734863
ep23_l4_test_time 0.7761359214782715
gc 0
Train Epoch24 Acc 0.985025 (39401/40000), AUC 0.9982961416244507
ep24_train_time 11.633299350738525
Test Epoch24 layer4 Acc 0.8506, AUC 0.9185736179351807, avg_entr 0.015077117830514908, f1 0.8505999445915222
ep24_l4_test_time 0.7815060615539551
gc 0
Train Epoch25 Acc 0.985675 (39427/40000), AUC 0.9984160661697388
ep25_train_time 12.887295484542847
Test Epoch25 layer4 Acc 0.847, AUC 0.9165244102478027, avg_entr 0.013982199132442474, f1 0.847000002861023
ep25_l4_test_time 0.9420833587646484
gc 0
Train Epoch26 Acc 0.985775 (39431/40000), AUC 0.9986008405685425
ep26_train_time 12.818157434463501
Test Epoch26 layer4 Acc 0.8478, AUC 0.9153614044189453, avg_entr 0.014781124889850616, f1 0.8477999567985535
ep26_l4_test_time 0.8068583011627197
gc 0
Train Epoch27 Acc 0.9868 (39472/40000), AUC 0.9987702369689941
ep27_train_time 12.56190037727356
Test Epoch27 layer4 Acc 0.8442, AUC 0.9133055210113525, avg_entr 0.015226167626678944, f1 0.8442000150680542
ep27_l4_test_time 0.8256947994232178
gc 0
Train Epoch28 Acc 0.986675 (39467/40000), AUC 0.9987226724624634
ep28_train_time 12.710490942001343
Test Epoch28 layer4 Acc 0.843, AUC 0.9106032848358154, avg_entr 0.014038322493433952, f1 0.8429999947547913
ep28_l4_test_time 0.8423287868499756
gc 0
Train Epoch29 Acc 0.987075 (39483/40000), AUC 0.9987621307373047
ep29_train_time 12.628597021102905
Test Epoch29 layer4 Acc 0.8414, AUC 0.9069125056266785, avg_entr 0.014935758896172047, f1 0.8414000272750854
ep29_l4_test_time 0.8266832828521729
Best AUC tensor(0.9016) 5
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 403.6143400669098
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8936, AUC 0.9554163217544556, avg_entr 0.16871987283229828, f1 0.8935999870300293
l0_test_time 0.8401429653167725
Test layer1 Acc 0.894, AUC 0.9559637308120728, avg_entr 0.15466415882110596, f1 0.8939999938011169
l1_test_time 0.8219785690307617
Test layer2 Acc 0.8932, AUC 0.9564635753631592, avg_entr 0.14209648966789246, f1 0.8931999802589417
l2_test_time 0.820204496383667
Test layer3 Acc 0.8932, AUC 0.956961989402771, avg_entr 0.11550819128751755, f1 0.8931999802589417
l3_test_time 0.8634445667266846
Test layer4 Acc 0.894, AUC 0.9563049077987671, avg_entr 0.07552909106016159, f1 0.8939999938011169
l4_test_time 0.8446943759918213
