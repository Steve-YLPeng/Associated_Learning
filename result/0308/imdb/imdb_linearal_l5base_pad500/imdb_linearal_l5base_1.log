total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 23.75462794303894
Start Training
gc 0
Train Epoch0 Acc 0.53305 (21322/40000), AUC 0.5263898372650146
ep0_train_time 14.601162672042847
Test Epoch0 layer4 Acc 0.5992, AUC 0.8664470911026001, avg_entr 0.6884213089942932, f1 0.5992000102996826
ep0_l4_test_time 0.8276882171630859
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.83565 (33426/40000), AUC 0.908442497253418
ep1_train_time 12.703866720199585
Test Epoch1 layer4 Acc 0.8816, AUC 0.9468369483947754, avg_entr 0.2290542721748352, f1 0.881600022315979
ep1_l4_test_time 0.8102099895477295
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.904325 (36173/40000), AUC 0.9650863409042358
ep2_train_time 12.662968397140503
Test Epoch2 layer4 Acc 0.887, AUC 0.9559444189071655, avg_entr 0.17060384154319763, f1 0.8870000243186951
ep2_l4_test_time 0.8235909938812256
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.923475 (36939/40000), AUC 0.9756633043289185
ep3_train_time 12.581287860870361
Test Epoch3 layer4 Acc 0.8944, AUC 0.9593247175216675, avg_entr 0.12633875012397766, f1 0.8944000005722046
ep3_l4_test_time 0.8141684532165527
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.936925 (37477/40000), AUC 0.9819923043251038
ep4_train_time 12.556877136230469
Test Epoch4 layer4 Acc 0.8994, AUC 0.960134744644165, avg_entr 0.09020963311195374, f1 0.8993999361991882
ep4_l4_test_time 0.822758674621582
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.94305 (37722/40000), AUC 0.9854640960693359
ep5_train_time 12.66363787651062
Test Epoch5 layer4 Acc 0.897, AUC 0.9597684144973755, avg_entr 0.06624018400907516, f1 0.8970000147819519
ep5_l4_test_time 0.8393819332122803
gc 0
Train Epoch6 Acc 0.948725 (37949/40000), AUC 0.9877400398254395
ep6_train_time 12.646803617477417
Test Epoch6 layer4 Acc 0.8974, AUC 0.9583864212036133, avg_entr 0.04784161597490311, f1 0.8974000215530396
ep6_l4_test_time 0.8040480613708496
gc 0
Train Epoch7 Acc 0.953975 (38159/40000), AUC 0.9893240928649902
ep7_train_time 12.779481649398804
Test Epoch7 layer4 Acc 0.8952, AUC 0.9555343389511108, avg_entr 0.042003732174634933, f1 0.8952000141143799
ep7_l4_test_time 0.830899715423584
gc 0
Train Epoch8 Acc 0.959575 (38383/40000), AUC 0.9911065101623535
ep8_train_time 12.660135984420776
Test Epoch8 layer4 Acc 0.893, AUC 0.9533206820487976, avg_entr 0.035869140177965164, f1 0.8930000066757202
ep8_l4_test_time 0.7916605472564697
gc 0
Train Epoch9 Acc 0.962375 (38495/40000), AUC 0.9923250675201416
ep9_train_time 11.682443141937256
Test Epoch9 layer4 Acc 0.8872, AUC 0.9481773376464844, avg_entr 0.032225992530584335, f1 0.8871999979019165
ep9_l4_test_time 0.7915658950805664
gc 0
Train Epoch10 Acc 0.96525 (38610/40000), AUC 0.9934027194976807
ep10_train_time 11.13035535812378
Test Epoch10 layer4 Acc 0.8814, AUC 0.9485633969306946, avg_entr 0.03232278302311897, f1 0.8813999891281128
ep10_l4_test_time 0.7170553207397461
gc 0
Train Epoch11 Acc 0.9687 (38748/40000), AUC 0.9942260384559631
ep11_train_time 13.625365018844604
Test Epoch11 layer4 Acc 0.8824, AUC 0.9465766549110413, avg_entr 0.027640607208013535, f1 0.8823999762535095
ep11_l4_test_time 0.9159767627716064
gc 0
Train Epoch12 Acc 0.970325 (38813/40000), AUC 0.9950173497200012
ep12_train_time 12.678619146347046
Test Epoch12 layer4 Acc 0.88, AUC 0.944951057434082, avg_entr 0.02556340955197811, f1 0.8799999952316284
ep12_l4_test_time 0.8471584320068359
gc 0
Train Epoch13 Acc 0.973025 (38921/40000), AUC 0.9955998659133911
ep13_train_time 12.6182382106781
Test Epoch13 layer4 Acc 0.8784, AUC 0.9396874308586121, avg_entr 0.02064356952905655, f1 0.8784000277519226
ep13_l4_test_time 0.838665246963501
gc 0
Train Epoch14 Acc 0.974325 (38973/40000), AUC 0.9958672523498535
ep14_train_time 12.592709064483643
Test Epoch14 layer4 Acc 0.877, AUC 0.939592719078064, avg_entr 0.02024775557219982, f1 0.8769999742507935
ep14_l4_test_time 0.7959957122802734
gc 0
Train Epoch15 Acc 0.9756 (39024/40000), AUC 0.9962986707687378
ep15_train_time 12.591843843460083
Test Epoch15 layer4 Acc 0.8684, AUC 0.9350220561027527, avg_entr 0.020212095230817795, f1 0.868399977684021
ep15_l4_test_time 0.8287417888641357
gc 0
Train Epoch16 Acc 0.97745 (39098/40000), AUC 0.9964636564254761
ep16_train_time 12.667428255081177
Test Epoch16 layer4 Acc 0.8646, AUC 0.9357290267944336, avg_entr 0.01919865794479847, f1 0.8646000027656555
ep16_l4_test_time 0.8121480941772461
gc 0
Train Epoch17 Acc 0.978775 (39151/40000), AUC 0.99697345495224
ep17_train_time 12.644151210784912
Test Epoch17 layer4 Acc 0.8626, AUC 0.930706799030304, avg_entr 0.01870947703719139, f1 0.8626000285148621
ep17_l4_test_time 0.8049209117889404
gc 0
Train Epoch18 Acc 0.980175 (39207/40000), AUC 0.9971276521682739
ep18_train_time 12.642364501953125
Test Epoch18 layer4 Acc 0.862, AUC 0.9201235771179199, avg_entr 0.019495278596878052, f1 0.8619999885559082
ep18_l4_test_time 0.8401443958282471
gc 0
Train Epoch19 Acc 0.98075 (39230/40000), AUC 0.997359037399292
ep19_train_time 12.623981952667236
Test Epoch19 layer4 Acc 0.8562, AUC 0.9239420890808105, avg_entr 0.01595938764512539, f1 0.8561999797821045
ep19_l4_test_time 0.8209867477416992
gc 0
Train Epoch20 Acc 0.9821 (39284/40000), AUC 0.9973629713058472
ep20_train_time 12.09595251083374
Test Epoch20 layer4 Acc 0.8602, AUC 0.9199434518814087, avg_entr 0.018800362944602966, f1 0.8601999878883362
ep20_l4_test_time 0.7689478397369385
gc 0
Train Epoch21 Acc 0.982625 (39305/40000), AUC 0.9977942705154419
ep21_train_time 11.579509258270264
Test Epoch21 layer4 Acc 0.8524, AUC 0.9197220802307129, avg_entr 0.013672417029738426, f1 0.852400004863739
ep21_l4_test_time 0.7692577838897705
gc 0
Train Epoch22 Acc 0.983375 (39335/40000), AUC 0.997835636138916
ep22_train_time 13.285650968551636
Test Epoch22 layer4 Acc 0.8502, AUC 0.9183007478713989, avg_entr 0.014983444474637508, f1 0.8501999974250793
ep22_l4_test_time 0.9261701107025146
gc 0
Train Epoch23 Acc 0.984425 (39377/40000), AUC 0.997911274433136
ep23_train_time 12.828251361846924
Test Epoch23 layer4 Acc 0.8498, AUC 0.9103863835334778, avg_entr 0.01318878773599863, f1 0.8497999906539917
ep23_l4_test_time 0.8261888027191162
gc 0
Train Epoch24 Acc 0.9851 (39404/40000), AUC 0.9981297254562378
ep24_train_time 12.796387672424316
Test Epoch24 layer4 Acc 0.8486, AUC 0.9060981273651123, avg_entr 0.015243520960211754, f1 0.8485999703407288
ep24_l4_test_time 0.8376517295837402
gc 0
Train Epoch25 Acc 0.9856 (39424/40000), AUC 0.9980413913726807
ep25_train_time 12.60086178779602
Test Epoch25 layer4 Acc 0.8438, AUC 0.9089419841766357, avg_entr 0.015332847833633423, f1 0.8438000082969666
ep25_l4_test_time 0.817842960357666
gc 0
Train Epoch26 Acc 0.9862 (39448/40000), AUC 0.9982424378395081
ep26_train_time 12.666114330291748
Test Epoch26 layer4 Acc 0.8474, AUC 0.9030748009681702, avg_entr 0.014828436076641083, f1 0.8474000096321106
ep26_l4_test_time 0.8314127922058105
gc 0
Train Epoch27 Acc 0.986575 (39463/40000), AUC 0.9983441829681396
ep27_train_time 12.792296409606934
Test Epoch27 layer4 Acc 0.8392, AUC 0.905564546585083, avg_entr 0.014262049458920956, f1 0.8392000198364258
ep27_l4_test_time 0.8477156162261963
gc 0
Train Epoch28 Acc 0.9868 (39472/40000), AUC 0.998629629611969
ep28_train_time 12.592576503753662
Test Epoch28 layer4 Acc 0.8422, AUC 0.9014798402786255, avg_entr 0.015155015513300896, f1 0.842199981212616
ep28_l4_test_time 0.8126356601715088
gc 0
Train Epoch29 Acc 0.9869 (39476/40000), AUC 0.9986865520477295
ep29_train_time 12.69994330406189
Test Epoch29 layer4 Acc 0.838, AUC 0.8996607065200806, avg_entr 0.012931453064084053, f1 0.8379999995231628
ep29_l4_test_time 0.8165755271911621
Best AUC tensor(0.8994) 4
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 405.8100118637085
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8948, AUC 0.9555277228355408, avg_entr 0.17800383269786835, f1 0.8948000073432922
l0_test_time 0.8121075630187988
Test layer1 Acc 0.8936, AUC 0.9558460712432861, avg_entr 0.1598329395055771, f1 0.8935999870300293
l1_test_time 0.8049147129058838
Test layer2 Acc 0.8954, AUC 0.9562109112739563, avg_entr 0.14726164937019348, f1 0.8953999876976013
l2_test_time 0.8423688411712646
Test layer3 Acc 0.8946, AUC 0.9568073749542236, avg_entr 0.12352775782346725, f1 0.894599974155426
l3_test_time 0.8476800918579102
Test layer4 Acc 0.8946, AUC 0.95691978931427, avg_entr 0.09531714767217636, f1 0.894599974155426
l4_test_time 0.8627274036407471
