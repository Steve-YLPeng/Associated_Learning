total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 23.309532165527344
Start Training
gc 0
Train Epoch0 Acc 0.5 (20000/40000), AUC 0.5055290460586548
ep0_train_time 13.797565221786499
Test Epoch0 layer4 Acc 0.502, AUC 0.8176050782203674, avg_entr 0.6839840412139893, f1 0.5019999742507935
ep0_l4_test_time 0.8077125549316406
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.802025 (32081/40000), AUC 0.8895204663276672
ep1_train_time 12.655168771743774
Test Epoch1 layer4 Acc 0.8672, AUC 0.9466995000839233, avg_entr 0.23310324549674988, f1 0.8672000169754028
ep1_l4_test_time 0.8181061744689941
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9033 (36132/40000), AUC 0.9639458656311035
ep2_train_time 12.641698122024536
Test Epoch2 layer4 Acc 0.8884, AUC 0.9560352563858032, avg_entr 0.1705435812473297, f1 0.8884000182151794
ep2_l4_test_time 0.8194139003753662
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.92285 (36914/40000), AUC 0.9752191305160522
ep3_train_time 12.614223003387451
Test Epoch3 layer4 Acc 0.8934, AUC 0.95932936668396, avg_entr 0.13455486297607422, f1 0.8934000134468079
ep3_l4_test_time 0.8288357257843018
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.935025 (37401/40000), AUC 0.9815428256988525
ep4_train_time 12.494398355484009
Test Epoch4 layer4 Acc 0.899, AUC 0.9603347778320312, avg_entr 0.09016077220439911, f1 0.8989999890327454
ep4_l4_test_time 0.8480501174926758
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.94245 (37698/40000), AUC 0.9850301742553711
ep5_train_time 12.458382606506348
Test Epoch5 layer4 Acc 0.8972, AUC 0.9602331519126892, avg_entr 0.06218728795647621, f1 0.8971999883651733
ep5_l4_test_time 0.788489818572998
gc 0
Train Epoch6 Acc 0.948725 (37949/40000), AUC 0.987251877784729
ep6_train_time 11.733480453491211
Test Epoch6 layer4 Acc 0.8934, AUC 0.9579548835754395, avg_entr 0.047331977635622025, f1 0.8934000134468079
ep6_l4_test_time 0.8172192573547363
gc 0
Train Epoch7 Acc 0.954625 (38185/40000), AUC 0.9888491034507751
ep7_train_time 12.196896314620972
Test Epoch7 layer4 Acc 0.8968, AUC 0.9548736810684204, avg_entr 0.04008257016539574, f1 0.8967999815940857
ep7_l4_test_time 0.8915379047393799
gc 0
Train Epoch8 Acc 0.958725 (38349/40000), AUC 0.9907064437866211
ep8_train_time 13.38084864616394
Test Epoch8 layer4 Acc 0.894, AUC 0.9510193467140198, avg_entr 0.03533006086945534, f1 0.8939999938011169
ep8_l4_test_time 0.8275885581970215
gc 0
Train Epoch9 Acc 0.96275 (38510/40000), AUC 0.992082417011261
ep9_train_time 12.605932235717773
Test Epoch9 layer4 Acc 0.8908, AUC 0.9489758014678955, avg_entr 0.030492955818772316, f1 0.8907999992370605
ep9_l4_test_time 0.8042426109313965
gc 0
Train Epoch10 Acc 0.965425 (38617/40000), AUC 0.9933242201805115
ep10_train_time 12.618682622909546
Test Epoch10 layer4 Acc 0.8876, AUC 0.9471911191940308, avg_entr 0.02883869595825672, f1 0.8876000046730042
ep10_l4_test_time 0.8178935050964355
gc 0
Train Epoch11 Acc 0.967475 (38699/40000), AUC 0.9941372871398926
ep11_train_time 12.733605861663818
Test Epoch11 layer4 Acc 0.8832, AUC 0.9477202892303467, avg_entr 0.024959703907370567, f1 0.8831999897956848
ep11_l4_test_time 0.8164119720458984
gc 0
Train Epoch12 Acc 0.96965 (38786/40000), AUC 0.9949277639389038
ep12_train_time 12.57390546798706
Test Epoch12 layer4 Acc 0.881, AUC 0.9444441795349121, avg_entr 0.022812001407146454, f1 0.8809999823570251
ep12_l4_test_time 0.7935638427734375
gc 0
Train Epoch13 Acc 0.97275 (38910/40000), AUC 0.9954624772071838
ep13_train_time 12.6987886428833
Test Epoch13 layer4 Acc 0.8784, AUC 0.9460818767547607, avg_entr 0.02369397133588791, f1 0.8784000277519226
ep13_l4_test_time 0.8465008735656738
gc 0
Train Epoch14 Acc 0.973975 (38959/40000), AUC 0.9960182309150696
ep14_train_time 12.637242794036865
Test Epoch14 layer4 Acc 0.8748, AUC 0.9414290189743042, avg_entr 0.019971750676631927, f1 0.8748000264167786
ep14_l4_test_time 0.8655135631561279
gc 0
Train Epoch15 Acc 0.9756 (39024/40000), AUC 0.9962631464004517
ep15_train_time 12.472386360168457
Test Epoch15 layer4 Acc 0.8732, AUC 0.9419238567352295, avg_entr 0.02138020098209381, f1 0.873199999332428
ep15_l4_test_time 0.8536839485168457
gc 0
Train Epoch16 Acc 0.97825 (39130/40000), AUC 0.9967118501663208
ep16_train_time 12.462580680847168
Test Epoch16 layer4 Acc 0.8714, AUC 0.9383896589279175, avg_entr 0.018340589478611946, f1 0.871399998664856
ep16_l4_test_time 0.7909069061279297
gc 0
Train Epoch17 Acc 0.978775 (39151/40000), AUC 0.9969953298568726
ep17_train_time 11.72541093826294
Test Epoch17 layer4 Acc 0.8696, AUC 0.9351606965065002, avg_entr 0.018791137263178825, f1 0.8695999383926392
ep17_l4_test_time 0.801039457321167
gc 0
Train Epoch18 Acc 0.97995 (39198/40000), AUC 0.997383177280426
ep18_train_time 12.18802285194397
Test Epoch18 layer4 Acc 0.8652, AUC 0.9347150325775146, avg_entr 0.017848486080765724, f1 0.8652000427246094
ep18_l4_test_time 1.0952301025390625
gc 0
Train Epoch19 Acc 0.981475 (39259/40000), AUC 0.9976420402526855
ep19_train_time 13.129427909851074
Test Epoch19 layer4 Acc 0.8622, AUC 0.9319071769714355, avg_entr 0.01673045940697193, f1 0.8622000217437744
ep19_l4_test_time 0.8040227890014648
gc 0
Train Epoch20 Acc 0.982675 (39307/40000), AUC 0.9978457689285278
ep20_train_time 12.255690574645996
Test Epoch20 layer4 Acc 0.8586, AUC 0.9293908476829529, avg_entr 0.01572609692811966, f1 0.8586000204086304
ep20_l4_test_time 0.8083720207214355
gc 0
Train Epoch21 Acc 0.983 (39320/40000), AUC 0.9979639053344727
ep21_train_time 12.505030155181885
Test Epoch21 layer4 Acc 0.8544, AUC 0.929291844367981, avg_entr 0.01540442369878292, f1 0.8543999791145325
ep21_l4_test_time 0.8399958610534668
gc 0
Train Epoch22 Acc 0.9831 (39324/40000), AUC 0.9982137680053711
ep22_train_time 12.619236946105957
Test Epoch22 layer4 Acc 0.856, AUC 0.9261615872383118, avg_entr 0.01361831370741129, f1 0.8560000061988831
ep22_l4_test_time 0.8038442134857178
gc 0
Train Epoch23 Acc 0.985025 (39401/40000), AUC 0.9984673261642456
ep23_train_time 12.388999700546265
Test Epoch23 layer4 Acc 0.8546, AUC 0.9243111610412598, avg_entr 0.012827856466174126, f1 0.8546000123023987
ep23_l4_test_time 0.7791244983673096
gc 0
Train Epoch24 Acc 0.9856 (39424/40000), AUC 0.9984622001647949
ep24_train_time 8.113491773605347
Test Epoch24 layer4 Acc 0.8536, AUC 0.921495795249939, avg_entr 0.011769015341997147, f1 0.853600025177002
ep24_l4_test_time 0.6159169673919678
gc 0
Train Epoch25 Acc 0.9865 (39460/40000), AUC 0.9985330104827881
ep25_train_time 8.02351188659668
Test Epoch25 layer4 Acc 0.8502, AUC 0.9209061861038208, avg_entr 0.015201780945062637, f1 0.8501999974250793
ep25_l4_test_time 0.624469518661499
gc 0
Train Epoch26 Acc 0.986825 (39473/40000), AUC 0.9987313151359558
ep26_train_time 7.892036199569702
Test Epoch26 layer4 Acc 0.8452, AUC 0.9183339476585388, avg_entr 0.013996116816997528, f1 0.8452000021934509
ep26_l4_test_time 0.6166515350341797
gc 0
Train Epoch27 Acc 0.987625 (39505/40000), AUC 0.9987525939941406
ep27_train_time 8.046606063842773
Test Epoch27 layer4 Acc 0.8482, AUC 0.9161653518676758, avg_entr 0.011748125776648521, f1 0.8482000231742859
ep27_l4_test_time 0.6118979454040527
gc 0
Train Epoch28 Acc 0.988025 (39521/40000), AUC 0.9987509250640869
ep28_train_time 7.907007217407227
Test Epoch28 layer4 Acc 0.845, AUC 0.9149574041366577, avg_entr 0.011767295189201832, f1 0.8449999690055847
ep28_l4_test_time 0.6401839256286621
gc 0
Train Epoch29 Acc 0.98825 (39530/40000), AUC 0.9989415407180786
ep29_train_time 7.412328243255615
Test Epoch29 layer4 Acc 0.8408, AUC 0.9132228493690491, avg_entr 0.01195542048662901, f1 0.8408000469207764
ep29_l4_test_time 0.5990936756134033
Best AUC tensor(0.8990) 4
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 374.4836850166321
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8928, AUC 0.956211507320404, avg_entr 0.17741745710372925, f1 0.892799973487854
l0_test_time 0.5851686000823975
Test layer1 Acc 0.8926, AUC 0.9564542770385742, avg_entr 0.1547205150127411, f1 0.8925999999046326
l1_test_time 0.5918786525726318
Test layer2 Acc 0.8944, AUC 0.9571024179458618, avg_entr 0.15124039351940155, f1 0.8944000005722046
l2_test_time 0.621924638748169
Test layer3 Acc 0.8948, AUC 0.9573390483856201, avg_entr 0.13174255192279816, f1 0.8948000073432922
l3_test_time 0.6490130424499512
Test layer4 Acc 0.895, AUC 0.9574793577194214, avg_entr 0.09482827037572861, f1 0.8949999809265137
l4_test_time 0.5938806533813477
