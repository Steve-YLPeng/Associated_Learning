total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 22.839076042175293
Start Training
gc 0
Train Epoch0 Acc 0.5029 (20116/40000), AUC 0.5008594393730164
ep0_train_time 12.255755186080933
Test Epoch0 layer4 Acc 0.5, AUC 0.6907201409339905, avg_entr 0.6825092434883118, f1 0.5
ep0_l4_test_time 0.7762784957885742
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.8189 (32756/40000), AUC 0.8959913849830627
ep1_train_time 11.133342742919922
Test Epoch1 layer4 Acc 0.88, AUC 0.9462848901748657, avg_entr 0.23643037676811218, f1 0.8799999952316284
ep1_l4_test_time 0.7594788074493408
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.907475 (36299/40000), AUC 0.9650403261184692
ep2_train_time 11.064820289611816
Test Epoch2 layer4 Acc 0.8932, AUC 0.9559013843536377, avg_entr 0.16921210289001465, f1 0.8931999802589417
ep2_l4_test_time 0.7779183387756348
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.922675 (36907/40000), AUC 0.9754902124404907
ep3_train_time 11.173063278198242
Test Epoch3 layer4 Acc 0.897, AUC 0.9588512182235718, avg_entr 0.13057874143123627, f1 0.8970000147819519
ep3_l4_test_time 0.7674448490142822
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.934625 (37385/40000), AUC 0.9815553426742554
ep4_train_time 11.189480304718018
Test Epoch4 layer4 Acc 0.8988, AUC 0.9604383111000061, avg_entr 0.09607063233852386, f1 0.8988000154495239
ep4_l4_test_time 0.7842252254486084
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9424 (37696/40000), AUC 0.9852036237716675
ep5_train_time 11.125248432159424
Test Epoch5 layer4 Acc 0.8974, AUC 0.9606128931045532, avg_entr 0.06498470902442932, f1 0.8974000215530396
ep5_l4_test_time 0.7738325595855713
gc 0
Train Epoch6 Acc 0.9489 (37956/40000), AUC 0.9879353046417236
ep6_train_time 11.149892091751099
Test Epoch6 layer4 Acc 0.8958, AUC 0.9591550827026367, avg_entr 0.05341462418437004, f1 0.895799994468689
ep6_l4_test_time 0.7693758010864258
gc 0
Train Epoch7 Acc 0.95425 (38170/40000), AUC 0.9893828630447388
ep7_train_time 11.15296983718872
Test Epoch7 layer4 Acc 0.8906, AUC 0.9551851749420166, avg_entr 0.042087260633707047, f1 0.8906000256538391
ep7_l4_test_time 0.7685387134552002
gc 0
Train Epoch8 Acc 0.959225 (38369/40000), AUC 0.9910920858383179
ep8_train_time 10.718682527542114
Test Epoch8 layer4 Acc 0.8954, AUC 0.9529635906219482, avg_entr 0.036994148045778275, f1 0.8953999876976013
ep8_l4_test_time 0.7606210708618164
gc 0
Train Epoch9 Acc 0.962025 (38481/40000), AUC 0.9920107126235962
ep9_train_time 11.137568950653076
Test Epoch9 layer4 Acc 0.8818, AUC 0.9501322507858276, avg_entr 0.03756105899810791, f1 0.8818000555038452
ep9_l4_test_time 0.762904167175293
gc 0
Train Epoch10 Acc 0.965175 (38607/40000), AUC 0.9934123158454895
ep10_train_time 11.058149099349976
Test Epoch10 layer4 Acc 0.8818, AUC 0.9486371278762817, avg_entr 0.031169695779681206, f1 0.8818000555038452
ep10_l4_test_time 0.7357943058013916
gc 0
Train Epoch11 Acc 0.968525 (38741/40000), AUC 0.9941518306732178
ep11_train_time 11.155630588531494
Test Epoch11 layer4 Acc 0.8818, AUC 0.9478396773338318, avg_entr 0.028182772919535637, f1 0.8818000555038452
ep11_l4_test_time 0.7644085884094238
gc 0
Train Epoch12 Acc 0.970675 (38827/40000), AUC 0.9948666095733643
ep12_train_time 11.190524101257324
Test Epoch12 layer4 Acc 0.8804, AUC 0.9436790943145752, avg_entr 0.024495719000697136, f1 0.8804000020027161
ep12_l4_test_time 0.7796869277954102
gc 0
Train Epoch13 Acc 0.97225 (38890/40000), AUC 0.9956698417663574
ep13_train_time 11.108513116836548
Test Epoch13 layer4 Acc 0.8752, AUC 0.9447182416915894, avg_entr 0.023283785209059715, f1 0.8751999735832214
ep13_l4_test_time 0.7731888294219971
gc 0
Train Epoch14 Acc 0.9743 (38972/40000), AUC 0.9959924221038818
ep14_train_time 11.105594396591187
Test Epoch14 layer4 Acc 0.8722, AUC 0.9389336109161377, avg_entr 0.02191893570125103, f1 0.872200071811676
ep14_l4_test_time 0.7530312538146973
gc 0
Train Epoch15 Acc 0.976375 (39055/40000), AUC 0.996430516242981
ep15_train_time 11.206512689590454
Test Epoch15 layer4 Acc 0.8716, AUC 0.9393956661224365, avg_entr 0.02195693925023079, f1 0.8715999722480774
ep15_l4_test_time 0.7813191413879395
gc 0
Train Epoch16 Acc 0.977325 (39093/40000), AUC 0.9968809485435486
ep16_train_time 11.14997148513794
Test Epoch16 layer4 Acc 0.8588, AUC 0.9343681335449219, avg_entr 0.021511714905500412, f1 0.8587999939918518
ep16_l4_test_time 0.7629859447479248
gc 0
Train Epoch17 Acc 0.97785 (39114/40000), AUC 0.9970937967300415
ep17_train_time 11.105088233947754
Test Epoch17 layer4 Acc 0.8604, AUC 0.9340229034423828, avg_entr 0.018283048644661903, f1 0.8604000210762024
ep17_l4_test_time 0.7414717674255371
gc 0
Train Epoch18 Acc 0.979025 (39161/40000), AUC 0.9972224235534668
ep18_train_time 11.126870155334473
Test Epoch18 layer4 Acc 0.8536, AUC 0.928443431854248, avg_entr 0.019387103617191315, f1 0.853600025177002
ep18_l4_test_time 0.7465803623199463
gc 0
Train Epoch19 Acc 0.9803 (39212/40000), AUC 0.9976711273193359
ep19_train_time 10.670611381530762
Test Epoch19 layer4 Acc 0.8638, AUC 0.930152952671051, avg_entr 0.018069034442305565, f1 0.8637999892234802
ep19_l4_test_time 0.772740364074707
gc 0
Train Epoch20 Acc 0.98185 (39274/40000), AUC 0.9978466629981995
ep20_train_time 11.142291069030762
Test Epoch20 layer4 Acc 0.8602, AUC 0.9255362749099731, avg_entr 0.016925819218158722, f1 0.8601999878883362
ep20_l4_test_time 0.7653083801269531
gc 0
Train Epoch21 Acc 0.982675 (39307/40000), AUC 0.9979588985443115
ep21_train_time 11.11928653717041
Test Epoch21 layer4 Acc 0.858, AUC 0.924761950969696, avg_entr 0.014463154599070549, f1 0.8579999804496765
ep21_l4_test_time 0.7691478729248047
gc 0
Train Epoch22 Acc 0.983475 (39339/40000), AUC 0.9981151223182678
ep22_train_time 11.158651351928711
Test Epoch22 layer4 Acc 0.8546, AUC 0.922174334526062, avg_entr 0.01735716126859188, f1 0.8546000123023987
ep22_l4_test_time 0.7753643989562988
gc 0
Train Epoch23 Acc 0.983625 (39345/40000), AUC 0.9982976317405701
ep23_train_time 11.054144382476807
Test Epoch23 layer4 Acc 0.8542, AUC 0.923244059085846, avg_entr 0.013598578982055187, f1 0.854200005531311
ep23_l4_test_time 0.7689108848571777
gc 0
Train Epoch24 Acc 0.9849 (39396/40000), AUC 0.9983823299407959
ep24_train_time 11.037336349487305
Test Epoch24 layer4 Acc 0.8508, AUC 0.9192700386047363, avg_entr 0.015162866562604904, f1 0.8507999777793884
ep24_l4_test_time 0.7610008716583252
gc 0
Train Epoch25 Acc 0.98555 (39422/40000), AUC 0.998574435710907
ep25_train_time 11.137655973434448
Test Epoch25 layer4 Acc 0.8478, AUC 0.9176169633865356, avg_entr 0.013285448774695396, f1 0.8477999567985535
ep25_l4_test_time 0.7574570178985596
gc 0
Train Epoch26 Acc 0.9861 (39444/40000), AUC 0.9986053705215454
ep26_train_time 11.090498208999634
Test Epoch26 layer4 Acc 0.8462, AUC 0.9164732694625854, avg_entr 0.015180305577814579, f1 0.8461999893188477
ep26_l4_test_time 0.7627067565917969
gc 0
Train Epoch27 Acc 0.9866 (39464/40000), AUC 0.9986962080001831
ep27_train_time 11.116604566574097
Test Epoch27 layer4 Acc 0.8466, AUC 0.9148095846176147, avg_entr 0.014021326787769794, f1 0.8465999960899353
ep27_l4_test_time 0.768690824508667
gc 0
Train Epoch28 Acc 0.986775 (39471/40000), AUC 0.9987626671791077
ep28_train_time 11.132982730865479
Test Epoch28 layer4 Acc 0.8422, AUC 0.9137144088745117, avg_entr 0.01267162710428238, f1 0.842199981212616
ep28_l4_test_time 0.7821698188781738
gc 0
Train Epoch29 Acc 0.987425 (39497/40000), AUC 0.9988886117935181
ep29_train_time 11.115802764892578
Test Epoch29 layer4 Acc 0.8364, AUC 0.9148896932601929, avg_entr 0.012448843568563461, f1 0.8363999724388123
ep29_l4_test_time 0.7508728504180908
Best AUC tensor(0.8988) 4
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 358.72428798675537
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8974, AUC 0.9561915397644043, avg_entr 0.17886288464069366, f1 0.8974000215530396
l0_test_time 0.7518658638000488
Test layer1 Acc 0.8984, AUC 0.9565998315811157, avg_entr 0.16019350290298462, f1 0.8984000086784363
l1_test_time 0.7500784397125244
Test layer2 Acc 0.8984, AUC 0.9571384787559509, avg_entr 0.14777004718780518, f1 0.8984000086784363
l2_test_time 0.7520630359649658
Test layer3 Acc 0.8954, AUC 0.9575704336166382, avg_entr 0.13015154004096985, f1 0.8953999876976013
l3_test_time 0.7554614543914795
Test layer4 Acc 0.8968, AUC 0.9576830863952637, avg_entr 0.09988976269960403, f1 0.8967999815940857
l4_test_time 0.766726016998291
