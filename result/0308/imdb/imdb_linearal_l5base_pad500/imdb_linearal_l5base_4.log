total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 23.515719890594482
Start Training
gc 0
Train Epoch0 Acc 0.51045 (20418/40000), AUC 0.5194988250732422
ep0_train_time 12.595553398132324
Test Epoch0 layer4 Acc 0.5396, AUC 0.8505597114562988, avg_entr 0.6879479289054871, f1 0.5396000146865845
ep0_l4_test_time 0.7737841606140137
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.829575 (33183/40000), AUC 0.907715380191803
ep1_train_time 11.421079158782959
Test Epoch1 layer4 Acc 0.8842, AUC 0.947156548500061, avg_entr 0.23455573618412018, f1 0.8842000365257263
ep1_l4_test_time 0.7881824970245361
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9061 (36244/40000), AUC 0.9652483463287354
ep2_train_time 11.290685653686523
Test Epoch2 layer4 Acc 0.8746, AUC 0.9556844234466553, avg_entr 0.17801666259765625, f1 0.8745999932289124
ep2_l4_test_time 0.7740867137908936
gc 0
Train Epoch3 Acc 0.922575 (36903/40000), AUC 0.9757388830184937
ep3_train_time 11.319782733917236
Test Epoch3 layer4 Acc 0.8962, AUC 0.959420919418335, avg_entr 0.1247420385479927, f1 0.8962000012397766
ep3_l4_test_time 0.7832531929016113
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9367 (37468/40000), AUC 0.9819861650466919
ep4_train_time 11.172253131866455
Test Epoch4 layer4 Acc 0.8908, AUC 0.9605513215065002, avg_entr 0.08449822664260864, f1 0.8907999992370605
ep4_l4_test_time 0.7781281471252441
gc 0
Train Epoch5 Acc 0.94305 (37722/40000), AUC 0.985115110874176
ep5_train_time 11.393034934997559
Test Epoch5 layer4 Acc 0.8926, AUC 0.9595334529876709, avg_entr 0.057861462235450745, f1 0.8925999999046326
ep5_l4_test_time 0.7781381607055664
gc 0
Train Epoch6 Acc 0.94935 (37974/40000), AUC 0.9874013066291809
ep6_train_time 11.376227855682373
Test Epoch6 layer4 Acc 0.8938, AUC 0.9564460515975952, avg_entr 0.046782951802015305, f1 0.8938000202178955
ep6_l4_test_time 0.762901782989502
gc 0
Train Epoch7 Acc 0.954225 (38169/40000), AUC 0.989374577999115
ep7_train_time 11.381728887557983
Test Epoch7 layer4 Acc 0.8718, AUC 0.9486720561981201, avg_entr 0.04115598276257515, f1 0.8718000650405884
ep7_l4_test_time 0.7764215469360352
gc 0
Train Epoch8 Acc 0.957825 (38313/40000), AUC 0.9905185699462891
ep8_train_time 11.343336343765259
Test Epoch8 layer4 Acc 0.894, AUC 0.9518712759017944, avg_entr 0.033288754522800446, f1 0.8939999938011169
ep8_l4_test_time 0.7793185710906982
gc 0
Train Epoch9 Acc 0.962325 (38493/40000), AUC 0.992121696472168
ep9_train_time 11.340457916259766
Test Epoch9 layer4 Acc 0.8926, AUC 0.9503540396690369, avg_entr 0.03157780319452286, f1 0.8925999999046326
ep9_l4_test_time 0.7713634967803955
gc 0
Train Epoch10 Acc 0.9653 (38612/40000), AUC 0.9932100772857666
ep10_train_time 11.276505708694458
Test Epoch10 layer4 Acc 0.885, AUC 0.9482601881027222, avg_entr 0.02896934188902378, f1 0.8849999904632568
ep10_l4_test_time 0.7907392978668213
gc 0
Train Epoch11 Acc 0.9689 (38756/40000), AUC 0.9942978620529175
ep11_train_time 11.333853006362915
Test Epoch11 layer4 Acc 0.8824, AUC 0.9463156461715698, avg_entr 0.02464904822409153, f1 0.8823999762535095
ep11_l4_test_time 0.7811501026153564
gc 0
Train Epoch12 Acc 0.970625 (38825/40000), AUC 0.9949617385864258
ep12_train_time 11.312775373458862
Test Epoch12 layer4 Acc 0.8832, AUC 0.9444446563720703, avg_entr 0.023591842502355576, f1 0.8831999897956848
ep12_l4_test_time 0.7856488227844238
gc 0
Train Epoch13 Acc 0.972375 (38895/40000), AUC 0.9955592155456543
ep13_train_time 11.127339124679565
Test Epoch13 layer4 Acc 0.8774, AUC 0.9442680478096008, avg_entr 0.022631395608186722, f1 0.8773999810218811
ep13_l4_test_time 0.7769348621368408
gc 0
Train Epoch14 Acc 0.974325 (38973/40000), AUC 0.9958827495574951
ep14_train_time 11.350685119628906
Test Epoch14 layer4 Acc 0.8726, AUC 0.9398810267448425, avg_entr 0.022510236129164696, f1 0.8726000189781189
ep14_l4_test_time 0.7901012897491455
gc 0
Train Epoch15 Acc 0.975525 (39021/40000), AUC 0.9964053630828857
ep15_train_time 11.30539608001709
Test Epoch15 layer4 Acc 0.8664, AUC 0.9392780065536499, avg_entr 0.02055836096405983, f1 0.8664000034332275
ep15_l4_test_time 0.783928394317627
gc 0
Train Epoch16 Acc 0.977675 (39107/40000), AUC 0.9968087673187256
ep16_train_time 11.374373197555542
Test Epoch16 layer4 Acc 0.868, AUC 0.9372154474258423, avg_entr 0.019314158707857132, f1 0.8679999709129333
ep16_l4_test_time 0.7773158550262451
gc 0
Train Epoch17 Acc 0.9782 (39128/40000), AUC 0.9967734813690186
ep17_train_time 11.332353830337524
Test Epoch17 layer4 Acc 0.8644, AUC 0.9320785999298096, avg_entr 0.01872444525361061, f1 0.8644000291824341
ep17_l4_test_time 0.7726948261260986
gc 0
Train Epoch18 Acc 0.980425 (39217/40000), AUC 0.9973441958427429
ep18_train_time 11.359193801879883
Test Epoch18 layer4 Acc 0.865, AUC 0.9314366579055786, avg_entr 0.019462130963802338, f1 0.8650000095367432
ep18_l4_test_time 0.784869909286499
gc 0
Train Epoch19 Acc 0.98075 (39230/40000), AUC 0.9974981546401978
ep19_train_time 11.37109923362732
Test Epoch19 layer4 Acc 0.8598, AUC 0.9271245002746582, avg_entr 0.017314789816737175, f1 0.8597999811172485
ep19_l4_test_time 0.7821023464202881
gc 0
Train Epoch20 Acc 0.982175 (39287/40000), AUC 0.997769832611084
ep20_train_time 11.363499641418457
Test Epoch20 layer4 Acc 0.8584, AUC 0.9252781867980957, avg_entr 0.01471825409680605, f1 0.8583999872207642
ep20_l4_test_time 0.7656891345977783
gc 0
Train Epoch21 Acc 0.982325 (39293/40000), AUC 0.9980517625808716
ep21_train_time 11.333038806915283
Test Epoch21 layer4 Acc 0.8534, AUC 0.9227179288864136, avg_entr 0.014291034080088139, f1 0.8533999919891357
ep21_l4_test_time 0.7821896076202393
gc 0
Train Epoch22 Acc 0.983375 (39335/40000), AUC 0.9981421232223511
ep22_train_time 11.149135828018188
Test Epoch22 layer4 Acc 0.8544, AUC 0.9210072755813599, avg_entr 0.015529515221714973, f1 0.8543999791145325
ep22_l4_test_time 0.7692070007324219
gc 0
Train Epoch23 Acc 0.98425 (39370/40000), AUC 0.9982432723045349
ep23_train_time 11.399035930633545
Test Epoch23 layer4 Acc 0.8488, AUC 0.9207800626754761, avg_entr 0.014937622472643852, f1 0.848800003528595
ep23_l4_test_time 0.7849712371826172
gc 0
Train Epoch24 Acc 0.9849 (39396/40000), AUC 0.998374342918396
ep24_train_time 11.334143877029419
Test Epoch24 layer4 Acc 0.847, AUC 0.9178166389465332, avg_entr 0.012389273382723331, f1 0.847000002861023
ep24_l4_test_time 0.7807304859161377
gc 0
Train Epoch25 Acc 0.986225 (39449/40000), AUC 0.9985209703445435
ep25_train_time 11.401904821395874
Test Epoch25 layer4 Acc 0.8426, AUC 0.9166003465652466, avg_entr 0.013639518991112709, f1 0.8426000475883484
ep25_l4_test_time 0.7698976993560791
gc 0
Train Epoch26 Acc 0.98585 (39434/40000), AUC 0.9986811280250549
ep26_train_time 11.41573977470398
Test Epoch26 layer4 Acc 0.848, AUC 0.9132484197616577, avg_entr 0.013556286692619324, f1 0.8479999899864197
ep26_l4_test_time 0.7538981437683105
gc 0
Train Epoch27 Acc 0.9869 (39476/40000), AUC 0.998798131942749
ep27_train_time 11.411107301712036
Test Epoch27 layer4 Acc 0.8428, AUC 0.9110697507858276, avg_entr 0.011945012025535107, f1 0.8428000211715698
ep27_l4_test_time 0.7715966701507568
gc 0
Train Epoch28 Acc 0.9873 (39492/40000), AUC 0.9988073110580444
ep28_train_time 11.407262325286865
Test Epoch28 layer4 Acc 0.8392, AUC 0.9104411005973816, avg_entr 0.011070603504776955, f1 0.8392000198364258
ep28_l4_test_time 0.7882757186889648
gc 0
Train Epoch29 Acc 0.987525 (39501/40000), AUC 0.9988309741020203
ep29_train_time 11.30616283416748
Test Epoch29 layer4 Acc 0.8334, AUC 0.9098073840141296, avg_entr 0.012504220008850098, f1 0.8334000110626221
ep29_l4_test_time 0.7935349941253662
Best AUC tensor(0.8962) 3
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 366.20400977134705
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8886, AUC 0.9558440446853638, avg_entr 0.1926513910293579, f1 0.8885999917984009
l0_test_time 0.7641463279724121
Test layer1 Acc 0.8934, AUC 0.9561659097671509, avg_entr 0.1783939152956009, f1 0.8934000134468079
l1_test_time 0.7736904621124268
Test layer2 Acc 0.8934, AUC 0.9563379287719727, avg_entr 0.1595643013715744, f1 0.8934000134468079
l2_test_time 0.7921249866485596
Test layer3 Acc 0.8942, AUC 0.9564720988273621, avg_entr 0.14878970384597778, f1 0.8942000269889832
l3_test_time 0.7717845439910889
Test layer4 Acc 0.8938, AUC 0.9567781686782837, avg_entr 0.1258287876844406, f1 0.8938000202178955
l4_test_time 0.7791633605957031
