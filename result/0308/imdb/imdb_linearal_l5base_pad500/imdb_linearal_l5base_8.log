total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 22.861124753952026
Start Training
gc 0
Train Epoch0 Acc 0.51445 (20578/40000), AUC 0.5182178616523743
ep0_train_time 12.242804050445557
Test Epoch0 layer4 Acc 0.5388, AUC 0.8397801518440247, avg_entr 0.6889677047729492, f1 0.5388000011444092
ep0_l4_test_time 0.7638015747070312
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.81765 (32706/40000), AUC 0.8995317220687866
ep1_train_time 11.08534550666809
Test Epoch1 layer4 Acc 0.87, AUC 0.9465137720108032, avg_entr 0.2408037781715393, f1 0.8700000047683716
ep1_l4_test_time 0.7581460475921631
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.905025 (36201/40000), AUC 0.9645664691925049
ep2_train_time 11.09522294998169
Test Epoch2 layer4 Acc 0.893, AUC 0.9563184976577759, avg_entr 0.1758752018213272, f1 0.8930000066757202
ep2_l4_test_time 0.7452330589294434
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.923125 (36925/40000), AUC 0.975498616695404
ep3_train_time 10.718304634094238
Test Epoch3 layer4 Acc 0.8898, AUC 0.9594506621360779, avg_entr 0.1295391470193863, f1 0.8898000121116638
ep3_l4_test_time 0.7528376579284668
gc 0
Train Epoch4 Acc 0.93505 (37402/40000), AUC 0.9812600016593933
ep4_train_time 11.063336610794067
Test Epoch4 layer4 Acc 0.896, AUC 0.9610409736633301, avg_entr 0.09742192924022675, f1 0.8960000276565552
ep4_l4_test_time 0.7606210708618164
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.941325 (37653/40000), AUC 0.9842917919158936
ep5_train_time 11.129028558731079
Test Epoch5 layer4 Acc 0.8964, AUC 0.9609189033508301, avg_entr 0.0710141658782959, f1 0.896399974822998
ep5_l4_test_time 0.7805626392364502
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.94855 (37942/40000), AUC 0.9873789548873901
ep6_train_time 11.084202527999878
Test Epoch6 layer4 Acc 0.8978, AUC 0.9587777853012085, avg_entr 0.05174043029546738, f1 0.8978000283241272
ep6_l4_test_time 0.7701961994171143
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.954 (38160/40000), AUC 0.9889829158782959
ep7_train_time 11.065626621246338
Test Epoch7 layer4 Acc 0.8962, AUC 0.9545913934707642, avg_entr 0.04228759557008743, f1 0.8962000012397766
ep7_l4_test_time 0.7613868713378906
gc 0
Train Epoch8 Acc 0.9584 (38336/40000), AUC 0.9908236861228943
ep8_train_time 11.10694146156311
Test Epoch8 layer4 Acc 0.894, AUC 0.9539370536804199, avg_entr 0.03614126890897751, f1 0.8939999938011169
ep8_l4_test_time 0.7788271903991699
gc 0
Train Epoch9 Acc 0.961025 (38441/40000), AUC 0.9919908046722412
ep9_train_time 11.332154989242554
Test Epoch9 layer4 Acc 0.8866, AUC 0.9498090744018555, avg_entr 0.03708769008517265, f1 0.8866000771522522
ep9_l4_test_time 0.7696881294250488
gc 0
Train Epoch10 Acc 0.9646 (38584/40000), AUC 0.9932347536087036
ep10_train_time 11.112308263778687
Test Epoch10 layer4 Acc 0.8868, AUC 0.9490298628807068, avg_entr 0.029593192040920258, f1 0.8867999911308289
ep10_l4_test_time 0.7609686851501465
gc 0
Train Epoch11 Acc 0.967725 (38709/40000), AUC 0.9941209554672241
ep11_train_time 11.149441242218018
Test Epoch11 layer4 Acc 0.8824, AUC 0.9472061991691589, avg_entr 0.027921266853809357, f1 0.8823999762535095
ep11_l4_test_time 0.7625508308410645
gc 0
Train Epoch12 Acc 0.9702 (38808/40000), AUC 0.9947769045829773
ep12_train_time 11.11843752861023
Test Epoch12 layer4 Acc 0.8812, AUC 0.9460899829864502, avg_entr 0.02443534880876541, f1 0.8812000155448914
ep12_l4_test_time 0.7853152751922607
gc 0
Train Epoch13 Acc 0.97205 (38882/40000), AUC 0.9953184723854065
ep13_train_time 11.145241498947144
Test Epoch13 layer4 Acc 0.8778, AUC 0.9470008015632629, avg_entr 0.024950584396719933, f1 0.8778000473976135
ep13_l4_test_time 0.7586431503295898
gc 0
Train Epoch14 Acc 0.974225 (38969/40000), AUC 0.9959376454353333
ep14_train_time 10.704292058944702
Test Epoch14 layer4 Acc 0.8668, AUC 0.9409483075141907, avg_entr 0.026121923699975014, f1 0.8668000102043152
ep14_l4_test_time 0.7754571437835693
gc 0
Train Epoch15 Acc 0.9751 (39004/40000), AUC 0.9963103532791138
ep15_train_time 11.110298871994019
Test Epoch15 layer4 Acc 0.871, AUC 0.9398133754730225, avg_entr 0.022333942353725433, f1 0.8709999918937683
ep15_l4_test_time 0.7684764862060547
gc 0
Train Epoch16 Acc 0.9764 (39056/40000), AUC 0.9966903924942017
ep16_train_time 11.110218048095703
Test Epoch16 layer4 Acc 0.8662, AUC 0.9364807605743408, avg_entr 0.020749233663082123, f1 0.8661999702453613
ep16_l4_test_time 0.7598240375518799
gc 0
Train Epoch17 Acc 0.97805 (39122/40000), AUC 0.9970135688781738
ep17_train_time 11.103144645690918
Test Epoch17 layer4 Acc 0.864, AUC 0.9330552816390991, avg_entr 0.020858479663729668, f1 0.8640000224113464
ep17_l4_test_time 0.7724196910858154
gc 0
Train Epoch18 Acc 0.9796 (39184/40000), AUC 0.9972257614135742
ep18_train_time 11.053492069244385
Test Epoch18 layer4 Acc 0.8668, AUC 0.9288910627365112, avg_entr 0.019631406292319298, f1 0.8668000102043152
ep18_l4_test_time 0.7903056144714355
gc 0
Train Epoch19 Acc 0.980975 (39239/40000), AUC 0.9975384473800659
ep19_train_time 11.043063879013062
Test Epoch19 layer4 Acc 0.8616, AUC 0.9276554584503174, avg_entr 0.016349133104085922, f1 0.8615999817848206
ep19_l4_test_time 0.7642850875854492
gc 0
Train Epoch20 Acc 0.98175 (39270/40000), AUC 0.9978125691413879
ep20_train_time 11.172372817993164
Test Epoch20 layer4 Acc 0.8622, AUC 0.9239605665206909, avg_entr 0.01925044320523739, f1 0.8622000217437744
ep20_l4_test_time 0.7503159046173096
gc 0
Train Epoch21 Acc 0.981975 (39279/40000), AUC 0.9978370070457458
ep21_train_time 11.095521688461304
Test Epoch21 layer4 Acc 0.8562, AUC 0.9215440154075623, avg_entr 0.015175587497651577, f1 0.8561999797821045
ep21_l4_test_time 0.7680039405822754
gc 0
Train Epoch22 Acc 0.9827 (39308/40000), AUC 0.9979701042175293
ep22_train_time 11.065893650054932
Test Epoch22 layer4 Acc 0.8546, AUC 0.918644905090332, avg_entr 0.015327487140893936, f1 0.8546000123023987
ep22_l4_test_time 0.7628376483917236
gc 0
Train Epoch23 Acc 0.98345 (39338/40000), AUC 0.9981493949890137
ep23_train_time 11.072036981582642
Test Epoch23 layer4 Acc 0.848, AUC 0.9178815484046936, avg_entr 0.016078032553195953, f1 0.8479999899864197
ep23_l4_test_time 0.739922285079956
gc 0
Train Epoch24 Acc 0.9848 (39392/40000), AUC 0.9983446002006531
ep24_train_time 11.011339902877808
Test Epoch24 layer4 Acc 0.849, AUC 0.9166793823242188, avg_entr 0.014620816335082054, f1 0.8489999771118164
ep24_l4_test_time 0.7648758888244629
gc 0
Train Epoch25 Acc 0.98525 (39410/40000), AUC 0.9983504414558411
ep25_train_time 10.900726795196533
Test Epoch25 layer4 Acc 0.8512, AUC 0.9108675718307495, avg_entr 0.014928528107702732, f1 0.8511999845504761
ep25_l4_test_time 0.7640492916107178
gc 0
Train Epoch26 Acc 0.98555 (39422/40000), AUC 0.9984999895095825
ep26_train_time 11.156646728515625
Test Epoch26 layer4 Acc 0.8478, AUC 0.9079347848892212, avg_entr 0.015071072615683079, f1 0.8477999567985535
ep26_l4_test_time 0.7712979316711426
gc 0
Train Epoch27 Acc 0.986625 (39465/40000), AUC 0.9986577033996582
ep27_train_time 11.150517702102661
Test Epoch27 layer4 Acc 0.8476, AUC 0.9065948128700256, avg_entr 0.014144857414066792, f1 0.847599983215332
ep27_l4_test_time 0.77144455909729
gc 0
Train Epoch28 Acc 0.98685 (39474/40000), AUC 0.9989134669303894
ep28_train_time 11.108567953109741
Test Epoch28 layer4 Acc 0.8434, AUC 0.9051088690757751, avg_entr 0.013655385002493858, f1 0.8434000015258789
ep28_l4_test_time 0.7708709239959717
gc 0
Train Epoch29 Acc 0.987625 (39505/40000), AUC 0.9988166093826294
ep29_train_time 11.204878330230713
Test Epoch29 layer4 Acc 0.8426, AUC 0.9019392728805542, avg_entr 0.013567542657256126, f1 0.8426000475883484
ep29_l4_test_time 0.769751787185669
Best AUC tensor(0.8978) 6
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 358.2173755168915
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.892, AUC 0.9534485340118408, avg_entr 0.1544400453567505, f1 0.8920000195503235
l0_test_time 0.7754487991333008
Test layer1 Acc 0.8914, AUC 0.9540767669677734, avg_entr 0.13672281801700592, f1 0.8913999795913696
l1_test_time 0.7483413219451904
Test layer2 Acc 0.892, AUC 0.95479816198349, avg_entr 0.12279301881790161, f1 0.8920000195503235
l2_test_time 0.7827348709106445
Test layer3 Acc 0.8908, AUC 0.9554581046104431, avg_entr 0.08695916831493378, f1 0.8907999992370605
l3_test_time 0.7665565013885498
Test layer4 Acc 0.8906, AUC 0.9530906677246094, avg_entr 0.05662430450320244, f1 0.8906000256538391
l4_test_time 0.7752485275268555
