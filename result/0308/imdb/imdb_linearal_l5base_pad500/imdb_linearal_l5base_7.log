total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 22.93680500984192
Start Training
gc 0
Train Epoch0 Acc 0.5076 (20304/40000), AUC 0.5104377865791321
ep0_train_time 12.142345905303955
Test Epoch0 layer4 Acc 0.5006, AUC 0.8235695362091064, avg_entr 0.6667608618736267, f1 0.5005999803543091
ep0_l4_test_time 0.7674634456634521
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.8308 (33232/40000), AUC 0.9025990962982178
ep1_train_time 11.153691291809082
Test Epoch1 layer4 Acc 0.855, AUC 0.9442607760429382, avg_entr 0.21661323308944702, f1 0.8550000190734863
ep1_l4_test_time 0.7757220268249512
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.903325 (36133/40000), AUC 0.9645500779151917
ep2_train_time 11.093656301498413
Test Epoch2 layer4 Acc 0.8926, AUC 0.9559510946273804, avg_entr 0.16709375381469727, f1 0.8925999999046326
ep2_l4_test_time 0.766291618347168
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.923375 (36935/40000), AUC 0.9756135940551758
ep3_train_time 11.175392627716064
Test Epoch3 layer4 Acc 0.8876, AUC 0.9583572745323181, avg_entr 0.11288044601678848, f1 0.8876000046730042
ep3_l4_test_time 0.760002613067627
gc 0
Train Epoch4 Acc 0.934675 (37387/40000), AUC 0.9815347194671631
ep4_train_time 11.161798238754272
Test Epoch4 layer4 Acc 0.8978, AUC 0.9603126049041748, avg_entr 0.08137104660272598, f1 0.8978000283241272
ep4_l4_test_time 0.781247615814209
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.942375 (37695/40000), AUC 0.985328197479248
ep5_train_time 11.002508163452148
Test Epoch5 layer4 Acc 0.8888, AUC 0.9598995447158813, avg_entr 0.06673755496740341, f1 0.8888000249862671
ep5_l4_test_time 0.7410147190093994
gc 0
Train Epoch6 Acc 0.94725 (37890/40000), AUC 0.9871988296508789
ep6_train_time 10.90620732307434
Test Epoch6 layer4 Acc 0.8866, AUC 0.9571877121925354, avg_entr 0.04964502528309822, f1 0.8866000771522522
ep6_l4_test_time 0.7536396980285645
gc 0
Train Epoch7 Acc 0.953525 (38141/40000), AUC 0.9892556667327881
ep7_train_time 11.14630389213562
Test Epoch7 layer4 Acc 0.8928, AUC 0.9555177092552185, avg_entr 0.04245677962899208, f1 0.892799973487854
ep7_l4_test_time 0.7509841918945312
gc 0
Train Epoch8 Acc 0.957325 (38293/40000), AUC 0.9909753799438477
ep8_train_time 11.165153741836548
Test Epoch8 layer4 Acc 0.8924, AUC 0.953709602355957, avg_entr 0.034492239356040955, f1 0.8923999667167664
ep8_l4_test_time 0.7747337818145752
gc 0
Train Epoch9 Acc 0.962125 (38485/40000), AUC 0.9925937652587891
ep9_train_time 11.119409799575806
Test Epoch9 layer4 Acc 0.888, AUC 0.9515031576156616, avg_entr 0.03225454315543175, f1 0.8880000114440918
ep9_l4_test_time 0.7844107151031494
gc 0
Train Epoch10 Acc 0.9645 (38580/40000), AUC 0.9933680295944214
ep10_train_time 11.127478122711182
Test Epoch10 layer4 Acc 0.888, AUC 0.9507558345794678, avg_entr 0.026956500485539436, f1 0.8880000114440918
ep10_l4_test_time 0.7730205059051514
gc 0
Train Epoch11 Acc 0.967175 (38687/40000), AUC 0.9942682385444641
ep11_train_time 11.167322397232056
Test Epoch11 layer4 Acc 0.8822, AUC 0.9485706686973572, avg_entr 0.028551284223794937, f1 0.8822000026702881
ep11_l4_test_time 0.7778339385986328
gc 0
Train Epoch12 Acc 0.9702 (38808/40000), AUC 0.9952157735824585
ep12_train_time 11.19547176361084
Test Epoch12 layer4 Acc 0.882, AUC 0.9457154273986816, avg_entr 0.02371462620794773, f1 0.8820000290870667
ep12_l4_test_time 0.7747788429260254
gc 0
Train Epoch13 Acc 0.97245 (38898/40000), AUC 0.9958544969558716
ep13_train_time 11.175899028778076
Test Epoch13 layer4 Acc 0.8796, AUC 0.9431344270706177, avg_entr 0.02149386890232563, f1 0.8795999884605408
ep13_l4_test_time 0.775902271270752
gc 0
Train Epoch14 Acc 0.973575 (38943/40000), AUC 0.9960731863975525
ep14_train_time 11.148090600967407
Test Epoch14 layer4 Acc 0.869, AUC 0.9413049221038818, avg_entr 0.024194397032260895, f1 0.8690000176429749
ep14_l4_test_time 0.7868378162384033
gc 0
Train Epoch15 Acc 0.97515 (39006/40000), AUC 0.996790885925293
ep15_train_time 11.199754476547241
Test Epoch15 layer4 Acc 0.8724, AUC 0.9401795864105225, avg_entr 0.0208617951720953, f1 0.8723999857902527
ep15_l4_test_time 0.7663931846618652
gc 0
Train Epoch16 Acc 0.976675 (39067/40000), AUC 0.9970073699951172
ep16_train_time 10.791356801986694
Test Epoch16 layer4 Acc 0.869, AUC 0.9367276430130005, avg_entr 0.017550760880112648, f1 0.8690000176429749
ep16_l4_test_time 0.7502894401550293
gc 0
Train Epoch17 Acc 0.97815 (39126/40000), AUC 0.9973547458648682
ep17_train_time 11.155205726623535
Test Epoch17 layer4 Acc 0.8616, AUC 0.9352571964263916, avg_entr 0.017527960240840912, f1 0.8615999817848206
ep17_l4_test_time 0.7626307010650635
gc 0
Train Epoch18 Acc 0.979725 (39189/40000), AUC 0.9975416660308838
ep18_train_time 11.17628788948059
Test Epoch18 layer4 Acc 0.8602, AUC 0.9339037537574768, avg_entr 0.015680447220802307, f1 0.8601999878883362
ep18_l4_test_time 0.7644350528717041
gc 0
Train Epoch19 Acc 0.98 (39200/40000), AUC 0.9976654648780823
ep19_train_time 11.238120317459106
Test Epoch19 layer4 Acc 0.863, AUC 0.9318833947181702, avg_entr 0.017586257308721542, f1 0.8629999756813049
ep19_l4_test_time 0.7637264728546143
gc 0
Train Epoch20 Acc 0.981625 (39265/40000), AUC 0.9979968667030334
ep20_train_time 11.092050790786743
Test Epoch20 layer4 Acc 0.857, AUC 0.9297008514404297, avg_entr 0.014779282733798027, f1 0.8569999933242798
ep20_l4_test_time 0.7732326984405518
gc 0
Train Epoch21 Acc 0.982325 (39293/40000), AUC 0.9981799125671387
ep21_train_time 11.212105989456177
Test Epoch21 layer4 Acc 0.8552, AUC 0.9277955889701843, avg_entr 0.015423287637531757, f1 0.8551999926567078
ep21_l4_test_time 0.7717993259429932
gc 0
Train Epoch22 Acc 0.983625 (39345/40000), AUC 0.9982516765594482
ep22_train_time 11.143892288208008
Test Epoch22 layer4 Acc 0.8512, AUC 0.9262270927429199, avg_entr 0.014412953518331051, f1 0.8511999845504761
ep22_l4_test_time 0.7772135734558105
gc 0
Train Epoch23 Acc 0.9839 (39356/40000), AUC 0.998551607131958
ep23_train_time 11.160025358200073
Test Epoch23 layer4 Acc 0.8502, AUC 0.9212133288383484, avg_entr 0.013880765065550804, f1 0.8501999974250793
ep23_l4_test_time 0.775123119354248
gc 0
Train Epoch24 Acc 0.984975 (39399/40000), AUC 0.9986082315444946
ep24_train_time 11.05960988998413
Test Epoch24 layer4 Acc 0.8452, AUC 0.920000433921814, avg_entr 0.015695320442318916, f1 0.8452000021934509
ep24_l4_test_time 0.7719800472259521
gc 0
Train Epoch25 Acc 0.985425 (39417/40000), AUC 0.9986331462860107
ep25_train_time 11.162918329238892
Test Epoch25 layer4 Acc 0.8492, AUC 0.9188476800918579, avg_entr 0.0113124530762434, f1 0.8492000102996826
ep25_l4_test_time 0.7701985836029053
gc 0
Train Epoch26 Acc 0.986525 (39461/40000), AUC 0.9987450838088989
ep26_train_time 11.125609636306763
Test Epoch26 layer4 Acc 0.8474, AUC 0.9155520796775818, avg_entr 0.011992114596068859, f1 0.8474000096321106
ep26_l4_test_time 0.7508876323699951
gc 0
Train Epoch27 Acc 0.986625 (39465/40000), AUC 0.9989011287689209
ep27_train_time 10.754997253417969
Test Epoch27 layer4 Acc 0.8458, AUC 0.9127565622329712, avg_entr 0.012463873252272606, f1 0.84579998254776
ep27_l4_test_time 0.7560122013092041
gc 0
Train Epoch28 Acc 0.98655 (39462/40000), AUC 0.9988526105880737
ep28_train_time 11.186641931533813
Test Epoch28 layer4 Acc 0.8426, AUC 0.9115060567855835, avg_entr 0.012269738130271435, f1 0.8426000475883484
ep28_l4_test_time 0.7630136013031006
gc 0
Train Epoch29 Acc 0.98795 (39518/40000), AUC 0.9989570379257202
ep29_train_time 11.111210346221924
Test Epoch29 layer4 Acc 0.8412, AUC 0.909170925617218, avg_entr 0.011459936387836933, f1 0.8411999344825745
ep29_l4_test_time 0.7890009880065918
Best AUC tensor(0.8978) 4
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 359.0858120918274
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8966, AUC 0.9560108184814453, avg_entr 0.177839994430542, f1 0.8966000080108643
l0_test_time 0.7926969528198242
Test layer1 Acc 0.8942, AUC 0.9564102292060852, avg_entr 0.16487067937850952, f1 0.8942000269889832
l1_test_time 0.7824583053588867
Test layer2 Acc 0.896, AUC 0.9565818905830383, avg_entr 0.14393052458763123, f1 0.8960000276565552
l2_test_time 0.7732996940612793
Test layer3 Acc 0.8966, AUC 0.9570361375808716, avg_entr 0.1244862824678421, f1 0.8966000080108643
l3_test_time 0.7566287517547607
Test layer4 Acc 0.8958, AUC 0.9573571681976318, avg_entr 0.08406637609004974, f1 0.895799994468689
l4_test_time 0.7829914093017578
