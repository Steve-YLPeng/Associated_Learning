total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 22.92271065711975
Start Training
gc 0
Train Epoch0 Acc 0.507775 (20311/40000), AUC 0.515954315662384
ep0_train_time 12.084356307983398
Test Epoch0 layer4 Acc 0.6162, AUC 0.8413841724395752, avg_entr 0.6890848875045776, f1 0.6161999702453613
ep0_l4_test_time 0.7532434463500977
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.82265 (32906/40000), AUC 0.8997474908828735
ep1_train_time 11.14679741859436
Test Epoch1 layer4 Acc 0.8812, AUC 0.9465721845626831, avg_entr 0.24762395024299622, f1 0.8812000155448914
ep1_l4_test_time 0.7752470970153809
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.90285 (36114/40000), AUC 0.9640276432037354
ep2_train_time 10.679996967315674
Test Epoch2 layer4 Acc 0.892, AUC 0.9559887647628784, avg_entr 0.17222073674201965, f1 0.8920000195503235
ep2_l4_test_time 0.7630352973937988
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9229 (36916/40000), AUC 0.9754286408424377
ep3_train_time 11.090060234069824
Test Epoch3 layer4 Acc 0.8952, AUC 0.95920729637146, avg_entr 0.1386972963809967, f1 0.8952000141143799
ep3_l4_test_time 0.7741124629974365
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.935375 (37415/40000), AUC 0.9816245436668396
ep4_train_time 11.181901216506958
Test Epoch4 layer4 Acc 0.8874, AUC 0.9604641199111938, avg_entr 0.10902504622936249, f1 0.8873999714851379
ep4_l4_test_time 0.7663602828979492
gc 0
Train Epoch5 Acc 0.9411 (37644/40000), AUC 0.9849672317504883
ep5_train_time 11.095197439193726
Test Epoch5 layer4 Acc 0.895, AUC 0.9599266052246094, avg_entr 0.06492899358272552, f1 0.8949999809265137
ep5_l4_test_time 0.7516191005706787
gc 0
Train Epoch6 Acc 0.94945 (37978/40000), AUC 0.9871645569801331
ep6_train_time 11.072386741638184
Test Epoch6 layer4 Acc 0.896, AUC 0.958281397819519, avg_entr 0.053269121795892715, f1 0.8960000276565552
ep6_l4_test_time 0.7537209987640381
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9537 (38148/40000), AUC 0.988990068435669
ep7_train_time 11.074653625488281
Test Epoch7 layer4 Acc 0.8948, AUC 0.955007791519165, avg_entr 0.04224583879113197, f1 0.8948000073432922
ep7_l4_test_time 0.753931999206543
gc 0
Train Epoch8 Acc 0.958675 (38347/40000), AUC 0.9910317063331604
ep8_train_time 11.127060174942017
Test Epoch8 layer4 Acc 0.8936, AUC 0.9526363611221313, avg_entr 0.03707912564277649, f1 0.8935999870300293
ep8_l4_test_time 0.771134614944458
gc 0
Train Epoch9 Acc 0.96155 (38462/40000), AUC 0.992273211479187
ep9_train_time 11.106759786605835
Test Epoch9 layer4 Acc 0.8808, AUC 0.9478684067726135, avg_entr 0.04127368703484535, f1 0.8808000087738037
ep9_l4_test_time 0.7513537406921387
gc 0
Train Epoch10 Acc 0.964875 (38595/40000), AUC 0.9933902025222778
ep10_train_time 11.142347574234009
Test Epoch10 layer4 Acc 0.8868, AUC 0.9462260603904724, avg_entr 0.029075922444462776, f1 0.8867999911308289
ep10_l4_test_time 0.7729063034057617
gc 0
Train Epoch11 Acc 0.96825 (38730/40000), AUC 0.9943182468414307
ep11_train_time 11.179559230804443
Test Epoch11 layer4 Acc 0.8828, AUC 0.9455975294113159, avg_entr 0.02730310708284378, f1 0.8827999830245972
ep11_l4_test_time 0.7876987457275391
gc 0
Train Epoch12 Acc 0.97085 (38834/40000), AUC 0.9948433637619019
ep12_train_time 11.168159008026123
Test Epoch12 layer4 Acc 0.882, AUC 0.9462940096855164, avg_entr 0.026750029996037483, f1 0.8820000290870667
ep12_l4_test_time 0.7528667449951172
gc 0
Train Epoch13 Acc 0.972 (38880/40000), AUC 0.9956501722335815
ep13_train_time 10.747621059417725
Test Epoch13 layer4 Acc 0.8678, AUC 0.9453164339065552, avg_entr 0.029824750497937202, f1 0.8677999973297119
ep13_l4_test_time 0.7669055461883545
gc 0
Train Epoch14 Acc 0.9746 (38984/40000), AUC 0.9960750341415405
ep14_train_time 11.098021745681763
Test Epoch14 layer4 Acc 0.8724, AUC 0.9400250911712646, avg_entr 0.02588343247771263, f1 0.8723999857902527
ep14_l4_test_time 0.7507071495056152
gc 0
Train Epoch15 Acc 0.976 (39040/40000), AUC 0.9964560270309448
ep15_train_time 11.093933343887329
Test Epoch15 layer4 Acc 0.8746, AUC 0.9397634267807007, avg_entr 0.019017988815903664, f1 0.8745999932289124
ep15_l4_test_time 0.776585578918457
gc 0
Train Epoch16 Acc 0.97755 (39102/40000), AUC 0.9967586994171143
ep16_train_time 11.148059606552124
Test Epoch16 layer4 Acc 0.8714, AUC 0.9364199042320251, avg_entr 0.02031601592898369, f1 0.871399998664856
ep16_l4_test_time 0.754711389541626
gc 0
Train Epoch17 Acc 0.978975 (39159/40000), AUC 0.9971940517425537
ep17_train_time 11.082124471664429
Test Epoch17 layer4 Acc 0.8662, AUC 0.933349609375, avg_entr 0.018455341458320618, f1 0.8661999702453613
ep17_l4_test_time 0.7697467803955078
gc 0
Train Epoch18 Acc 0.9792 (39168/40000), AUC 0.9971802234649658
ep18_train_time 11.172983646392822
Test Epoch18 layer4 Acc 0.8644, AUC 0.9315606355667114, avg_entr 0.01907900907099247, f1 0.8644000291824341
ep18_l4_test_time 0.780935525894165
gc 0
Train Epoch19 Acc 0.980725 (39229/40000), AUC 0.9975416660308838
ep19_train_time 11.116070747375488
Test Epoch19 layer4 Acc 0.8562, AUC 0.9294813871383667, avg_entr 0.01764325052499771, f1 0.8561999797821045
ep19_l4_test_time 0.7601213455200195
gc 0
Train Epoch20 Acc 0.98225 (39290/40000), AUC 0.9977329969406128
ep20_train_time 11.072565793991089
Test Epoch20 layer4 Acc 0.8588, AUC 0.928837776184082, avg_entr 0.017267003655433655, f1 0.8587999939918518
ep20_l4_test_time 0.7633562088012695
gc 0
Train Epoch21 Acc 0.9834 (39336/40000), AUC 0.9979918599128723
ep21_train_time 11.234478235244751
Test Epoch21 layer4 Acc 0.859, AUC 0.9263879656791687, avg_entr 0.014987701550126076, f1 0.859000027179718
ep21_l4_test_time 0.7645928859710693
gc 0
Train Epoch22 Acc 0.9833 (39332/40000), AUC 0.9981199502944946
ep22_train_time 11.1364905834198
Test Epoch22 layer4 Acc 0.8558, AUC 0.9233077764511108, avg_entr 0.014894973486661911, f1 0.8558000326156616
ep22_l4_test_time 0.7693252563476562
gc 0
Train Epoch23 Acc 0.9846 (39384/40000), AUC 0.9983074069023132
ep23_train_time 10.975831985473633
Test Epoch23 layer4 Acc 0.8504, AUC 0.9201639890670776, avg_entr 0.015711482614278793, f1 0.8503999710083008
ep23_l4_test_time 0.7358963489532471
gc 0
Train Epoch24 Acc 0.985425 (39417/40000), AUC 0.9983077645301819
ep24_train_time 10.865504264831543
Test Epoch24 layer4 Acc 0.8518, AUC 0.9195914268493652, avg_entr 0.015547500923275948, f1 0.8518000245094299
ep24_l4_test_time 0.7870862483978271
gc 0
Train Epoch25 Acc 0.98545 (39418/40000), AUC 0.998458981513977
ep25_train_time 11.151711702346802
Test Epoch25 layer4 Acc 0.8502, AUC 0.9177099466323853, avg_entr 0.013650956563651562, f1 0.8501999974250793
ep25_l4_test_time 0.7680916786193848
gc 0
Train Epoch26 Acc 0.9862 (39448/40000), AUC 0.9986118674278259
ep26_train_time 11.152647018432617
Test Epoch26 layer4 Acc 0.8476, AUC 0.9143239855766296, avg_entr 0.013999365270137787, f1 0.847599983215332
ep26_l4_test_time 0.7728126049041748
gc 0
Train Epoch27 Acc 0.986925 (39477/40000), AUC 0.9986668825149536
ep27_train_time 11.182478189468384
Test Epoch27 layer4 Acc 0.8416, AUC 0.912562370300293, avg_entr 0.0136629743501544, f1 0.8416000008583069
ep27_l4_test_time 0.7674689292907715
gc 0
Train Epoch28 Acc 0.987175 (39487/40000), AUC 0.998671293258667
ep28_train_time 11.189687013626099
Test Epoch28 layer4 Acc 0.8434, AUC 0.912260890007019, avg_entr 0.013431534171104431, f1 0.8434000015258789
ep28_l4_test_time 0.7562847137451172
gc 0
Train Epoch29 Acc 0.9881 (39524/40000), AUC 0.998766303062439
ep29_train_time 11.125926494598389
Test Epoch29 layer4 Acc 0.8404, AUC 0.9097713828086853, avg_entr 0.011970269493758678, f1 0.840399980545044
ep29_l4_test_time 0.7660155296325684
Best AUC tensor(0.8960) 6
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 358.2848515510559
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8908, AUC 0.9534109830856323, avg_entr 0.15417249500751495, f1 0.8907999992370605
l0_test_time 0.7710506916046143
Test layer1 Acc 0.8908, AUC 0.954291045665741, avg_entr 0.14078669250011444, f1 0.8907999992370605
l1_test_time 0.7497694492340088
Test layer2 Acc 0.8914, AUC 0.9551763534545898, avg_entr 0.1254757046699524, f1 0.8913999795913696
l2_test_time 0.7442712783813477
Test layer3 Acc 0.8926, AUC 0.9556307196617126, avg_entr 0.0933891013264656, f1 0.8925999999046326
l3_test_time 0.7430403232574463
Test layer4 Acc 0.892, AUC 0.9537419080734253, avg_entr 0.05767739936709404, f1 0.8920000195503235
l4_test_time 0.7658648490905762
