total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 23.043598890304565
Start Training
gc 0
Train Epoch0 Acc 0.517825 (20713/40000), AUC 0.5659804344177246
ep0_train_time 7.2460901737213135
Test Epoch0 layer4 Acc 0.7674, AUC 0.8619787693023682, avg_entr 0.68930584192276, f1 0.7673999667167664
ep0_l4_test_time 0.5931415557861328
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.829225 (33169/40000), AUC 0.9069491624832153
ep1_train_time 6.765159368515015
Test Epoch1 layer4 Acc 0.8796, AUC 0.9455693960189819, avg_entr 0.22802236676216125, f1 0.8795999884605408
ep1_l4_test_time 0.5649092197418213
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.905025 (36201/40000), AUC 0.9642380475997925
ep2_train_time 7.95545768737793
Test Epoch2 layer4 Acc 0.8946, AUC 0.9558324217796326, avg_entr 0.1620057225227356, f1 0.894599974155426
ep2_l4_test_time 0.7666261196136475
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.922425 (36897/40000), AUC 0.975351095199585
ep3_train_time 11.364257097244263
Test Epoch3 layer4 Acc 0.8988, AUC 0.9595394730567932, avg_entr 0.11531303822994232, f1 0.8988000154495239
ep3_l4_test_time 0.7860021591186523
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.93415 (37366/40000), AUC 0.9813365936279297
ep4_train_time 11.373257160186768
Test Epoch4 layer4 Acc 0.8986, AUC 0.9610356092453003, avg_entr 0.08330412954092026, f1 0.8985999822616577
ep4_l4_test_time 0.7986109256744385
gc 0
Train Epoch5 Acc 0.941625 (37665/40000), AUC 0.9846880435943604
ep5_train_time 11.449034214019775
Test Epoch5 layer4 Acc 0.8912, AUC 0.9597759246826172, avg_entr 0.060462865978479385, f1 0.8912000060081482
ep5_l4_test_time 0.7821433544158936
gc 0
Train Epoch6 Acc 0.9481 (37924/40000), AUC 0.9869771003723145
ep6_train_time 11.450318098068237
Test Epoch6 layer4 Acc 0.8978, AUC 0.9575127959251404, avg_entr 0.04854201525449753, f1 0.8978000283241272
ep6_l4_test_time 0.7751114368438721
gc 0
Train Epoch7 Acc 0.95315 (38126/40000), AUC 0.9892492890357971
ep7_train_time 11.448025465011597
Test Epoch7 layer4 Acc 0.8924, AUC 0.9545830488204956, avg_entr 0.041188500821590424, f1 0.8923999667167664
ep7_l4_test_time 0.7755801677703857
gc 0
Train Epoch8 Acc 0.958375 (38335/40000), AUC 0.990725040435791
ep8_train_time 11.435326099395752
Test Epoch8 layer4 Acc 0.8928, AUC 0.9520399570465088, avg_entr 0.03541383519768715, f1 0.892799973487854
ep8_l4_test_time 0.7831845283508301
gc 0
Train Epoch9 Acc 0.962 (38480/40000), AUC 0.992231011390686
ep9_train_time 11.399847745895386
Test Epoch9 layer4 Acc 0.8872, AUC 0.9515084028244019, avg_entr 0.0344153456389904, f1 0.8871999979019165
ep9_l4_test_time 0.7772116661071777
gc 0
Train Epoch10 Acc 0.9655 (38620/40000), AUC 0.9934839010238647
ep10_train_time 11.386531591415405
Test Epoch10 layer4 Acc 0.8884, AUC 0.948800802230835, avg_entr 0.028370076790452003, f1 0.8884000182151794
ep10_l4_test_time 0.7711353302001953
gc 0
Train Epoch11 Acc 0.967925 (38717/40000), AUC 0.9941743612289429
ep11_train_time 11.171642780303955
Test Epoch11 layer4 Acc 0.8822, AUC 0.9483271241188049, avg_entr 0.027361556887626648, f1 0.8822000026702881
ep11_l4_test_time 0.7860026359558105
gc 0
Train Epoch12 Acc 0.9698 (38792/40000), AUC 0.9949357509613037
ep12_train_time 11.41728687286377
Test Epoch12 layer4 Acc 0.8634, AUC 0.943976640701294, avg_entr 0.02903568185865879, f1 0.8634000420570374
ep12_l4_test_time 0.7716004848480225
gc 0
Train Epoch13 Acc 0.971725 (38869/40000), AUC 0.9954358339309692
ep13_train_time 11.385305404663086
Test Epoch13 layer4 Acc 0.8784, AUC 0.9432010650634766, avg_entr 0.022663313895463943, f1 0.8784000277519226
ep13_l4_test_time 0.7820050716400146
gc 0
Train Epoch14 Acc 0.97425 (38970/40000), AUC 0.9962848424911499
ep14_train_time 11.449944496154785
Test Epoch14 layer4 Acc 0.8646, AUC 0.9417438507080078, avg_entr 0.024248776957392693, f1 0.8646000027656555
ep14_l4_test_time 0.777716875076294
gc 0
Train Epoch15 Acc 0.9757 (39028/40000), AUC 0.9963473677635193
ep15_train_time 11.389393091201782
Test Epoch15 layer4 Acc 0.8718, AUC 0.9395779371261597, avg_entr 0.020999541506171227, f1 0.8718000650405884
ep15_l4_test_time 0.7764203548431396
gc 0
Train Epoch16 Acc 0.9776 (39104/40000), AUC 0.9969077706336975
ep16_train_time 11.39646577835083
Test Epoch16 layer4 Acc 0.8658, AUC 0.9377584457397461, avg_entr 0.019986223429441452, f1 0.8658000826835632
ep16_l4_test_time 0.791923999786377
gc 0
Train Epoch17 Acc 0.978775 (39151/40000), AUC 0.9971480369567871
ep17_train_time 11.437090873718262
Test Epoch17 layer4 Acc 0.864, AUC 0.935917317867279, avg_entr 0.019117064774036407, f1 0.8640000224113464
ep17_l4_test_time 0.7752234935760498
gc 0
Train Epoch18 Acc 0.979125 (39165/40000), AUC 0.9972537755966187
ep18_train_time 11.42653226852417
Test Epoch18 layer4 Acc 0.8628, AUC 0.9339874982833862, avg_entr 0.01600099727511406, f1 0.8628000020980835
ep18_l4_test_time 0.7663998603820801
gc 0
Train Epoch19 Acc 0.980525 (39221/40000), AUC 0.9976707696914673
ep19_train_time 11.414012432098389
Test Epoch19 layer4 Acc 0.8592, AUC 0.9313891530036926, avg_entr 0.014467081986367702, f1 0.8592000007629395
ep19_l4_test_time 0.7830085754394531
gc 0
Train Epoch20 Acc 0.98155 (39262/40000), AUC 0.9977267980575562
ep20_train_time 11.107895612716675
Test Epoch20 layer4 Acc 0.8594, AUC 0.9301111698150635, avg_entr 0.018635490909218788, f1 0.8593999743461609
ep20_l4_test_time 0.7972338199615479
gc 0
Train Epoch21 Acc 0.982125 (39285/40000), AUC 0.9979919195175171
ep21_train_time 11.371896028518677
Test Epoch21 layer4 Acc 0.8568, AUC 0.9276599884033203, avg_entr 0.01394933182746172, f1 0.8568000793457031
ep21_l4_test_time 0.7774035930633545
gc 0
Train Epoch22 Acc 0.982875 (39315/40000), AUC 0.9981124997138977
ep22_train_time 11.473004341125488
Test Epoch22 layer4 Acc 0.8548, AUC 0.9261695146560669, avg_entr 0.014636443927884102, f1 0.8547999858856201
ep22_l4_test_time 0.7758419513702393
gc 0
Train Epoch23 Acc 0.9838 (39352/40000), AUC 0.998309850692749
ep23_train_time 11.416234254837036
Test Epoch23 layer4 Acc 0.85, AUC 0.9217157959938049, avg_entr 0.01376174483448267, f1 0.8500000238418579
ep23_l4_test_time 0.7730495929718018
gc 0
Train Epoch24 Acc 0.9846 (39384/40000), AUC 0.9982990026473999
ep24_train_time 11.401403903961182
Test Epoch24 layer4 Acc 0.8504, AUC 0.9207141399383545, avg_entr 0.012431642971932888, f1 0.8503999710083008
ep24_l4_test_time 0.773918628692627
gc 0
Train Epoch25 Acc 0.985225 (39409/40000), AUC 0.998435914516449
ep25_train_time 11.463220596313477
Test Epoch25 layer4 Acc 0.8482, AUC 0.9190848469734192, avg_entr 0.014206069521605968, f1 0.8482000231742859
ep25_l4_test_time 0.7722554206848145
gc 0
Train Epoch26 Acc 0.98605 (39442/40000), AUC 0.9985777139663696
ep26_train_time 11.384710788726807
Test Epoch26 layer4 Acc 0.8464, AUC 0.914157509803772, avg_entr 0.014922414906322956, f1 0.8464000225067139
ep26_l4_test_time 0.7791867256164551
gc 0
Train Epoch27 Acc 0.9861 (39444/40000), AUC 0.9987223744392395
ep27_train_time 11.374678611755371
Test Epoch27 layer4 Acc 0.844, AUC 0.9130703806877136, avg_entr 0.013676063157618046, f1 0.8439999222755432
ep27_l4_test_time 0.7742774486541748
gc 0
Train Epoch28 Acc 0.987075 (39483/40000), AUC 0.9988335967063904
ep28_train_time 11.38329267501831
Test Epoch28 layer4 Acc 0.8398, AUC 0.9125744104385376, avg_entr 0.015187600627541542, f1 0.8398000001907349
ep28_l4_test_time 0.7717077732086182
gc 0
Train Epoch29 Acc 0.98765 (39506/40000), AUC 0.9988597631454468
ep29_train_time 11.121191501617432
Test Epoch29 layer4 Acc 0.8416, AUC 0.9097803831100464, avg_entr 0.013294901698827744, f1 0.8416000008583069
ep29_l4_test_time 0.7889525890350342
Best AUC tensor(0.8988) 3
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 353.82431530952454
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8934, AUC 0.9554189443588257, avg_entr 0.19730044901371002, f1 0.8934000134468079
l0_test_time 0.7709977626800537
Test layer1 Acc 0.895, AUC 0.9558207392692566, avg_entr 0.18028804659843445, f1 0.8949999809265137
l1_test_time 0.7721865177154541
Test layer2 Acc 0.896, AUC 0.9561548233032227, avg_entr 0.1549721509218216, f1 0.8960000276565552
l2_test_time 0.7720775604248047
Test layer3 Acc 0.8962, AUC 0.9566110372543335, avg_entr 0.13909874856472015, f1 0.8962000012397766
l3_test_time 0.7613413333892822
Test layer4 Acc 0.8962, AUC 0.9567820429801941, avg_entr 0.11834615468978882, f1 0.8962000012397766
l4_test_time 0.7744960784912109
