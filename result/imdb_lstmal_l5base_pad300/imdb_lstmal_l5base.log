total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 23.33403253555298
Start Training
gc 0
Train Epoch0 Acc 0.5106 (20424/40000), AUC 0.5218479633331299
ep0_train_time 97.04073810577393
Test Epoch0 layer4 Acc 0.636, AUC 0.7232961654663086, avg_entr 0.7038179636001587
ep0_l4_test_time 3.3806471824645996
Save ckpt to ckpt/imdb_lstmal_l5base_pad300//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.803175 (32127/40000), AUC 0.8664174675941467
ep1_train_time 96.92288708686829
Test Epoch1 layer4 Acc 0.8482, AUC 0.9251143932342529, avg_entr 0.10355939716100693
ep1_l4_test_time 3.336610794067383
Save ckpt to ckpt/imdb_lstmal_l5base_pad300//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.89175 (35670/40000), AUC 0.9442270398139954
ep2_train_time 96.86973595619202
Test Epoch2 layer4 Acc 0.8728, AUC 0.9395869970321655, avg_entr 0.05745818465948105
ep2_l4_test_time 3.3626210689544678
Save ckpt to ckpt/imdb_lstmal_l5base_pad300//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.918675 (36747/40000), AUC 0.9642074108123779
ep3_train_time 96.85285639762878
Test Epoch3 layer4 Acc 0.8834, AUC 0.9428914785385132, avg_entr 0.06569190323352814
ep3_l4_test_time 3.376952886581421
Save ckpt to ckpt/imdb_lstmal_l5base_pad300//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9374 (37496/40000), AUC 0.9786794185638428
ep4_train_time 96.88505864143372
Test Epoch4 layer4 Acc 0.8828, AUC 0.9424300193786621, avg_entr 0.04390895739197731
ep4_l4_test_time 3.375243663787842
gc 0
Train Epoch5 Acc 0.947725 (37909/40000), AUC 0.9842782020568848
ep5_train_time 96.88476276397705
Test Epoch5 layer4 Acc 0.8766, AUC 0.9415067434310913, avg_entr 0.050383374094963074
ep5_l4_test_time 3.3926408290863037
gc 0
Train Epoch6 Acc 0.955 (38200/40000), AUC 0.9878338575363159
ep6_train_time 72.13056206703186
Test Epoch6 layer4 Acc 0.8804, AUC 0.9369347095489502, avg_entr 0.031497523188591
ep6_l4_test_time 3.3696205615997314
gc 0
Train Epoch7 Acc 0.960725 (38429/40000), AUC 0.990718424320221
ep7_train_time 97.73158884048462
Test Epoch7 layer4 Acc 0.8632, AUC 0.9345441460609436, avg_entr 0.03274140506982803
ep7_l4_test_time 3.335310220718384
gc 0
Train Epoch8 Acc 0.96605 (38642/40000), AUC 0.9933059215545654
ep8_train_time 97.85261106491089
Test Epoch8 layer4 Acc 0.8604, AUC 0.9319033026695251, avg_entr 0.03709503635764122
ep8_l4_test_time 3.3955137729644775
gc 0
Train Epoch9 Acc 0.969875 (38795/40000), AUC 0.9943169951438904
ep9_train_time 97.72545719146729
Test Epoch9 layer4 Acc 0.8596, AUC 0.9311046600341797, avg_entr 0.03556235507130623
ep9_l4_test_time 3.3556530475616455
gc 0
Train Epoch10 Acc 0.9727 (38908/40000), AUC 0.9953665733337402
ep10_train_time 97.6682550907135
Test Epoch10 layer4 Acc 0.8674, AUC 0.9293498992919922, avg_entr 0.023022985085844994
ep10_l4_test_time 3.2776191234588623
gc 0
Train Epoch11 Acc 0.97445 (38978/40000), AUC 0.9956938028335571
ep11_train_time 97.56343126296997
Test Epoch11 layer4 Acc 0.864, AUC 0.9282665252685547, avg_entr 0.023288676515221596
ep11_l4_test_time 3.357685089111328
gc 0
Train Epoch12 Acc 0.977075 (39083/40000), AUC 0.9962478876113892
ep12_train_time 97.618492603302
Test Epoch12 layer4 Acc 0.8512, AUC 0.9228130578994751, avg_entr 0.028583038598299026
ep12_l4_test_time 3.327943801879883
gc 0
Train Epoch13 Acc 0.97935 (39174/40000), AUC 0.9970669150352478
ep13_train_time 97.57767748832703
Test Epoch13 layer4 Acc 0.8526, AUC 0.9221018552780151, avg_entr 0.02630576863884926
ep13_l4_test_time 3.4185521602630615
gc 0
Train Epoch14 Acc 0.9809 (39236/40000), AUC 0.9973516464233398
ep14_train_time 97.45836329460144
Test Epoch14 layer4 Acc 0.8512, AUC 0.9180908203125, avg_entr 0.017696743831038475
ep14_l4_test_time 3.285879135131836
gc 0
Train Epoch15 Acc 0.982525 (39301/40000), AUC 0.9975494146347046
ep15_train_time 97.5312819480896
Test Epoch15 layer4 Acc 0.8482, AUC 0.9163568019866943, avg_entr 0.015185980126261711
ep15_l4_test_time 3.2839548587799072
gc 0
Train Epoch16 Acc 0.983975 (39359/40000), AUC 0.9981572031974792
ep16_train_time 97.47108888626099
Test Epoch16 layer4 Acc 0.8438, AUC 0.9169008731842041, avg_entr 0.019197816029191017
ep16_l4_test_time 3.3750572204589844
gc 0
Train Epoch17 Acc 0.9848 (39392/40000), AUC 0.9981964826583862
ep17_train_time 97.55881452560425
Test Epoch17 layer4 Acc 0.845, AUC 0.9147233963012695, avg_entr 0.017086129635572433
ep17_l4_test_time 3.3588759899139404
gc 0
Train Epoch18 Acc 0.985925 (39437/40000), AUC 0.9982721209526062
ep18_train_time 97.57015824317932
Test Epoch18 layer4 Acc 0.8458, AUC 0.9133269190788269, avg_entr 0.018593447282910347
ep18_l4_test_time 3.4094901084899902
gc 0
Train Epoch19 Acc 0.98615 (39446/40000), AUC 0.9984525442123413
ep19_train_time 97.66007328033447
Test Epoch19 layer4 Acc 0.8414, AUC 0.9120441675186157, avg_entr 0.019722675904631615
ep19_l4_test_time 3.3790504932403564
gc 0
Train Epoch20 Acc 0.987125 (39485/40000), AUC 0.9986842274665833
ep20_train_time 97.5257248878479
Test Epoch20 layer4 Acc 0.8402, AUC 0.9108225107192993, avg_entr 0.020464910194277763
ep20_l4_test_time 3.385406255722046
gc 0
Train Epoch21 Acc 0.98895 (39558/40000), AUC 0.9989173412322998
ep21_train_time 98.03219699859619
Test Epoch21 layer4 Acc 0.8378, AUC 0.9069837331771851, avg_entr 0.017262235283851624
ep21_l4_test_time 3.379351854324341
gc 0
Train Epoch22 Acc 0.989275 (39571/40000), AUC 0.9988991022109985
ep22_train_time 97.52475833892822
Test Epoch22 layer4 Acc 0.834, AUC 0.9030255079269409, avg_entr 0.017267104238271713
ep22_l4_test_time 3.375112295150757
gc 0
Train Epoch23 Acc 0.9888 (39552/40000), AUC 0.9988599419593811
ep23_train_time 78.89540410041809
Test Epoch23 layer4 Acc 0.8376, AUC 0.9028745293617249, avg_entr 0.014313788153231144
ep23_l4_test_time 3.2795677185058594
gc 0
Train Epoch24 Acc 0.990175 (39607/40000), AUC 0.9991244673728943
ep24_train_time 97.84267687797546
Test Epoch24 layer4 Acc 0.8346, AUC 0.8937084674835205, avg_entr 0.00997881405055523
ep24_l4_test_time 3.2915585041046143
gc 0
Train Epoch25 Acc 0.990925 (39637/40000), AUC 0.9991728067398071
ep25_train_time 97.42473983764648
Test Epoch25 layer4 Acc 0.8346, AUC 0.8922219276428223, avg_entr 0.010982697829604149
ep25_l4_test_time 3.3787553310394287
gc 0
Train Epoch26 Acc 0.990975 (39639/40000), AUC 0.9990675449371338
ep26_train_time 97.58952164649963
Test Epoch26 layer4 Acc 0.8322, AUC 0.8959597945213318, avg_entr 0.013841490261256695
ep26_l4_test_time 3.4031565189361572
gc 0
Train Epoch27 Acc 0.9916 (39664/40000), AUC 0.9993492960929871
ep27_train_time 97.49555397033691
Test Epoch27 layer4 Acc 0.829, AUC 0.8929547667503357, avg_entr 0.013325218111276627
ep27_l4_test_time 3.3952620029449463
gc 0
Train Epoch28 Acc 0.99175 (39670/40000), AUC 0.9992875456809998
ep28_train_time 97.38950371742249
Test Epoch28 layer4 Acc 0.828, AUC 0.8872607946395874, avg_entr 0.012321826070547104
ep28_l4_test_time 3.246342420578003
gc 0
Train Epoch29 Acc 0.9923 (39692/40000), AUC 0.9994257688522339
ep29_train_time 96.88952541351318
Test Epoch29 layer4 Acc 0.8258, AUC 0.8817749619483948, avg_entr 0.009678417816758156
ep29_l4_test_time 3.334371566772461
gc 0
Train Epoch30 Acc 0.991925 (39677/40000), AUC 0.9994085431098938
ep30_train_time 97.61284065246582
Test Epoch30 layer4 Acc 0.8264, AUC 0.8747262358665466, avg_entr 0.009886077605187893
ep30_l4_test_time 3.3686890602111816
gc 0
Train Epoch31 Acc 0.993075 (39723/40000), AUC 0.9994556903839111
ep31_train_time 97.61893701553345
Test Epoch31 layer4 Acc 0.8254, AUC 0.8774629831314087, avg_entr 0.009838621132075787
ep31_l4_test_time 3.333502769470215
gc 0
Train Epoch32 Acc 0.993725 (39749/40000), AUC 0.9994932413101196
ep32_train_time 97.69839334487915
Test Epoch32 layer4 Acc 0.823, AUC 0.8759727478027344, avg_entr 0.009731133468449116
ep32_l4_test_time 3.2140390872955322
gc 0
Train Epoch33 Acc 0.993975 (39759/40000), AUC 0.9994794130325317
ep33_train_time 97.72901678085327
Test Epoch33 layer4 Acc 0.8192, AUC 0.8676393032073975, avg_entr 0.008379754610359669
ep33_l4_test_time 3.386389970779419
gc 0
Train Epoch34 Acc 0.99435 (39774/40000), AUC 0.9995557069778442
ep34_train_time 97.64450287818909
Test Epoch34 layer4 Acc 0.8122, AUC 0.8803020715713501, avg_entr 0.012333104386925697
ep34_l4_test_time 3.328336238861084
gc 0
Train Epoch35 Acc 0.99405 (39762/40000), AUC 0.9993601441383362
ep35_train_time 97.64208364486694
Test Epoch35 layer4 Acc 0.8148, AUC 0.8760716915130615, avg_entr 0.009361669421195984
ep35_l4_test_time 3.3402259349823
gc 0
Train Epoch36 Acc 0.994575 (39783/40000), AUC 0.9995339512825012
ep36_train_time 97.65885853767395
Test Epoch36 layer4 Acc 0.823, AUC 0.8740890622138977, avg_entr 0.010144665837287903
ep36_l4_test_time 3.363560199737549
gc 0
Train Epoch37 Acc 0.99525 (39810/40000), AUC 0.9995471239089966
ep37_train_time 97.68255829811096
Test Epoch37 layer4 Acc 0.8176, AUC 0.8685176968574524, avg_entr 0.007901987060904503
ep37_l4_test_time 3.3285508155822754
gc 0
Train Epoch38 Acc 0.994875 (39795/40000), AUC 0.999627411365509
ep38_train_time 97.69980311393738
Test Epoch38 layer4 Acc 0.8192, AUC 0.8777098655700684, avg_entr 0.010136952623724937
ep38_l4_test_time 3.3860695362091064
gc 0
Train Epoch39 Acc 0.9954 (39816/40000), AUC 0.9996998906135559
ep39_train_time 90.31453251838684
Test Epoch39 layer4 Acc 0.8156, AUC 0.8715599179267883, avg_entr 0.00810471922159195
ep39_l4_test_time 1.7407894134521484
gc 0
Train Epoch40 Acc 0.995925 (39837/40000), AUC 0.9997035264968872
ep40_train_time 87.36829948425293
Test Epoch40 layer4 Acc 0.8178, AUC 0.8611056804656982, avg_entr 0.006890506949275732
ep40_l4_test_time 3.3577611446380615
gc 0
Train Epoch41 Acc 0.99615 (39846/40000), AUC 0.9997259378433228
ep41_train_time 97.71075224876404
Test Epoch41 layer4 Acc 0.8156, AUC 0.8632438778877258, avg_entr 0.006692362949252129
ep41_l4_test_time 3.3676769733428955
gc 0
Train Epoch42 Acc 0.996175 (39847/40000), AUC 0.9997060298919678
ep42_train_time 97.6619188785553
Test Epoch42 layer4 Acc 0.8146, AUC 0.8591976165771484, avg_entr 0.006214477121829987
ep42_l4_test_time 3.3722751140594482
gc 0
Train Epoch43 Acc 0.9966 (39864/40000), AUC 0.9997329711914062
ep43_train_time 97.66340065002441
Test Epoch43 layer4 Acc 0.8088, AUC 0.8681958913803101, avg_entr 0.008572125807404518
ep43_l4_test_time 3.418504476547241
gc 0
Train Epoch44 Acc 0.996825 (39873/40000), AUC 0.9996850490570068
ep44_train_time 97.66778445243835
Test Epoch44 layer4 Acc 0.811, AUC 0.8501614928245544, avg_entr 0.005606492981314659
ep44_l4_test_time 3.3316798210144043
gc 0
Train Epoch45 Acc 0.996775 (39871/40000), AUC 0.9997243881225586
ep45_train_time 97.7066056728363
Test Epoch45 layer4 Acc 0.8124, AUC 0.8606016635894775, avg_entr 0.006697573233395815
ep45_l4_test_time 3.3644144535064697
gc 0
Train Epoch46 Acc 0.996825 (39873/40000), AUC 0.99973464012146
ep46_train_time 97.71877408027649
Test Epoch46 layer4 Acc 0.8128, AUC 0.8644106388092041, avg_entr 0.0060969083569943905
ep46_l4_test_time 3.368100643157959
gc 0
Train Epoch47 Acc 0.9971 (39884/40000), AUC 0.9997707009315491
ep47_train_time 97.7343008518219
Test Epoch47 layer4 Acc 0.8118, AUC 0.8512819409370422, avg_entr 0.004684964194893837
ep47_l4_test_time 3.349910020828247
gc 0
Train Epoch48 Acc 0.99725 (39890/40000), AUC 0.9996926784515381
ep48_train_time 97.73425102233887
Test Epoch48 layer4 Acc 0.8068, AUC 0.8518660068511963, avg_entr 0.006254931446164846
ep48_l4_test_time 3.382216691970825
gc 0
Train Epoch49 Acc 0.997175 (39887/40000), AUC 0.9996345639228821
ep49_train_time 97.74650001525879
Test Epoch49 layer4 Acc 0.8098, AUC 0.858643651008606, avg_entr 0.007293818052858114
ep49_l4_test_time 3.3329789638519287
Best AUC 0.9428914785385132
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 4983.994384527206
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad300//imdb_lstmal_l5.pt
Test layer4 Acc 0.8794, AUC 0.9397594928741455, avg_entr 0.06572140753269196
l4_test_time 3.3361663818359375
