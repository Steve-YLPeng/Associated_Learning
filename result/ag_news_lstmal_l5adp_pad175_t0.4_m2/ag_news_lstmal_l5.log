total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.4_m1//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.23754166666666668 (28505/120000), AUC 0.679638147354126
ep0_train_time 56.03755831718445
Test Epoch0 threshold 0.4 Acc 0.9126644736842106, AUC 0.9805153608322144, avg_entr 0.02707461640238762
ep0_t0.4_test_time 0.32018041610717773
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.4_m2//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.150925 (18111/120000), AUC 0.7012423872947693
ep1_train_time 56.02467226982117
Test Epoch1 threshold 0.4 Acc 0.9171052631578948, AUC 0.9807546138763428, avg_entr 0.024859964847564697
ep1_t0.4_test_time 0.31021738052368164
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.4_m2//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.12946666666666667 (15536/120000), AUC 0.6963003873825073
ep2_train_time 56.044705390930176
Test Epoch2 threshold 0.4 Acc 0.9143092105263158, AUC 0.9806023240089417, avg_entr 0.02516905404627323
ep2_t0.4_test_time 0.2944364547729492
gc 0
Train Epoch3 Acc 0.119 (14280/120000), AUC 0.699095606803894
ep3_train_time 56.06924557685852
Test Epoch3 threshold 0.4 Acc 0.9144736842105263, AUC 0.9805859327316284, avg_entr 0.02462092414498329
ep3_t0.4_test_time 0.2898106575012207
gc 0
Train Epoch4 Acc 0.12838333333333332 (15406/120000), AUC 0.6986862421035767
ep4_train_time 55.98600435256958
Test Epoch4 threshold 0.4 Acc 0.912828947368421, AUC 0.9804543852806091, avg_entr 0.025121156126260757
ep4_t0.4_test_time 0.2907252311706543
gc 0
Train Epoch5 Acc 0.14303333333333335 (17164/120000), AUC 0.6968896985054016
ep5_train_time 56.107327699661255
Test Epoch5 threshold 0.4 Acc 0.915625, AUC 0.98032546043396, avg_entr 0.024076994508504868
ep5_t0.4_test_time 0.2877488136291504
gc 0
Train Epoch6 Acc 0.1478 (17736/120000), AUC 0.699110746383667
ep6_train_time 56.15211534500122
Test Epoch6 threshold 0.4 Acc 0.9139802631578947, AUC 0.9800924062728882, avg_entr 0.025263607501983643
ep6_t0.4_test_time 0.30093860626220703
gc 0
Train Epoch7 Acc 0.14666666666666667 (17600/120000), AUC 0.6968395709991455
ep7_train_time 55.974926233291626
Test Epoch7 threshold 0.4 Acc 0.9125, AUC 0.9801290035247803, avg_entr 0.024772468954324722
ep7_t0.4_test_time 0.2935621738433838
gc 0
Train Epoch8 Acc 0.15203333333333333 (18244/120000), AUC 0.6954739093780518
ep8_train_time 56.160035610198975
Test Epoch8 threshold 0.4 Acc 0.9134868421052632, AUC 0.9800609946250916, avg_entr 0.024878354743123055
ep8_t0.4_test_time 0.2854945659637451
gc 0
Train Epoch9 Acc 0.15868333333333334 (19042/120000), AUC 0.6944190859794617
ep9_train_time 56.125099658966064
Test Epoch9 threshold 0.4 Acc 0.9146381578947368, AUC 0.979915201663971, avg_entr 0.024330776184797287
ep9_t0.4_test_time 0.2864255905151367
Best AUC 0.9807546138763428
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.4_m2//ag_news_lstmal_l5_prefix.pt
Test threshold 0.4 Acc 0.9223684210526316, AUC 0.9860600233078003, avg_entr 0.023836860433220863
t0.4_test_time 0.07555866241455078
