total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.5_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.196825 (23619/120000), AUC 0.5082725882530212
ep0_train_time 9.38567328453064
Test Epoch0 threshold 0.5 Acc 0.9175986842105263, AUC 0.9809813499450684, avg_entr 0.02578442171216011
ep0_t0.5_test_time 0.25261521339416504
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.13154166666666667 (15785/120000), AUC 0.5021538138389587
ep1_train_time 8.929402828216553
Test Epoch1 threshold 0.5 Acc 0.9157894736842105, AUC 0.9809814691543579, avg_entr 0.025458864867687225
ep1_t0.5_test_time 0.25321054458618164
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m3//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.06324166666666667 (7589/120000), AUC 0.4924714267253876
ep2_train_time 9.136023044586182
Test Epoch2 threshold 0.5 Acc 0.9164473684210527, AUC 0.9808285236358643, avg_entr 0.026131514459848404
ep2_t0.5_test_time 0.25080132484436035
gc 0
Train Epoch3 Acc 0.036033333333333334 (4324/120000), AUC 0.48319703340530396
ep3_train_time 9.004526853561401
Test Epoch3 threshold 0.5 Acc 0.9133223684210526, AUC 0.9805780053138733, avg_entr 0.024913286790251732
ep3_t0.5_test_time 0.25038576126098633
gc 0
Train Epoch4 Acc 0.025941666666666665 (3113/120000), AUC 0.4746391177177429
ep4_train_time 8.85657811164856
Test Epoch4 threshold 0.5 Acc 0.9148026315789474, AUC 0.9805731773376465, avg_entr 0.02568112686276436
ep4_t0.5_test_time 0.2505149841308594
gc 0
Train Epoch5 Acc 0.022133333333333335 (2656/120000), AUC 0.4664180874824524
ep5_train_time 8.833258152008057
Test Epoch5 threshold 0.5 Acc 0.9143092105263158, AUC 0.9805346727371216, avg_entr 0.025756118819117546
ep5_t0.5_test_time 0.2504465579986572
gc 0
Train Epoch6 Acc 0.020391666666666666 (2447/120000), AUC 0.45772379636764526
ep6_train_time 9.070768117904663
Test Epoch6 threshold 0.5 Acc 0.9148026315789474, AUC 0.9803740978240967, avg_entr 0.02542821317911148
ep6_t0.5_test_time 0.2507929801940918
gc 0
Train Epoch7 Acc 0.0191 (2292/120000), AUC 0.4509449005126953
ep7_train_time 8.94213056564331
Test Epoch7 threshold 0.5 Acc 0.9149671052631579, AUC 0.9802606105804443, avg_entr 0.025952570140361786
ep7_t0.5_test_time 0.2511463165283203
gc 0
Train Epoch8 Acc 0.017783333333333335 (2134/120000), AUC 0.44720566272735596
ep8_train_time 9.085631132125854
Test Epoch8 threshold 0.5 Acc 0.9141447368421053, AUC 0.9801244735717773, avg_entr 0.025550490245223045
ep8_t0.5_test_time 0.25800585746765137
gc 0
Train Epoch9 Acc 0.016691666666666667 (2003/120000), AUC 0.44375696778297424
ep9_train_time 9.091533660888672
Test Epoch9 threshold 0.5 Acc 0.9131578947368421, AUC 0.980089545249939, avg_entr 0.02603740245103836
ep9_t0.5_test_time 0.2521805763244629
Best AUC 0.9809814691543579
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.5_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9236842105263158, AUC 0.9863395690917969, avg_entr 0.025149798020720482
t0.5_test_time 0.06387948989868164
