total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.316025 (37923/120000), AUC 0.665459394454956
ep0_train_time 8.977807521820068
Test Epoch0 threshold 0.2 Acc 0.9136513157894737, AUC 0.9808530211448669, avg_entr 0.026828864589333534
ep0_t0.2_test_time 0.26128673553466797
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.2_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.285575 (34269/120000), AUC 0.7810672521591187
ep1_train_time 8.634541988372803
Test Epoch1 threshold 0.2 Acc 0.9149671052631579, AUC 0.9807796478271484, avg_entr 0.02573351189494133
ep1_t0.2_test_time 0.2585415840148926
gc 0
Train Epoch2 Acc 0.29370833333333335 (35245/120000), AUC 0.7691394090652466
ep2_train_time 8.810248851776123
Test Epoch2 threshold 0.2 Acc 0.9154605263157894, AUC 0.9808475971221924, avg_entr 0.02520124800503254
ep2_t0.2_test_time 0.25808167457580566
gc 0
Train Epoch3 Acc 0.322675 (38721/120000), AUC 0.7629751563072205
ep3_train_time 8.762769937515259
Test Epoch3 threshold 0.2 Acc 0.9149671052631579, AUC 0.9804949164390564, avg_entr 0.024929771199822426
ep3_t0.2_test_time 0.2580292224884033
gc 0
Train Epoch4 Acc 0.36635 (43962/120000), AUC 0.7606427073478699
ep4_train_time 8.597584247589111
Test Epoch4 threshold 0.2 Acc 0.9164473684210527, AUC 0.980602502822876, avg_entr 0.02566249668598175
ep4_t0.2_test_time 0.2587263584136963
gc 0
Train Epoch5 Acc 0.377325 (45279/120000), AUC 0.7600857019424438
ep5_train_time 8.619395017623901
Test Epoch5 threshold 0.2 Acc 0.9146381578947368, AUC 0.9803826808929443, avg_entr 0.025111066177487373
ep5_t0.2_test_time 0.25821924209594727
gc 0
Train Epoch6 Acc 0.3765833333333333 (45190/120000), AUC 0.7592363953590393
ep6_train_time 8.654008626937866
Test Epoch6 threshold 0.2 Acc 0.9136513157894737, AUC 0.980202317237854, avg_entr 0.025053001940250397
ep6_t0.2_test_time 0.2586548328399658
gc 0
Train Epoch7 Acc 0.368825 (44259/120000), AUC 0.7583452463150024
ep7_train_time 8.564917087554932
Test Epoch7 threshold 0.2 Acc 0.915296052631579, AUC 0.9801223278045654, avg_entr 0.025501713156700134
ep7_t0.2_test_time 0.25837039947509766
gc 0
Train Epoch8 Acc 0.366925 (44031/120000), AUC 0.7569097280502319
ep8_train_time 8.535264015197754
Test Epoch8 threshold 0.2 Acc 0.9139802631578947, AUC 0.9799631834030151, avg_entr 0.025319790467619896
ep8_t0.2_test_time 0.25911974906921387
gc 0
Train Epoch9 Acc 0.3691583333333333 (44299/120000), AUC 0.7561666965484619
ep9_train_time 8.548831701278687
Test Epoch9 threshold 0.2 Acc 0.9143092105263158, AUC 0.9799246788024902, avg_entr 0.025233589112758636
ep9_t0.2_test_time 0.25900769233703613
Best AUC 0.9808530211448669
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.2_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9269736842105263, AUC 0.9864762425422668, avg_entr 0.02712353877723217
t0.2_test_time 0.06629419326782227
