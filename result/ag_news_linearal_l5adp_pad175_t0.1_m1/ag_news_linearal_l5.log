total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25133333333333335 (30160/120000), AUC 0.5050032138824463
ep0_train_time 8.882230758666992
Test Epoch0 threshold 0.1 Acc 0.8985197368421053, AUC 0.973753035068512, avg_entr 0.18226756155490875
ep0_t0.1_test_time 0.26151323318481445
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.4707815647125244
ep1_train_time 8.41557264328003
Test Epoch1 threshold 0.1 Acc 0.9088815789473684, AUC 0.9777575135231018, avg_entr 0.10752049833536148
ep1_t0.1_test_time 0.25897836685180664
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.4651826322078705
ep2_train_time 8.210743427276611
Test Epoch2 threshold 0.1 Acc 0.912828947368421, AUC 0.9794437885284424, avg_entr 0.07956377416849136
ep2_t0.1_test_time 0.2601306438446045
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.46770262718200684
ep3_train_time 8.132267236709595
Test Epoch3 threshold 0.1 Acc 0.9161184210526315, AUC 0.9802113771438599, avg_entr 0.06574831902980804
ep3_t0.1_test_time 0.25829482078552246
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.47176334261894226
ep4_train_time 8.164137601852417
Test Epoch4 threshold 0.1 Acc 0.9146381578947368, AUC 0.9805973768234253, avg_entr 0.05916815623641014
ep4_t0.1_test_time 0.2591423988342285
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.4749096930027008
ep5_train_time 8.225091218948364
Test Epoch5 threshold 0.1 Acc 0.915296052631579, AUC 0.9806239604949951, avg_entr 0.05408376827836037
ep5_t0.1_test_time 0.2579314708709717
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.4792982339859009
ep6_train_time 8.128257513046265
Test Epoch6 threshold 0.1 Acc 0.9133223684210526, AUC 0.98075932264328, avg_entr 0.04967530071735382
ep6_t0.1_test_time 0.2583198547363281
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.48249122500419617
ep7_train_time 8.141374111175537
Test Epoch7 threshold 0.1 Acc 0.9149671052631579, AUC 0.9806864261627197, avg_entr 0.04627200588583946
ep7_t0.1_test_time 0.25804615020751953
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.4864027202129364
ep8_train_time 8.19343876838684
Test Epoch8 threshold 0.1 Acc 0.9161184210526315, AUC 0.9806369543075562, avg_entr 0.04317571595311165
ep8_t0.1_test_time 0.2576453685760498
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.48947641253471375
ep9_train_time 8.210156917572021
Test Epoch9 threshold 0.1 Acc 0.9144736842105263, AUC 0.980377197265625, avg_entr 0.041127048432826996
ep9_t0.1_test_time 0.2570316791534424
Best AUC 0.98075932264328
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9236842105263158, AUC 0.9863208532333374, avg_entr 0.05063401162624359
t0.1_test_time 0.06581544876098633
