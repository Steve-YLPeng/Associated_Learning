total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.9_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.28999166666666665 (34799/120000), AUC 0.6455252170562744
ep0_train_time 4.786466360092163
Test Epoch0 threshold 0.9 Acc 0.9120065789473685, AUC 0.9810388088226318, avg_entr 0.03642715886235237
ep0_t0.9_test_time 0.07303237915039062
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.9_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.3045083333333333 (36541/120000), AUC 0.6652761697769165
ep1_train_time 4.509880781173706
Test Epoch1 threshold 0.9 Acc 0.9116776315789473, AUC 0.9810819625854492, avg_entr 0.03315670043230057
ep1_t0.9_test_time 0.07321786880493164
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.9_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.3318833333333333 (39826/120000), AUC 0.6657555103302002
ep2_train_time 4.560627698898315
Test Epoch2 threshold 0.9 Acc 0.9151315789473684, AUC 0.9811295866966248, avg_entr 0.02978566661477089
ep2_t0.9_test_time 0.07344794273376465
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.9_m2//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.3550083333333333 (42601/120000), AUC 0.6690743565559387
ep3_train_time 4.6043102741241455
Test Epoch3 threshold 0.9 Acc 0.9126644736842106, AUC 0.980233371257782, avg_entr 0.028927989304065704
ep3_t0.9_test_time 0.07311630249023438
gc 0
Train Epoch4 Acc 0.37299166666666667 (44759/120000), AUC 0.674982488155365
ep4_train_time 4.449552536010742
Test Epoch4 threshold 0.9 Acc 0.9100328947368421, AUC 0.9803356528282166, avg_entr 0.028283942490816116
ep4_t0.9_test_time 0.07204818725585938
gc 0
Train Epoch5 Acc 0.3870416666666667 (46445/120000), AUC 0.6824739575386047
ep5_train_time 4.332600355148315
Test Epoch5 threshold 0.9 Acc 0.9111842105263158, AUC 0.9798725843429565, avg_entr 0.027463434264063835
ep5_t0.9_test_time 0.0711679458618164
gc 0
Train Epoch6 Acc 0.393075 (47169/120000), AUC 0.6865155100822449
ep6_train_time 4.375112056732178
Test Epoch6 threshold 0.9 Acc 0.9106907894736842, AUC 0.9797943830490112, avg_entr 0.027468936517834663
ep6_t0.9_test_time 0.0712587833404541
gc 0
Train Epoch7 Acc 0.400175 (48021/120000), AUC 0.6908843517303467
ep7_train_time 4.355441331863403
Test Epoch7 threshold 0.9 Acc 0.9111842105263158, AUC 0.9795889854431152, avg_entr 0.0272851400077343
ep7_t0.9_test_time 0.07145023345947266
gc 0
Train Epoch8 Acc 0.405675 (48681/120000), AUC 0.6949116587638855
ep8_train_time 4.370098352432251
Test Epoch8 threshold 0.9 Acc 0.9113486842105263, AUC 0.9791646599769592, avg_entr 0.026668231934309006
ep8_t0.9_test_time 0.07146549224853516
gc 0
Train Epoch9 Acc 0.41110833333333335 (49333/120000), AUC 0.6987102031707764
ep9_train_time 4.371930360794067
Test Epoch9 threshold 0.9 Acc 0.9100328947368421, AUC 0.9791059494018555, avg_entr 0.0267287939786911
ep9_t0.9_test_time 0.07111907005310059
Best AUC 0.9811295866966248
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.9_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9223684210526316, AUC 0.9851447343826294, avg_entr 0.03425705060362816
t0.9_test_time 0.01856231689453125
