total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.4_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.91105 (109326/120000), AUC 0.9852413535118103
ep0_train_time 10.359365224838257
Test Epoch0 threshold 0.4 Acc 0.915296052631579, AUC 0.9804884195327759, avg_entr 0.02482576295733452
ep0_t0.4_test_time 0.2631704807281494
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.95015 (114018/120000), AUC 0.9933512210845947
ep1_train_time 9.921681880950928
Test Epoch1 threshold 0.4 Acc 0.9146381578947368, AUC 0.9803849458694458, avg_entr 0.026101287454366684
ep1_t0.4_test_time 0.25961804389953613
gc 0
Train Epoch2 Acc 0.9511083333333333 (114133/120000), AUC 0.9935121536254883
ep2_train_time 9.963496685028076
Test Epoch2 threshold 0.4 Acc 0.9129934210526316, AUC 0.9804089069366455, avg_entr 0.025066489353775978
ep2_t0.4_test_time 0.26238441467285156
gc 0
Train Epoch3 Acc 0.9527333333333333 (114328/120000), AUC 0.9935156106948853
ep3_train_time 10.028018236160278
Test Epoch3 threshold 0.4 Acc 0.9151315789473684, AUC 0.9801044464111328, avg_entr 0.025767888873815536
ep3_t0.4_test_time 0.25810956954956055
gc 0
Train Epoch4 Acc 0.953475 (114417/120000), AUC 0.9939315319061279
ep4_train_time 10.235350131988525
Test Epoch4 threshold 0.4 Acc 0.9139802631578947, AUC 0.9799187183380127, avg_entr 0.025404592975974083
ep4_t0.4_test_time 0.26788997650146484
gc 0
Train Epoch5 Acc 0.954875 (114585/120000), AUC 0.9945918321609497
ep5_train_time 10.224627256393433
Test Epoch5 threshold 0.4 Acc 0.9133223684210526, AUC 0.9799160957336426, avg_entr 0.025501076132059097
ep5_t0.4_test_time 0.26104164123535156
gc 0
Train Epoch6 Acc 0.9557083333333334 (114685/120000), AUC 0.9947788715362549
ep6_train_time 10.050408124923706
Test Epoch6 threshold 0.4 Acc 0.9133223684210526, AUC 0.9797186851501465, avg_entr 0.025302568450570107
ep6_t0.4_test_time 0.255889892578125
gc 0
Train Epoch7 Acc 0.955875 (114705/120000), AUC 0.994820237159729
ep7_train_time 9.994608163833618
Test Epoch7 threshold 0.4 Acc 0.9111842105263158, AUC 0.9797026515007019, avg_entr 0.026437578722834587
ep7_t0.4_test_time 0.25779128074645996
gc 0
Train Epoch8 Acc 0.9565666666666667 (114788/120000), AUC 0.9949100017547607
ep8_train_time 9.991739988327026
Test Epoch8 threshold 0.4 Acc 0.9118421052631579, AUC 0.9797006845474243, avg_entr 0.02527526393532753
ep8_t0.4_test_time 0.2579951286315918
gc 0
Train Epoch9 Acc 0.9573083333333333 (114877/120000), AUC 0.9952493906021118
ep9_train_time 10.048226118087769
Test Epoch9 threshold 0.4 Acc 0.9123355263157895, AUC 0.9795405268669128, avg_entr 0.026476111263036728
ep9_t0.4_test_time 0.2569601535797119
Best AUC 0.9804884195327759
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.4_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.925, AUC 0.9859418869018555, avg_entr 0.02414044924080372
t0.4_test_time 0.06581234931945801
