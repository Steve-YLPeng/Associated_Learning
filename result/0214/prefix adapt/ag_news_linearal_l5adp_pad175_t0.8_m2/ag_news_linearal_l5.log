total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.012667179107666
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.21081666666666668 (25298/120000), AUC 0.5869840383529663
ep0_train_time 9.210637092590332
Test Epoch0 threshold 0.8 Acc 0.906578947368421, AUC 0.9789748787879944, avg_entr 0.030277099460363388
ep0_t0.8_test_time 0.1623091697692871
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.14696666666666666 (17636/120000), AUC 0.584230899810791
ep1_train_time 8.81087851524353
Test Epoch1 threshold 0.8 Acc 0.9107894736842105, AUC 0.9790160059928894, avg_entr 0.027743589133024216
ep1_t0.8_test_time 0.15912199020385742
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.16868333333333332 (20242/120000), AUC 0.5979576706886292
ep2_train_time 8.761078357696533
Test Epoch2 threshold 0.8 Acc 0.9102631578947369, AUC 0.9788781404495239, avg_entr 0.027547314763069153
ep2_t0.8_test_time 0.15941739082336426
gc 0
Train Epoch3 Acc 0.16586666666666666 (19904/120000), AUC 0.6089722514152527
ep3_train_time 8.779850006103516
Test Epoch3 threshold 0.8 Acc 0.9121052631578948, AUC 0.9787030220031738, avg_entr 0.02644575759768486
ep3_t0.8_test_time 0.15947508811950684
gc 0
Train Epoch4 Acc 0.146875 (17625/120000), AUC 0.6169869899749756
ep4_train_time 8.83847165107727
Test Epoch4 threshold 0.8 Acc 0.9131578947368421, AUC 0.9785299301147461, avg_entr 0.025232555344700813
ep4_t0.8_test_time 0.16173577308654785
gc 0
Train Epoch5 Acc 0.131675 (15801/120000), AUC 0.6206899285316467
ep5_train_time 8.915821075439453
Test Epoch5 threshold 0.8 Acc 0.9128947368421053, AUC 0.9784864783287048, avg_entr 0.026580603793263435
ep5_t0.8_test_time 0.15919804573059082
gc 0
Train Epoch6 Acc 0.132625 (15915/120000), AUC 0.6227430701255798
ep6_train_time 8.75469183921814
Test Epoch6 threshold 0.8 Acc 0.9123684210526316, AUC 0.9783137440681458, avg_entr 0.026020780205726624
ep6_t0.8_test_time 0.15971684455871582
gc 0
Train Epoch7 Acc 0.13461666666666666 (16154/120000), AUC 0.6248757839202881
ep7_train_time 8.795953512191772
Test Epoch7 threshold 0.8 Acc 0.9076315789473685, AUC 0.978195071220398, avg_entr 0.026052482426166534
ep7_t0.8_test_time 0.15833449363708496
gc 0
Train Epoch8 Acc 0.13319166666666668 (15983/120000), AUC 0.6266822814941406
ep8_train_time 8.731532335281372
Test Epoch8 threshold 0.8 Acc 0.9089473684210526, AUC 0.978125810623169, avg_entr 0.026294635608792305
ep8_t0.8_test_time 0.1587543487548828
gc 0
Train Epoch9 Acc 0.13130833333333333 (15757/120000), AUC 0.6279221177101135
ep9_train_time 8.696768522262573
Test Epoch9 threshold 0.8 Acc 0.9121052631578948, AUC 0.9780663251876831, avg_entr 0.02685743011534214
ep9_t0.8_test_time 0.1595315933227539
Best AUC 0.9790160059928894
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 90.69355702400208
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.8_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9247368421052632, AUC 0.9852285981178284, avg_entr 0.02759416215121746
t0.8_test_time 0.15792036056518555
