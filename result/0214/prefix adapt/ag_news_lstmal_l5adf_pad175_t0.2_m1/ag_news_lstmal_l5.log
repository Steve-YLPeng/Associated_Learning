total count words 102019
vocab size 30000
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 20.010364770889282
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.30201666666666666 (36242/120000), AUC 0.5647680759429932
ep0_train_time 46.957706928253174
Test Epoch0 threshold 0.2 Acc 0.8944736842105263, AUC 0.9715520739555359, avg_entr 0.18561823666095734
ep0_t0.2_test_time 0.1630234718322754
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.2_m1//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.30135833333333334 (36163/120000), AUC 0.595374584197998
ep1_train_time 47.23260021209717
Test Epoch1 threshold 0.2 Acc 0.9094736842105263, AUC 0.975943386554718, avg_entr 0.1082630306482315
ep1_t0.2_test_time 0.16083288192749023
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.2_m1//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.2910916666666667 (34931/120000), AUC 0.5955838561058044
ep2_train_time 47.422919511795044
Test Epoch2 threshold 0.2 Acc 0.9121052631578948, AUC 0.9776096940040588, avg_entr 0.07969927787780762
ep2_t0.2_test_time 0.1609039306640625
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.2_m1//ag_news_lstmal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.28455833333333336 (34147/120000), AUC 0.5939260721206665
ep3_train_time 47.223979473114014
Test Epoch3 threshold 0.2 Acc 0.9134210526315789, AUC 0.9784754514694214, avg_entr 0.06825912743806839
ep3_t0.2_test_time 0.16032171249389648
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.2_m1//ag_news_lstmal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.279675 (33561/120000), AUC 0.5918857455253601
ep4_train_time 47.21796631813049
Test Epoch4 threshold 0.2 Acc 0.911578947368421, AUC 0.9789620041847229, avg_entr 0.05975232645869255
ep4_t0.2_test_time 0.15999174118041992
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.2_m1//ag_news_lstmal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.27598333333333336 (33118/120000), AUC 0.5901103019714355
ep5_train_time 47.222697734832764
Test Epoch5 threshold 0.2 Acc 0.9128947368421053, AUC 0.978946328163147, avg_entr 0.053761500865221024
ep5_t0.2_test_time 0.16194629669189453
gc 0
Train Epoch6 Acc 0.272475 (32697/120000), AUC 0.5882191061973572
ep6_train_time 47.1444456577301
Test Epoch6 threshold 0.2 Acc 0.9105263157894737, AUC 0.9789251685142517, avg_entr 0.05042518675327301
ep6_t0.2_test_time 0.16025328636169434
gc 0
Train Epoch7 Acc 0.26984166666666665 (32381/120000), AUC 0.5867926478385925
ep7_train_time 47.34767460823059
Test Epoch7 threshold 0.2 Acc 0.9134210526315789, AUC 0.9788745641708374, avg_entr 0.046406734734773636
ep7_t0.2_test_time 0.16208505630493164
gc 0
Train Epoch8 Acc 0.2675 (32100/120000), AUC 0.5854132175445557
ep8_train_time 47.328577756881714
Test Epoch8 threshold 0.2 Acc 0.9128947368421053, AUC 0.9785583019256592, avg_entr 0.042869292199611664
ep8_t0.2_test_time 0.16041302680969238
gc 0
Train Epoch9 Acc 0.2660166666666667 (31922/120000), AUC 0.5847540497779846
ep9_train_time 47.21958255767822
Test Epoch9 threshold 0.2 Acc 0.9089473684210526, AUC 0.9785521626472473, avg_entr 0.04172087088227272
ep9_t0.2_test_time 0.15964388847351074
Best AUC 0.9789620041847229
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 475.0933563709259
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.2_m1//ag_news_lstmal_l5_prefix.pt
Test threshold 0.2 Acc 0.9244736842105263, AUC 0.9847193956375122, avg_entr 0.05851270258426666
t0.2_test_time 0.15894293785095215
