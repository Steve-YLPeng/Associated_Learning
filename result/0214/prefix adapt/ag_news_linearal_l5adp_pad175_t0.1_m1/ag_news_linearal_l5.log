total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 29.86509418487549
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25049166666666667 (30059/120000), AUC 0.4858018159866333
ep0_train_time 10.963582754135132
Test Epoch0 threshold 0.1 Acc 0.8923684210526316, AUC 0.97133469581604, avg_entr 0.18828444182872772
ep0_t0.1_test_time 0.21062469482421875
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2503666666666667 (30044/120000), AUC 0.4299383759498596
ep1_train_time 10.634876728057861
Test Epoch1 threshold 0.1 Acc 0.9057894736842105, AUC 0.9757358431816101, avg_entr 0.10844846069812775
ep1_t0.1_test_time 0.2142477035522461
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.2501333333333333 (30016/120000), AUC 0.4195852279663086
ep2_train_time 11.156155824661255
Test Epoch2 threshold 0.1 Acc 0.9044736842105263, AUC 0.9773434400558472, avg_entr 0.08392124623060226
ep2_t0.1_test_time 0.27887964248657227
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.2500833333333333 (30010/120000), AUC 0.418916255235672
ep3_train_time 12.231473684310913
Test Epoch3 threshold 0.1 Acc 0.9110526315789473, AUC 0.9782476425170898, avg_entr 0.06848227977752686
ep3_t0.1_test_time 0.29234910011291504
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25003333333333333 (30004/120000), AUC 0.42030441761016846
ep4_train_time 12.26228952407837
Test Epoch4 threshold 0.1 Acc 0.9107894736842105, AUC 0.9786763191223145, avg_entr 0.06029214709997177
ep4_t0.1_test_time 0.21259522438049316
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25000833333333333 (30001/120000), AUC 0.42244258522987366
ep5_train_time 10.393502235412598
Test Epoch5 threshold 0.1 Acc 0.9121052631578948, AUC 0.9784873723983765, avg_entr 0.054057132452726364
ep5_t0.1_test_time 0.2187824249267578
gc 0
Train Epoch6 Acc 0.25000833333333333 (30001/120000), AUC 0.4237020015716553
ep6_train_time 11.867092370986938
Test Epoch6 threshold 0.1 Acc 0.911578947368421, AUC 0.9788090586662292, avg_entr 0.04864713177084923
ep6_t0.1_test_time 0.287416934967041
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25000833333333333 (30001/120000), AUC 0.4251037538051605
ep7_train_time 12.109906673431396
Test Epoch7 threshold 0.1 Acc 0.91, AUC 0.9788141250610352, avg_entr 0.04610767215490341
ep7_t0.1_test_time 0.19916582107543945
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.25000833333333333 (30001/120000), AUC 0.4262034296989441
ep8_train_time 10.782524585723877
Test Epoch8 threshold 0.1 Acc 0.9078947368421053, AUC 0.9784758687019348, avg_entr 0.0455813892185688
ep8_t0.1_test_time 0.21719765663146973
gc 0
Train Epoch9 Acc 0.25000833333333333 (30001/120000), AUC 0.426912784576416
ep9_train_time 11.450318574905396
Test Epoch9 threshold 0.1 Acc 0.9113157894736842, AUC 0.978374719619751, avg_entr 0.04131806641817093
ep9_t0.1_test_time 0.29247617721557617
Best AUC 0.9788141250610352
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 117.96934127807617
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9247368421052632, AUC 0.9846454858779907, avg_entr 0.045205336064100266
t0.1_test_time 0.2919464111328125
