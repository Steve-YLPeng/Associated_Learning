total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.4_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.848551988601685
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.24675833333333333 (29611/120000), AUC 0.4619230031967163
ep0_train_time 10.137447834014893
Test Epoch0 threshold 0.4 Acc 0.9092105263157895, AUC 0.9786640405654907, avg_entr 0.025919318199157715
ep0_t0.4_test_time 0.163377046585083
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.20779166666666668 (24935/120000), AUC 0.4741327166557312
ep1_train_time 9.64885687828064
Test Epoch1 threshold 0.4 Acc 0.911578947368421, AUC 0.9785640239715576, avg_entr 0.025264224037528038
ep1_t0.4_test_time 0.16208672523498535
gc 0
Train Epoch2 Acc 0.17841666666666667 (21410/120000), AUC 0.5627898573875427
ep2_train_time 9.542902946472168
Test Epoch2 threshold 0.4 Acc 0.9126315789473685, AUC 0.9783871173858643, avg_entr 0.025117097422480583
ep2_t0.4_test_time 0.1628584861755371
gc 0
Train Epoch3 Acc 0.15625 (18750/120000), AUC 0.6111780405044556
ep3_train_time 9.732264995574951
Test Epoch3 threshold 0.4 Acc 0.9102631578947369, AUC 0.9781602025032043, avg_entr 0.025756577029824257
ep3_t0.4_test_time 0.1621401309967041
gc 0
Train Epoch4 Acc 0.16445 (19734/120000), AUC 0.6484770178794861
ep4_train_time 9.735190629959106
Test Epoch4 threshold 0.4 Acc 0.9105263157894737, AUC 0.9781382083892822, avg_entr 0.02661672607064247
ep4_t0.4_test_time 0.16293978691101074
gc 0
Train Epoch5 Acc 0.17259166666666667 (20711/120000), AUC 0.6658366322517395
ep5_train_time 9.606369495391846
Test Epoch5 threshold 0.4 Acc 0.9102631578947369, AUC 0.9779918789863586, avg_entr 0.025561856105923653
ep5_t0.4_test_time 0.1627211570739746
gc 0
Train Epoch6 Acc 0.16819166666666666 (20183/120000), AUC 0.66960209608078
ep6_train_time 9.606104612350464
Test Epoch6 threshold 0.4 Acc 0.911578947368421, AUC 0.9778591990470886, avg_entr 0.025588374584913254
ep6_t0.4_test_time 0.16214466094970703
gc 0
Train Epoch7 Acc 0.16004166666666667 (19205/120000), AUC 0.6729761958122253
ep7_train_time 9.61461615562439
Test Epoch7 threshold 0.4 Acc 0.9086842105263158, AUC 0.9777399301528931, avg_entr 0.025641318410634995
ep7_t0.4_test_time 0.16250014305114746
gc 0
Train Epoch8 Acc 0.15055833333333332 (18067/120000), AUC 0.6749228239059448
ep8_train_time 9.605382442474365
Test Epoch8 threshold 0.4 Acc 0.908157894736842, AUC 0.9776385426521301, avg_entr 0.025192489847540855
ep8_t0.4_test_time 0.16237282752990723
gc 0
Train Epoch9 Acc 0.14205833333333334 (17047/120000), AUC 0.6762992143630981
ep9_train_time 9.577768325805664
Test Epoch9 threshold 0.4 Acc 0.9084210526315789, AUC 0.9775838255882263, avg_entr 0.025639455765485764
ep9_t0.4_test_time 0.16279864311218262
Best AUC 0.9786640405654907
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 99.1686098575592
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.4_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.921578947368421, AUC 0.9846756458282471, avg_entr 0.024340659379959106
t0.4_test_time 0.1630241870880127
