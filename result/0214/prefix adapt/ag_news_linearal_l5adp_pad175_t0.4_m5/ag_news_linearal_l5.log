total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.4_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.95652461051941
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9084166666666667 (109010/120000), AUC 0.984016478061676
ep0_train_time 10.519735336303711
Test Epoch0 threshold 0.4 Acc 0.9136842105263158, AUC 0.978500485420227, avg_entr 0.025820188224315643
ep0_t0.4_test_time 0.16550445556640625
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9503416666666666 (114041/120000), AUC 0.9931429624557495
ep1_train_time 10.07179594039917
Test Epoch1 threshold 0.4 Acc 0.9113157894736842, AUC 0.9781627058982849, avg_entr 0.026038318872451782
ep1_t0.4_test_time 0.16516923904418945
gc 0
Train Epoch2 Acc 0.9517 (114204/120000), AUC 0.9932264089584351
ep2_train_time 10.055463790893555
Test Epoch2 threshold 0.4 Acc 0.9086842105263158, AUC 0.9783326387405396, avg_entr 0.025144167244434357
ep2_t0.4_test_time 0.16308903694152832
gc 0
Train Epoch3 Acc 0.952475 (114297/120000), AUC 0.9933570623397827
ep3_train_time 10.026582956314087
Test Epoch3 threshold 0.4 Acc 0.9121052631578948, AUC 0.9780556559562683, avg_entr 0.025835327804088593
ep3_t0.4_test_time 0.16221332550048828
gc 0
Train Epoch4 Acc 0.9534333333333334 (114412/120000), AUC 0.9937493801116943
ep4_train_time 10.236214637756348
Test Epoch4 threshold 0.4 Acc 0.9105263157894737, AUC 0.977927029132843, avg_entr 0.02512894570827484
ep4_t0.4_test_time 0.1618330478668213
gc 0
Train Epoch5 Acc 0.9552166666666667 (114626/120000), AUC 0.9944180250167847
ep5_train_time 9.980390310287476
Test Epoch5 threshold 0.4 Acc 0.9084210526315789, AUC 0.9777930378913879, avg_entr 0.025168482214212418
ep5_t0.4_test_time 0.1612403392791748
gc 0
Train Epoch6 Acc 0.9556 (114672/120000), AUC 0.9946404695510864
ep6_train_time 10.10797381401062
Test Epoch6 threshold 0.4 Acc 0.9084210526315789, AUC 0.9777887463569641, avg_entr 0.02578051947057247
ep6_t0.4_test_time 0.16171598434448242
gc 0
Train Epoch7 Acc 0.9559666666666666 (114716/120000), AUC 0.9948937296867371
ep7_train_time 10.113070726394653
Test Epoch7 threshold 0.4 Acc 0.9060526315789473, AUC 0.9775879979133606, avg_entr 0.025739574804902077
ep7_t0.4_test_time 0.1606144905090332
gc 0
Train Epoch8 Acc 0.9566583333333334 (114799/120000), AUC 0.9949299693107605
ep8_train_time 10.061016321182251
Test Epoch8 threshold 0.4 Acc 0.9094736842105263, AUC 0.9775628447532654, avg_entr 0.024875886738300323
ep8_t0.4_test_time 0.16096091270446777
gc 0
Train Epoch9 Acc 0.9575166666666667 (114902/120000), AUC 0.9951730966567993
ep9_train_time 10.126885890960693
Test Epoch9 threshold 0.4 Acc 0.9094736842105263, AUC 0.977455735206604, avg_entr 0.025476690381765366
ep9_t0.4_test_time 0.1607348918914795
Best AUC 0.978500485420227
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 103.65765261650085
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.4_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.92, AUC 0.9846658706665039, avg_entr 0.025536468252539635
t0.4_test_time 0.1607224941253662
