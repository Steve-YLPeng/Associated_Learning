total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.6_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.86093783378601
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.25604166666666667 (30725/120000), AUC 0.5332124829292297
ep0_train_time 9.66144847869873
Test Epoch0 threshold 0.6 Acc 0.9076315789473685, AUC 0.9785840511322021, avg_entr 0.027107827365398407
ep0_t0.6_test_time 0.163177490234375
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2583916666666667 (31007/120000), AUC 0.5207111835479736
ep1_train_time 9.23066782951355
Test Epoch1 threshold 0.6 Acc 0.9086842105263158, AUC 0.9785457849502563, avg_entr 0.026705371215939522
ep1_t0.6_test_time 0.15917229652404785
gc 0
Train Epoch2 Acc 0.25855 (31026/120000), AUC 0.49039226770401
ep2_train_time 9.166472911834717
Test Epoch2 threshold 0.6 Acc 0.9092105263157895, AUC 0.9783463478088379, avg_entr 0.026670105755329132
ep2_t0.6_test_time 0.15968060493469238
gc 0
Train Epoch3 Acc 0.25883333333333336 (31060/120000), AUC 0.48166799545288086
ep3_train_time 9.158214330673218
Test Epoch3 threshold 0.6 Acc 0.9110526315789473, AUC 0.9781256914138794, avg_entr 0.025955012068152428
ep3_t0.6_test_time 0.1578357219696045
gc 0
Train Epoch4 Acc 0.2602333333333333 (31228/120000), AUC 0.5076981782913208
ep4_train_time 9.224263668060303
Test Epoch4 threshold 0.6 Acc 0.9071052631578947, AUC 0.978004515171051, avg_entr 0.02545628510415554
ep4_t0.6_test_time 0.15795397758483887
gc 0
Train Epoch5 Acc 0.2617083333333333 (31405/120000), AUC 0.5350457429885864
ep5_train_time 9.193137407302856
Test Epoch5 threshold 0.6 Acc 0.91, AUC 0.9778319597244263, avg_entr 0.026630045846104622
ep5_t0.6_test_time 0.15798234939575195
gc 0
Train Epoch6 Acc 0.263025 (31563/120000), AUC 0.5495765805244446
ep6_train_time 9.151606559753418
Test Epoch6 threshold 0.6 Acc 0.9102631578947369, AUC 0.9778087735176086, avg_entr 0.02557733841240406
ep6_t0.6_test_time 0.15790414810180664
gc 0
Train Epoch7 Acc 0.2637833333333333 (31654/120000), AUC 0.561959445476532
ep7_train_time 9.232045412063599
Test Epoch7 threshold 0.6 Acc 0.9092105263157895, AUC 0.9775375127792358, avg_entr 0.025904040783643723
ep7_t0.6_test_time 0.1593160629272461
gc 0
Train Epoch8 Acc 0.26365 (31638/120000), AUC 0.5777173042297363
ep8_train_time 9.136141538619995
Test Epoch8 threshold 0.6 Acc 0.91, AUC 0.9775035381317139, avg_entr 0.0263089407235384
ep8_t0.6_test_time 0.15910744667053223
gc 0
Train Epoch9 Acc 0.26319166666666666 (31583/120000), AUC 0.5921080112457275
ep9_train_time 9.118276357650757
Test Epoch9 threshold 0.6 Acc 0.9086842105263158, AUC 0.9774125814437866, avg_entr 0.026793282479047775
ep9_t0.6_test_time 0.15908074378967285
Best AUC 0.9785840511322021
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 94.59834122657776
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.6_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9234210526315789, AUC 0.9848300218582153, avg_entr 0.025426480919122696
t0.6_test_time 0.15729570388793945
