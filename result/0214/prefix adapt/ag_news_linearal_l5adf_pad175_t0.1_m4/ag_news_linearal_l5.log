total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.1_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.712552547454834
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.49959166666666666 (59951/120000), AUC 0.6272209882736206
ep0_train_time 9.885708093643188
Test Epoch0 threshold 0.1 Acc 0.9097368421052632, AUC 0.9785099029541016, avg_entr 0.023889247328042984
ep0_t0.1_test_time 0.17557573318481445
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.32645833333333335 (39175/120000), AUC 0.5979152917861938
ep1_train_time 9.467809438705444
Test Epoch1 threshold 0.1 Acc 0.91, AUC 0.9784956574440002, avg_entr 0.021519968286156654
ep1_t0.1_test_time 0.1732325553894043
gc 0
Train Epoch2 Acc 0.29675 (35610/120000), AUC 0.6084111928939819
ep2_train_time 9.43521237373352
Test Epoch2 threshold 0.1 Acc 0.911578947368421, AUC 0.9784080982208252, avg_entr 0.019627513363957405
ep2_t0.1_test_time 0.17420482635498047
gc 0
Train Epoch3 Acc 0.36838333333333334 (44206/120000), AUC 0.6728628873825073
ep3_train_time 9.388846158981323
Test Epoch3 threshold 0.1 Acc 0.91, AUC 0.9782931208610535, avg_entr 0.01570483110845089
ep3_t0.1_test_time 0.17322468757629395
gc 0
Train Epoch4 Acc 0.44004166666666666 (52805/120000), AUC 0.684906542301178
ep4_train_time 9.511982440948486
Test Epoch4 threshold 0.1 Acc 0.91, AUC 0.9780552387237549, avg_entr 0.013710709288716316
ep4_t0.1_test_time 0.17475342750549316
gc 0
Train Epoch5 Acc 0.4535416666666667 (54425/120000), AUC 0.6974897384643555
ep5_train_time 9.458818197250366
Test Epoch5 threshold 0.1 Acc 0.9094736842105263, AUC 0.9778625965118408, avg_entr 0.012966975569725037
ep5_t0.1_test_time 0.17481279373168945
gc 0
Train Epoch6 Acc 0.4543583333333333 (54523/120000), AUC 0.6995854377746582
ep6_train_time 9.478338479995728
Test Epoch6 threshold 0.1 Acc 0.9092105263157895, AUC 0.9777531027793884, avg_entr 0.01251414604485035
ep6_t0.1_test_time 0.17336750030517578
gc 0
Train Epoch7 Acc 0.451725 (54207/120000), AUC 0.69692462682724
ep7_train_time 9.458495616912842
Test Epoch7 threshold 0.1 Acc 0.9086842105263158, AUC 0.9776096343994141, avg_entr 0.012202119454741478
ep7_t0.1_test_time 0.17338228225708008
gc 0
Train Epoch8 Acc 0.4442833333333333 (53314/120000), AUC 0.6932032108306885
ep8_train_time 9.423563241958618
Test Epoch8 threshold 0.1 Acc 0.9092105263157895, AUC 0.9775835275650024, avg_entr 0.011546268127858639
ep8_t0.1_test_time 0.17490601539611816
gc 0
Train Epoch9 Acc 0.43774166666666664 (52529/120000), AUC 0.6889076828956604
ep9_train_time 9.510710000991821
Test Epoch9 threshold 0.1 Acc 0.9086842105263158, AUC 0.9776501655578613, avg_entr 0.011683964170515537
ep9_t0.1_test_time 0.17427778244018555
Best AUC 0.9785099029541016
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 97.50232720375061
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.1_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9218421052631579, AUC 0.9845377206802368, avg_entr 0.024020476266741753
t0.1_test_time 0.17313075065612793
