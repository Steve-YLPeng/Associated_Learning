total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.2_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 22.89666175842285
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.06523333333333334 (7828/120000), AUC 0.2885606288909912
ep0_train_time 12.366917371749878
Test Epoch0 threshold 0.2 Acc 0.9121052631578948, AUC 0.9785493612289429, avg_entr 0.024356910958886147
ep0_t0.2_test_time 0.2237682342529297
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.2_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.08435833333333333 (10123/120000), AUC 0.26731377840042114
ep1_train_time 11.927266120910645
Test Epoch1 threshold 0.2 Acc 0.9134210526315789, AUC 0.9784491658210754, avg_entr 0.02551129274070263
ep1_t0.2_test_time 0.2204289436340332
gc 0
Train Epoch2 Acc 0.16915833333333333 (20299/120000), AUC 0.2793545722961426
ep2_train_time 11.76678466796875
Test Epoch2 threshold 0.2 Acc 0.9105263157894737, AUC 0.9785904884338379, avg_entr 0.025438770651817322
ep2_t0.2_test_time 0.21961140632629395
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.2_m3//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.16843333333333332 (20212/120000), AUC 0.2870686650276184
ep3_train_time 11.770235061645508
Test Epoch3 threshold 0.2 Acc 0.9121052631578948, AUC 0.9782466888427734, avg_entr 0.025045519694685936
ep3_t0.2_test_time 0.2203388214111328
gc 0
Train Epoch4 Acc 0.13748333333333335 (16498/120000), AUC 0.27969929575920105
ep4_train_time 11.795318841934204
Test Epoch4 threshold 0.2 Acc 0.9086842105263158, AUC 0.9782185554504395, avg_entr 0.023755574598908424
ep4_t0.2_test_time 0.22269558906555176
gc 0
Train Epoch5 Acc 0.10100833333333334 (12121/120000), AUC 0.270402193069458
ep5_train_time 13.1083345413208
Test Epoch5 threshold 0.2 Acc 0.9102631578947369, AUC 0.9780784845352173, avg_entr 0.024357516318559647
ep5_t0.2_test_time 0.22354507446289062
gc 0
Train Epoch6 Acc 0.07553333333333333 (9064/120000), AUC 0.2649223208427429
ep6_train_time 11.823833465576172
Test Epoch6 threshold 0.2 Acc 0.9094736842105263, AUC 0.9780298471450806, avg_entr 0.023601606488227844
ep6_t0.2_test_time 0.22286581993103027
gc 0
Train Epoch7 Acc 0.05185833333333333 (6223/120000), AUC 0.26267093420028687
ep7_train_time 12.268914461135864
Test Epoch7 threshold 0.2 Acc 0.9102631578947369, AUC 0.9779254794120789, avg_entr 0.022806188091635704
ep7_t0.2_test_time 0.22321105003356934
gc 0
Train Epoch8 Acc 0.034325 (4119/120000), AUC 0.2626485228538513
ep8_train_time 12.733110904693604
Test Epoch8 threshold 0.2 Acc 0.9110526315789473, AUC 0.9779461622238159, avg_entr 0.022243471816182137
ep8_t0.2_test_time 0.22193169593811035
gc 0
Train Epoch9 Acc 0.026216666666666666 (3146/120000), AUC 0.2630881667137146
ep9_train_time 11.854683876037598
Test Epoch9 threshold 0.2 Acc 0.9073684210526316, AUC 0.9777399301528931, avg_entr 0.021591024473309517
ep9_t0.2_test_time 0.2235720157623291
Best AUC 0.9785904884338379
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 124.700270652771
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.2_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9247368421052632, AUC 0.9847283959388733, avg_entr 0.024661369621753693
t0.2_test_time 0.21880245208740234
