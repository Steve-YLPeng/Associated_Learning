total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.8_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 20.540560245513916
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.038033333333333336 (4564/120000), AUC 0.19528330862522125
ep0_train_time 10.085849046707153
Test Epoch0 threshold 0.8 Acc 0.9126315789473685, AUC 0.9786607027053833, avg_entr 0.0259699784219265
ep0_t0.8_test_time 0.15919733047485352
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.027141666666666668 (3257/120000), AUC 0.26612570881843567
ep1_train_time 9.626301288604736
Test Epoch1 threshold 0.8 Acc 0.9097368421052632, AUC 0.9786436557769775, avg_entr 0.025581106543540955
ep1_t0.8_test_time 0.1590747833251953
gc 0
Train Epoch2 Acc 0.018575 (2229/120000), AUC 0.3885038495063782
ep2_train_time 9.684690952301025
Test Epoch2 threshold 0.8 Acc 0.9110526315789473, AUC 0.9786363840103149, avg_entr 0.025689812377095222
ep2_t0.8_test_time 0.1587541103363037
gc 0
Train Epoch3 Acc 0.008766666666666667 (1052/120000), AUC 0.42642685770988464
ep3_train_time 9.656981229782104
Test Epoch3 threshold 0.8 Acc 0.9102631578947369, AUC 0.978268563747406, avg_entr 0.02585553750395775
ep3_t0.8_test_time 0.1579418182373047
gc 0
Train Epoch4 Acc 0.007741666666666667 (929/120000), AUC 0.4487973153591156
ep4_train_time 9.64661431312561
Test Epoch4 threshold 0.8 Acc 0.9102631578947369, AUC 0.978336751461029, avg_entr 0.027290204539895058
ep4_t0.8_test_time 0.15825510025024414
gc 0
Train Epoch5 Acc 0.007758333333333333 (931/120000), AUC 0.44853365421295166
ep5_train_time 9.662833452224731
Test Epoch5 threshold 0.8 Acc 0.9084210526315789, AUC 0.9780550599098206, avg_entr 0.026377085596323013
ep5_t0.8_test_time 0.15964436531066895
gc 0
Train Epoch6 Acc 0.007841666666666667 (941/120000), AUC 0.4459001421928406
ep6_train_time 9.666122674942017
Test Epoch6 threshold 0.8 Acc 0.9086842105263158, AUC 0.9779138565063477, avg_entr 0.026256978511810303
ep6_t0.8_test_time 0.15758180618286133
gc 0
Train Epoch7 Acc 0.0072833333333333335 (874/120000), AUC 0.44133472442626953
ep7_train_time 9.685796737670898
Test Epoch7 threshold 0.8 Acc 0.9084210526315789, AUC 0.9778034090995789, avg_entr 0.02637331560254097
ep7_t0.8_test_time 0.15831661224365234
gc 0
Train Epoch8 Acc 0.006841666666666667 (821/120000), AUC 0.4402468204498291
ep8_train_time 9.666377544403076
Test Epoch8 threshold 0.8 Acc 0.9107894736842105, AUC 0.9777804613113403, avg_entr 0.026205841451883316
ep8_t0.8_test_time 0.15900588035583496
gc 0
Train Epoch9 Acc 0.006725 (807/120000), AUC 0.44003546237945557
ep9_train_time 9.690167665481567
Test Epoch9 threshold 0.8 Acc 0.9078947368421053, AUC 0.9776666760444641, avg_entr 0.02522619627416134
ep9_t0.8_test_time 0.1578056812286377
Best AUC 0.9786607027053833
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 99.38660883903503
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9234210526315789, AUC 0.9847451448440552, avg_entr 0.025447173044085503
t0.8_test_time 0.15661978721618652
