total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m4//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 19.839696407318115
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9245916666666667 (110951/120000), AUC 0.9861588478088379
ep0_train_time 88.29846668243408
Test Epoch0 threshold 0.3 Acc 0.9105263157894737, AUC 0.9782235622406006, avg_entr 0.022743921726942062
ep0_t0.3_test_time 0.22049927711486816
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m5//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.958975 (115077/120000), AUC 0.9936904907226562
ep1_train_time 88.38196349143982
Test Epoch1 threshold 0.3 Acc 0.9113157894736842, AUC 0.9779249429702759, avg_entr 0.02371348813176155
ep1_t0.3_test_time 0.24386143684387207
gc 0
Train Epoch2 Acc 0.9617916666666667 (115415/120000), AUC 0.9939827919006348
ep2_train_time 88.32588958740234
Test Epoch2 threshold 0.3 Acc 0.9092105263157895, AUC 0.9775119423866272, avg_entr 0.023357922211289406
ep2_t0.3_test_time 0.23638081550598145
gc 0
Train Epoch3 Acc 0.96385 (115662/120000), AUC 0.994396448135376
ep3_train_time 88.30440759658813
Test Epoch3 threshold 0.3 Acc 0.9089473684210526, AUC 0.9775039553642273, avg_entr 0.02411612682044506
ep3_t0.3_test_time 0.22074460983276367
gc 0
Train Epoch4 Acc 0.9659 (115908/120000), AUC 0.9946408271789551
ep4_train_time 88.24058747291565
Test Epoch4 threshold 0.3 Acc 0.908157894736842, AUC 0.9772546291351318, avg_entr 0.02309863641858101
ep4_t0.3_test_time 0.20278525352478027
gc 0
Train Epoch5 Acc 0.9696083333333333 (116353/120000), AUC 0.9951611161231995
ep5_train_time 88.4531614780426
Test Epoch5 threshold 0.3 Acc 0.9084210526315789, AUC 0.9772186279296875, avg_entr 0.022945823147892952
ep5_t0.3_test_time 0.21280336380004883
gc 0
Train Epoch6 Acc 0.9706583333333333 (116479/120000), AUC 0.9953398704528809
ep6_train_time 88.39571523666382
Test Epoch6 threshold 0.3 Acc 0.9084210526315789, AUC 0.9769562482833862, avg_entr 0.022745147347450256
ep6_t0.3_test_time 0.1997988224029541
gc 0
Train Epoch7 Acc 0.9715833333333334 (116590/120000), AUC 0.9952409863471985
ep7_train_time 88.25053000450134
Test Epoch7 threshold 0.3 Acc 0.9044736842105263, AUC 0.9772481322288513, avg_entr 0.023315589874982834
ep7_t0.3_test_time 0.2102348804473877
gc 0
Train Epoch8 Acc 0.9726666666666667 (116720/120000), AUC 0.9953229427337646
ep8_train_time 88.21422672271729
Test Epoch8 threshold 0.3 Acc 0.9071052631578947, AUC 0.9769336581230164, avg_entr 0.02301691100001335
ep8_t0.3_test_time 0.20502519607543945
gc 0
Train Epoch9 Acc 0.97445 (116934/120000), AUC 0.995668888092041
ep9_train_time 88.30482482910156
Test Epoch9 threshold 0.3 Acc 0.9092105263157895, AUC 0.976862907409668, avg_entr 0.02394638955593109
ep9_t0.3_test_time 0.20013666152954102
Best AUC 0.9782235622406006
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 886.0935864448547
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m5//ag_news_lstmal_l5_prefix.pt
Test threshold 0.3 Acc 0.9231578947368421, AUC 0.9841468334197998, avg_entr 0.02151562087237835
t0.3_test_time 0.25029420852661133
