total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.225409984588623
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.24980833333333333 (29977/120000), AUC 0.2859148383140564
ep0_train_time 9.614227056503296
Test Epoch0 threshold 0.6 Acc 0.9105263157894737, AUC 0.9790273904800415, avg_entr 0.026220867410302162
ep0_t0.6_test_time 0.1600799560546875
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.249975 (29997/120000), AUC 0.19590231776237488
ep1_train_time 9.2129487991333
Test Epoch1 threshold 0.6 Acc 0.9110526315789473, AUC 0.9790351986885071, avg_entr 0.02691897191107273
ep1_t0.6_test_time 0.15960121154785156
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.20618633925914764
ep2_train_time 9.090181350708008
Test Epoch2 threshold 0.6 Acc 0.9102631578947369, AUC 0.9789247512817383, avg_entr 0.02632400393486023
ep2_t0.6_test_time 0.15846467018127441
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.20379634201526642
ep3_train_time 9.19412350654602
Test Epoch3 threshold 0.6 Acc 0.9110526315789473, AUC 0.9786462187767029, avg_entr 0.026267698034644127
ep3_t0.6_test_time 0.1593167781829834
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.27321791648864746
ep4_train_time 9.120628595352173
Test Epoch4 threshold 0.6 Acc 0.9089473684210526, AUC 0.978344202041626, avg_entr 0.026714861392974854
ep4_t0.6_test_time 0.1571953296661377
gc 0
Train Epoch5 Acc 0.24999166666666667 (29999/120000), AUC 0.3505849838256836
ep5_train_time 9.088445663452148
Test Epoch5 threshold 0.6 Acc 0.9126315789473685, AUC 0.9783357381820679, avg_entr 0.026511484757065773
ep5_t0.6_test_time 0.1577436923980713
gc 0
Train Epoch6 Acc 0.24998333333333334 (29998/120000), AUC 0.38486766815185547
ep6_train_time 9.282322883605957
Test Epoch6 threshold 0.6 Acc 0.9105263157894737, AUC 0.9781589508056641, avg_entr 0.025657424703240395
ep6_t0.6_test_time 0.15772533416748047
gc 0
Train Epoch7 Acc 0.24998333333333334 (29998/120000), AUC 0.4204837381839752
ep7_train_time 9.205147981643677
Test Epoch7 threshold 0.6 Acc 0.9094736842105263, AUC 0.9780265092849731, avg_entr 0.026268433779478073
ep7_t0.6_test_time 0.15716934204101562
gc 0
Train Epoch8 Acc 0.250075 (30009/120000), AUC 0.4401887059211731
ep8_train_time 9.180418968200684
Test Epoch8 threshold 0.6 Acc 0.9092105263157895, AUC 0.9779752492904663, avg_entr 0.026183178648352623
ep8_t0.6_test_time 0.15807771682739258
gc 0
Train Epoch9 Acc 0.25059166666666666 (30071/120000), AUC 0.44739145040512085
ep9_train_time 9.117222309112549
Test Epoch9 threshold 0.6 Acc 0.9094736842105263, AUC 0.9779126644134521, avg_entr 0.025679826736450195
ep9_t0.6_test_time 0.15790891647338867
Best AUC 0.9790351986885071
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 94.49080514907837
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9247368421052632, AUC 0.9850389957427979, avg_entr 0.026230502873659134
t0.6_test_time 0.15683579444885254
