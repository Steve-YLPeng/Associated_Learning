total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.2_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 23.914787769317627
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9018416666666667 (108221/120000), AUC 0.9846354126930237
ep0_train_time 15.702515125274658
Test Epoch0 threshold 0.2 Acc 0.9107894736842105, AUC 0.9784235954284668, avg_entr 0.022365963086485863
ep0_t0.2_test_time 0.23962974548339844
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.2_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.951475 (114177/120000), AUC 0.9935680627822876
ep1_train_time 14.874716520309448
Test Epoch1 threshold 0.2 Acc 0.9102631578947369, AUC 0.978002667427063, avg_entr 0.019576093181967735
ep1_t0.2_test_time 0.24071288108825684
gc 0
Train Epoch2 Acc 0.95265 (114318/120000), AUC 0.9937014579772949
ep2_train_time 13.304222345352173
Test Epoch2 threshold 0.2 Acc 0.9092105263157895, AUC 0.9779553413391113, avg_entr 0.019141027703881264
ep2_t0.2_test_time 0.23924708366394043
gc 0
Train Epoch3 Acc 0.9539666666666666 (114476/120000), AUC 0.9936975240707397
ep3_train_time 14.184457778930664
Test Epoch3 threshold 0.2 Acc 0.9110526315789473, AUC 0.9776934385299683, avg_entr 0.01794140227138996
ep3_t0.2_test_time 0.23914241790771484
gc 0
Train Epoch4 Acc 0.9545916666666666 (114551/120000), AUC 0.9943671226501465
ep4_train_time 14.882604360580444
Test Epoch4 threshold 0.2 Acc 0.91, AUC 0.9776837825775146, avg_entr 0.016937412321567535
ep4_t0.2_test_time 0.23722290992736816
gc 0
Train Epoch5 Acc 0.9565 (114780/120000), AUC 0.994809091091156
ep5_train_time 13.29163122177124
Test Epoch5 threshold 0.2 Acc 0.9105263157894737, AUC 0.977596640586853, avg_entr 0.017430923879146576
ep5_t0.2_test_time 0.2391364574432373
gc 0
Train Epoch6 Acc 0.956875 (114825/120000), AUC 0.9949527978897095
ep6_train_time 13.263690948486328
Test Epoch6 threshold 0.2 Acc 0.9084210526315789, AUC 0.9773387908935547, avg_entr 0.01722828671336174
ep6_t0.2_test_time 0.23723101615905762
gc 0
Train Epoch7 Acc 0.956975 (114837/120000), AUC 0.9950323700904846
ep7_train_time 14.180155038833618
Test Epoch7 threshold 0.2 Acc 0.9071052631578947, AUC 0.9771932363510132, avg_entr 0.01653597317636013
ep7_t0.2_test_time 0.23543453216552734
gc 0
Train Epoch8 Acc 0.9575166666666667 (114902/120000), AUC 0.995087742805481
ep8_train_time 16.34681797027588
Test Epoch8 threshold 0.2 Acc 0.9094736842105263, AUC 0.9769870042800903, avg_entr 0.015977278351783752
ep8_t0.2_test_time 0.3083512783050537
gc 0
Train Epoch9 Acc 0.9583916666666666 (115007/120000), AUC 0.9952907562255859
ep9_train_time 14.820598363876343
Test Epoch9 threshold 0.2 Acc 0.9073684210526316, AUC 0.9771460294723511, avg_entr 0.01673698239028454
ep9_t0.2_test_time 0.281383752822876
Best AUC 0.9784235954284668
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 148.52189135551453
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.2_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9221052631578948, AUC 0.9843535423278809, avg_entr 0.020862607285380363
t0.2_test_time 0.3676300048828125
