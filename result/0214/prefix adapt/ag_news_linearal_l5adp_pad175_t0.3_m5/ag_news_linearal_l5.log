total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.3_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.999427318572998
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9100916666666666 (109211/120000), AUC 0.9858108758926392
ep0_train_time 10.366647481918335
Test Epoch0 threshold 0.3 Acc 0.911578947368421, AUC 0.9786270260810852, avg_entr 0.02638251706957817
ep0_t0.3_test_time 0.1735689640045166
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.948975 (113877/120000), AUC 0.9929993152618408
ep1_train_time 10.087941646575928
Test Epoch1 threshold 0.3 Acc 0.9092105263157895, AUC 0.9786480069160461, avg_entr 0.02602098137140274
ep1_t0.3_test_time 0.16783928871154785
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m5//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9509416666666667 (114113/120000), AUC 0.9932582378387451
ep2_train_time 10.096059799194336
Test Epoch2 threshold 0.3 Acc 0.9086842105263158, AUC 0.978331446647644, avg_entr 0.025812942534685135
ep2_t0.3_test_time 0.17363190650939941
gc 0
Train Epoch3 Acc 0.9519 (114228/120000), AUC 0.9932342767715454
ep3_train_time 10.070230960845947
Test Epoch3 threshold 0.3 Acc 0.9110526315789473, AUC 0.9783034920692444, avg_entr 0.025530152022838593
ep3_t0.3_test_time 0.17360186576843262
gc 0
Train Epoch4 Acc 0.953 (114360/120000), AUC 0.993588924407959
ep4_train_time 10.063729286193848
Test Epoch4 threshold 0.3 Acc 0.9084210526315789, AUC 0.9780516028404236, avg_entr 0.025798892602324486
ep4_t0.3_test_time 0.1715238094329834
gc 0
Train Epoch5 Acc 0.9547 (114564/120000), AUC 0.9942607879638672
ep5_train_time 10.143510818481445
Test Epoch5 threshold 0.3 Acc 0.9089473684210526, AUC 0.9780927300453186, avg_entr 0.024906644597649574
ep5_t0.3_test_time 0.16965365409851074
gc 0
Train Epoch6 Acc 0.9551416666666667 (114617/120000), AUC 0.9944866895675659
ep6_train_time 10.07503366470337
Test Epoch6 threshold 0.3 Acc 0.9084210526315789, AUC 0.9779244661331177, avg_entr 0.025410166010260582
ep6_t0.3_test_time 0.1694498062133789
gc 0
Train Epoch7 Acc 0.9557 (114684/120000), AUC 0.994606614112854
ep7_train_time 10.002146482467651
Test Epoch7 threshold 0.3 Acc 0.9071052631578947, AUC 0.9778145551681519, avg_entr 0.024891937151551247
ep7_t0.3_test_time 0.16982555389404297
gc 0
Train Epoch8 Acc 0.9560333333333333 (114724/120000), AUC 0.9948355555534363
ep8_train_time 10.109188318252563
Test Epoch8 threshold 0.3 Acc 0.9057894736842105, AUC 0.9776577949523926, avg_entr 0.02470545843243599
ep8_t0.3_test_time 0.16971898078918457
gc 0
Train Epoch9 Acc 0.9574 (114888/120000), AUC 0.9950970411300659
ep9_train_time 9.980557203292847
Test Epoch9 threshold 0.3 Acc 0.9092105263157895, AUC 0.9776204824447632, avg_entr 0.025224123150110245
ep9_t0.3_test_time 0.17241859436035156
Best AUC 0.9786480069160461
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 103.50975513458252
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.3_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9239473684210526, AUC 0.9843831658363342, avg_entr 0.025159690529108047
t0.3_test_time 0.1697995662689209
