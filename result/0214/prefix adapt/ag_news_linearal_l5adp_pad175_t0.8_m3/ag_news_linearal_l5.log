total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.8_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.688161373138428
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.448025 (53763/120000), AUC 0.6905946731567383
ep0_train_time 9.710848569869995
Test Epoch0 threshold 0.8 Acc 0.9131578947368421, AUC 0.9788854122161865, avg_entr 0.026366950944066048
ep0_t0.8_test_time 0.16295742988586426
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.492775 (59133/120000), AUC 0.6948633193969727
ep1_train_time 9.289001226425171
Test Epoch1 threshold 0.8 Acc 0.9110526315789473, AUC 0.9787188172340393, avg_entr 0.026369608938694
ep1_t0.8_test_time 0.1577136516571045
gc 0
Train Epoch2 Acc 0.4959166666666667 (59510/120000), AUC 0.6820240020751953
ep2_train_time 9.253523588180542
Test Epoch2 threshold 0.8 Acc 0.911578947368421, AUC 0.9786601662635803, avg_entr 0.02557431533932686
ep2_t0.8_test_time 0.15872693061828613
gc 0
Train Epoch3 Acc 0.49606666666666666 (59528/120000), AUC 0.6712805032730103
ep3_train_time 9.300535678863525
Test Epoch3 threshold 0.8 Acc 0.9123684210526316, AUC 0.9784294366836548, avg_entr 0.02574465237557888
ep3_t0.8_test_time 0.15869808197021484
gc 0
Train Epoch4 Acc 0.49525833333333336 (59431/120000), AUC 0.6714847087860107
ep4_train_time 9.189738512039185
Test Epoch4 threshold 0.8 Acc 0.9118421052631579, AUC 0.978265643119812, avg_entr 0.026308415457606316
ep4_t0.8_test_time 0.15821576118469238
gc 0
Train Epoch5 Acc 0.49575 (59490/120000), AUC 0.6777932047843933
ep5_train_time 9.207367420196533
Test Epoch5 threshold 0.8 Acc 0.9110526315789473, AUC 0.9781967401504517, avg_entr 0.026434697210788727
ep5_t0.8_test_time 0.15892815589904785
gc 0
Train Epoch6 Acc 0.49609166666666665 (59531/120000), AUC 0.6829137802124023
ep6_train_time 9.221088409423828
Test Epoch6 threshold 0.8 Acc 0.91, AUC 0.9779883027076721, avg_entr 0.025871600955724716
ep6_t0.8_test_time 0.15804719924926758
gc 0
Train Epoch7 Acc 0.49635833333333335 (59563/120000), AUC 0.6842257976531982
ep7_train_time 9.220178842544556
Test Epoch7 threshold 0.8 Acc 0.9113157894736842, AUC 0.9779247045516968, avg_entr 0.025930671021342278
ep7_t0.8_test_time 0.16108989715576172
gc 0
Train Epoch8 Acc 0.49655 (59586/120000), AUC 0.6817008256912231
ep8_train_time 9.28222942352295
Test Epoch8 threshold 0.8 Acc 0.9118421052631579, AUC 0.9778078198432922, avg_entr 0.026113593950867653
ep8_t0.8_test_time 0.16113686561584473
gc 0
Train Epoch9 Acc 0.496275 (59553/120000), AUC 0.6748513579368591
ep9_train_time 9.309784412384033
Test Epoch9 threshold 0.8 Acc 0.9105263157894737, AUC 0.9777227640151978, avg_entr 0.027025584131479263
ep9_t0.8_test_time 0.1587073802947998
Best AUC 0.9788854122161865
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 95.30846333503723
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.8_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9273684210526316, AUC 0.9850265383720398, avg_entr 0.025546347722411156
t0.8_test_time 0.15646767616271973
