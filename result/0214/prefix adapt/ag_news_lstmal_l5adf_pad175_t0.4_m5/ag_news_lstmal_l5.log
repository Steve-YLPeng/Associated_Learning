total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad175_t0.4_m4//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 20.165855407714844
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9335166666666667 (112022/120000), AUC 0.9863572716712952
ep0_train_time 88.63871121406555
Test Epoch0 threshold 0.4 Acc 0.9110526315789473, AUC 0.9780789613723755, avg_entr 0.02575940452516079
ep0_t0.4_test_time 0.18453454971313477
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.4_m5//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.959475 (115137/120000), AUC 0.9935849905014038
ep1_train_time 88.46364569664001
Test Epoch1 threshold 0.4 Acc 0.9107894736842105, AUC 0.9778790473937988, avg_entr 0.025383051484823227
ep1_t0.4_test_time 0.18242979049682617
gc 0
Train Epoch2 Acc 0.9618416666666667 (115421/120000), AUC 0.993791937828064
ep2_train_time 88.54767322540283
Test Epoch2 threshold 0.4 Acc 0.9084210526315789, AUC 0.9775418043136597, avg_entr 0.024561362341046333
ep2_t0.4_test_time 0.18434524536132812
gc 0
Train Epoch3 Acc 0.9641166666666666 (115694/120000), AUC 0.9942619800567627
ep3_train_time 88.57809853553772
Test Epoch3 threshold 0.4 Acc 0.9078947368421053, AUC 0.9776444435119629, avg_entr 0.024757597595453262
ep3_t0.4_test_time 0.17121124267578125
gc 0
Train Epoch4 Acc 0.9657083333333333 (115885/120000), AUC 0.994560718536377
ep4_train_time 88.44320607185364
Test Epoch4 threshold 0.4 Acc 0.9073684210526316, AUC 0.9775693416595459, avg_entr 0.02526642382144928
ep4_t0.4_test_time 0.18932819366455078
gc 0
Train Epoch5 Acc 0.9690333333333333 (116284/120000), AUC 0.9951761960983276
ep5_train_time 88.52399849891663
Test Epoch5 threshold 0.4 Acc 0.908157894736842, AUC 0.9774554967880249, avg_entr 0.02469453029334545
ep5_t0.4_test_time 0.18679165840148926
gc 0
Train Epoch6 Acc 0.970225 (116427/120000), AUC 0.9951879978179932
ep6_train_time 88.55401420593262
Test Epoch6 threshold 0.4 Acc 0.9094736842105263, AUC 0.9772377014160156, avg_entr 0.025533169507980347
ep6_t0.4_test_time 0.1796252727508545
gc 0
Train Epoch7 Acc 0.9711416666666667 (116537/120000), AUC 0.9952585697174072
ep7_train_time 88.46295547485352
Test Epoch7 threshold 0.4 Acc 0.9071052631578947, AUC 0.9772319793701172, avg_entr 0.025119205936789513
ep7_t0.4_test_time 0.1804332733154297
gc 0
Train Epoch8 Acc 0.9722833333333334 (116674/120000), AUC 0.9954864978790283
ep8_train_time 88.42584896087646
Test Epoch8 threshold 0.4 Acc 0.9102631578947369, AUC 0.9771551489830017, avg_entr 0.025281449779868126
ep8_t0.4_test_time 0.18018245697021484
gc 0
Train Epoch9 Acc 0.9739 (116868/120000), AUC 0.9957162737846375
ep9_train_time 88.4302167892456
Test Epoch9 threshold 0.4 Acc 0.908157894736842, AUC 0.9770528674125671, avg_entr 0.024627158418297768
ep9_t0.4_test_time 0.18397831916809082
Best AUC 0.9780789613723755
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 887.6602520942688
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.4_m5//ag_news_lstmal_l5_prefix.pt
Test threshold 0.4 Acc 0.9226315789473685, AUC 0.9842584729194641, avg_entr 0.024088287726044655
t0.4_test_time 0.18625330924987793
