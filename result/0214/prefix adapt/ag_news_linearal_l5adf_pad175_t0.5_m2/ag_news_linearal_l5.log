total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.30877995491028
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.25040833333333334 (30049/120000), AUC 0.5113937854766846
ep0_train_time 10.051129817962646
Test Epoch0 threshold 0.5 Acc 0.9068421052631579, AUC 0.9791086912155151, avg_entr 0.03115268237888813
ep0_t0.5_test_time 0.1696624755859375
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25130833333333336 (30157/120000), AUC 0.5660797357559204
ep1_train_time 9.511024475097656
Test Epoch1 threshold 0.5 Acc 0.9123684210526316, AUC 0.9789182543754578, avg_entr 0.027873674407601357
ep1_t0.5_test_time 0.16739869117736816
gc 0
Train Epoch2 Acc 0.25448333333333334 (30538/120000), AUC 0.5788840055465698
ep2_train_time 9.506705522537231
Test Epoch2 threshold 0.5 Acc 0.9123684210526316, AUC 0.9788037538528442, avg_entr 0.026905156672000885
ep2_t0.5_test_time 0.16691374778747559
gc 0
Train Epoch3 Acc 0.26015 (31218/120000), AUC 0.5811737775802612
ep3_train_time 9.440148830413818
Test Epoch3 threshold 0.5 Acc 0.9110526315789473, AUC 0.9785484671592712, avg_entr 0.027330726385116577
ep3_t0.5_test_time 0.16807150840759277
gc 0
Train Epoch4 Acc 0.26355 (31626/120000), AUC 0.578450083732605
ep4_train_time 9.543438911437988
Test Epoch4 threshold 0.5 Acc 0.9118421052631579, AUC 0.9786415696144104, avg_entr 0.02807082049548626
ep4_t0.5_test_time 0.1679086685180664
gc 0
Train Epoch5 Acc 0.26416666666666666 (31700/120000), AUC 0.5753819346427917
ep5_train_time 9.438241004943848
Test Epoch5 threshold 0.5 Acc 0.9105263157894737, AUC 0.9784739017486572, avg_entr 0.026271097362041473
ep5_t0.5_test_time 0.16701126098632812
gc 0
Train Epoch6 Acc 0.26445 (31734/120000), AUC 0.5746262073516846
ep6_train_time 9.50832223892212
Test Epoch6 threshold 0.5 Acc 0.911578947368421, AUC 0.9783991575241089, avg_entr 0.026932712644338608
ep6_t0.5_test_time 0.16823577880859375
gc 0
Train Epoch7 Acc 0.26510833333333333 (31813/120000), AUC 0.5744042992591858
ep7_train_time 9.522634983062744
Test Epoch7 threshold 0.5 Acc 0.9110526315789473, AUC 0.9782876968383789, avg_entr 0.02627369575202465
ep7_t0.5_test_time 0.1669607162475586
gc 0
Train Epoch8 Acc 0.26675 (32010/120000), AUC 0.5738019347190857
ep8_train_time 9.480310201644897
Test Epoch8 threshold 0.5 Acc 0.9105263157894737, AUC 0.9781964421272278, avg_entr 0.026482773944735527
ep8_t0.5_test_time 0.16757416725158691
gc 0
Train Epoch9 Acc 0.26866666666666666 (32240/120000), AUC 0.5734812021255493
ep9_train_time 9.558432340621948
Test Epoch9 threshold 0.5 Acc 0.9107894736842105, AUC 0.9781299829483032, avg_entr 0.026491302996873856
ep9_t0.5_test_time 0.16702008247375488
Best AUC 0.9791086912155151
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 98.04540538787842
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.5_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9239473684210526, AUC 0.98515784740448, avg_entr 0.029402034357190132
t0.5_test_time 0.16813230514526367
