total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.2_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.362140893936157
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.4879583333333333 (58555/120000), AUC 0.5342660546302795
ep0_train_time 10.053356647491455
Test Epoch0 threshold 0.2 Acc 0.9134210526315789, AUC 0.9783859252929688, avg_entr 0.02465439774096012
ep0_t0.2_test_time 0.17721176147460938
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.4920833333333333 (59050/120000), AUC 0.5359852313995361
ep1_train_time 9.58828592300415
Test Epoch1 threshold 0.2 Acc 0.911578947368421, AUC 0.9783351421356201, avg_entr 0.023782270029187202
ep1_t0.2_test_time 0.17621374130249023
gc 0
Train Epoch2 Acc 0.4905333333333333 (58864/120000), AUC 0.54914790391922
ep2_train_time 9.725448369979858
Test Epoch2 threshold 0.2 Acc 0.9094736842105263, AUC 0.9780853986740112, avg_entr 0.02229750156402588
ep2_t0.2_test_time 0.17534351348876953
gc 0
Train Epoch3 Acc 0.4881083333333333 (58573/120000), AUC 0.5555853843688965
ep3_train_time 9.604731321334839
Test Epoch3 threshold 0.2 Acc 0.911578947368421, AUC 0.9779980182647705, avg_entr 0.020743900910019875
ep3_t0.2_test_time 0.1762993335723877
gc 0
Train Epoch4 Acc 0.48461666666666664 (58154/120000), AUC 0.5573225021362305
ep4_train_time 9.62307596206665
Test Epoch4 threshold 0.2 Acc 0.9097368421052632, AUC 0.9776599407196045, avg_entr 0.01885547861456871
ep4_t0.2_test_time 0.1804966926574707
gc 0
Train Epoch5 Acc 0.48281666666666667 (57938/120000), AUC 0.5627059936523438
ep5_train_time 9.529647588729858
Test Epoch5 threshold 0.2 Acc 0.9089473684210526, AUC 0.9779268503189087, avg_entr 0.01790251024067402
ep5_t0.2_test_time 0.1760101318359375
gc 0
Train Epoch6 Acc 0.4824833333333333 (57898/120000), AUC 0.5656090378761292
ep6_train_time 9.564009428024292
Test Epoch6 threshold 0.2 Acc 0.908157894736842, AUC 0.9776487350463867, avg_entr 0.018391745164990425
ep6_t0.2_test_time 0.17504405975341797
gc 0
Train Epoch7 Acc 0.48283333333333334 (57940/120000), AUC 0.5689048171043396
ep7_train_time 9.664250612258911
Test Epoch7 threshold 0.2 Acc 0.908157894736842, AUC 0.9774125814437866, avg_entr 0.017856143414974213
ep7_t0.2_test_time 0.18012213706970215
gc 0
Train Epoch8 Acc 0.48325833333333335 (57991/120000), AUC 0.5709202885627747
ep8_train_time 9.576082944869995
Test Epoch8 threshold 0.2 Acc 0.906578947368421, AUC 0.9775223731994629, avg_entr 0.016967186704277992
ep8_t0.2_test_time 0.1753225326538086
gc 0
Train Epoch9 Acc 0.48370833333333335 (58045/120000), AUC 0.5727404952049255
ep9_train_time 9.586888790130615
Test Epoch9 threshold 0.2 Acc 0.9078947368421053, AUC 0.9773614406585693, avg_entr 0.01728859171271324
ep9_t0.2_test_time 0.17554450035095215
Best AUC 0.9783859252929688
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 99.01255345344543
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.2_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9247368421052632, AUC 0.9846731424331665, avg_entr 0.02445579506456852
t0.2_test_time 0.1740272045135498
