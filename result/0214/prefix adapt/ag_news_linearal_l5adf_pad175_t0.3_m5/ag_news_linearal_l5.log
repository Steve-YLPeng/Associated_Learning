total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.3_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.734015226364136
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.922175 (110661/120000), AUC 0.9856910705566406
ep0_train_time 10.416223526000977
Test Epoch0 threshold 0.3 Acc 0.9110526315789473, AUC 0.9782591462135315, avg_entr 0.025336362421512604
ep0_t0.3_test_time 0.1719808578491211
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9496916666666667 (113963/120000), AUC 0.9928662776947021
ep1_train_time 9.963805675506592
Test Epoch1 threshold 0.3 Acc 0.9094736842105263, AUC 0.9781227111816406, avg_entr 0.02564636990427971
ep1_t0.3_test_time 0.17051219940185547
gc 0
Train Epoch2 Acc 0.9507833333333333 (114094/120000), AUC 0.9930356740951538
ep2_train_time 9.956681251525879
Test Epoch2 threshold 0.3 Acc 0.9123684210526316, AUC 0.9780771732330322, avg_entr 0.02452908083796501
ep2_t0.3_test_time 0.16783881187438965
gc 0
Train Epoch3 Acc 0.951925 (114231/120000), AUC 0.9930591583251953
ep3_train_time 10.018259286880493
Test Epoch3 threshold 0.3 Acc 0.9094736842105263, AUC 0.9777017831802368, avg_entr 0.025666892528533936
ep3_t0.3_test_time 0.16742348670959473
gc 0
Train Epoch4 Acc 0.9532666666666667 (114392/120000), AUC 0.9936246871948242
ep4_train_time 9.979448795318604
Test Epoch4 threshold 0.3 Acc 0.9118421052631579, AUC 0.9778228998184204, avg_entr 0.024938033893704414
ep4_t0.3_test_time 0.16817784309387207
gc 0
Train Epoch5 Acc 0.95515 (114618/120000), AUC 0.9942488074302673
ep5_train_time 9.993882179260254
Test Epoch5 threshold 0.3 Acc 0.9076315789473685, AUC 0.9776371717453003, avg_entr 0.025342924520373344
ep5_t0.3_test_time 0.16928505897521973
gc 0
Train Epoch6 Acc 0.955575 (114669/120000), AUC 0.994498610496521
ep6_train_time 10.015170812606812
Test Epoch6 threshold 0.3 Acc 0.9110526315789473, AUC 0.9775881171226501, avg_entr 0.024464717134833336
ep6_t0.3_test_time 0.16664457321166992
gc 0
Train Epoch7 Acc 0.9560416666666667 (114725/120000), AUC 0.9946004748344421
ep7_train_time 10.094377040863037
Test Epoch7 threshold 0.3 Acc 0.908157894736842, AUC 0.9775443077087402, avg_entr 0.024537552148103714
ep7_t0.3_test_time 0.16697430610656738
gc 0
Train Epoch8 Acc 0.9564583333333333 (114775/120000), AUC 0.994813859462738
ep8_train_time 9.960657835006714
Test Epoch8 threshold 0.3 Acc 0.9060526315789473, AUC 0.9773687124252319, avg_entr 0.024424903094768524
ep8_t0.3_test_time 0.1676628589630127
gc 0
Train Epoch9 Acc 0.9574583333333333 (114895/120000), AUC 0.995122492313385
ep9_train_time 9.99811840057373
Test Epoch9 threshold 0.3 Acc 0.9097368421052632, AUC 0.9773529171943665, avg_entr 0.024668075144290924
ep9_t0.3_test_time 0.168898344039917
Best AUC 0.9782591462135315
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 102.80617690086365
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.3_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9242105263157895, AUC 0.9845669269561768, avg_entr 0.024785565212368965
t0.3_test_time 0.17304611206054688
