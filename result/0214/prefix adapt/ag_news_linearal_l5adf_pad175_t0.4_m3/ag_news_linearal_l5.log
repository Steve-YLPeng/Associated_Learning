total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.4_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.08143138885498
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.3329916666666667 (39959/120000), AUC 0.5393868684768677
ep0_train_time 9.587218523025513
Test Epoch0 threshold 0.4 Acc 0.9113157894736842, AUC 0.9789981842041016, avg_entr 0.02598237805068493
ep0_t0.4_test_time 0.16485357284545898
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.349675 (41961/120000), AUC 0.5579936504364014
ep1_train_time 9.09923529624939
Test Epoch1 threshold 0.4 Acc 0.9144736842105263, AUC 0.978728175163269, avg_entr 0.025775302201509476
ep1_t0.4_test_time 0.16287803649902344
gc 0
Train Epoch2 Acc 0.373375 (44805/120000), AUC 0.5705825090408325
ep2_train_time 9.156271696090698
Test Epoch2 threshold 0.4 Acc 0.9092105263157895, AUC 0.9786239266395569, avg_entr 0.025716563686728477
ep2_t0.4_test_time 0.16174030303955078
gc 0
Train Epoch3 Acc 0.3911833333333333 (46942/120000), AUC 0.5803629159927368
ep3_train_time 9.140355825424194
Test Epoch3 threshold 0.4 Acc 0.9102631578947369, AUC 0.9784884452819824, avg_entr 0.02587617188692093
ep3_t0.4_test_time 0.16093158721923828
gc 0
Train Epoch4 Acc 0.3675583333333333 (44107/120000), AUC 0.5924279689788818
ep4_train_time 9.077964544296265
Test Epoch4 threshold 0.4 Acc 0.9107894736842105, AUC 0.9781816601753235, avg_entr 0.026395907625555992
ep4_t0.4_test_time 0.16194415092468262
gc 0
Train Epoch5 Acc 0.2674166666666667 (32090/120000), AUC 0.6023021936416626
ep5_train_time 9.175335168838501
Test Epoch5 threshold 0.4 Acc 0.9110526315789473, AUC 0.9781273603439331, avg_entr 0.02604432962834835
ep5_t0.4_test_time 0.16170668601989746
gc 0
Train Epoch6 Acc 0.220375 (26445/120000), AUC 0.6083407998085022
ep6_train_time 9.159786462783813
Test Epoch6 threshold 0.4 Acc 0.9084210526315789, AUC 0.9780369400978088, avg_entr 0.025124162435531616
ep6_t0.4_test_time 0.16154956817626953
gc 0
Train Epoch7 Acc 0.20375833333333335 (24451/120000), AUC 0.6122099161148071
ep7_train_time 9.16206431388855
Test Epoch7 threshold 0.4 Acc 0.9113157894736842, AUC 0.9778657555580139, avg_entr 0.02592059224843979
ep7_t0.4_test_time 0.16098427772521973
gc 0
Train Epoch8 Acc 0.19158333333333333 (22990/120000), AUC 0.6130280494689941
ep8_train_time 9.193350791931152
Test Epoch8 threshold 0.4 Acc 0.9105263157894737, AUC 0.9778828024864197, avg_entr 0.025431456044316292
ep8_t0.4_test_time 0.16161084175109863
gc 0
Train Epoch9 Acc 0.18281666666666666 (21938/120000), AUC 0.6128935813903809
ep9_train_time 9.194864511489868
Test Epoch9 threshold 0.4 Acc 0.908157894736842, AUC 0.9776921272277832, avg_entr 0.02552276849746704
ep9_t0.4_test_time 0.1617882251739502
Best AUC 0.9789981842041016
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 94.29625725746155
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.4_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9231578947368421, AUC 0.9850343465805054, avg_entr 0.02571859024465084
t0.4_test_time 0.1622614860534668
