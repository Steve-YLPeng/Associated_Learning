total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.7_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.424285650253296
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.41546666666666665 (49856/120000), AUC 0.6465951204299927
ep0_train_time 10.219127178192139
Test Epoch0 threshold 0.7 Acc 0.9084210526315789, AUC 0.9789770841598511, avg_entr 0.027305614203214645
ep0_t0.7_test_time 0.1705307960510254
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.437625 (52515/120000), AUC 0.6563299298286438
ep1_train_time 9.906446933746338
Test Epoch1 threshold 0.7 Acc 0.9128947368421053, AUC 0.9788696765899658, avg_entr 0.027058938518166542
ep1_t0.7_test_time 0.16463923454284668
gc 0
Train Epoch2 Acc 0.4592833333333333 (55114/120000), AUC 0.6504029631614685
ep2_train_time 10.163209438323975
Test Epoch2 threshold 0.7 Acc 0.911578947368421, AUC 0.9787183403968811, avg_entr 0.026495538651943207
ep2_t0.7_test_time 0.1626720428466797
gc 0
Train Epoch3 Acc 0.46918333333333334 (56302/120000), AUC 0.630206823348999
ep3_train_time 10.419128656387329
Test Epoch3 threshold 0.7 Acc 0.9105263157894737, AUC 0.9784560203552246, avg_entr 0.02589605748653412
ep3_t0.7_test_time 0.1627340316772461
gc 0
Train Epoch4 Acc 0.47563333333333335 (57076/120000), AUC 0.6054505109786987
ep4_train_time 10.095998287200928
Test Epoch4 threshold 0.7 Acc 0.9092105263157895, AUC 0.9784676432609558, avg_entr 0.02608194388449192
ep4_t0.7_test_time 0.16241717338562012
gc 0
Train Epoch5 Acc 0.47885833333333333 (57463/120000), AUC 0.6013490557670593
ep5_train_time 10.554448127746582
Test Epoch5 threshold 0.7 Acc 0.911578947368421, AUC 0.9783827066421509, avg_entr 0.026742057874798775
ep5_t0.7_test_time 0.16862845420837402
gc 0
Train Epoch6 Acc 0.47918333333333335 (57502/120000), AUC 0.5986424684524536
ep6_train_time 9.290088415145874
Test Epoch6 threshold 0.7 Acc 0.9107894736842105, AUC 0.9782448410987854, avg_entr 0.02696855179965496
ep6_t0.7_test_time 0.15956592559814453
gc 0
Train Epoch7 Acc 0.4758583333333333 (57103/120000), AUC 0.5910810232162476
ep7_train_time 9.28012752532959
Test Epoch7 threshold 0.7 Acc 0.9113157894736842, AUC 0.9781872630119324, avg_entr 0.026577824726700783
ep7_t0.7_test_time 0.16078758239746094
gc 0
Train Epoch8 Acc 0.463175 (55581/120000), AUC 0.5771623849868774
ep8_train_time 9.239131212234497
Test Epoch8 threshold 0.7 Acc 0.9102631578947369, AUC 0.9779965877532959, avg_entr 0.026060093194246292
ep8_t0.7_test_time 0.16007518768310547
gc 0
Train Epoch9 Acc 0.4434916666666667 (53219/120000), AUC 0.5658047199249268
ep9_train_time 9.209012746810913
Test Epoch9 threshold 0.7 Acc 0.911578947368421, AUC 0.9779842495918274, avg_entr 0.02627333626151085
ep9_t0.7_test_time 0.16010785102844238
Best AUC 0.9789770841598511
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 100.78125095367432
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.7_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9252631578947368, AUC 0.9850978851318359, avg_entr 0.025547362864017487
t0.7_test_time 0.15894246101379395
