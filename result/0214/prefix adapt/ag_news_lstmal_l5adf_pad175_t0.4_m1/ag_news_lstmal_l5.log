total count words 102019
vocab size 30000
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 19.893251419067383
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24428333333333332 (29314/120000), AUC 0.49751871824264526
ep0_train_time 47.06797003746033
Test Epoch0 threshold 0.4 Acc 0.8960526315789473, AUC 0.9714978933334351, avg_entr 0.18482036888599396
ep0_t0.4_test_time 0.1624596118927002
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.4_m1//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24340833333333334 (29209/120000), AUC 0.500572681427002
ep1_train_time 47.27055644989014
Test Epoch1 threshold 0.4 Acc 0.9031578947368422, AUC 0.9756056070327759, avg_entr 0.10815844684839249
ep1_t0.4_test_time 0.16425633430480957
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.4_m1//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24289166666666667 (29147/120000), AUC 0.4955037832260132
ep2_train_time 47.28547430038452
Test Epoch2 threshold 0.4 Acc 0.91, AUC 0.9775415062904358, avg_entr 0.08162268251180649
ep2_t0.4_test_time 0.16316938400268555
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.4_m1//ag_news_lstmal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.24214166666666667 (29057/120000), AUC 0.49061837792396545
ep3_train_time 47.284321546554565
Test Epoch3 threshold 0.4 Acc 0.9118421052631579, AUC 0.9782257080078125, avg_entr 0.06707603484392166
ep3_t0.4_test_time 0.16074490547180176
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.4_m1//ag_news_lstmal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.24201666666666666 (29042/120000), AUC 0.48708993196487427
ep4_train_time 47.29785203933716
Test Epoch4 threshold 0.4 Acc 0.9102631578947369, AUC 0.9785086512565613, avg_entr 0.06114082783460617
ep4_t0.4_test_time 0.16057729721069336
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.4_m1//ag_news_lstmal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24173333333333333 (29008/120000), AUC 0.4841585159301758
ep5_train_time 47.2167649269104
Test Epoch5 threshold 0.4 Acc 0.9113157894736842, AUC 0.978752851486206, avg_entr 0.05380042642354965
ep5_t0.4_test_time 0.16379928588867188
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.4_m1//ag_news_lstmal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.241425 (28971/120000), AUC 0.4817664325237274
ep6_train_time 47.2472288608551
Test Epoch6 threshold 0.4 Acc 0.9105263157894737, AUC 0.9785958528518677, avg_entr 0.050105515867471695
ep6_t0.4_test_time 0.1618363857269287
gc 0
Train Epoch7 Acc 0.24103333333333332 (28924/120000), AUC 0.4797987937927246
ep7_train_time 47.27011585235596
Test Epoch7 threshold 0.4 Acc 0.9126315789473685, AUC 0.978563666343689, avg_entr 0.04676571488380432
ep7_t0.4_test_time 0.16110730171203613
gc 0
Train Epoch8 Acc 0.240775 (28893/120000), AUC 0.47845324873924255
ep8_train_time 47.207273721694946
Test Epoch8 threshold 0.4 Acc 0.9107894736842105, AUC 0.9785348176956177, avg_entr 0.043139826506376266
ep8_t0.4_test_time 0.1607682704925537
gc 0
Train Epoch9 Acc 0.24060833333333334 (28873/120000), AUC 0.477238267660141
ep9_train_time 47.22882866859436
Test Epoch9 threshold 0.4 Acc 0.9105263157894737, AUC 0.9783246517181396, avg_entr 0.04055076837539673
ep9_t0.4_test_time 0.1620016098022461
Best AUC 0.978752851486206
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 475.27006363868713
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.4_m1//ag_news_lstmal_l5_prefix.pt
Test threshold 0.4 Acc 0.9252631578947368, AUC 0.984850287437439, avg_entr 0.05282283574342728
t0.4_test_time 0.1596214771270752
