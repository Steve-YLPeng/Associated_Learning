total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.7_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.575387716293335
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.25588333333333335 (30706/120000), AUC 0.530367374420166
ep0_train_time 10.174433946609497
Test Epoch0 threshold 0.7 Acc 0.9107894736842105, AUC 0.9789543151855469, avg_entr 0.02599669061601162
ep0_t0.7_test_time 0.16218876838684082
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.343325 (41199/120000), AUC 0.5316900610923767
ep1_train_time 9.668875932693481
Test Epoch1 threshold 0.7 Acc 0.9102631578947369, AUC 0.9787049889564514, avg_entr 0.026402026414871216
ep1_t0.7_test_time 0.15837311744689941
gc 0
Train Epoch2 Acc 0.46728333333333333 (56074/120000), AUC 0.519596517086029
ep2_train_time 9.589305400848389
Test Epoch2 threshold 0.7 Acc 0.911578947368421, AUC 0.9785363674163818, avg_entr 0.026629148051142693
ep2_t0.7_test_time 0.15740013122558594
gc 0
Train Epoch3 Acc 0.4629083333333333 (55549/120000), AUC 0.49846887588500977
ep3_train_time 9.629771947860718
Test Epoch3 threshold 0.7 Acc 0.9121052631578948, AUC 0.9785043001174927, avg_entr 0.026045184582471848
ep3_t0.7_test_time 0.16027355194091797
gc 0
Train Epoch4 Acc 0.4741666666666667 (56900/120000), AUC 0.4879235625267029
ep4_train_time 9.676662683486938
Test Epoch4 threshold 0.7 Acc 0.91, AUC 0.9783830642700195, avg_entr 0.025584248825907707
ep4_t0.7_test_time 0.15812039375305176
gc 0
Train Epoch5 Acc 0.46955833333333336 (56347/120000), AUC 0.480873167514801
ep5_train_time 9.679602146148682
Test Epoch5 threshold 0.7 Acc 0.9097368421052632, AUC 0.9780905246734619, avg_entr 0.026460589841008186
ep5_t0.7_test_time 0.15878987312316895
gc 0
Train Epoch6 Acc 0.44221666666666665 (53066/120000), AUC 0.4776748716831207
ep6_train_time 9.6283860206604
Test Epoch6 threshold 0.7 Acc 0.9105263157894737, AUC 0.977951169013977, avg_entr 0.026674048975110054
ep6_t0.7_test_time 0.1606431007385254
gc 0
Train Epoch7 Acc 0.4153 (49836/120000), AUC 0.476190984249115
ep7_train_time 9.728477478027344
Test Epoch7 threshold 0.7 Acc 0.9097368421052632, AUC 0.9780011773109436, avg_entr 0.02677878737449646
ep7_t0.7_test_time 0.1582193374633789
gc 0
Train Epoch8 Acc 0.39908333333333335 (47890/120000), AUC 0.47515031695365906
ep8_train_time 9.734478950500488
Test Epoch8 threshold 0.7 Acc 0.9086842105263158, AUC 0.9778488874435425, avg_entr 0.025883466005325317
ep8_t0.7_test_time 0.15801048278808594
gc 0
Train Epoch9 Acc 0.3982833333333333 (47794/120000), AUC 0.47538885474205017
ep9_train_time 9.739262819290161
Test Epoch9 threshold 0.7 Acc 0.9084210526315789, AUC 0.97782301902771, avg_entr 0.02574925497174263
ep9_t0.7_test_time 0.15742921829223633
Best AUC 0.9789543151855469
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 99.56778025627136
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.7_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9234210526315789, AUC 0.9847213625907898, avg_entr 0.02502780221402645
t0.7_test_time 0.15671706199645996
