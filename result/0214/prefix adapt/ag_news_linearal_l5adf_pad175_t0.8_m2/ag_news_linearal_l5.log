total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.983227968215942
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.25690833333333335 (30829/120000), AUC 0.5815718173980713
ep0_train_time 9.13801121711731
Test Epoch0 threshold 0.8 Acc 0.9097368421052632, AUC 0.9789604544639587, avg_entr 0.029676705598831177
ep0_t0.8_test_time 0.16009759902954102
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.32075 (38490/120000), AUC 0.5977942943572998
ep1_train_time 8.656992435455322
Test Epoch1 threshold 0.8 Acc 0.9097368421052632, AUC 0.9790477156639099, avg_entr 0.027629543095827103
ep1_t0.8_test_time 0.15828204154968262
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.3454333333333333 (41452/120000), AUC 0.5937531590461731
ep2_train_time 8.697276592254639
Test Epoch2 threshold 0.8 Acc 0.9097368421052632, AUC 0.9787988066673279, avg_entr 0.027266819030046463
ep2_t0.8_test_time 0.15806818008422852
gc 0
Train Epoch3 Acc 0.33734166666666665 (40481/120000), AUC 0.5934672951698303
ep3_train_time 8.777765989303589
Test Epoch3 threshold 0.8 Acc 0.9076315789473685, AUC 0.9786003232002258, avg_entr 0.02731448970735073
ep3_t0.8_test_time 0.15847134590148926
gc 0
Train Epoch4 Acc 0.296725 (35607/120000), AUC 0.5940365195274353
ep4_train_time 8.755528211593628
Test Epoch4 threshold 0.8 Acc 0.9105263157894737, AUC 0.9785297513008118, avg_entr 0.02684253640472889
ep4_t0.8_test_time 0.1583874225616455
gc 0
Train Epoch5 Acc 0.27086666666666664 (32504/120000), AUC 0.5947912335395813
ep5_train_time 8.762641668319702
Test Epoch5 threshold 0.8 Acc 0.91, AUC 0.9785420894622803, avg_entr 0.026956062763929367
ep5_t0.8_test_time 0.15797162055969238
gc 0
Train Epoch6 Acc 0.2589916666666667 (31079/120000), AUC 0.595615804195404
ep6_train_time 8.635910511016846
Test Epoch6 threshold 0.8 Acc 0.9094736842105263, AUC 0.9782200455665588, avg_entr 0.02654668688774109
ep6_t0.8_test_time 0.15790152549743652
gc 0
Train Epoch7 Acc 0.25421666666666665 (30506/120000), AUC 0.5965268611907959
ep7_train_time 8.780366659164429
Test Epoch7 threshold 0.8 Acc 0.9097368421052632, AUC 0.9782129526138306, avg_entr 0.02619384229183197
ep7_t0.8_test_time 0.1585545539855957
gc 0
Train Epoch8 Acc 0.2527083333333333 (30325/120000), AUC 0.5970288515090942
ep8_train_time 8.695652723312378
Test Epoch8 threshold 0.8 Acc 0.9084210526315789, AUC 0.9781237244606018, avg_entr 0.025847433134913445
ep8_t0.8_test_time 0.1613008975982666
gc 0
Train Epoch9 Acc 0.2523916666666667 (30287/120000), AUC 0.5976736545562744
ep9_train_time 8.813464641571045
Test Epoch9 threshold 0.8 Acc 0.9084210526315789, AUC 0.9781186580657959, avg_entr 0.026606790721416473
ep9_t0.8_test_time 0.15726375579833984
Best AUC 0.9790477156639099
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 90.11290693283081
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.8_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9236842105263158, AUC 0.9849006533622742, avg_entr 0.02768578939139843
t0.8_test_time 0.15679550170898438
