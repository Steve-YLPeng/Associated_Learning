total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.6_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.737839698791504
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.26190833333333335 (31429/120000), AUC 0.4782499074935913
ep0_train_time 10.128601789474487
Test Epoch0 threshold 0.6 Acc 0.9107894736842105, AUC 0.9782951474189758, avg_entr 0.026397429406642914
ep0_t0.6_test_time 0.1600809097290039
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.26669166666666666 (32003/120000), AUC 0.49156084656715393
ep1_train_time 9.684476375579834
Test Epoch1 threshold 0.6 Acc 0.9107894736842105, AUC 0.9782211184501648, avg_entr 0.02566489763557911
ep1_t0.6_test_time 0.15984582901000977
gc 0
Train Epoch2 Acc 0.27829166666666666 (33395/120000), AUC 0.4869644045829773
ep2_train_time 9.622896909713745
Test Epoch2 threshold 0.6 Acc 0.9110526315789473, AUC 0.9781824350357056, avg_entr 0.025261474773287773
ep2_t0.6_test_time 0.15937018394470215
gc 0
Train Epoch3 Acc 0.277775 (33333/120000), AUC 0.5129831433296204
ep3_train_time 9.680944919586182
Test Epoch3 threshold 0.6 Acc 0.9089473684210526, AUC 0.9779585003852844, avg_entr 0.025282641872763634
ep3_t0.6_test_time 0.1596062183380127
gc 0
Train Epoch4 Acc 0.2734416666666667 (32813/120000), AUC 0.5517618060112
ep4_train_time 9.659814596176147
Test Epoch4 threshold 0.6 Acc 0.9118421052631579, AUC 0.9777964353561401, avg_entr 0.02608717978000641
ep4_t0.6_test_time 0.15946030616760254
gc 0
Train Epoch5 Acc 0.2723583333333333 (32683/120000), AUC 0.5692051649093628
ep5_train_time 9.621880531311035
Test Epoch5 threshold 0.6 Acc 0.9102631578947369, AUC 0.9775597453117371, avg_entr 0.026654116809368134
ep5_t0.6_test_time 0.15952301025390625
gc 0
Train Epoch6 Acc 0.27595833333333336 (33115/120000), AUC 0.5743448734283447
ep6_train_time 9.744942665100098
Test Epoch6 threshold 0.6 Acc 0.9113157894736842, AUC 0.9775272011756897, avg_entr 0.02620287798345089
ep6_t0.6_test_time 0.16041111946105957
gc 0
Train Epoch7 Acc 0.28734166666666666 (34481/120000), AUC 0.5780888199806213
ep7_train_time 9.614227294921875
Test Epoch7 threshold 0.6 Acc 0.9110526315789473, AUC 0.9774433374404907, avg_entr 0.02614484541118145
ep7_t0.6_test_time 0.1596686840057373
gc 0
Train Epoch8 Acc 0.3100583333333333 (37207/120000), AUC 0.5811344385147095
ep8_train_time 9.728695392608643
Test Epoch8 threshold 0.6 Acc 0.9094736842105263, AUC 0.9773504734039307, avg_entr 0.026519348844885826
ep8_t0.6_test_time 0.15943145751953125
gc 0
Train Epoch9 Acc 0.3303333333333333 (39640/120000), AUC 0.5833457708358765
ep9_train_time 9.747572183609009
Test Epoch9 threshold 0.6 Acc 0.91, AUC 0.9773266315460205, avg_entr 0.026005350053310394
ep9_t0.6_test_time 0.1607356071472168
Best AUC 0.9782951474189758
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 99.56203150749207
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.6_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9236842105263158, AUC 0.9846714735031128, avg_entr 0.02593800239264965
t0.6_test_time 0.1578688621520996
