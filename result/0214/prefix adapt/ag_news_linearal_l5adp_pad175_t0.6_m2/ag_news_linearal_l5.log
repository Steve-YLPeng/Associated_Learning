total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.81354856491089
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.28170833333333334 (33805/120000), AUC 0.627493679523468
ep0_train_time 9.139257669448853
Test Epoch0 threshold 0.6 Acc 0.9110526315789473, AUC 0.9787195920944214, avg_entr 0.02873856946825981
ep0_t0.6_test_time 0.16045403480529785
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25024166666666664 (30029/120000), AUC 0.6696978807449341
ep1_train_time 8.618413209915161
Test Epoch1 threshold 0.6 Acc 0.9123684210526316, AUC 0.9787881970405579, avg_entr 0.026997288689017296
ep1_t0.6_test_time 0.15900897979736328
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.2502083333333333 (30025/120000), AUC 0.6709904670715332
ep2_train_time 8.615137100219727
Test Epoch2 threshold 0.6 Acc 0.9102631578947369, AUC 0.9786815643310547, avg_entr 0.027712227776646614
ep2_t0.6_test_time 0.15948987007141113
gc 0
Train Epoch3 Acc 0.25021666666666664 (30026/120000), AUC 0.6731205582618713
ep3_train_time 8.61359453201294
Test Epoch3 threshold 0.6 Acc 0.9105263157894737, AUC 0.9783391952514648, avg_entr 0.027612056583166122
ep3_t0.6_test_time 0.15844178199768066
gc 0
Train Epoch4 Acc 0.2502916666666667 (30035/120000), AUC 0.6733980178833008
ep4_train_time 8.703197956085205
Test Epoch4 threshold 0.6 Acc 0.9068421052631579, AUC 0.9781135320663452, avg_entr 0.02793392725288868
ep4_t0.6_test_time 0.15894675254821777
gc 0
Train Epoch5 Acc 0.25025 (30030/120000), AUC 0.6721590757369995
ep5_train_time 8.681816577911377
Test Epoch5 threshold 0.6 Acc 0.9110526315789473, AUC 0.9781754612922668, avg_entr 0.02745724469423294
ep5_t0.6_test_time 0.15908336639404297
gc 0
Train Epoch6 Acc 0.25024166666666664 (30029/120000), AUC 0.6712549328804016
ep6_train_time 8.683987379074097
Test Epoch6 threshold 0.6 Acc 0.9089473684210526, AUC 0.9779828786849976, avg_entr 0.026423463597893715
ep6_t0.6_test_time 0.1587216854095459
gc 0
Train Epoch7 Acc 0.250225 (30027/120000), AUC 0.6704471707344055
ep7_train_time 8.714428663253784
Test Epoch7 threshold 0.6 Acc 0.911578947368421, AUC 0.9778487682342529, avg_entr 0.025976747274398804
ep7_t0.6_test_time 0.15917491912841797
gc 0
Train Epoch8 Acc 0.2502 (30024/120000), AUC 0.6694135665893555
ep8_train_time 8.686300039291382
Test Epoch8 threshold 0.6 Acc 0.9110526315789473, AUC 0.977824866771698, avg_entr 0.026182731613516808
ep8_t0.6_test_time 0.16116952896118164
gc 0
Train Epoch9 Acc 0.2502 (30024/120000), AUC 0.6688439846038818
ep9_train_time 8.684118032455444
Test Epoch9 threshold 0.6 Acc 0.9105263157894737, AUC 0.9777219891548157, avg_entr 0.026359939947724342
ep9_t0.6_test_time 0.15910863876342773
Best AUC 0.9787881970405579
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 89.52901911735535
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.6_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9236842105263158, AUC 0.9848700761795044, avg_entr 0.02637394331395626
t0.6_test_time 0.15703344345092773
