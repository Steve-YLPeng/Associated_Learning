total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.1_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.740293741226196
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.92505 (111006/120000), AUC 0.9850448369979858
ep0_train_time 10.377709865570068
Test Epoch0 threshold 0.1 Acc 0.9123684210526316, AUC 0.9785568118095398, avg_entr 0.01998358964920044
ep0_t0.1_test_time 0.1825242042541504
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9504333333333334 (114052/120000), AUC 0.9932483434677124
ep1_train_time 10.0338716506958
Test Epoch1 threshold 0.1 Acc 0.91, AUC 0.9780726432800293, avg_entr 0.015851188451051712
ep1_t0.1_test_time 0.18102478981018066
gc 0
Train Epoch2 Acc 0.9514583333333333 (114175/120000), AUC 0.9934741258621216
ep2_train_time 10.018167734146118
Test Epoch2 threshold 0.1 Acc 0.9086842105263158, AUC 0.9779824614524841, avg_entr 0.01225272472947836
ep2_t0.1_test_time 0.18003606796264648
gc 0
Train Epoch3 Acc 0.9528 (114336/120000), AUC 0.9937637448310852
ep3_train_time 9.977285385131836
Test Epoch3 threshold 0.1 Acc 0.9097368421052632, AUC 0.9779120683670044, avg_entr 0.011997029185295105
ep3_t0.1_test_time 0.1802208423614502
gc 0
Train Epoch4 Acc 0.9533666666666667 (114404/120000), AUC 0.9941537380218506
ep4_train_time 10.083353042602539
Test Epoch4 threshold 0.1 Acc 0.9110526315789473, AUC 0.9775221347808838, avg_entr 0.010852889157831669
ep4_t0.1_test_time 0.17959356307983398
gc 0
Train Epoch5 Acc 0.9552083333333333 (114625/120000), AUC 0.9946494102478027
ep5_train_time 10.039460897445679
Test Epoch5 threshold 0.1 Acc 0.9102631578947369, AUC 0.9777907133102417, avg_entr 0.011531142517924309
ep5_t0.1_test_time 0.1802504062652588
gc 0
Train Epoch6 Acc 0.9556833333333333 (114682/120000), AUC 0.9947822093963623
ep6_train_time 10.010077238082886
Test Epoch6 threshold 0.1 Acc 0.9092105263157895, AUC 0.9775909185409546, avg_entr 0.010915559716522694
ep6_t0.1_test_time 0.18038153648376465
gc 0
Train Epoch7 Acc 0.9561 (114732/120000), AUC 0.9949260354042053
ep7_train_time 9.973555564880371
Test Epoch7 threshold 0.1 Acc 0.9086842105263158, AUC 0.9776801466941833, avg_entr 0.0106381606310606
ep7_t0.1_test_time 0.18015360832214355
gc 0
Train Epoch8 Acc 0.9566333333333333 (114796/120000), AUC 0.9951163530349731
ep8_train_time 10.097700595855713
Test Epoch8 threshold 0.1 Acc 0.9073684210526316, AUC 0.9774845242500305, avg_entr 0.010946289636194706
ep8_t0.1_test_time 0.18047738075256348
gc 0
Train Epoch9 Acc 0.9574416666666666 (114893/120000), AUC 0.9953014850616455
ep9_train_time 10.014485359191895
Test Epoch9 threshold 0.1 Acc 0.9086842105263158, AUC 0.9775226712226868, avg_entr 0.010792223736643791
ep9_t0.1_test_time 0.1802840232849121
Best AUC 0.9785568118095398
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 103.1651713848114
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.1_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9242105263157895, AUC 0.9844578504562378, avg_entr 0.020109176635742188
t0.1_test_time 0.1835002899169922
