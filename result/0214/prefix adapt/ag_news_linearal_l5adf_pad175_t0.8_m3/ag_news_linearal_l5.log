total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.8_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.24617314338684
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.23728333333333335 (28474/120000), AUC 0.3354801535606384
ep0_train_time 9.587887048721313
Test Epoch0 threshold 0.8 Acc 0.9123684210526316, AUC 0.9788385629653931, avg_entr 0.026269448921084404
ep0_t0.8_test_time 0.16061663627624512
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.325525 (39063/120000), AUC 0.29509437084198
ep1_train_time 9.258499145507812
Test Epoch1 threshold 0.8 Acc 0.906578947368421, AUC 0.9787694215774536, avg_entr 0.026776472106575966
ep1_t0.8_test_time 0.15928101539611816
gc 0
Train Epoch2 Acc 0.34263333333333335 (41116/120000), AUC 0.3205447494983673
ep2_train_time 9.140100002288818
Test Epoch2 threshold 0.8 Acc 0.9097368421052632, AUC 0.9787721633911133, avg_entr 0.026766469702124596
ep2_t0.8_test_time 0.15902113914489746
gc 0
Train Epoch3 Acc 0.20845833333333333 (25015/120000), AUC 0.3602486848831177
ep3_train_time 9.176634788513184
Test Epoch3 threshold 0.8 Acc 0.9078947368421053, AUC 0.9783898591995239, avg_entr 0.026783373206853867
ep3_t0.8_test_time 0.15960693359375
gc 0
Train Epoch4 Acc 0.092725 (11127/120000), AUC 0.4310295283794403
ep4_train_time 9.187760829925537
Test Epoch4 threshold 0.8 Acc 0.9102631578947369, AUC 0.978325605392456, avg_entr 0.02670086920261383
ep4_t0.8_test_time 0.1589674949645996
gc 0
Train Epoch5 Acc 0.057833333333333334 (6940/120000), AUC 0.4439179003238678
ep5_train_time 9.195334911346436
Test Epoch5 threshold 0.8 Acc 0.9102631578947369, AUC 0.978198766708374, avg_entr 0.026447676122188568
ep5_t0.8_test_time 0.15886950492858887
gc 0
Train Epoch6 Acc 0.046975 (5637/120000), AUC 0.42607203125953674
ep6_train_time 9.229142904281616
Test Epoch6 threshold 0.8 Acc 0.9078947368421053, AUC 0.9780300259590149, avg_entr 0.02733120322227478
ep6_t0.8_test_time 0.15901565551757812
gc 0
Train Epoch7 Acc 0.0401 (4812/120000), AUC 0.38794389367103577
ep7_train_time 9.20305323600769
Test Epoch7 threshold 0.8 Acc 0.9102631578947369, AUC 0.9780011177062988, avg_entr 0.02540682628750801
ep7_t0.8_test_time 0.16205787658691406
gc 0
Train Epoch8 Acc 0.036075 (4329/120000), AUC 0.3491910696029663
ep8_train_time 9.197198629379272
Test Epoch8 threshold 0.8 Acc 0.9086842105263158, AUC 0.977894127368927, avg_entr 0.02680335007607937
ep8_t0.8_test_time 0.15934348106384277
gc 0
Train Epoch9 Acc 0.03476666666666667 (4172/120000), AUC 0.3266617953777313
ep9_train_time 9.268573999404907
Test Epoch9 threshold 0.8 Acc 0.9097368421052632, AUC 0.9777894020080566, avg_entr 0.026356691494584084
ep9_t0.8_test_time 0.1626758575439453
Best AUC 0.9788385629653931
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 94.78699040412903
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.8_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9239473684210526, AUC 0.9849134087562561, avg_entr 0.02585870400071144
t0.8_test_time 0.1574399471282959
