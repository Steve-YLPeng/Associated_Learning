total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.721787214279175
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.2502916666666667 (30035/120000), AUC 0.6200583577156067
ep0_train_time 8.60206937789917
Test Epoch0 threshold 0.9 Acc 0.8960526315789473, AUC 0.9719477295875549, avg_entr 0.18308281898498535
ep0_t0.9_test_time 0.16126680374145508
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2511583333333333 (30139/120000), AUC 0.7247452735900879
ep1_train_time 8.158176183700562
Test Epoch1 threshold 0.9 Acc 0.9071052631578947, AUC 0.975990891456604, avg_entr 0.10604362189769745
ep1_t0.9_test_time 0.1605846881866455
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25206666666666666 (30248/120000), AUC 0.734836757183075
ep2_train_time 8.211015701293945
Test Epoch2 threshold 0.9 Acc 0.9110526315789473, AUC 0.9776075482368469, avg_entr 0.08252058923244476
ep2_t0.9_test_time 0.1632823944091797
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.253125 (30375/120000), AUC 0.7372854351997375
ep3_train_time 8.221853733062744
Test Epoch3 threshold 0.9 Acc 0.9110526315789473, AUC 0.9783182144165039, avg_entr 0.06746277958154678
ep3_t0.9_test_time 0.16035771369934082
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25524166666666664 (30629/120000), AUC 0.738700270652771
ep4_train_time 8.211536169052124
Test Epoch4 threshold 0.9 Acc 0.908157894736842, AUC 0.9787483215332031, avg_entr 0.06161649525165558
ep4_t0.9_test_time 0.1605079174041748
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25943333333333335 (31132/120000), AUC 0.7392569780349731
ep5_train_time 8.26237964630127
Test Epoch5 threshold 0.9 Acc 0.9105263157894737, AUC 0.9789055585861206, avg_entr 0.05390583723783493
ep5_t0.9_test_time 0.15958905220031738
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.26735 (32082/120000), AUC 0.7400261163711548
ep6_train_time 8.33298397064209
Test Epoch6 threshold 0.9 Acc 0.9110526315789473, AUC 0.9791407585144043, avg_entr 0.04810187593102455
ep6_t0.9_test_time 0.1605074405670166
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.2820416666666667 (33845/120000), AUC 0.7401488423347473
ep7_train_time 8.266769170761108
Test Epoch7 threshold 0.9 Acc 0.9110526315789473, AUC 0.9787825345993042, avg_entr 0.04573770985007286
ep7_t0.9_test_time 0.16010785102844238
gc 0
Train Epoch8 Acc 0.302375 (36285/120000), AUC 0.741019606590271
ep8_train_time 8.440699338912964
Test Epoch8 threshold 0.9 Acc 0.9131578947368421, AUC 0.9788424372673035, avg_entr 0.04195398464798927
ep8_t0.9_test_time 0.16021275520324707
gc 0
Train Epoch9 Acc 0.3303833333333333 (39646/120000), AUC 0.7414660453796387
ep9_train_time 8.199339151382446
Test Epoch9 threshold 0.9 Acc 0.9118421052631579, AUC 0.978560209274292, avg_entr 0.040342025458812714
ep9_t0.9_test_time 0.16063833236694336
Best AUC 0.9791407585144043
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 85.65426731109619
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9265789473684211, AUC 0.9849294424057007, avg_entr 0.047902911901474
t0.9_test_time 0.15832972526550293
