total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.514237642288208
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.514918327331543
ep0_train_time 8.608093023300171
Test Epoch0 threshold 0.5 Acc 0.8957894736842106, AUC 0.9709405899047852, avg_entr 0.18955746293067932
ep0_t0.5_test_time 0.1616075038909912
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.5629671812057495
ep1_train_time 8.259716272354126
Test Epoch1 threshold 0.5 Acc 0.9060526315789473, AUC 0.975504994392395, avg_entr 0.1057308167219162
ep1_t0.5_test_time 0.16019630432128906
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.5825353860855103
ep2_train_time 8.211233139038086
Test Epoch2 threshold 0.5 Acc 0.9126315789473685, AUC 0.9774751663208008, avg_entr 0.08235536515712738
ep2_t0.5_test_time 0.1603989601135254
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.5940493941307068
ep3_train_time 8.18732476234436
Test Epoch3 threshold 0.5 Acc 0.9105263157894737, AUC 0.978209912776947, avg_entr 0.06890850514173508
ep3_t0.5_test_time 0.16061139106750488
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.6026319265365601
ep4_train_time 8.164123773574829
Test Epoch4 threshold 0.5 Acc 0.911578947368421, AUC 0.9787429571151733, avg_entr 0.059597115963697433
ep4_t0.5_test_time 0.16000676155090332
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.6091325879096985
ep5_train_time 8.161332607269287
Test Epoch5 threshold 0.5 Acc 0.911578947368421, AUC 0.9789795875549316, avg_entr 0.053690019994974136
ep5_t0.5_test_time 0.15982651710510254
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.6145965456962585
ep6_train_time 8.134477376937866
Test Epoch6 threshold 0.5 Acc 0.9113157894736842, AUC 0.9787682294845581, avg_entr 0.04883655533194542
ep6_t0.5_test_time 0.15961408615112305
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.6195531487464905
ep7_train_time 8.282586336135864
Test Epoch7 threshold 0.5 Acc 0.911578947368421, AUC 0.9789888858795166, avg_entr 0.04669584706425667
ep7_t0.5_test_time 0.16004300117492676
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.6240962743759155
ep8_train_time 8.113217115402222
Test Epoch8 threshold 0.5 Acc 0.9092105263157895, AUC 0.9787923693656921, avg_entr 0.04458854719996452
ep8_t0.5_test_time 0.16008734703063965
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.6279592514038086
ep9_train_time 8.19137167930603
Test Epoch9 threshold 0.5 Acc 0.9123684210526316, AUC 0.978580892086029, avg_entr 0.040681611746549606
ep9_t0.5_test_time 0.16044068336486816
Best AUC 0.9789888858795166
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 85.05637216567993
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9231578947368421, AUC 0.9848782420158386, avg_entr 0.045659326016902924
t0.5_test_time 0.15842223167419434
