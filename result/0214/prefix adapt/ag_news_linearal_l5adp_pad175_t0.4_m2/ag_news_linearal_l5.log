total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.629489183425903
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.243825 (29259/120000), AUC 0.4820506274700165
ep0_train_time 9.058092594146729
Test Epoch0 threshold 0.4 Acc 0.9107894736842105, AUC 0.9787682294845581, avg_entr 0.027709217742085457
ep0_t0.4_test_time 0.1638033390045166
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.16580833333333334 (19897/120000), AUC 0.5068932175636292
ep1_train_time 8.711479425430298
Test Epoch1 threshold 0.4 Acc 0.9126315789473685, AUC 0.978753924369812, avg_entr 0.026572398841381073
ep1_t0.4_test_time 0.16218304634094238
gc 0
Train Epoch2 Acc 0.12655 (15186/120000), AUC 0.5113721489906311
ep2_train_time 8.636724710464478
Test Epoch2 threshold 0.4 Acc 0.9113157894736842, AUC 0.9784228801727295, avg_entr 0.02570537105202675
ep2_t0.4_test_time 0.16099810600280762
gc 0
Train Epoch3 Acc 0.153525 (18423/120000), AUC 0.5147885084152222
ep3_train_time 8.65915322303772
Test Epoch3 threshold 0.4 Acc 0.9113157894736842, AUC 0.9783025979995728, avg_entr 0.025687098503112793
ep3_t0.4_test_time 0.1610269546508789
gc 0
Train Epoch4 Acc 0.17141666666666666 (20570/120000), AUC 0.5190551280975342
ep4_train_time 8.620351076126099
Test Epoch4 threshold 0.4 Acc 0.9094736842105263, AUC 0.9784584641456604, avg_entr 0.026243561878800392
ep4_t0.4_test_time 0.16097211837768555
gc 0
Train Epoch5 Acc 0.17544166666666666 (21053/120000), AUC 0.5215408802032471
ep5_train_time 8.587696552276611
Test Epoch5 threshold 0.4 Acc 0.9097368421052632, AUC 0.9781987071037292, avg_entr 0.025848640128970146
ep5_t0.4_test_time 0.16233348846435547
gc 0
Train Epoch6 Acc 0.1807 (21684/120000), AUC 0.5239343643188477
ep6_train_time 8.678439617156982
Test Epoch6 threshold 0.4 Acc 0.9094736842105263, AUC 0.9780002236366272, avg_entr 0.026651253923773766
ep6_t0.4_test_time 0.16242456436157227
gc 0
Train Epoch7 Acc 0.18891666666666668 (22670/120000), AUC 0.5264926552772522
ep7_train_time 8.638444185256958
Test Epoch7 threshold 0.4 Acc 0.9078947368421053, AUC 0.9778708219528198, avg_entr 0.02589491568505764
ep7_t0.4_test_time 0.16126203536987305
gc 0
Train Epoch8 Acc 0.197175 (23661/120000), AUC 0.5289024710655212
ep8_train_time 8.665842533111572
Test Epoch8 threshold 0.4 Acc 0.9086842105263158, AUC 0.9777581691741943, avg_entr 0.026554781943559647
ep8_t0.4_test_time 0.16322875022888184
gc 0
Train Epoch9 Acc 0.20310833333333334 (24373/120000), AUC 0.5307470560073853
ep9_train_time 8.679199457168579
Test Epoch9 threshold 0.4 Acc 0.91, AUC 0.9776749610900879, avg_entr 0.026616433635354042
ep9_t0.4_test_time 0.16094970703125
Best AUC 0.9787682294845581
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 89.29541254043579
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.4_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9244736842105263, AUC 0.9848059415817261, avg_entr 0.026581939309835434
t0.4_test_time 0.16020560264587402
