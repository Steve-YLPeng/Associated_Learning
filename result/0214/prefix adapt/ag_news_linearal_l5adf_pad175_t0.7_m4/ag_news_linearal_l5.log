total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.946202516555786
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.33808333333333335 (40570/120000), AUC 0.4977461099624634
ep0_train_time 10.752995729446411
Test Epoch0 threshold 0.7 Acc 0.911578947368421, AUC 0.9787752628326416, avg_entr 0.026318660005927086
ep0_t0.7_test_time 0.16701459884643555
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.27986666666666665 (33584/120000), AUC 0.4739465117454529
ep1_train_time 10.325165510177612
Test Epoch1 threshold 0.7 Acc 0.9121052631578948, AUC 0.9786036014556885, avg_entr 0.026362089440226555
ep1_t0.7_test_time 0.16446638107299805
gc 0
Train Epoch2 Acc 0.389225 (46707/120000), AUC 0.5898216962814331
ep2_train_time 10.272855043411255
Test Epoch2 threshold 0.7 Acc 0.911578947368421, AUC 0.9784448742866516, avg_entr 0.025989791378378868
ep2_t0.7_test_time 0.16435980796813965
gc 0
Train Epoch3 Acc 0.2770916666666667 (33251/120000), AUC 0.6345774531364441
ep3_train_time 10.30495309829712
Test Epoch3 threshold 0.7 Acc 0.9107894736842105, AUC 0.9781625270843506, avg_entr 0.025753289461135864
ep3_t0.7_test_time 0.16376638412475586
gc 0
Train Epoch4 Acc 0.2668833333333333 (32026/120000), AUC 0.6446530818939209
ep4_train_time 10.207237958908081
Test Epoch4 threshold 0.7 Acc 0.9063157894736842, AUC 0.9780673980712891, avg_entr 0.025501932948827744
ep4_t0.7_test_time 0.16457343101501465
gc 0
Train Epoch5 Acc 0.2629 (31548/120000), AUC 0.64947110414505
ep5_train_time 10.293587446212769
Test Epoch5 threshold 0.7 Acc 0.908157894736842, AUC 0.9779261350631714, avg_entr 0.02666240744292736
ep5_t0.7_test_time 0.1646575927734375
gc 0
Train Epoch6 Acc 0.24436666666666668 (29324/120000), AUC 0.6389334797859192
ep6_train_time 10.189901351928711
Test Epoch6 threshold 0.7 Acc 0.9078947368421053, AUC 0.977792501449585, avg_entr 0.02628488652408123
ep6_t0.7_test_time 0.16429543495178223
gc 0
Train Epoch7 Acc 0.211275 (25353/120000), AUC 0.6253783106803894
ep7_train_time 10.273564338684082
Test Epoch7 threshold 0.7 Acc 0.9076315789473685, AUC 0.9777090549468994, avg_entr 0.025442438200116158
ep7_t0.7_test_time 0.16453003883361816
gc 0
Train Epoch8 Acc 0.18210833333333334 (21853/120000), AUC 0.6113177537918091
ep8_train_time 10.298986196517944
Test Epoch8 threshold 0.7 Acc 0.9094736842105263, AUC 0.9777692556381226, avg_entr 0.02522815577685833
ep8_t0.7_test_time 0.16389942169189453
gc 0
Train Epoch9 Acc 0.17556666666666668 (21068/120000), AUC 0.6020464301109314
ep9_train_time 10.2392098903656
Test Epoch9 threshold 0.7 Acc 0.9073684210526316, AUC 0.9775925874710083, avg_entr 0.02591046318411827
ep9_t0.7_test_time 0.16660785675048828
Best AUC 0.9787752628326416
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 105.58813691139221
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.7_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9228947368421052, AUC 0.9847787022590637, avg_entr 0.025595879182219505
t0.7_test_time 0.16393733024597168
