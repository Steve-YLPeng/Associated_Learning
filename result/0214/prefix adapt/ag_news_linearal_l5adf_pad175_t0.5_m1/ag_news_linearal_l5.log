total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.887606620788574
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.45708853006362915
ep0_train_time 9.285590410232544
Test Epoch0 threshold 0.5 Acc 0.8910526315789473, AUC 0.9713881611824036, avg_entr 0.18641965091228485
ep0_t0.5_test_time 0.17178559303283691
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.41712266206741333
ep1_train_time 8.81968641281128
Test Epoch1 threshold 0.5 Acc 0.901578947368421, AUC 0.9756797552108765, avg_entr 0.10944362729787827
ep1_t0.5_test_time 0.16844868659973145
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.4143896698951721
ep2_train_time 8.889857769012451
Test Epoch2 threshold 0.5 Acc 0.9105263157894737, AUC 0.9774624109268188, avg_entr 0.0805746391415596
ep2_t0.5_test_time 0.16803598403930664
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.4185904860496521
ep3_train_time 8.820497989654541
Test Epoch3 threshold 0.5 Acc 0.9121052631578948, AUC 0.9783648252487183, avg_entr 0.06781928986310959
ep3_t0.5_test_time 0.1677548885345459
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.42404887080192566
ep4_train_time 8.855730295181274
Test Epoch4 threshold 0.5 Acc 0.9128947368421053, AUC 0.9786044359207153, avg_entr 0.05997178703546524
ep4_t0.5_test_time 0.16826486587524414
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.4294464588165283
ep5_train_time 8.879006624221802
Test Epoch5 threshold 0.5 Acc 0.9110526315789473, AUC 0.9787939786911011, avg_entr 0.055032119154930115
ep5_t0.5_test_time 0.1677865982055664
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.43484270572662354
ep6_train_time 8.939348697662354
Test Epoch6 threshold 0.5 Acc 0.9102631578947369, AUC 0.9787155985832214, avg_entr 0.05103515461087227
ep6_t0.5_test_time 0.16741108894348145
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.43957632780075073
ep7_train_time 8.857293605804443
Test Epoch7 threshold 0.5 Acc 0.9131578947368421, AUC 0.9786599278450012, avg_entr 0.04649127274751663
ep7_t0.5_test_time 0.16782712936401367
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.4438526928424835
ep8_train_time 8.859528541564941
Test Epoch8 threshold 0.5 Acc 0.9107894736842105, AUC 0.978466272354126, avg_entr 0.04378673434257507
ep8_t0.5_test_time 0.1681227684020996
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.4481339752674103
ep9_train_time 8.845096588134766
Test Epoch9 threshold 0.5 Acc 0.9126315789473685, AUC 0.9785799980163574, avg_entr 0.040622033178806305
ep9_t0.5_test_time 0.16751408576965332
Best AUC 0.9787939786911011
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 91.89420676231384
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9236842105263158, AUC 0.9849331378936768, avg_entr 0.05404268950223923
t0.5_test_time 0.16611099243164062
