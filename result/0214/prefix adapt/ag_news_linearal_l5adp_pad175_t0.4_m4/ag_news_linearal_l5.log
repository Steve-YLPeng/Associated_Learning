total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.4_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.33385705947876
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.22979166666666667 (27575/120000), AUC 0.47075268626213074
ep0_train_time 10.087554216384888
Test Epoch0 threshold 0.4 Acc 0.9094736842105263, AUC 0.9785780906677246, avg_entr 0.02616942673921585
ep0_t0.4_test_time 0.16647005081176758
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24981666666666666 (29978/120000), AUC 0.5324020981788635
ep1_train_time 9.613954067230225
Test Epoch1 threshold 0.4 Acc 0.911578947368421, AUC 0.9783751964569092, avg_entr 0.0263824425637722
ep1_t0.4_test_time 0.16450262069702148
gc 0
Train Epoch2 Acc 0.24709166666666665 (29651/120000), AUC 0.5583997964859009
ep2_train_time 9.645478963851929
Test Epoch2 threshold 0.4 Acc 0.9118421052631579, AUC 0.978213906288147, avg_entr 0.025325417518615723
ep2_t0.4_test_time 0.16421842575073242
gc 0
Train Epoch3 Acc 0.24555833333333332 (29467/120000), AUC 0.5808176398277283
ep3_train_time 9.685528755187988
Test Epoch3 threshold 0.4 Acc 0.9086842105263158, AUC 0.9779950380325317, avg_entr 0.02556498534977436
ep3_t0.4_test_time 0.16399383544921875
gc 0
Train Epoch4 Acc 0.233475 (28017/120000), AUC 0.586286187171936
ep4_train_time 9.69384479522705
Test Epoch4 threshold 0.4 Acc 0.9084210526315789, AUC 0.9777867197990417, avg_entr 0.025215880945324898
ep4_t0.4_test_time 0.1654975414276123
gc 0
Train Epoch5 Acc 0.21649166666666667 (25979/120000), AUC 0.5955960750579834
ep5_train_time 9.653297901153564
Test Epoch5 threshold 0.4 Acc 0.9076315789473685, AUC 0.9778815507888794, avg_entr 0.025629593059420586
ep5_t0.4_test_time 0.16580653190612793
gc 0
Train Epoch6 Acc 0.20809166666666667 (24971/120000), AUC 0.6047614812850952
ep6_train_time 9.56197714805603
Test Epoch6 threshold 0.4 Acc 0.9078947368421053, AUC 0.9776889085769653, avg_entr 0.025324953719973564
ep6_t0.4_test_time 0.16359376907348633
gc 0
Train Epoch7 Acc 0.19933333333333333 (23920/120000), AUC 0.6135558485984802
ep7_train_time 9.577457189559937
Test Epoch7 threshold 0.4 Acc 0.9089473684210526, AUC 0.9776365160942078, avg_entr 0.02577795460820198
ep7_t0.4_test_time 0.1645815372467041
gc 0
Train Epoch8 Acc 0.19285 (23142/120000), AUC 0.6192220449447632
ep8_train_time 9.669855833053589
Test Epoch8 threshold 0.4 Acc 0.9076315789473685, AUC 0.9775111079216003, avg_entr 0.02547410875558853
ep8_t0.4_test_time 0.16321635246276855
gc 0
Train Epoch9 Acc 0.18485 (22182/120000), AUC 0.6229120492935181
ep9_train_time 9.670300722122192
Test Epoch9 threshold 0.4 Acc 0.9089473684210526, AUC 0.9775145649909973, avg_entr 0.025748828426003456
ep9_t0.4_test_time 0.16396474838256836
Best AUC 0.9785780906677246
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 99.23512077331543
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.4_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9228947368421052, AUC 0.9846981763839722, avg_entr 0.024810681119561195
t0.4_test_time 0.16386175155639648
