total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.09374499320984
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.369125 (44295/120000), AUC 0.5854307413101196
ep0_train_time 9.659456014633179
Test Epoch0 threshold 0.9 Acc 0.9128947368421053, AUC 0.9786471724510193, avg_entr 0.025804823264479637
ep0_t0.9_test_time 0.16123533248901367
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.40799166666666664 (48959/120000), AUC 0.5060803294181824
ep1_train_time 9.228923797607422
Test Epoch1 threshold 0.9 Acc 0.911578947368421, AUC 0.9789893627166748, avg_entr 0.025538310408592224
ep1_t0.9_test_time 0.1601715087890625
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m3//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.406625 (48795/120000), AUC 0.42724210023880005
ep2_train_time 9.228774309158325
Test Epoch2 threshold 0.9 Acc 0.9121052631578948, AUC 0.9785771369934082, avg_entr 0.02598017454147339
ep2_t0.9_test_time 0.15827441215515137
gc 0
Train Epoch3 Acc 0.38335833333333336 (46003/120000), AUC 0.374819815158844
ep3_train_time 9.24906873703003
Test Epoch3 threshold 0.9 Acc 0.9118421052631579, AUC 0.978420078754425, avg_entr 0.02600441314280033
ep3_t0.9_test_time 0.15976762771606445
gc 0
Train Epoch4 Acc 0.277225 (33267/120000), AUC 0.36885353922843933
ep4_train_time 9.225942850112915
Test Epoch4 threshold 0.9 Acc 0.9105263157894737, AUC 0.9783253073692322, avg_entr 0.02720249444246292
ep4_t0.9_test_time 0.15886950492858887
gc 0
Train Epoch5 Acc 0.1973 (23676/120000), AUC 0.37215128540992737
ep5_train_time 9.236308097839355
Test Epoch5 threshold 0.9 Acc 0.9113157894736842, AUC 0.9783335328102112, avg_entr 0.025899168103933334
ep5_t0.9_test_time 0.15846753120422363
gc 0
Train Epoch6 Acc 0.1379 (16548/120000), AUC 0.38870909810066223
ep6_train_time 9.175123691558838
Test Epoch6 threshold 0.9 Acc 0.91, AUC 0.9779952764511108, avg_entr 0.026063483208417892
ep6_t0.9_test_time 0.15953946113586426
gc 0
Train Epoch7 Acc 0.11268333333333333 (13522/120000), AUC 0.4096253514289856
ep7_train_time 9.260255575180054
Test Epoch7 threshold 0.9 Acc 0.91, AUC 0.9778845310211182, avg_entr 0.026319922879338264
ep7_t0.9_test_time 0.15946602821350098
gc 0
Train Epoch8 Acc 0.09625 (11550/120000), AUC 0.42947831749916077
ep8_train_time 9.147098302841187
Test Epoch8 threshold 0.9 Acc 0.9097368421052632, AUC 0.9778055548667908, avg_entr 0.026405664160847664
ep8_t0.9_test_time 0.15940356254577637
gc 0
Train Epoch9 Acc 0.07945 (9534/120000), AUC 0.44379863142967224
ep9_train_time 9.338781118392944
Test Epoch9 threshold 0.9 Acc 0.9094736842105263, AUC 0.9776487350463867, avg_entr 0.02602912113070488
ep9_t0.9_test_time 0.15936756134033203
Best AUC 0.9789893627166748
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 95.14259505271912
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.9_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9223684210526316, AUC 0.9847221374511719, avg_entr 0.0243111290037632
t0.9_test_time 0.15877556800842285
