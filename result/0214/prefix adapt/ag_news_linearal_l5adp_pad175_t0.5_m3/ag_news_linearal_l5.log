total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.5_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.09496307373047
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.5382916666666666 (64595/120000), AUC 0.8971766233444214
ep0_train_time 9.59004259109497
Test Epoch0 threshold 0.5 Acc 0.911578947368421, AUC 0.9789910912513733, avg_entr 0.026506422087550163
ep0_t0.5_test_time 0.15901422500610352
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.6599333333333334 (79192/120000), AUC 0.922637939453125
ep1_train_time 9.12877368927002
Test Epoch1 threshold 0.5 Acc 0.9078947368421053, AUC 0.978826642036438, avg_entr 0.026711417362093925
ep1_t0.5_test_time 0.1591024398803711
gc 0
Train Epoch2 Acc 0.7268166666666667 (87218/120000), AUC 0.9042352437973022
ep2_train_time 9.176414012908936
Test Epoch2 threshold 0.5 Acc 0.9113157894736842, AUC 0.9786044955253601, avg_entr 0.025826623663306236
ep2_t0.5_test_time 0.15832281112670898
gc 0
Train Epoch3 Acc 0.7688166666666667 (92258/120000), AUC 0.8702242374420166
ep3_train_time 9.067315101623535
Test Epoch3 threshold 0.5 Acc 0.9086842105263158, AUC 0.9786102771759033, avg_entr 0.026114504784345627
ep3_t0.5_test_time 0.1582493782043457
gc 0
Train Epoch4 Acc 0.7092833333333334 (85114/120000), AUC 0.8277380466461182
ep4_train_time 9.158567905426025
Test Epoch4 threshold 0.5 Acc 0.9094736842105263, AUC 0.9785263538360596, avg_entr 0.02571054920554161
ep4_t0.5_test_time 0.15993237495422363
gc 0
Train Epoch5 Acc 0.6552166666666667 (78626/120000), AUC 0.8001705408096313
ep5_train_time 9.170209407806396
Test Epoch5 threshold 0.5 Acc 0.908157894736842, AUC 0.9782646298408508, avg_entr 0.026129432022571564
ep5_t0.5_test_time 0.159102201461792
gc 0
Train Epoch6 Acc 0.6430833333333333 (77170/120000), AUC 0.7843425273895264
ep6_train_time 9.154248714447021
Test Epoch6 threshold 0.5 Acc 0.9076315789473685, AUC 0.9780460596084595, avg_entr 0.026081213727593422
ep6_t0.5_test_time 0.15806341171264648
gc 0
Train Epoch7 Acc 0.635925 (76311/120000), AUC 0.7715396285057068
ep7_train_time 9.079744338989258
Test Epoch7 threshold 0.5 Acc 0.9086842105263158, AUC 0.9779998064041138, avg_entr 0.024976184591650963
ep7_t0.5_test_time 0.15836119651794434
gc 0
Train Epoch8 Acc 0.6206833333333334 (74482/120000), AUC 0.7586066722869873
ep8_train_time 9.068716526031494
Test Epoch8 threshold 0.5 Acc 0.908157894736842, AUC 0.9778448939323425, avg_entr 0.026547400280833244
ep8_t0.5_test_time 0.15851593017578125
gc 0
Train Epoch9 Acc 0.602325 (72279/120000), AUC 0.7489322423934937
ep9_train_time 9.108355045318604
Test Epoch9 threshold 0.5 Acc 0.9089473684210526, AUC 0.9777412414550781, avg_entr 0.025843996554613113
ep9_t0.5_test_time 0.15780401229858398
Best AUC 0.9789910912513733
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 94.0243239402771
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.5_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9236842105263158, AUC 0.9848397374153137, avg_entr 0.025603340938687325
t0.5_test_time 0.1574254035949707
