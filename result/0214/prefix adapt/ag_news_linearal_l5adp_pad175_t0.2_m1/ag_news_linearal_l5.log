total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 23.25040054321289
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25025833333333336 (30031/120000), AUC 0.4907184839248657
ep0_train_time 11.283804893493652
Test Epoch0 threshold 0.2 Acc 0.8928947368421053, AUC 0.9716644287109375, avg_entr 0.18465353548526764
ep0_t0.2_test_time 0.21208906173706055
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.39267459511756897
ep1_train_time 11.53553318977356
Test Epoch1 threshold 0.2 Acc 0.9060526315789473, AUC 0.9756658673286438, avg_entr 0.10576190054416656
ep1_t0.2_test_time 0.21174073219299316
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.38149791955947876
ep2_train_time 10.423668622970581
Test Epoch2 threshold 0.2 Acc 0.9123684210526316, AUC 0.9774158000946045, avg_entr 0.08316624164581299
ep2_t0.2_test_time 0.20984411239624023
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.3829123377799988
ep3_train_time 10.316725730895996
Test Epoch3 threshold 0.2 Acc 0.9121052631578948, AUC 0.9783026576042175, avg_entr 0.06902118772268295
ep3_t0.2_test_time 0.21047663688659668
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.3866123557090759
ep4_train_time 10.362897157669067
Test Epoch4 threshold 0.2 Acc 0.9118421052631579, AUC 0.9786317944526672, avg_entr 0.06027316302061081
ep4_t0.2_test_time 0.21018028259277344
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.39061516523361206
ep5_train_time 12.472933292388916
Test Epoch5 threshold 0.2 Acc 0.9128947368421053, AUC 0.9786087274551392, avg_entr 0.053829360753297806
ep5_t0.2_test_time 0.20824217796325684
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.3943881392478943
ep6_train_time 10.425333261489868
Test Epoch6 threshold 0.2 Acc 0.9128947368421053, AUC 0.9787103533744812, avg_entr 0.04963591694831848
ep6_t0.2_test_time 0.20964431762695312
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.39783263206481934
ep7_train_time 10.669307708740234
Test Epoch7 threshold 0.2 Acc 0.9126315789473685, AUC 0.9786545634269714, avg_entr 0.04691248759627342
ep7_t0.2_test_time 0.29575467109680176
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.40107461810112
ep8_train_time 12.990674495697021
Test Epoch8 threshold 0.2 Acc 0.9126315789473685, AUC 0.9785952568054199, avg_entr 0.04291462153196335
ep8_t0.2_test_time 0.2949950695037842
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.40194249153137207
ep9_train_time 11.358854055404663
Test Epoch9 threshold 0.2 Acc 0.9105263157894737, AUC 0.9784951210021973, avg_entr 0.0417456328868866
ep9_t0.2_test_time 0.20924854278564453
Best AUC 0.9787103533744812
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 115.5011157989502
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9228947368421052, AUC 0.9850363731384277, avg_entr 0.04940606653690338
t0.2_test_time 0.21050214767456055
