total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.774450302124023
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24724166666666667 (29669/120000), AUC 0.5061231851577759
ep0_train_time 8.696630716323853
Test Epoch0 threshold 0.8 Acc 0.8928947368421053, AUC 0.9714015126228333, avg_entr 0.1863042265176773
ep0_t0.8_test_time 0.15983319282531738
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.5077133178710938
ep1_train_time 8.253232479095459
Test Epoch1 threshold 0.8 Acc 0.908157894736842, AUC 0.9757120013237, avg_entr 0.10702585428953171
ep1_t0.8_test_time 0.1580638885498047
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.5065608620643616
ep2_train_time 8.27058219909668
Test Epoch2 threshold 0.8 Acc 0.911578947368421, AUC 0.977638304233551, avg_entr 0.083574078977108
ep2_t0.8_test_time 0.15890979766845703
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.5079108476638794
ep3_train_time 8.142603397369385
Test Epoch3 threshold 0.8 Acc 0.9097368421052632, AUC 0.9782676696777344, avg_entr 0.07119474560022354
ep3_t0.8_test_time 0.15874075889587402
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.5084333419799805
ep4_train_time 8.22905945777893
Test Epoch4 threshold 0.8 Acc 0.911578947368421, AUC 0.9785981774330139, avg_entr 0.06022088602185249
ep4_t0.8_test_time 0.15887880325317383
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.5090365409851074
ep5_train_time 8.135055780410767
Test Epoch5 threshold 0.8 Acc 0.9107894736842105, AUC 0.9789407253265381, avg_entr 0.05552498251199722
ep5_t0.8_test_time 0.1588144302368164
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.5095942616462708
ep6_train_time 8.234692811965942
Test Epoch6 threshold 0.8 Acc 0.9084210526315789, AUC 0.9788007140159607, avg_entr 0.05145470052957535
ep6_t0.8_test_time 0.15889978408813477
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.5102444887161255
ep7_train_time 8.24582052230835
Test Epoch7 threshold 0.8 Acc 0.9105263157894737, AUC 0.9786012172698975, avg_entr 0.046396926045417786
ep7_t0.8_test_time 0.15914392471313477
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.5104159712791443
ep8_train_time 8.131834030151367
Test Epoch8 threshold 0.8 Acc 0.9121052631578948, AUC 0.9786329865455627, avg_entr 0.04337843880057335
ep8_t0.8_test_time 0.15827727317810059
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.5111163258552551
ep9_train_time 8.214515209197998
Test Epoch9 threshold 0.8 Acc 0.9078947368421053, AUC 0.9785531163215637, avg_entr 0.042733561247587204
ep9_t0.8_test_time 0.1585221290588379
Best AUC 0.9789407253265381
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 85.22286081314087
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9247368421052632, AUC 0.9848085641860962, avg_entr 0.054687704890966415
t0.8_test_time 0.15665960311889648
