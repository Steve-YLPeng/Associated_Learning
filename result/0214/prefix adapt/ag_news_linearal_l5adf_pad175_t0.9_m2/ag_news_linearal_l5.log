total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.184205055236816
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.3377833333333333 (40534/120000), AUC 0.6601808667182922
ep0_train_time 9.167067289352417
Test Epoch0 threshold 0.9 Acc 0.908157894736842, AUC 0.9791897535324097, avg_entr 0.029736382886767387
ep0_t0.9_test_time 0.1604318618774414
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2871666666666667 (34460/120000), AUC 0.6044168472290039
ep1_train_time 8.688332796096802
Test Epoch1 threshold 0.9 Acc 0.9110526315789473, AUC 0.9792068004608154, avg_entr 0.02885163016617298
ep1_t0.9_test_time 0.15875649452209473
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.392525 (47103/120000), AUC 0.6018435955047607
ep2_train_time 8.699661254882812
Test Epoch2 threshold 0.9 Acc 0.9126315789473685, AUC 0.9788935780525208, avg_entr 0.02548815682530403
ep2_t0.9_test_time 0.15870046615600586
gc 0
Train Epoch3 Acc 0.4297 (51564/120000), AUC 0.6013396382331848
ep3_train_time 8.717007875442505
Test Epoch3 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788237810134888, avg_entr 0.026834456250071526
ep3_t0.9_test_time 0.15755677223205566
gc 0
Train Epoch4 Acc 0.4345833333333333 (52150/120000), AUC 0.6030302047729492
ep4_train_time 8.771192073822021
Test Epoch4 threshold 0.9 Acc 0.9086842105263158, AUC 0.9786717891693115, avg_entr 0.02718442492187023
ep4_t0.9_test_time 0.15834832191467285
gc 0
Train Epoch5 Acc 0.43325833333333336 (51991/120000), AUC 0.6048861742019653
ep5_train_time 8.722545862197876
Test Epoch5 threshold 0.9 Acc 0.9110526315789473, AUC 0.9786258339881897, avg_entr 0.025625843554735184
ep5_t0.9_test_time 0.16106367111206055
gc 0
Train Epoch6 Acc 0.428275 (51393/120000), AUC 0.6056375503540039
ep6_train_time 8.684123277664185
Test Epoch6 threshold 0.9 Acc 0.9107894736842105, AUC 0.9785093665122986, avg_entr 0.025490667670965195
ep6_t0.9_test_time 0.1583857536315918
gc 0
Train Epoch7 Acc 0.422375 (50685/120000), AUC 0.6061458587646484
ep7_train_time 8.768527507781982
Test Epoch7 threshold 0.9 Acc 0.9110526315789473, AUC 0.9783702492713928, avg_entr 0.02657359465956688
ep7_t0.9_test_time 0.15796303749084473
gc 0
Train Epoch8 Acc 0.4146666666666667 (49760/120000), AUC 0.6062877774238586
ep8_train_time 8.741381168365479
Test Epoch8 threshold 0.9 Acc 0.91, AUC 0.978179931640625, avg_entr 0.026461930945515633
ep8_t0.9_test_time 0.1609654426574707
gc 0
Train Epoch9 Acc 0.408875 (49065/120000), AUC 0.6064369082450867
ep9_train_time 8.754897594451904
Test Epoch9 threshold 0.9 Acc 0.9102631578947369, AUC 0.9781116843223572, avg_entr 0.02672348916530609
ep9_t0.9_test_time 0.15803074836730957
Best AUC 0.9792068004608154
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 90.111825466156
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9263157894736842, AUC 0.9850912094116211, avg_entr 0.028617003932595253
t0.9_test_time 0.15728497505187988
