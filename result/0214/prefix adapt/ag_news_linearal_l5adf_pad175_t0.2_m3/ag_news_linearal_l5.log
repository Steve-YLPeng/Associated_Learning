total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.2_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.946796894073486
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.25254166666666666 (30305/120000), AUC 0.5455281734466553
ep0_train_time 9.56961464881897
Test Epoch0 threshold 0.2 Acc 0.9139473684210526, AUC 0.978516161441803, avg_entr 0.024149535223841667
ep0_t0.2_test_time 0.17290782928466797
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.262075 (31449/120000), AUC 0.5568219423294067
ep1_train_time 9.170856475830078
Test Epoch1 threshold 0.2 Acc 0.9094736842105263, AUC 0.9786497354507446, avg_entr 0.025721097365021706
ep1_t0.2_test_time 0.17186236381530762
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m3//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.266775 (32013/120000), AUC 0.564685046672821
ep2_train_time 9.181410789489746
Test Epoch2 threshold 0.2 Acc 0.9105263157894737, AUC 0.9783440232276917, avg_entr 0.02503086067736149
ep2_t0.2_test_time 0.1709306240081787
gc 0
Train Epoch3 Acc 0.2657333333333333 (31888/120000), AUC 0.574633777141571
ep3_train_time 9.15307092666626
Test Epoch3 threshold 0.2 Acc 0.9128947368421053, AUC 0.9781797528266907, avg_entr 0.024307575076818466
ep3_t0.2_test_time 0.17174577713012695
gc 0
Train Epoch4 Acc 0.25908333333333333 (31090/120000), AUC 0.588627278804779
ep4_train_time 9.219387769699097
Test Epoch4 threshold 0.2 Acc 0.91, AUC 0.9781041145324707, avg_entr 0.024119460955262184
ep4_t0.2_test_time 0.17179369926452637
gc 0
Train Epoch5 Acc 0.25348333333333334 (30418/120000), AUC 0.6058924794197083
ep5_train_time 9.238433122634888
Test Epoch5 threshold 0.2 Acc 0.9121052631578948, AUC 0.9779731035232544, avg_entr 0.02266674116253853
ep5_t0.2_test_time 0.17213797569274902
gc 0
Train Epoch6 Acc 0.25269166666666665 (30323/120000), AUC 0.6189329028129578
ep6_train_time 9.13493013381958
Test Epoch6 threshold 0.2 Acc 0.9092105263157895, AUC 0.9778993129730225, avg_entr 0.022484757006168365
ep6_t0.2_test_time 0.1721484661102295
gc 0
Train Epoch7 Acc 0.25285 (30342/120000), AUC 0.6256051659584045
ep7_train_time 9.196946620941162
Test Epoch7 threshold 0.2 Acc 0.9086842105263158, AUC 0.9778398871421814, avg_entr 0.02229589968919754
ep7_t0.2_test_time 0.1714036464691162
gc 0
Train Epoch8 Acc 0.25355833333333333 (30427/120000), AUC 0.6298282742500305
ep8_train_time 9.068182468414307
Test Epoch8 threshold 0.2 Acc 0.9105263157894737, AUC 0.9777669906616211, avg_entr 0.02169058285653591
ep8_t0.2_test_time 0.1715238094329834
gc 0
Train Epoch9 Acc 0.25435833333333335 (30523/120000), AUC 0.6312386393547058
ep9_train_time 9.127514839172363
Test Epoch9 threshold 0.2 Acc 0.9105263157894737, AUC 0.9777388572692871, avg_entr 0.020230552181601524
ep9_t0.2_test_time 0.171860933303833
Best AUC 0.9786497354507446
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 94.57432723045349
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.2_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9223684210526316, AUC 0.9849414825439453, avg_entr 0.025431720539927483
t0.2_test_time 0.17061114311218262
