total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.90760612487793
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.4679069519042969
ep0_train_time 9.173024892807007
Test Epoch0 threshold 0.2 Acc 0.9102631578947369, AUC 0.9786360859870911, avg_entr 0.0251793060451746
ep0_t0.2_test_time 0.1685349941253662
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25000833333333333 (30001/120000), AUC 0.4568517804145813
ep1_train_time 8.664358377456665
Test Epoch1 threshold 0.2 Acc 0.9128947368421053, AUC 0.9786170125007629, avg_entr 0.02499978058040142
ep1_t0.2_test_time 0.1661992073059082
gc 0
Train Epoch2 Acc 0.25000833333333333 (30001/120000), AUC 0.4569137990474701
ep2_train_time 8.676823377609253
Test Epoch2 threshold 0.2 Acc 0.9118421052631579, AUC 0.9786159992218018, avg_entr 0.025837929919362068
ep2_t0.2_test_time 0.16888856887817383
gc 0
Train Epoch3 Acc 0.25001666666666666 (30002/120000), AUC 0.4557952284812927
ep3_train_time 8.80705451965332
Test Epoch3 threshold 0.2 Acc 0.9113157894736842, AUC 0.9786005020141602, avg_entr 0.025297559797763824
ep3_t0.2_test_time 0.16658616065979004
gc 0
Train Epoch4 Acc 0.25001666666666666 (30002/120000), AUC 0.4528123438358307
ep4_train_time 8.733843564987183
Test Epoch4 threshold 0.2 Acc 0.9121052631578948, AUC 0.9782142043113708, avg_entr 0.02547667920589447
ep4_t0.2_test_time 0.16870594024658203
gc 0
Train Epoch5 Acc 0.25000833333333333 (30001/120000), AUC 0.4496638774871826
ep5_train_time 8.623784303665161
Test Epoch5 threshold 0.2 Acc 0.9107894736842105, AUC 0.9781726598739624, avg_entr 0.02531406469643116
ep5_t0.2_test_time 0.16664838790893555
gc 0
Train Epoch6 Acc 0.25000833333333333 (30001/120000), AUC 0.4489201307296753
ep6_train_time 8.631361246109009
Test Epoch6 threshold 0.2 Acc 0.9105263157894737, AUC 0.9781111478805542, avg_entr 0.025244520977139473
ep6_t0.2_test_time 0.16629505157470703
gc 0
Train Epoch7 Acc 0.25000833333333333 (30001/120000), AUC 0.4479984641075134
ep7_train_time 8.656232833862305
Test Epoch7 threshold 0.2 Acc 0.9086842105263158, AUC 0.9779030084609985, avg_entr 0.02546251378953457
ep7_t0.2_test_time 0.16624212265014648
gc 0
Train Epoch8 Acc 0.25000833333333333 (30001/120000), AUC 0.44715848565101624
ep8_train_time 8.681435823440552
Test Epoch8 threshold 0.2 Acc 0.9102631578947369, AUC 0.977819561958313, avg_entr 0.02591775730252266
ep8_t0.2_test_time 0.16780376434326172
gc 0
Train Epoch9 Acc 0.25000833333333333 (30001/120000), AUC 0.44639846682548523
ep9_train_time 8.695733308792114
Test Epoch9 threshold 0.2 Acc 0.9094736842105263, AUC 0.9777780771255493, avg_entr 0.025249654427170753
ep9_t0.2_test_time 0.1663510799407959
Best AUC 0.9786360859870911
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 89.74713253974915
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.2_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9234210526315789, AUC 0.9851275682449341, avg_entr 0.024744436144828796
t0.2_test_time 0.16465091705322266
