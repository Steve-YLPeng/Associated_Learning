total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.520602464675903
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24263333333333334 (29116/120000), AUC 0.4493984580039978
ep0_train_time 8.49757719039917
Test Epoch0 threshold 0.4 Acc 0.8931578947368422, AUC 0.9709785580635071, avg_entr 0.18640556931495667
ep0_t0.4_test_time 0.1599736213684082
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.23761666666666667 (28514/120000), AUC 0.40917864441871643
ep1_train_time 8.030564785003662
Test Epoch1 threshold 0.4 Acc 0.9060526315789473, AUC 0.9757211208343506, avg_entr 0.11070263385772705
ep1_t0.4_test_time 0.15779852867126465
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24098333333333333 (28918/120000), AUC 0.4100750684738159
ep2_train_time 8.06641173362732
Test Epoch2 threshold 0.4 Acc 0.9102631578947369, AUC 0.9773545265197754, avg_entr 0.08323284238576889
ep2_t0.4_test_time 0.1577901840209961
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.24354166666666666 (29225/120000), AUC 0.4111459255218506
ep3_train_time 8.192551851272583
Test Epoch3 threshold 0.4 Acc 0.9071052631578947, AUC 0.9783152341842651, avg_entr 0.0712021216750145
ep3_t0.4_test_time 0.158097505569458
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.24465833333333334 (29359/120000), AUC 0.41150298714637756
ep4_train_time 8.185165405273438
Test Epoch4 threshold 0.4 Acc 0.9110526315789473, AUC 0.9785341620445251, avg_entr 0.06120277941226959
ep4_t0.4_test_time 0.15793418884277344
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.242375 (29085/120000), AUC 0.412092000246048
ep5_train_time 8.059170007705688
Test Epoch5 threshold 0.4 Acc 0.9118421052631579, AUC 0.9785363674163818, avg_entr 0.05540330335497856
ep5_t0.4_test_time 0.15703439712524414
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.23254166666666667 (27905/120000), AUC 0.41204404830932617
ep6_train_time 8.193029403686523
Test Epoch6 threshold 0.4 Acc 0.9094736842105263, AUC 0.9789372682571411, avg_entr 0.05074170231819153
ep6_t0.4_test_time 0.15764284133911133
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.21125833333333333 (25351/120000), AUC 0.41201621294021606
ep7_train_time 8.000802755355835
Test Epoch7 threshold 0.4 Acc 0.9110526315789473, AUC 0.9786456823348999, avg_entr 0.046456847339868546
ep7_t0.4_test_time 0.1587064266204834
gc 0
Train Epoch8 Acc 0.18278333333333333 (21934/120000), AUC 0.41197437047958374
ep8_train_time 8.116416931152344
Test Epoch8 threshold 0.4 Acc 0.9126315789473685, AUC 0.978671669960022, avg_entr 0.04595528915524483
ep8_t0.4_test_time 0.15741586685180664
gc 0
Train Epoch9 Acc 0.16111666666666666 (19334/120000), AUC 0.41128110885620117
ep9_train_time 7.987146615982056
Test Epoch9 threshold 0.4 Acc 0.9126315789473685, AUC 0.9785760641098022, avg_entr 0.04184684529900551
ep9_t0.4_test_time 0.1579141616821289
Best AUC 0.9789372682571411
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 84.0554792881012
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9228947368421052, AUC 0.9849599599838257, avg_entr 0.049890633672475815
t0.4_test_time 0.15583419799804688
