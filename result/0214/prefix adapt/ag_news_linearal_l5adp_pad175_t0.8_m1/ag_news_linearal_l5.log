total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.679029941558838
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.47918838262557983
ep0_train_time 8.660685062408447
Test Epoch0 threshold 0.8 Acc 0.8928947368421053, AUC 0.9710341691970825, avg_entr 0.18109571933746338
ep0_t0.8_test_time 0.16398286819458008
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.4104401767253876
ep1_train_time 8.265805721282959
Test Epoch1 threshold 0.8 Acc 0.9073684210526316, AUC 0.9753543138504028, avg_entr 0.10379732400178909
ep1_t0.8_test_time 0.1614058017730713
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.39928364753723145
ep2_train_time 8.225728988647461
Test Epoch2 threshold 0.8 Acc 0.9107894736842105, AUC 0.9774088859558105, avg_entr 0.08021601289510727
ep2_t0.8_test_time 0.15972304344177246
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.40166255831718445
ep3_train_time 8.226534843444824
Test Epoch3 threshold 0.8 Acc 0.9121052631578948, AUC 0.9781718254089355, avg_entr 0.06665971130132675
ep3_t0.8_test_time 0.1604170799255371
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.4049071967601776
ep4_train_time 8.264127254486084
Test Epoch4 threshold 0.8 Acc 0.9105263157894737, AUC 0.9783978462219238, avg_entr 0.06006498634815216
ep4_t0.8_test_time 0.16018342971801758
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.40910962224006653
ep5_train_time 8.230686902999878
Test Epoch5 threshold 0.8 Acc 0.9121052631578948, AUC 0.9789230823516846, avg_entr 0.05490029230713844
ep5_t0.8_test_time 0.15979838371276855
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.4120517671108246
ep6_train_time 8.21750545501709
Test Epoch6 threshold 0.8 Acc 0.9105263157894737, AUC 0.9785933494567871, avg_entr 0.050747212022542953
ep6_t0.8_test_time 0.15914607048034668
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.4149431586265564
ep7_train_time 8.236204385757446
Test Epoch7 threshold 0.8 Acc 0.91, AUC 0.9786480665206909, avg_entr 0.047002967447042465
ep7_t0.8_test_time 0.16005444526672363
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.41737067699432373
ep8_train_time 8.238049268722534
Test Epoch8 threshold 0.8 Acc 0.9113157894736842, AUC 0.9784055352210999, avg_entr 0.044044990092515945
ep8_t0.8_test_time 0.15935349464416504
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.4193378686904907
ep9_train_time 8.19920039176941
Test Epoch9 threshold 0.8 Acc 0.9107894736842105, AUC 0.9785417318344116, avg_entr 0.041070982813835144
ep9_t0.8_test_time 0.15997624397277832
Best AUC 0.9789230823516846
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 85.42961382865906
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9247368421052632, AUC 0.9850174188613892, avg_entr 0.05500427633523941
t0.8_test_time 0.1584937572479248
