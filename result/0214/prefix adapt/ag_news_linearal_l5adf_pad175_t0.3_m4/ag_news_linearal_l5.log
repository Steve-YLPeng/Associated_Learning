total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.3_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.556892156600952
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.08984166666666667 (10781/120000), AUC 0.42939573526382446
ep0_train_time 9.858769416809082
Test Epoch0 threshold 0.3 Acc 0.9110526315789473, AUC 0.9783939123153687, avg_entr 0.025571687147021294
ep0_t0.3_test_time 0.16769623756408691
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.220975 (26517/120000), AUC 0.47446301579475403
ep1_train_time 9.37122893333435
Test Epoch1 threshold 0.3 Acc 0.9105263157894737, AUC 0.9783312082290649, avg_entr 0.025628769770264626
ep1_t0.3_test_time 0.16580915451049805
gc 0
Train Epoch2 Acc 0.26940833333333336 (32329/120000), AUC 0.4996088743209839
ep2_train_time 9.480079650878906
Test Epoch2 threshold 0.3 Acc 0.91, AUC 0.9781190752983093, avg_entr 0.024585429579019547
ep2_t0.3_test_time 0.1655254364013672
gc 0
Train Epoch3 Acc 0.29885 (35862/120000), AUC 0.5138455033302307
ep3_train_time 9.519279956817627
Test Epoch3 threshold 0.3 Acc 0.9107894736842105, AUC 0.9780380129814148, avg_entr 0.02487657405436039
ep3_t0.3_test_time 0.16618037223815918
gc 0
Train Epoch4 Acc 0.3947333333333333 (47368/120000), AUC 0.5200583934783936
ep4_train_time 9.506838321685791
Test Epoch4 threshold 0.3 Acc 0.9110526315789473, AUC 0.9780250787734985, avg_entr 0.025849800556898117
ep4_t0.3_test_time 0.16473984718322754
gc 0
Train Epoch5 Acc 0.4382916666666667 (52595/120000), AUC 0.5183959007263184
ep5_train_time 9.487637042999268
Test Epoch5 threshold 0.3 Acc 0.9089473684210526, AUC 0.9779684543609619, avg_entr 0.02459729090332985
ep5_t0.3_test_time 0.16533112525939941
gc 0
Train Epoch6 Acc 0.4396583333333333 (52759/120000), AUC 0.5155196785926819
ep6_train_time 9.505683898925781
Test Epoch6 threshold 0.3 Acc 0.9092105263157895, AUC 0.97773277759552, avg_entr 0.024869056418538094
ep6_t0.3_test_time 0.1640794277191162
gc 0
Train Epoch7 Acc 0.4382333333333333 (52588/120000), AUC 0.511671245098114
ep7_train_time 9.50133991241455
Test Epoch7 threshold 0.3 Acc 0.9084210526315789, AUC 0.9775950908660889, avg_entr 0.025694819167256355
ep7_t0.3_test_time 0.16507554054260254
gc 0
Train Epoch8 Acc 0.43778333333333336 (52534/120000), AUC 0.508651614189148
ep8_train_time 9.460422992706299
Test Epoch8 threshold 0.3 Acc 0.9097368421052632, AUC 0.9774831533432007, avg_entr 0.02451006881892681
ep8_t0.3_test_time 0.16478729248046875
gc 0
Train Epoch9 Acc 0.43755 (52506/120000), AUC 0.5039376020431519
ep9_train_time 9.469614267349243
Test Epoch9 threshold 0.3 Acc 0.9092105263157895, AUC 0.9774220585823059, avg_entr 0.024707941338419914
ep9_t0.3_test_time 0.1650083065032959
Best AUC 0.9783939123153687
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 97.5514771938324
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.3_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9244736842105263, AUC 0.9847584962844849, avg_entr 0.024488959461450577
t0.3_test_time 0.16545987129211426
