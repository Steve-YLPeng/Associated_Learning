total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.96456480026245
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.33569166666666667 (40283/120000), AUC 0.5047580003738403
ep0_train_time 8.998454093933105
Test Epoch0 threshold 0.1 Acc 0.9139473684210526, AUC 0.9789508581161499, avg_entr 0.02715812437236309
ep0_t0.1_test_time 0.16705060005187988
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.33066666666666666 (39680/120000), AUC 0.5869438648223877
ep1_train_time 8.670748949050903
Test Epoch1 threshold 0.1 Acc 0.9118421052631579, AUC 0.9787575006484985, avg_entr 0.025893373414874077
ep1_t0.1_test_time 0.16649723052978516
gc 0
Train Epoch2 Acc 0.4088833333333333 (49066/120000), AUC 0.5917446613311768
ep2_train_time 8.599517107009888
Test Epoch2 threshold 0.1 Acc 0.9128947368421053, AUC 0.9788289666175842, avg_entr 0.02544010430574417
ep2_t0.1_test_time 0.16551947593688965
gc 0
Train Epoch3 Acc 0.481775 (57813/120000), AUC 0.5927376747131348
ep3_train_time 8.439119815826416
Test Epoch3 threshold 0.1 Acc 0.911578947368421, AUC 0.978528618812561, avg_entr 0.02613835036754608
ep3_t0.1_test_time 0.1664578914642334
gc 0
Train Epoch4 Acc 0.4953166666666667 (59438/120000), AUC 0.5953142642974854
ep4_train_time 8.612081527709961
Test Epoch4 threshold 0.1 Acc 0.9097368421052632, AUC 0.9785122275352478, avg_entr 0.025524664670228958
ep4_t0.1_test_time 0.16618776321411133
gc 0
Train Epoch5 Acc 0.4947 (59364/120000), AUC 0.5969067215919495
ep5_train_time 8.643126010894775
Test Epoch5 threshold 0.1 Acc 0.9107894736842105, AUC 0.9783971309661865, avg_entr 0.025569330900907516
ep5_t0.1_test_time 0.1651909351348877
gc 0
Train Epoch6 Acc 0.4940583333333333 (59287/120000), AUC 0.5979405641555786
ep6_train_time 8.707695722579956
Test Epoch6 threshold 0.1 Acc 0.9097368421052632, AUC 0.9782041311264038, avg_entr 0.02506447583436966
ep6_t0.1_test_time 0.16660189628601074
gc 0
Train Epoch7 Acc 0.49396666666666667 (59276/120000), AUC 0.5984419584274292
ep7_train_time 8.634581565856934
Test Epoch7 threshold 0.1 Acc 0.9097368421052632, AUC 0.9782528281211853, avg_entr 0.025744710117578506
ep7_t0.1_test_time 0.16711664199829102
gc 0
Train Epoch8 Acc 0.4935083333333333 (59221/120000), AUC 0.598347008228302
ep8_train_time 8.701966762542725
Test Epoch8 threshold 0.1 Acc 0.9105263157894737, AUC 0.9781694412231445, avg_entr 0.025030968710780144
ep8_t0.1_test_time 0.1680309772491455
gc 0
Train Epoch9 Acc 0.49328333333333335 (59194/120000), AUC 0.5980503559112549
ep9_train_time 8.5796377658844
Test Epoch9 threshold 0.1 Acc 0.9097368421052632, AUC 0.9780641794204712, avg_entr 0.026037519797682762
ep9_t0.1_test_time 0.16648077964782715
Best AUC 0.9789508581161499
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 88.99106097221375
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.1_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.925, AUC 0.9848988056182861, avg_entr 0.027054281905293465
t0.1_test_time 0.16411137580871582
