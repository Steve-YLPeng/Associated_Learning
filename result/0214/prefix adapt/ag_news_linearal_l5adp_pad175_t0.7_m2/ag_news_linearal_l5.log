total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.06409001350403
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.35604166666666665 (42725/120000), AUC 0.7083402276039124
ep0_train_time 9.473960161209106
Test Epoch0 threshold 0.7 Acc 0.9144736842105263, AUC 0.9792042374610901, avg_entr 0.028119221329689026
ep0_t0.7_test_time 0.1630842685699463
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.374475 (44937/120000), AUC 0.7947566509246826
ep1_train_time 9.092182397842407
Test Epoch1 threshold 0.7 Acc 0.9126315789473685, AUC 0.9790209531784058, avg_entr 0.02673879638314247
ep1_t0.7_test_time 0.16050004959106445
gc 0
Train Epoch2 Acc 0.39245 (47094/120000), AUC 0.7905545234680176
ep2_train_time 9.764567852020264
Test Epoch2 threshold 0.7 Acc 0.9113157894736842, AUC 0.9788515567779541, avg_entr 0.027623703703284264
ep2_t0.7_test_time 0.16156721115112305
gc 0
Train Epoch3 Acc 0.41096666666666665 (49316/120000), AUC 0.7868003845214844
ep3_train_time 9.084943056106567
Test Epoch3 threshold 0.7 Acc 0.9128947368421053, AUC 0.9786732196807861, avg_entr 0.026911333203315735
ep3_t0.7_test_time 0.16205406188964844
gc 0
Train Epoch4 Acc 0.43169166666666664 (51803/120000), AUC 0.7822021245956421
ep4_train_time 9.153606176376343
Test Epoch4 threshold 0.7 Acc 0.9118421052631579, AUC 0.9786219596862793, avg_entr 0.026035577058792114
ep4_t0.7_test_time 0.16129755973815918
gc 0
Train Epoch5 Acc 0.44374166666666665 (53249/120000), AUC 0.7795119881629944
ep5_train_time 9.268165588378906
Test Epoch5 threshold 0.7 Acc 0.9105263157894737, AUC 0.9784550666809082, avg_entr 0.027041302993893623
ep5_t0.7_test_time 0.16313767433166504
gc 0
Train Epoch6 Acc 0.44885833333333336 (53863/120000), AUC 0.7779710292816162
ep6_train_time 9.022831201553345
Test Epoch6 threshold 0.7 Acc 0.9089473684210526, AUC 0.9782838225364685, avg_entr 0.026533566415309906
ep6_t0.7_test_time 0.1584923267364502
gc 0
Train Epoch7 Acc 0.45469166666666666 (54563/120000), AUC 0.7760576009750366
ep7_train_time 8.779001712799072
Test Epoch7 threshold 0.7 Acc 0.9107894736842105, AUC 0.9782732129096985, avg_entr 0.02657640166580677
ep7_t0.7_test_time 0.15940070152282715
gc 0
Train Epoch8 Acc 0.4592333333333333 (55108/120000), AUC 0.7738070487976074
ep8_train_time 8.894667863845825
Test Epoch8 threshold 0.7 Acc 0.9102631578947369, AUC 0.97803795337677, avg_entr 0.026973461732268333
ep8_t0.7_test_time 0.1585369110107422
gc 0
Train Epoch9 Acc 0.4623333333333333 (55480/120000), AUC 0.7721593976020813
ep9_train_time 8.648002862930298
Test Epoch9 threshold 0.7 Acc 0.9105263157894737, AUC 0.9780620336532593, avg_entr 0.02627405896782875
ep9_t0.7_test_time 0.15974664688110352
Best AUC 0.9792042374610901
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 93.5243148803711
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.7_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9231578947368421, AUC 0.9850554466247559, avg_entr 0.027955498546361923
t0.7_test_time 0.15668272972106934
