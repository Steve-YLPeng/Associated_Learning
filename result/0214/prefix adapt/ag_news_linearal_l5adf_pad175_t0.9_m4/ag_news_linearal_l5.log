total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.9_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.712648391723633
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.03141666666666667 (3770/120000), AUC 0.5366578698158264
ep0_train_time 10.09322714805603
Test Epoch0 threshold 0.9 Acc 0.9105263157894737, AUC 0.978579044342041, avg_entr 0.0259492639452219
ep0_t0.9_test_time 0.16150999069213867
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.028275 (3393/120000), AUC 0.47461074590682983
ep1_train_time 9.732625246047974
Test Epoch1 threshold 0.9 Acc 0.91, AUC 0.978435218334198, avg_entr 0.025081798434257507
ep1_t0.9_test_time 0.16198420524597168
gc 0
Train Epoch2 Acc 0.12901666666666667 (15482/120000), AUC 0.4700997471809387
ep2_train_time 9.679524421691895
Test Epoch2 threshold 0.9 Acc 0.9094736842105263, AUC 0.9782268404960632, avg_entr 0.025500958785414696
ep2_t0.9_test_time 0.1597151756286621
gc 0
Train Epoch3 Acc 0.11860833333333333 (14233/120000), AUC 0.4832310676574707
ep3_train_time 9.70563268661499
Test Epoch3 threshold 0.9 Acc 0.9113157894736842, AUC 0.9781731367111206, avg_entr 0.02653840370476246
ep3_t0.9_test_time 0.15903735160827637
gc 0
Train Epoch4 Acc 0.05545 (6654/120000), AUC 0.5003688335418701
ep4_train_time 9.725696563720703
Test Epoch4 threshold 0.9 Acc 0.9092105263157895, AUC 0.9780117869377136, avg_entr 0.025741364806890488
ep4_t0.9_test_time 0.1598501205444336
gc 0
Train Epoch5 Acc 0.03381666666666667 (4058/120000), AUC 0.5124627947807312
ep5_train_time 9.705849409103394
Test Epoch5 threshold 0.9 Acc 0.91, AUC 0.9779360294342041, avg_entr 0.02648290991783142
ep5_t0.9_test_time 0.1590137481689453
gc 0
Train Epoch6 Acc 0.029258333333333334 (3511/120000), AUC 0.5169426202774048
ep6_train_time 9.83864450454712
Test Epoch6 threshold 0.9 Acc 0.9107894736842105, AUC 0.9778095483779907, avg_entr 0.02646404504776001
ep6_t0.9_test_time 0.15913128852844238
gc 0
Train Epoch7 Acc 0.027258333333333332 (3271/120000), AUC 0.5195578336715698
ep7_train_time 9.708266735076904
Test Epoch7 threshold 0.9 Acc 0.9094736842105263, AUC 0.9776450395584106, avg_entr 0.026421306654810905
ep7_t0.9_test_time 0.16048192977905273
gc 0
Train Epoch8 Acc 0.026608333333333335 (3193/120000), AUC 0.519038200378418
ep8_train_time 9.693495512008667
Test Epoch8 threshold 0.9 Acc 0.9089473684210526, AUC 0.9775738716125488, avg_entr 0.025626882910728455
ep8_t0.9_test_time 0.1585400104522705
gc 0
Train Epoch9 Acc 0.026083333333333333 (3130/120000), AUC 0.5190629959106445
ep9_train_time 9.706553936004639
Test Epoch9 threshold 0.9 Acc 0.9086842105263158, AUC 0.9775222539901733, avg_entr 0.026511261239647865
ep9_t0.9_test_time 0.159376859664917
Best AUC 0.978579044342041
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 99.91537761688232
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.9_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9213157894736842, AUC 0.9845367074012756, avg_entr 0.024562623351812363
t0.9_test_time 0.15811514854431152
