total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.2_m3//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 19.93264389038086
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.25378333333333336 (30454/120000), AUC 0.4841577410697937
ep0_train_time 77.59492921829224
Test Epoch0 threshold 0.2 Acc 0.906578947368421, AUC 0.9763628840446472, avg_entr 0.013387108221650124
ep0_t0.2_test_time 0.33347582817077637
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.2_m4//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25509166666666666 (30611/120000), AUC 0.4916943907737732
ep1_train_time 77.60701370239258
Test Epoch1 threshold 0.2 Acc 0.9102631578947369, AUC 0.9760855436325073, avg_entr 0.011918185278773308
ep1_t0.2_test_time 0.30408477783203125
gc 0
Train Epoch2 Acc 0.26011666666666666 (31214/120000), AUC 0.49246740341186523
ep2_train_time 77.79977202415466
Test Epoch2 threshold 0.2 Acc 0.9084210526315789, AUC 0.9755819439888, avg_entr 0.012551330029964447
ep2_t0.2_test_time 0.3006436824798584
gc 0
Train Epoch3 Acc 0.26708333333333334 (32050/120000), AUC 0.4981078803539276
ep3_train_time 78.90984082221985
Test Epoch3 threshold 0.2 Acc 0.9042105263157895, AUC 0.9764916896820068, avg_entr 0.01277482882142067
ep3_t0.2_test_time 0.387706995010376
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.2_m4//ag_news_lstmal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.2826 (33912/120000), AUC 0.5201600790023804
ep4_train_time 442.27440643310547
Test Epoch4 threshold 0.2 Acc 0.905, AUC 0.9755284190177917, avg_entr 0.013547484762966633
ep4_t0.2_test_time 0.34581470489501953
gc 0
Train Epoch5 Acc 0.2881666666666667 (34580/120000), AUC 0.5375168323516846
ep5_train_time 79.34082674980164
Test Epoch5 threshold 0.2 Acc 0.9089473684210526, AUC 0.9747158288955688, avg_entr 0.01153352577239275
ep5_t0.2_test_time 0.35344457626342773
gc 0
Train Epoch6 Acc 0.29134166666666667 (34961/120000), AUC 0.5522364974021912
ep6_train_time 78.39441895484924
Test Epoch6 threshold 0.2 Acc 0.9071052631578947, AUC 0.9743318557739258, avg_entr 0.011870594695210457
ep6_t0.2_test_time 0.29314255714416504
gc 0
Train Epoch7 Acc 0.27245 (32694/120000), AUC 0.5591280460357666
ep7_train_time 79.33051228523254
Test Epoch7 threshold 0.2 Acc 0.9073684210526316, AUC 0.974174976348877, avg_entr 0.012158629484474659
ep7_t0.2_test_time 0.38221168518066406
gc 0
Train Epoch8 Acc 0.27373333333333333 (32848/120000), AUC 0.5644381046295166
ep8_train_time 82.8994493484497
Test Epoch8 threshold 0.2 Acc 0.9036842105263158, AUC 0.9735399484634399, avg_entr 0.011827212758362293
ep8_t0.2_test_time 0.575474739074707
gc 0
Train Epoch9 Acc 0.2678583333333333 (32143/120000), AUC 0.5642271041870117
ep9_train_time 82.39838886260986
Test Epoch9 threshold 0.2 Acc 0.9034210526315789, AUC 0.9734494686126709, avg_entr 0.012049107812345028
ep9_t0.2_test_time 0.36443042755126953
Best AUC 0.9764916896820068
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 1161.2938482761383
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.2_m4//ag_news_lstmal_l5_prefix.pt
Test threshold 0.2 Acc 0.92, AUC 0.9824662804603577, avg_entr 0.011590300127863884
t0.2_test_time 0.3781096935272217
