total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.1_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.805699825286865
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.300925 (36111/120000), AUC 0.5972801446914673
ep0_train_time 9.446395635604858
Test Epoch0 threshold 0.1 Acc 0.9136842105263158, AUC 0.9789055585861206, avg_entr 0.02466071955859661
ep0_t0.1_test_time 0.16997289657592773
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.3255 (39060/120000), AUC 0.6125829815864563
ep1_train_time 8.989207029342651
Test Epoch1 threshold 0.1 Acc 0.9139473684210526, AUC 0.9789716005325317, avg_entr 0.024731522426009178
ep1_t0.1_test_time 0.16866612434387207
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m3//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.3025833333333333 (36310/120000), AUC 0.6227977275848389
ep2_train_time 8.975426435470581
Test Epoch2 threshold 0.1 Acc 0.9121052631578948, AUC 0.978617250919342, avg_entr 0.024608081206679344
ep2_t0.1_test_time 0.16807842254638672
gc 0
Train Epoch3 Acc 0.29378333333333334 (35254/120000), AUC 0.6324446201324463
ep3_train_time 8.953013181686401
Test Epoch3 threshold 0.1 Acc 0.9121052631578948, AUC 0.9784148335456848, avg_entr 0.023265324532985687
ep3_t0.1_test_time 0.1670985221862793
gc 0
Train Epoch4 Acc 0.29554166666666665 (35465/120000), AUC 0.6493359804153442
ep4_train_time 8.925509691238403
Test Epoch4 threshold 0.1 Acc 0.9097368421052632, AUC 0.978156566619873, avg_entr 0.023067140951752663
ep4_t0.1_test_time 0.16872262954711914
gc 0
Train Epoch5 Acc 0.30665 (36798/120000), AUC 0.6638786792755127
ep5_train_time 8.895912408828735
Test Epoch5 threshold 0.1 Acc 0.9105263157894737, AUC 0.9783380031585693, avg_entr 0.022369908168911934
ep5_t0.1_test_time 0.168745756149292
gc 0
Train Epoch6 Acc 0.32385833333333336 (38863/120000), AUC 0.6694114208221436
ep6_train_time 8.954959392547607
Test Epoch6 threshold 0.1 Acc 0.9113157894736842, AUC 0.9782547950744629, avg_entr 0.021402420476078987
ep6_t0.1_test_time 0.16814804077148438
gc 0
Train Epoch7 Acc 0.3486416666666667 (41837/120000), AUC 0.6725093126296997
ep7_train_time 8.95833969116211
Test Epoch7 threshold 0.1 Acc 0.9092105263157895, AUC 0.9781627655029297, avg_entr 0.021268147975206375
ep7_t0.1_test_time 0.1685025691986084
gc 0
Train Epoch8 Acc 0.375475 (45057/120000), AUC 0.6700769662857056
ep8_train_time 9.000790119171143
Test Epoch8 threshold 0.1 Acc 0.9086842105263158, AUC 0.9780967831611633, avg_entr 0.020541289821267128
ep8_t0.1_test_time 0.1684703826904297
gc 0
Train Epoch9 Acc 0.39248333333333335 (47098/120000), AUC 0.6654788255691528
ep9_train_time 8.990625143051147
Test Epoch9 threshold 0.1 Acc 0.9097368421052632, AUC 0.9780163168907166, avg_entr 0.02038351446390152
ep9_t0.1_test_time 0.16832375526428223
Best AUC 0.9789716005325317
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 92.57410502433777
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.1_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9223684210526316, AUC 0.9848476052284241, avg_entr 0.025271549820899963
t0.1_test_time 0.16603326797485352
