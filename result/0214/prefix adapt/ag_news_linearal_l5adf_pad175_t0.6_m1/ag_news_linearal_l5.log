total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.57739019393921
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.292475 (35097/120000), AUC 0.6074665784835815
ep0_train_time 8.530811309814453
Test Epoch0 threshold 0.6 Acc 0.8918421052631579, AUC 0.9712721705436707, avg_entr 0.18067751824855804
ep0_t0.6_test_time 0.15970754623413086
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.38143333333333335 (45772/120000), AUC 0.6755507588386536
ep1_train_time 8.14777421951294
Test Epoch1 threshold 0.6 Acc 0.908157894736842, AUC 0.9759379625320435, avg_entr 0.10717527568340302
ep1_t0.6_test_time 0.16134953498840332
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.4501 (54012/120000), AUC 0.6691620349884033
ep2_train_time 8.142898559570312
Test Epoch2 threshold 0.6 Acc 0.9105263157894737, AUC 0.9776154160499573, avg_entr 0.07970002293586731
ep2_t0.6_test_time 0.15845203399658203
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.44725 (53670/120000), AUC 0.6634228229522705
ep3_train_time 8.09322714805603
Test Epoch3 threshold 0.6 Acc 0.9060526315789473, AUC 0.9783990383148193, avg_entr 0.06883441656827927
ep3_t0.6_test_time 0.15859079360961914
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.38503333333333334 (46204/120000), AUC 0.659579873085022
ep4_train_time 8.086281299591064
Test Epoch4 threshold 0.6 Acc 0.9105263157894737, AUC 0.9788323640823364, avg_entr 0.05896986648440361
ep4_t0.6_test_time 0.15822720527648926
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.3221 (38652/120000), AUC 0.656089186668396
ep5_train_time 8.09430480003357
Test Epoch5 threshold 0.6 Acc 0.9113157894736842, AUC 0.9788045883178711, avg_entr 0.05310526117682457
ep5_t0.6_test_time 0.1617286205291748
gc 0
Train Epoch6 Acc 0.28025833333333333 (33631/120000), AUC 0.6531268954277039
ep6_train_time 8.118083715438843
Test Epoch6 threshold 0.6 Acc 0.9113157894736842, AUC 0.979037880897522, avg_entr 0.04851100221276283
ep6_t0.6_test_time 0.15890049934387207
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.2613666666666667 (31364/120000), AUC 0.6507428884506226
ep7_train_time 8.181230783462524
Test Epoch7 threshold 0.6 Acc 0.9089473684210526, AUC 0.9789184927940369, avg_entr 0.046003762632608414
ep7_t0.6_test_time 0.15874528884887695
gc 0
Train Epoch8 Acc 0.254175 (30501/120000), AUC 0.648524820804596
ep8_train_time 8.209053754806519
Test Epoch8 threshold 0.6 Acc 0.9078947368421053, AUC 0.9788797497749329, avg_entr 0.043718062341213226
ep8_t0.6_test_time 0.1593639850616455
gc 0
Train Epoch9 Acc 0.25156666666666666 (30188/120000), AUC 0.646831214427948
ep9_train_time 8.187939167022705
Test Epoch9 threshold 0.6 Acc 0.9118421052631579, AUC 0.9788157939910889, avg_entr 0.04131212830543518
ep9_t0.6_test_time 0.15893864631652832
Best AUC 0.979037880897522
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 84.46492671966553
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.925, AUC 0.9849940538406372, avg_entr 0.0478823147714138
t0.6_test_time 0.1570420265197754
