total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.2_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.850278854370117
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.916025 (109923/120000), AUC 0.9849432110786438
ep0_train_time 10.480839490890503
Test Epoch0 threshold 0.2 Acc 0.9052631578947369, AUC 0.9782834649085999, avg_entr 0.022928573191165924
ep0_t0.2_test_time 0.18454456329345703
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9504666666666667 (114056/120000), AUC 0.9932354688644409
ep1_train_time 10.096814393997192
Test Epoch1 threshold 0.2 Acc 0.9107894736842105, AUC 0.9782861471176147, avg_entr 0.020385516807436943
ep1_t0.2_test_time 0.1824955940246582
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m5//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.951675 (114201/120000), AUC 0.9936239719390869
ep2_train_time 10.010316848754883
Test Epoch2 threshold 0.2 Acc 0.9071052631578947, AUC 0.9779149889945984, avg_entr 0.019165433943271637
ep2_t0.2_test_time 0.17903876304626465
gc 0
Train Epoch3 Acc 0.9527833333333333 (114334/120000), AUC 0.9936684370040894
ep3_train_time 10.01725459098816
Test Epoch3 threshold 0.2 Acc 0.9102631578947369, AUC 0.9780659675598145, avg_entr 0.018617089837789536
ep3_t0.2_test_time 0.1787269115447998
gc 0
Train Epoch4 Acc 0.953725 (114447/120000), AUC 0.9941062927246094
ep4_train_time 10.116443872451782
Test Epoch4 threshold 0.2 Acc 0.9086842105263158, AUC 0.9779030084609985, avg_entr 0.017786074429750443
ep4_t0.2_test_time 0.18036532402038574
gc 0
Train Epoch5 Acc 0.9555833333333333 (114670/120000), AUC 0.9947816729545593
ep5_train_time 10.094889402389526
Test Epoch5 threshold 0.2 Acc 0.908157894736842, AUC 0.9777166247367859, avg_entr 0.017328741028904915
ep5_t0.2_test_time 0.17957019805908203
gc 0
Train Epoch6 Acc 0.955725 (114687/120000), AUC 0.9948632717132568
ep6_train_time 9.952158689498901
Test Epoch6 threshold 0.2 Acc 0.9071052631578947, AUC 0.9778317213058472, avg_entr 0.016896139830350876
ep6_t0.2_test_time 0.1778554916381836
gc 0
Train Epoch7 Acc 0.9563916666666666 (114767/120000), AUC 0.9949986934661865
ep7_train_time 9.949662923812866
Test Epoch7 threshold 0.2 Acc 0.91, AUC 0.9774396419525146, avg_entr 0.0170973502099514
ep7_t0.2_test_time 0.17963695526123047
gc 0
Train Epoch8 Acc 0.9569 (114828/120000), AUC 0.9950628280639648
ep8_train_time 10.037714958190918
Test Epoch8 threshold 0.2 Acc 0.9078947368421053, AUC 0.9773916006088257, avg_entr 0.0163828544318676
ep8_t0.2_test_time 0.1781482696533203
gc 0
Train Epoch9 Acc 0.957925 (114951/120000), AUC 0.9953621625900269
ep9_train_time 9.92776346206665
Test Epoch9 threshold 0.2 Acc 0.9089473684210526, AUC 0.9771907329559326, avg_entr 0.016769781708717346
ep9_t0.2_test_time 0.17993450164794922
Best AUC 0.9782861471176147
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 103.27895617485046
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.2_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9223684210526316, AUC 0.9843401312828064, avg_entr 0.02039552666246891
t0.2_test_time 0.18213868141174316
