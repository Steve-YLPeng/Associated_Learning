total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.62535333633423
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24988333333333335 (29986/120000), AUC 0.5846506953239441
ep0_train_time 8.646214962005615
Test Epoch0 threshold 0.6 Acc 0.8968421052631579, AUC 0.9711310863494873, avg_entr 0.18143709003925323
ep0_t0.6_test_time 0.16274428367614746
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.6437486410140991
ep1_train_time 8.187233686447144
Test Epoch1 threshold 0.6 Acc 0.9055263157894737, AUC 0.9755796194076538, avg_entr 0.10628097504377365
ep1_t0.6_test_time 0.16086387634277344
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.6429885625839233
ep2_train_time 8.206809520721436
Test Epoch2 threshold 0.6 Acc 0.9071052631578947, AUC 0.9772866368293762, avg_entr 0.08178000152111053
ep2_t0.6_test_time 0.16729402542114258
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.6401733756065369
ep3_train_time 8.173029899597168
Test Epoch3 threshold 0.6 Acc 0.908157894736842, AUC 0.9778649806976318, avg_entr 0.06892961263656616
ep3_t0.6_test_time 0.16127228736877441
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.6376504898071289
ep4_train_time 8.173238277435303
Test Epoch4 threshold 0.6 Acc 0.9107894736842105, AUC 0.9783661365509033, avg_entr 0.060079313814640045
ep4_t0.6_test_time 0.1598339080810547
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.6357384920120239
ep5_train_time 8.219799995422363
Test Epoch5 threshold 0.6 Acc 0.9118421052631579, AUC 0.9784715175628662, avg_entr 0.05358026921749115
ep5_t0.6_test_time 0.1606616973876953
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.6339111328125
ep6_train_time 8.23427700996399
Test Epoch6 threshold 0.6 Acc 0.9113157894736842, AUC 0.9785500168800354, avg_entr 0.05037811025977135
ep6_t0.6_test_time 0.16164445877075195
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.24998333333333334 (29998/120000), AUC 0.6322023868560791
ep7_train_time 8.239692449569702
Test Epoch7 threshold 0.6 Acc 0.9126315789473685, AUC 0.9784202575683594, avg_entr 0.045920100063085556
ep7_t0.6_test_time 0.16070199012756348
gc 0
Train Epoch8 Acc 0.24998333333333334 (29998/120000), AUC 0.6307445168495178
ep8_train_time 8.263468980789185
Test Epoch8 threshold 0.6 Acc 0.911578947368421, AUC 0.9784270524978638, avg_entr 0.043182920664548874
ep8_t0.6_test_time 0.16191482543945312
gc 0
Train Epoch9 Acc 0.24998333333333334 (29998/120000), AUC 0.6295492649078369
ep9_train_time 8.192760705947876
Test Epoch9 threshold 0.6 Acc 0.911578947368421, AUC 0.9784727692604065, avg_entr 0.04136174917221069
ep9_t0.6_test_time 0.1616978645324707
Best AUC 0.9785500168800354
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 85.28902840614319
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9244736842105263, AUC 0.9849303364753723, avg_entr 0.0500553734600544
t0.6_test_time 0.1588270664215088
