total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.816694974899292
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.24341666666666667 (29210/120000), AUC 0.4852364957332611
ep0_train_time 9.064284086227417
Test Epoch0 threshold 0.4 Acc 0.9123684210526316, AUC 0.97908616065979, avg_entr 0.028033511713147163
ep0_t0.4_test_time 0.16194915771484375
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24859166666666666 (29831/120000), AUC 0.5339906215667725
ep1_train_time 8.560885190963745
Test Epoch1 threshold 0.4 Acc 0.908157894736842, AUC 0.9786091446876526, avg_entr 0.028438115492463112
ep1_t0.4_test_time 0.160888671875
gc 0
Train Epoch2 Acc 0.23081666666666667 (27698/120000), AUC 0.5447757244110107
ep2_train_time 8.54785943031311
Test Epoch2 threshold 0.4 Acc 0.9110526315789473, AUC 0.9788724184036255, avg_entr 0.02681909315288067
ep2_t0.4_test_time 0.1608588695526123
gc 0
Train Epoch3 Acc 0.220425 (26451/120000), AUC 0.5476465225219727
ep3_train_time 8.541616678237915
Test Epoch3 threshold 0.4 Acc 0.91, AUC 0.9786670804023743, avg_entr 0.026094302535057068
ep3_t0.4_test_time 0.1603107452392578
gc 0
Train Epoch4 Acc 0.23455 (28146/120000), AUC 0.5514816641807556
ep4_train_time 8.54054045677185
Test Epoch4 threshold 0.4 Acc 0.9105263157894737, AUC 0.9785528182983398, avg_entr 0.02610892616212368
ep4_t0.4_test_time 0.1638498306274414
gc 0
Train Epoch5 Acc 0.24545833333333333 (29455/120000), AUC 0.5532875657081604
ep5_train_time 8.608996391296387
Test Epoch5 threshold 0.4 Acc 0.9086842105263158, AUC 0.9782609343528748, avg_entr 0.026279158890247345
ep5_t0.4_test_time 0.16038084030151367
gc 0
Train Epoch6 Acc 0.24829166666666666 (29795/120000), AUC 0.555873692035675
ep6_train_time 8.567698001861572
Test Epoch6 threshold 0.4 Acc 0.9086842105263158, AUC 0.9782482385635376, avg_entr 0.026032323017716408
ep6_t0.4_test_time 0.16146039962768555
gc 0
Train Epoch7 Acc 0.24935 (29922/120000), AUC 0.5583574771881104
ep7_train_time 8.614958047866821
Test Epoch7 threshold 0.4 Acc 0.91, AUC 0.9780747890472412, avg_entr 0.0268926452845335
ep7_t0.4_test_time 0.16203880310058594
gc 0
Train Epoch8 Acc 0.24983333333333332 (29980/120000), AUC 0.5605540871620178
ep8_train_time 8.532616138458252
Test Epoch8 threshold 0.4 Acc 0.9102631578947369, AUC 0.977886438369751, avg_entr 0.02622436173260212
ep8_t0.4_test_time 0.15995478630065918
gc 0
Train Epoch9 Acc 0.250225 (30027/120000), AUC 0.5625342130661011
ep9_train_time 8.639909267425537
Test Epoch9 threshold 0.4 Acc 0.9084210526315789, AUC 0.9777991771697998, avg_entr 0.02548328973352909
ep9_t0.4_test_time 0.16093659400939941
Best AUC 0.97908616065979
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 88.5726990699768
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.4_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9242105263157895, AUC 0.9850164651870728, avg_entr 0.02748468704521656
t0.4_test_time 0.16044116020202637
