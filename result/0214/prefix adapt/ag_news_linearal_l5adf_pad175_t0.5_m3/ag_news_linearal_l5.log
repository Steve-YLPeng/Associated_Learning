total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.5_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.363967657089233
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.239325 (28719/120000), AUC 0.5646167993545532
ep0_train_time 10.340024709701538
Test Epoch0 threshold 0.5 Acc 0.9128947368421053, AUC 0.9789731502532959, avg_entr 0.026538141071796417
ep0_t0.5_test_time 0.16733956336975098
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.23436666666666667 (28124/120000), AUC 0.577681839466095
ep1_train_time 9.813045024871826
Test Epoch1 threshold 0.5 Acc 0.9136842105263158, AUC 0.9789732098579407, avg_entr 0.02625449374318123
ep1_t0.5_test_time 0.16600918769836426
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m3//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.23475833333333335 (28171/120000), AUC 0.5857797265052795
ep2_train_time 9.932104110717773
Test Epoch2 threshold 0.5 Acc 0.9128947368421053, AUC 0.9786750078201294, avg_entr 0.026196954771876335
ep2_t0.5_test_time 0.1668415069580078
gc 0
Train Epoch3 Acc 0.23601666666666668 (28322/120000), AUC 0.5781205892562866
ep3_train_time 9.888503551483154
Test Epoch3 threshold 0.5 Acc 0.9128947368421053, AUC 0.9786598682403564, avg_entr 0.0261069443076849
ep3_t0.5_test_time 0.16590499877929688
gc 0
Train Epoch4 Acc 0.232925 (27951/120000), AUC 0.5537269711494446
ep4_train_time 9.983125925064087
Test Epoch4 threshold 0.5 Acc 0.9110526315789473, AUC 0.9783778190612793, avg_entr 0.026061708107590675
ep4_t0.5_test_time 0.16625499725341797
gc 0
Train Epoch5 Acc 0.217025 (26043/120000), AUC 0.5303021669387817
ep5_train_time 9.902762174606323
Test Epoch5 threshold 0.5 Acc 0.9102631578947369, AUC 0.9783217906951904, avg_entr 0.026766011491417885
ep5_t0.5_test_time 0.1660783290863037
gc 0
Train Epoch6 Acc 0.1703 (20436/120000), AUC 0.5165824890136719
ep6_train_time 9.84322190284729
Test Epoch6 threshold 0.5 Acc 0.9102631578947369, AUC 0.9782231450080872, avg_entr 0.026626117527484894
ep6_t0.5_test_time 0.16636109352111816
gc 0
Train Epoch7 Acc 0.100075 (12009/120000), AUC 0.5061202049255371
ep7_train_time 9.870483875274658
Test Epoch7 threshold 0.5 Acc 0.9113157894736842, AUC 0.978142499923706, avg_entr 0.026487963274121284
ep7_t0.5_test_time 0.16632294654846191
gc 0
Train Epoch8 Acc 0.049433333333333336 (5932/120000), AUC 0.49829402565956116
ep8_train_time 9.982398748397827
Test Epoch8 threshold 0.5 Acc 0.9110526315789473, AUC 0.9782001972198486, avg_entr 0.026026107370853424
ep8_t0.5_test_time 0.1650533676147461
gc 0
Train Epoch9 Acc 0.030483333333333335 (3658/120000), AUC 0.49275630712509155
ep9_train_time 9.960455179214478
Test Epoch9 threshold 0.5 Acc 0.9110526315789473, AUC 0.9779857397079468, avg_entr 0.026573719456791878
ep9_t0.5_test_time 0.16486787796020508
Best AUC 0.9789732098579407
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 102.05909323692322
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.5_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.921578947368421, AUC 0.9850595593452454, avg_entr 0.02559537999331951
t0.5_test_time 0.16364288330078125
