total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.1_m4//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 23.920289278030396
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9385416666666667 (112625/120000), AUC 0.9878320693969727
ep0_train_time 93.70120787620544
Test Epoch0 threshold 0.1 Acc 0.9110526315789473, AUC 0.9757684469223022, avg_entr 0.007178170140832663
ep0_t0.1_test_time 0.7311773300170898
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.1_m5//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.960175 (115221/120000), AUC 0.9936044216156006
ep1_train_time 93.42829656600952
Test Epoch1 threshold 0.1 Acc 0.9084210526315789, AUC 0.9753450155258179, avg_entr 0.007445200812071562
ep1_t0.1_test_time 0.7656142711639404
gc 0
Train Epoch2 Acc 0.962475 (115497/120000), AUC 0.9941925406455994
ep2_train_time 93.35396218299866
Test Epoch2 threshold 0.1 Acc 0.9071052631578947, AUC 0.9742130637168884, avg_entr 0.00694309314712882
ep2_t0.1_test_time 0.7271275520324707
gc 0
Train Epoch3 Acc 0.96445 (115734/120000), AUC 0.9943285584449768
ep3_train_time 93.69227814674377
Test Epoch3 threshold 0.1 Acc 0.9076315789473685, AUC 0.9747600555419922, avg_entr 0.007860246114432812
ep3_t0.1_test_time 0.8095147609710693
gc 0
Train Epoch4 Acc 0.9664333333333334 (115972/120000), AUC 0.9948035478591919
ep4_train_time 94.07995343208313
Test Epoch4 threshold 0.1 Acc 0.9036842105263158, AUC 0.9734083414077759, avg_entr 0.007130390033125877
ep4_t0.1_test_time 0.6459019184112549
gc 0
Train Epoch5 Acc 0.9700833333333333 (116410/120000), AUC 0.9953993558883667
ep5_train_time 93.67245292663574
Test Epoch5 threshold 0.1 Acc 0.9042105263157895, AUC 0.9729281663894653, avg_entr 0.006760182790458202
ep5_t0.1_test_time 0.7837252616882324
gc 0
Train Epoch6 Acc 0.971025 (116523/120000), AUC 0.995498776435852
ep6_train_time 92.98253130912781
Test Epoch6 threshold 0.1 Acc 0.9036842105263158, AUC 0.9733093976974487, avg_entr 0.006553041748702526
ep6_t0.1_test_time 0.5082640647888184
gc 0
Train Epoch7 Acc 0.9720083333333334 (116641/120000), AUC 0.995579719543457
ep7_train_time 93.28119993209839
Test Epoch7 threshold 0.1 Acc 0.9026315789473685, AUC 0.9717587828636169, avg_entr 0.00652166036888957
ep7_t0.1_test_time 0.7458686828613281
gc 0
Train Epoch8 Acc 0.9732083333333333 (116785/120000), AUC 0.99556565284729
ep8_train_time 93.47860836982727
Test Epoch8 threshold 0.1 Acc 0.9021052631578947, AUC 0.9721392393112183, avg_entr 0.006197988521307707
ep8_t0.1_test_time 0.7593607902526855
gc 0
Train Epoch9 Acc 0.975225 (117027/120000), AUC 0.9958248138427734
ep9_train_time 93.73284268379211
Test Epoch9 threshold 0.1 Acc 0.9021052631578947, AUC 0.9715753793716431, avg_entr 0.006429140921682119
ep9_t0.1_test_time 0.45949578285217285
Best AUC 0.9757684469223022
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 943.4885437488556
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.1_m5//ag_news_lstmal_l5_prefix.pt
Test threshold 0.1 Acc 0.9228947368421052, AUC 0.9819069504737854, avg_entr 0.0069992742501199245
t0.1_test_time 0.6411464214324951
