total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.1_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 34.81936836242676
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9094666666666666 (109136/120000), AUC 0.9842816591262817
ep0_train_time 19.90529727935791
Test Epoch0 threshold 0.1 Acc 0.9089473684210526, AUC 0.9785472750663757, avg_entr 0.020479068160057068
ep0_t0.1_test_time 0.36078619956970215
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9496916666666667 (113963/120000), AUC 0.9930295348167419
ep1_train_time 14.768947839736938
Test Epoch1 threshold 0.1 Acc 0.9107894736842105, AUC 0.978275716304779, avg_entr 0.016471518203616142
ep1_t0.1_test_time 0.25647711753845215
gc 0
Train Epoch2 Acc 0.9512166666666667 (114146/120000), AUC 0.9933604598045349
ep2_train_time 16.28032112121582
Test Epoch2 threshold 0.1 Acc 0.9097368421052632, AUC 0.9782106876373291, avg_entr 0.014198478311300278
ep2_t0.1_test_time 0.2548813819885254
gc 0
Train Epoch3 Acc 0.9522333333333334 (114268/120000), AUC 0.9933577179908752
ep3_train_time 15.235632181167603
Test Epoch3 threshold 0.1 Acc 0.9076315789473685, AUC 0.9780983924865723, avg_entr 0.012276747263967991
ep3_t0.1_test_time 0.2548654079437256
gc 0
Train Epoch4 Acc 0.9534333333333334 (114412/120000), AUC 0.9938640594482422
ep4_train_time 19.897234201431274
Test Epoch4 threshold 0.1 Acc 0.9107894736842105, AUC 0.977911651134491, avg_entr 0.011947698891162872
ep4_t0.1_test_time 0.37573766708374023
gc 0
Train Epoch5 Acc 0.9554 (114648/120000), AUC 0.994498610496521
ep5_train_time 18.014003038406372
Test Epoch5 threshold 0.1 Acc 0.9092105263157895, AUC 0.9777159690856934, avg_entr 0.012840699404478073
ep5_t0.1_test_time 0.23673415184020996
gc 0
Train Epoch6 Acc 0.95605 (114726/120000), AUC 0.9947162866592407
ep6_train_time 14.374032020568848
Test Epoch6 threshold 0.1 Acc 0.9107894736842105, AUC 0.9777114391326904, avg_entr 0.01170180831104517
ep6_t0.1_test_time 0.2534644603729248
gc 0
Train Epoch7 Acc 0.9563416666666666 (114761/120000), AUC 0.994836151599884
ep7_train_time 14.353483438491821
Test Epoch7 threshold 0.1 Acc 0.9086842105263158, AUC 0.9776395559310913, avg_entr 0.011029927060008049
ep7_t0.1_test_time 0.25365352630615234
gc 0
Train Epoch8 Acc 0.9569666666666666 (114836/120000), AUC 0.994949996471405
ep8_train_time 17.256190538406372
Test Epoch8 threshold 0.1 Acc 0.9084210526315789, AUC 0.97735995054245, avg_entr 0.011085708625614643
ep8_t0.1_test_time 0.2509160041809082
gc 0
Train Epoch9 Acc 0.9578916666666667 (114947/120000), AUC 0.9952484965324402
ep9_train_time 18.293644905090332
Test Epoch9 threshold 0.1 Acc 0.9076315789473685, AUC 0.9774327278137207, avg_entr 0.011345499195158482
ep9_t0.1_test_time 0.36711955070495605
Best AUC 0.9785472750663757
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 172.45302200317383
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.1_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9205263157894736, AUC 0.9846420884132385, avg_entr 0.02061312273144722
t0.1_test_time 0.27149271965026855
