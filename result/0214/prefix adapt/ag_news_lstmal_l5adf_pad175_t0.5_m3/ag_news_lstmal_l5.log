total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad175_t0.5_m2//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 20.79012107849121
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.259575 (31149/120000), AUC 0.3374782204627991
ep0_train_time 68.50250005722046
Test Epoch0 threshold 0.5 Acc 0.9134210526315789, AUC 0.9791198968887329, avg_entr 0.026508105918765068
ep0_t0.5_test_time 0.17422008514404297
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.5_m3//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2617083333333333 (31405/120000), AUC 0.4094504117965698
ep1_train_time 68.43711447715759
Test Epoch1 threshold 0.5 Acc 0.9092105263157895, AUC 0.9787784218788147, avg_entr 0.027008138597011566
ep1_t0.5_test_time 0.1701352596282959
gc 0
Train Epoch2 Acc 0.2608 (31296/120000), AUC 0.4179335832595825
ep2_train_time 68.54203462600708
Test Epoch2 threshold 0.5 Acc 0.9134210526315789, AUC 0.9789499044418335, avg_entr 0.0267940666526556
ep2_t0.5_test_time 0.17987060546875
gc 0
Train Epoch3 Acc 0.25943333333333335 (31132/120000), AUC 0.4169609844684601
ep3_train_time 68.4856812953949
Test Epoch3 threshold 0.5 Acc 0.9113157894736842, AUC 0.9785751700401306, avg_entr 0.025815734639763832
ep3_t0.5_test_time 0.1771984100341797
gc 0
Train Epoch4 Acc 0.25885833333333336 (31063/120000), AUC 0.4161764979362488
ep4_train_time 68.59580850601196
Test Epoch4 threshold 0.5 Acc 0.9073684210526316, AUC 0.9783104658126831, avg_entr 0.02621074765920639
ep4_t0.5_test_time 0.1691434383392334
gc 0
Train Epoch5 Acc 0.2591583333333333 (31099/120000), AUC 0.4174591898918152
ep5_train_time 68.53933882713318
Test Epoch5 threshold 0.5 Acc 0.9107894736842105, AUC 0.9783193469047546, avg_entr 0.025857314467430115
ep5_t0.5_test_time 0.16978788375854492
gc 0
Train Epoch6 Acc 0.25969166666666665 (31163/120000), AUC 0.41654902696609497
ep6_train_time 68.5016930103302
Test Epoch6 threshold 0.5 Acc 0.9084210526315789, AUC 0.9781324863433838, avg_entr 0.025815309956669807
ep6_t0.5_test_time 0.1793205738067627
gc 0
Train Epoch7 Acc 0.25985833333333336 (31183/120000), AUC 0.41663041710853577
ep7_train_time 68.52717685699463
Test Epoch7 threshold 0.5 Acc 0.9110526315789473, AUC 0.9780613780021667, avg_entr 0.02548757940530777
ep7_t0.5_test_time 0.1689302921295166
gc 0
Train Epoch8 Acc 0.260125 (31215/120000), AUC 0.41725295782089233
ep8_train_time 68.57633328437805
Test Epoch8 threshold 0.5 Acc 0.9076315789473685, AUC 0.9779830574989319, avg_entr 0.025893203914165497
ep8_t0.5_test_time 0.1741483211517334
gc 0
Train Epoch9 Acc 0.26045 (31254/120000), AUC 0.4166118800640106
ep9_train_time 68.65462517738342
Test Epoch9 threshold 0.5 Acc 0.9105263157894737, AUC 0.978018045425415, avg_entr 0.02618573047220707
ep9_t0.5_test_time 0.17684626579284668
Best AUC 0.9791198968887329
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 687.9585831165314
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.5_m3//ag_news_lstmal_l5_prefix.pt
Test threshold 0.5 Acc 0.9231578947368421, AUC 0.984895646572113, avg_entr 0.025870855897665024
t0.5_test_time 0.17071938514709473
