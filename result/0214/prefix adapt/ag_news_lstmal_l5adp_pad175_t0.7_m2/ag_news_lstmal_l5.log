total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.7_m1//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 24.945136547088623
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.38695833333333335 (46435/120000), AUC 0.6920961141586304
ep0_train_time 59.56424808502197
Test Epoch0 threshold 0.7 Acc 0.9139473684210526, AUC 0.9790390729904175, avg_entr 0.028258653357625008
ep0_t0.7_test_time 0.2222139835357666
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.7_m2//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.463725 (55647/120000), AUC 0.6882085800170898
ep1_train_time 59.95350408554077
Test Epoch1 threshold 0.7 Acc 0.9123684210526316, AUC 0.9789298176765442, avg_entr 0.02815810590982437
ep1_t0.7_test_time 0.21838736534118652
gc 0
Train Epoch2 Acc 0.46255833333333335 (55507/120000), AUC 0.6861644983291626
ep2_train_time 59.72333788871765
Test Epoch2 threshold 0.7 Acc 0.9118421052631579, AUC 0.9787702560424805, avg_entr 0.027369830757379532
ep2_t0.7_test_time 0.2212231159210205
gc 0
Train Epoch3 Acc 0.46720833333333334 (56065/120000), AUC 0.6882722973823547
ep3_train_time 61.28943729400635
Test Epoch3 threshold 0.7 Acc 0.9110526315789473, AUC 0.9786216616630554, avg_entr 0.026394102722406387
ep3_t0.7_test_time 0.2969985008239746
gc 0
Train Epoch4 Acc 0.4690916666666667 (56291/120000), AUC 0.6799651384353638
ep4_train_time 61.082475662231445
Test Epoch4 threshold 0.7 Acc 0.9123684210526316, AUC 0.9787049293518066, avg_entr 0.026264794170856476
ep4_t0.7_test_time 0.3049285411834717
gc 0
Train Epoch5 Acc 0.47308333333333336 (56770/120000), AUC 0.6750258803367615
ep5_train_time 59.5285370349884
Test Epoch5 threshold 0.7 Acc 0.9113157894736842, AUC 0.9784007668495178, avg_entr 0.026411330327391624
ep5_t0.7_test_time 0.15972638130187988
gc 0
Train Epoch6 Acc 0.47613333333333335 (57136/120000), AUC 0.6726604700088501
ep6_train_time 58.853168964385986
Test Epoch6 threshold 0.7 Acc 0.9118421052631579, AUC 0.9783506393432617, avg_entr 0.02648521587252617
ep6_t0.7_test_time 0.2896761894226074
gc 0
Train Epoch7 Acc 0.478025 (57363/120000), AUC 0.6685818433761597
ep7_train_time 57.40834283828735
Test Epoch7 threshold 0.7 Acc 0.9107894736842105, AUC 0.9782078266143799, avg_entr 0.026336589828133583
ep7_t0.7_test_time 0.16077256202697754
gc 0
Train Epoch8 Acc 0.48018333333333335 (57622/120000), AUC 0.6650714874267578
ep8_train_time 56.380385637283325
Test Epoch8 threshold 0.7 Acc 0.91, AUC 0.9781397581100464, avg_entr 0.026798788458108902
ep8_t0.7_test_time 0.16045236587524414
gc 0
Train Epoch9 Acc 0.48194166666666666 (57833/120000), AUC 0.6634665727615356
ep9_train_time 56.372599363327026
Test Epoch9 threshold 0.7 Acc 0.9118421052631579, AUC 0.9780918955802917, avg_entr 0.02612077072262764
ep9_t0.7_test_time 0.15946698188781738
Best AUC 0.9790390729904175
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 593.317108631134
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.7_m2//ag_news_lstmal_l5_prefix.pt
Test threshold 0.7 Acc 0.9242105263157895, AUC 0.9850786924362183, avg_entr 0.028056953102350235
t0.7_test_time 0.15665316581726074
