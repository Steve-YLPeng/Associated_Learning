total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 23.394908666610718
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.24999166666666667 (29999/120000), AUC 0.44212302565574646
ep0_train_time 13.5059072971344
Test Epoch0 threshold 0.1 Acc 0.9084210526315789, AUC 0.9789867401123047, avg_entr 0.025295216590166092
ep0_t0.1_test_time 0.21415138244628906
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24991666666666668 (29990/120000), AUC 0.4437521696090698
ep1_train_time 14.694997072219849
Test Epoch1 threshold 0.1 Acc 0.9084210526315789, AUC 0.9789303541183472, avg_entr 0.02485552802681923
ep1_t0.1_test_time 0.31162023544311523
gc 0
Train Epoch2 Acc 0.249775 (29973/120000), AUC 0.44507911801338196
ep2_train_time 14.164855718612671
Test Epoch2 threshold 0.1 Acc 0.9086842105263158, AUC 0.9787025451660156, avg_entr 0.025370163843035698
ep2_t0.1_test_time 0.22678065299987793
gc 0
Train Epoch3 Acc 0.2496 (29952/120000), AUC 0.4540601372718811
ep3_train_time 11.894878387451172
Test Epoch3 threshold 0.1 Acc 0.9097368421052632, AUC 0.9785888195037842, avg_entr 0.024463869631290436
ep3_t0.1_test_time 0.22443151473999023
gc 0
Train Epoch4 Acc 0.24944166666666667 (29933/120000), AUC 0.4603874087333679
ep4_train_time 12.947735071182251
Test Epoch4 threshold 0.1 Acc 0.9107894736842105, AUC 0.9785756468772888, avg_entr 0.024975281208753586
ep4_t0.1_test_time 0.22605586051940918
gc 0
Train Epoch5 Acc 0.24918333333333334 (29902/120000), AUC 0.46235978603363037
ep5_train_time 11.464370727539062
Test Epoch5 threshold 0.1 Acc 0.9102631578947369, AUC 0.978383481502533, avg_entr 0.025730840861797333
ep5_t0.1_test_time 0.22423696517944336
gc 0
Train Epoch6 Acc 0.24885833333333332 (29863/120000), AUC 0.4630981683731079
ep6_train_time 13.91244912147522
Test Epoch6 threshold 0.1 Acc 0.9102631578947369, AUC 0.978196918964386, avg_entr 0.025472348555922508
ep6_t0.1_test_time 0.3031349182128906
gc 0
Train Epoch7 Acc 0.24859166666666666 (29831/120000), AUC 0.4637519419193268
ep7_train_time 14.137578248977661
Test Epoch7 threshold 0.1 Acc 0.9078947368421053, AUC 0.9780768156051636, avg_entr 0.024291783571243286
ep7_t0.1_test_time 0.3070852756500244
gc 0
Train Epoch8 Acc 0.24834166666666666 (29801/120000), AUC 0.464386522769928
ep8_train_time 12.999921083450317
Test Epoch8 threshold 0.1 Acc 0.91, AUC 0.9780334234237671, avg_entr 0.02520878240466118
ep8_t0.1_test_time 0.2899613380432129
gc 0
Train Epoch9 Acc 0.24793333333333334 (29752/120000), AUC 0.465036541223526
ep9_train_time 12.04341435432434
Test Epoch9 threshold 0.1 Acc 0.9078947368421053, AUC 0.9779793620109558, avg_entr 0.024580862373113632
ep9_t0.1_test_time 0.2246532440185547
Best AUC 0.9789867401123047
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 135.37810611724854
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.1_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9236842105263158, AUC 0.9847888946533203, avg_entr 0.02526908926665783
t0.1_test_time 0.22244501113891602
