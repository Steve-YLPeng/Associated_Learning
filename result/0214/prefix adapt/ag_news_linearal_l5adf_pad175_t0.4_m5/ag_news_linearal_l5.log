total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.4_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.93368124961853
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9095416666666667 (109145/120000), AUC 0.9835766553878784
ep0_train_time 10.510638236999512
Test Epoch0 threshold 0.4 Acc 0.9113157894736842, AUC 0.9787729382514954, avg_entr 0.025899682193994522
ep0_t0.4_test_time 0.1627824306488037
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9490666666666666 (113888/120000), AUC 0.9929322004318237
ep1_train_time 9.993977546691895
Test Epoch1 threshold 0.4 Acc 0.9110526315789473, AUC 0.978338897228241, avg_entr 0.025688672438263893
ep1_t0.4_test_time 0.16367816925048828
gc 0
Train Epoch2 Acc 0.9509416666666667 (114113/120000), AUC 0.9933037757873535
ep2_train_time 9.999032258987427
Test Epoch2 threshold 0.4 Acc 0.9107894736842105, AUC 0.9783879518508911, avg_entr 0.025482213124632835
ep2_t0.4_test_time 0.16446208953857422
gc 0
Train Epoch3 Acc 0.95155 (114186/120000), AUC 0.9935052394866943
ep3_train_time 10.068209171295166
Test Epoch3 threshold 0.4 Acc 0.91, AUC 0.9781329035758972, avg_entr 0.02541974000632763
ep3_t0.4_test_time 0.1627054214477539
gc 0
Train Epoch4 Acc 0.9527833333333333 (114334/120000), AUC 0.993804395198822
ep4_train_time 10.107156991958618
Test Epoch4 threshold 0.4 Acc 0.911578947368421, AUC 0.9780558347702026, avg_entr 0.025277171283960342
ep4_t0.4_test_time 0.16331195831298828
gc 0
Train Epoch5 Acc 0.9546916666666667 (114563/120000), AUC 0.9944761991500854
ep5_train_time 10.130478143692017
Test Epoch5 threshold 0.4 Acc 0.9110526315789473, AUC 0.9779316782951355, avg_entr 0.025437671691179276
ep5_t0.4_test_time 0.16246676445007324
gc 0
Train Epoch6 Acc 0.9551083333333333 (114613/120000), AUC 0.9946095943450928
ep6_train_time 10.105643272399902
Test Epoch6 threshold 0.4 Acc 0.9107894736842105, AUC 0.9778162240982056, avg_entr 0.025649068877100945
ep6_t0.4_test_time 0.16243886947631836
gc 0
Train Epoch7 Acc 0.9555583333333333 (114667/120000), AUC 0.9947237968444824
ep7_train_time 10.035209655761719
Test Epoch7 threshold 0.4 Acc 0.9084210526315789, AUC 0.9777196645736694, avg_entr 0.025496235117316246
ep7_t0.4_test_time 0.16238188743591309
gc 0
Train Epoch8 Acc 0.95605 (114726/120000), AUC 0.994896411895752
ep8_train_time 10.014862775802612
Test Epoch8 threshold 0.4 Acc 0.9105263157894737, AUC 0.9775858521461487, avg_entr 0.025975381955504417
ep8_t0.4_test_time 0.1625041961669922
gc 0
Train Epoch9 Acc 0.9568416666666667 (114821/120000), AUC 0.995180606842041
ep9_train_time 10.036364555358887
Test Epoch9 threshold 0.4 Acc 0.91, AUC 0.9775140285491943, avg_entr 0.025373712182044983
ep9_t0.4_test_time 0.16364264488220215
Best AUC 0.9787729382514954
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 103.36493921279907
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.4_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9221052631578948, AUC 0.9846409559249878, avg_entr 0.024910928681492805
t0.4_test_time 0.16398358345031738
