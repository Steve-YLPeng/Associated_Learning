total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.5_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.335479497909546
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9165583333333334 (109987/120000), AUC 0.9852678775787354
ep0_train_time 11.3829665184021
Test Epoch0 threshold 0.5 Acc 0.9097368421052632, AUC 0.9784838557243347, avg_entr 0.026322102174162865
ep0_t0.5_test_time 0.1694474220275879
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9507 (114084/120000), AUC 0.9932671189308167
ep1_train_time 10.922354221343994
Test Epoch1 threshold 0.5 Acc 0.9110526315789473, AUC 0.9783530831336975, avg_entr 0.025992460548877716
ep1_t0.5_test_time 0.16703534126281738
gc 0
Train Epoch2 Acc 0.9520583333333333 (114247/120000), AUC 0.9934655427932739
ep2_train_time 10.941405773162842
Test Epoch2 threshold 0.5 Acc 0.9084210526315789, AUC 0.9780846834182739, avg_entr 0.026705585420131683
ep2_t0.5_test_time 0.16623854637145996
gc 0
Train Epoch3 Acc 0.9529583333333334 (114355/120000), AUC 0.9937413930892944
ep3_train_time 10.859118938446045
Test Epoch3 threshold 0.5 Acc 0.9097368421052632, AUC 0.978050947189331, avg_entr 0.02681557647883892
ep3_t0.5_test_time 0.16608834266662598
gc 0
Train Epoch4 Acc 0.954275 (114513/120000), AUC 0.9941186904907227
ep4_train_time 10.931554317474365
Test Epoch4 threshold 0.5 Acc 0.9105263157894737, AUC 0.9778711795806885, avg_entr 0.02717474289238453
ep4_t0.5_test_time 0.16672921180725098
gc 0
Train Epoch5 Acc 0.9559416666666667 (114713/120000), AUC 0.9946378469467163
ep5_train_time 10.891225814819336
Test Epoch5 threshold 0.5 Acc 0.9097368421052632, AUC 0.9777849912643433, avg_entr 0.026386868208646774
ep5_t0.5_test_time 0.16595816612243652
gc 0
Train Epoch6 Acc 0.9562083333333333 (114745/120000), AUC 0.9948832988739014
ep6_train_time 10.880233764648438
Test Epoch6 threshold 0.5 Acc 0.9097368421052632, AUC 0.9777613878250122, avg_entr 0.027273984625935555
ep6_t0.5_test_time 0.16582846641540527
gc 0
Train Epoch7 Acc 0.9568083333333334 (114817/120000), AUC 0.9950342178344727
ep7_train_time 10.893489837646484
Test Epoch7 threshold 0.5 Acc 0.9105263157894737, AUC 0.9775993824005127, avg_entr 0.02694827876985073
ep7_t0.5_test_time 0.16902732849121094
gc 0
Train Epoch8 Acc 0.9569916666666667 (114839/120000), AUC 0.9951539039611816
ep8_train_time 11.014002561569214
Test Epoch8 threshold 0.5 Acc 0.9092105263157895, AUC 0.9774695634841919, avg_entr 0.026700334623456
ep8_t0.5_test_time 0.16585612297058105
gc 0
Train Epoch9 Acc 0.9582666666666667 (114992/120000), AUC 0.9953694343566895
ep9_train_time 10.93631362915039
Test Epoch9 threshold 0.5 Acc 0.9071052631578947, AUC 0.9773927927017212, avg_entr 0.025674378499388695
ep9_t0.5_test_time 0.166978120803833
Best AUC 0.9784838557243347
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 112.13531994819641
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.5_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9231578947368421, AUC 0.9846495389938354, avg_entr 0.025157783180475235
t0.5_test_time 0.16459202766418457
