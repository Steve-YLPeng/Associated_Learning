total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.3_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.44885754585266
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.23801666666666665 (28562/120000), AUC 0.5376931428909302
ep0_train_time 10.050639629364014
Test Epoch0 threshold 0.3 Acc 0.9134210526315789, AUC 0.9787784814834595, avg_entr 0.025882242247462273
ep0_t0.3_test_time 0.17257404327392578
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24128333333333332 (28954/120000), AUC 0.6152719259262085
ep1_train_time 9.671048402786255
Test Epoch1 threshold 0.3 Acc 0.9107894736842105, AUC 0.9785864949226379, avg_entr 0.025898940861225128
ep1_t0.3_test_time 0.16811513900756836
gc 0
Train Epoch2 Acc 0.2464 (29568/120000), AUC 0.6635373830795288
ep2_train_time 9.611577033996582
Test Epoch2 threshold 0.3 Acc 0.9092105263157895, AUC 0.9784395694732666, avg_entr 0.02522394061088562
ep2_t0.3_test_time 0.16789770126342773
gc 0
Train Epoch3 Acc 0.24960833333333332 (29953/120000), AUC 0.6737762689590454
ep3_train_time 9.62737250328064
Test Epoch3 threshold 0.3 Acc 0.9094736842105263, AUC 0.9782881736755371, avg_entr 0.026212992146611214
ep3_t0.3_test_time 0.16628193855285645
gc 0
Train Epoch4 Acc 0.281175 (33741/120000), AUC 0.6458021402359009
ep4_train_time 9.55450177192688
Test Epoch4 threshold 0.3 Acc 0.9092105263157895, AUC 0.9781659841537476, avg_entr 0.02522236853837967
ep4_t0.3_test_time 0.16588759422302246
gc 0
Train Epoch5 Acc 0.29894166666666666 (35873/120000), AUC 0.6318703293800354
ep5_train_time 9.679319143295288
Test Epoch5 threshold 0.3 Acc 0.9105263157894737, AUC 0.9781938791275024, avg_entr 0.025832580402493477
ep5_t0.3_test_time 0.1662447452545166
gc 0
Train Epoch6 Acc 0.296775 (35613/120000), AUC 0.6271619200706482
ep6_train_time 9.531049728393555
Test Epoch6 threshold 0.3 Acc 0.9078947368421053, AUC 0.9781172275543213, avg_entr 0.02521538734436035
ep6_t0.3_test_time 0.16704130172729492
gc 0
Train Epoch7 Acc 0.297075 (35649/120000), AUC 0.625189483165741
ep7_train_time 9.649282217025757
Test Epoch7 threshold 0.3 Acc 0.9071052631578947, AUC 0.9779409170150757, avg_entr 0.02509089931845665
ep7_t0.3_test_time 0.16608572006225586
gc 0
Train Epoch8 Acc 0.294875 (35385/120000), AUC 0.6225495338439941
ep8_train_time 9.673994064331055
Test Epoch8 threshold 0.3 Acc 0.9076315789473685, AUC 0.9778727293014526, avg_entr 0.025119531899690628
ep8_t0.3_test_time 0.1660170555114746
gc 0
Train Epoch9 Acc 0.29030833333333333 (34837/120000), AUC 0.6200137138366699
ep9_train_time 9.69070816040039
Test Epoch9 threshold 0.3 Acc 0.9084210526315789, AUC 0.9777430295944214, avg_entr 0.025049731135368347
ep9_t0.3_test_time 0.16626596450805664
Best AUC 0.9787784814834595
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 99.15102028846741
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.3_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.925, AUC 0.9847704172134399, avg_entr 0.02484508976340294
t0.3_test_time 0.1695268154144287
