total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.4986412525177
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24995 (29994/120000), AUC 0.4767819941043854
ep0_train_time 8.753851890563965
Test Epoch0 threshold 0.2 Acc 0.8942105263157895, AUC 0.970996618270874, avg_entr 0.1822700947523117
ep0_t0.2_test_time 0.16125845909118652
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.43367016315460205
ep1_train_time 8.233572244644165
Test Epoch1 threshold 0.2 Acc 0.9047368421052632, AUC 0.9753705859184265, avg_entr 0.10460074245929718
ep1_t0.2_test_time 0.15866637229919434
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.4232058525085449
ep2_train_time 8.071047306060791
Test Epoch2 threshold 0.2 Acc 0.9097368421052632, AUC 0.9772288203239441, avg_entr 0.08010358363389969
ep2_t0.2_test_time 0.15874910354614258
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.4183245301246643
ep3_train_time 8.01334285736084
Test Epoch3 threshold 0.2 Acc 0.9110526315789473, AUC 0.9781140685081482, avg_entr 0.07033777981996536
ep3_t0.2_test_time 0.15875673294067383
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.4150846004486084
ep4_train_time 8.140547037124634
Test Epoch4 threshold 0.2 Acc 0.9107894736842105, AUC 0.9785844683647156, avg_entr 0.060564979910850525
ep4_t0.2_test_time 0.15851736068725586
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.41195958852767944
ep5_train_time 8.040961503982544
Test Epoch5 threshold 0.2 Acc 0.9105263157894737, AUC 0.9787154197692871, avg_entr 0.0566658116877079
ep5_t0.2_test_time 0.15899395942687988
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.40907183289527893
ep6_train_time 7.982532978057861
Test Epoch6 threshold 0.2 Acc 0.9107894736842105, AUC 0.9787967205047607, avg_entr 0.05003279447555542
ep6_t0.2_test_time 0.15851378440856934
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.406711220741272
ep7_train_time 8.114804983139038
Test Epoch7 threshold 0.2 Acc 0.9123684210526316, AUC 0.9785627126693726, avg_entr 0.046223875135183334
ep7_t0.2_test_time 0.15903210639953613
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.4041123390197754
ep8_train_time 8.08865475654602
Test Epoch8 threshold 0.2 Acc 0.9121052631578948, AUC 0.9785304665565491, avg_entr 0.044475335627794266
ep8_t0.2_test_time 0.15949225425720215
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.40135467052459717
ep9_train_time 8.078166246414185
Test Epoch9 threshold 0.2 Acc 0.9105263157894737, AUC 0.978351354598999, avg_entr 0.04078485444188118
ep9_t0.2_test_time 0.15918636322021484
Best AUC 0.9787967205047607
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 84.2411584854126
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9236842105263158, AUC 0.9848981499671936, avg_entr 0.04955857992172241
t0.2_test_time 0.1589653491973877
