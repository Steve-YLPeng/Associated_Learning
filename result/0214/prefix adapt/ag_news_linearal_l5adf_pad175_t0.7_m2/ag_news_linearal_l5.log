total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.553497076034546
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.28928333333333334 (34714/120000), AUC 0.507827639579773
ep0_train_time 9.804869651794434
Test Epoch0 threshold 0.7 Acc 0.9102631578947369, AUC 0.979090690612793, avg_entr 0.02970714122056961
ep0_t0.7_test_time 0.17032456398010254
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.4288416666666667 (51461/120000), AUC 0.44488126039505005
ep1_train_time 9.53053617477417
Test Epoch1 threshold 0.7 Acc 0.9139473684210526, AUC 0.979110836982727, avg_entr 0.02725663036108017
ep1_t0.7_test_time 0.16820669174194336
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.40289166666666665 (48347/120000), AUC 0.4405812919139862
ep2_train_time 9.477728366851807
Test Epoch2 threshold 0.7 Acc 0.9089473684210526, AUC 0.9792196750640869, avg_entr 0.02868112176656723
ep2_t0.7_test_time 0.16916394233703613
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.42423333333333335 (50908/120000), AUC 0.4372429847717285
ep3_train_time 9.495607614517212
Test Epoch3 threshold 0.7 Acc 0.9123684210526316, AUC 0.9788514971733093, avg_entr 0.026661910116672516
ep3_t0.7_test_time 0.16858911514282227
gc 0
Train Epoch4 Acc 0.42063333333333336 (50476/120000), AUC 0.43207499384880066
ep4_train_time 9.495115041732788
Test Epoch4 threshold 0.7 Acc 0.9097368421052632, AUC 0.9785690903663635, avg_entr 0.026473665609955788
ep4_t0.7_test_time 0.17157578468322754
gc 0
Train Epoch5 Acc 0.40095 (48114/120000), AUC 0.42980459332466125
ep5_train_time 9.456255674362183
Test Epoch5 threshold 0.7 Acc 0.911578947368421, AUC 0.9784517288208008, avg_entr 0.025571290403604507
ep5_t0.7_test_time 0.16872334480285645
gc 0
Train Epoch6 Acc 0.3752083333333333 (45025/120000), AUC 0.42888742685317993
ep6_train_time 9.561864614486694
Test Epoch6 threshold 0.7 Acc 0.9102631578947369, AUC 0.9783776998519897, avg_entr 0.026255592703819275
ep6_t0.7_test_time 0.17154479026794434
gc 0
Train Epoch7 Acc 0.3581 (42972/120000), AUC 0.42746490240097046
ep7_train_time 9.524917602539062
Test Epoch7 threshold 0.7 Acc 0.9102631578947369, AUC 0.9782665967941284, avg_entr 0.02537943609058857
ep7_t0.7_test_time 0.16785860061645508
gc 0
Train Epoch8 Acc 0.34739166666666665 (41687/120000), AUC 0.4267579913139343
ep8_train_time 9.43927550315857
Test Epoch8 threshold 0.7 Acc 0.9089473684210526, AUC 0.9781439304351807, avg_entr 0.025625741109251976
ep8_t0.7_test_time 0.1687943935394287
gc 0
Train Epoch9 Acc 0.33818333333333334 (40582/120000), AUC 0.4262378215789795
ep9_train_time 9.60346269607544
Test Epoch9 threshold 0.7 Acc 0.9102631578947369, AUC 0.9780559539794922, avg_entr 0.02617591805756092
ep9_t0.7_test_time 0.16817665100097656
Best AUC 0.9792196750640869
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 98.01332879066467
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9223684210526316, AUC 0.9850032329559326, avg_entr 0.02741464599967003
t0.7_test_time 0.16742777824401855
