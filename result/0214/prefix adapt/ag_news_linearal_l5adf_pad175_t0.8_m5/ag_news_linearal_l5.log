total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.809224605560303
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9029416666666666 (108353/120000), AUC 0.9828987717628479
ep0_train_time 10.79843521118164
Test Epoch0 threshold 0.8 Acc 0.9105263157894737, AUC 0.9787561893463135, avg_entr 0.026425184682011604
ep0_t0.8_test_time 0.1635589599609375
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9488416666666667 (113861/120000), AUC 0.9928756952285767
ep1_train_time 10.259793758392334
Test Epoch1 threshold 0.8 Acc 0.9102631578947369, AUC 0.9783501625061035, avg_entr 0.02609195187687874
ep1_t0.8_test_time 0.16300439834594727
gc 0
Train Epoch2 Acc 0.9506416666666667 (114077/120000), AUC 0.9931104183197021
ep2_train_time 10.250773429870605
Test Epoch2 threshold 0.8 Acc 0.91, AUC 0.9784639477729797, avg_entr 0.026457853615283966
ep2_t0.8_test_time 0.16285920143127441
gc 0
Train Epoch3 Acc 0.9519416666666667 (114233/120000), AUC 0.9932482242584229
ep3_train_time 10.299298286437988
Test Epoch3 threshold 0.8 Acc 0.9102631578947369, AUC 0.9781904816627502, avg_entr 0.027374492958188057
ep3_t0.8_test_time 0.16312074661254883
gc 0
Train Epoch4 Acc 0.9528416666666667 (114341/120000), AUC 0.9937810897827148
ep4_train_time 10.236814975738525
Test Epoch4 threshold 0.8 Acc 0.9084210526315789, AUC 0.9780571460723877, avg_entr 0.027468757703900337
ep4_t0.8_test_time 0.16425490379333496
gc 0
Train Epoch5 Acc 0.9544416666666666 (114533/120000), AUC 0.9944608211517334
ep5_train_time 10.354385614395142
Test Epoch5 threshold 0.8 Acc 0.9097368421052632, AUC 0.9778326153755188, avg_entr 0.02607550099492073
ep5_t0.8_test_time 0.16232562065124512
gc 0
Train Epoch6 Acc 0.955375 (114645/120000), AUC 0.9946499466896057
ep6_train_time 10.411308526992798
Test Epoch6 threshold 0.8 Acc 0.9102631578947369, AUC 0.977803647518158, avg_entr 0.02549736201763153
ep6_t0.8_test_time 0.16271328926086426
gc 0
Train Epoch7 Acc 0.9555666666666667 (114668/120000), AUC 0.9947697520256042
ep7_train_time 10.28282904624939
Test Epoch7 threshold 0.8 Acc 0.9094736842105263, AUC 0.9776511192321777, avg_entr 0.02632513828575611
ep7_t0.8_test_time 0.16288995742797852
gc 0
Train Epoch8 Acc 0.9560583333333333 (114727/120000), AUC 0.9949291348457336
ep8_train_time 10.404087781906128
Test Epoch8 threshold 0.8 Acc 0.9097368421052632, AUC 0.9775806665420532, avg_entr 0.02565716579556465
ep8_t0.8_test_time 0.163102388381958
gc 0
Train Epoch9 Acc 0.957175 (114861/120000), AUC 0.9952273964881897
ep9_train_time 10.233878135681152
Test Epoch9 threshold 0.8 Acc 0.908157894736842, AUC 0.9774025678634644, avg_entr 0.02594507485628128
ep9_t0.8_test_time 0.16228151321411133
Best AUC 0.9787561893463135
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 105.89448666572571
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.8_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9231578947368421, AUC 0.9845455884933472, avg_entr 0.02557777613401413
t0.8_test_time 0.16025090217590332
