total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.7_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.03362274169922
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9040833333333333 (108490/120000), AUC 0.9854792952537537
ep0_train_time 11.20291256904602
Test Epoch0 threshold 0.7 Acc 0.9110526315789473, AUC 0.9785997867584229, avg_entr 0.026213878765702248
ep0_t0.7_test_time 0.16617035865783691
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9507833333333333 (114094/120000), AUC 0.9932935237884521
ep1_train_time 10.80032992362976
Test Epoch1 threshold 0.7 Acc 0.911578947368421, AUC 0.9785270094871521, avg_entr 0.02623060531914234
ep1_t0.7_test_time 0.16419005393981934
gc 0
Train Epoch2 Acc 0.9520333333333333 (114244/120000), AUC 0.9934287667274475
ep2_train_time 10.717160940170288
Test Epoch2 threshold 0.7 Acc 0.9113157894736842, AUC 0.9782514572143555, avg_entr 0.025754639878869057
ep2_t0.7_test_time 0.16542553901672363
gc 0
Train Epoch3 Acc 0.9527916666666667 (114335/120000), AUC 0.9933315515518188
ep3_train_time 10.72231149673462
Test Epoch3 threshold 0.7 Acc 0.9076315789473685, AUC 0.9781755805015564, avg_entr 0.025233807042241096
ep3_t0.7_test_time 0.16460371017456055
gc 0
Train Epoch4 Acc 0.954 (114480/120000), AUC 0.9938596487045288
ep4_train_time 10.74189305305481
Test Epoch4 threshold 0.7 Acc 0.9086842105263158, AUC 0.9780658483505249, avg_entr 0.026362115517258644
ep4_t0.7_test_time 0.164306640625
gc 0
Train Epoch5 Acc 0.9559666666666666 (114716/120000), AUC 0.9945110082626343
ep5_train_time 10.794257640838623
Test Epoch5 threshold 0.7 Acc 0.9092105263157895, AUC 0.9778410196304321, avg_entr 0.026137126609683037
ep5_t0.7_test_time 0.16492319107055664
gc 0
Train Epoch6 Acc 0.956475 (114777/120000), AUC 0.9946932792663574
ep6_train_time 10.755918741226196
Test Epoch6 threshold 0.7 Acc 0.9086842105263158, AUC 0.9777354598045349, avg_entr 0.02644447050988674
ep6_t0.7_test_time 0.1637578010559082
gc 0
Train Epoch7 Acc 0.9564416666666666 (114773/120000), AUC 0.9948803186416626
ep7_train_time 10.788680076599121
Test Epoch7 threshold 0.7 Acc 0.9060526315789473, AUC 0.9775987863540649, avg_entr 0.025873491540551186
ep7_t0.7_test_time 0.16411900520324707
gc 0
Train Epoch8 Acc 0.9569833333333333 (114838/120000), AUC 0.9950345754623413
ep8_train_time 10.799674272537231
Test Epoch8 threshold 0.7 Acc 0.9092105263157895, AUC 0.9775950908660889, avg_entr 0.025957776233553886
ep8_t0.7_test_time 0.16432595252990723
gc 0
Train Epoch9 Acc 0.957825 (114939/120000), AUC 0.9953145980834961
ep9_train_time 10.765813827514648
Test Epoch9 threshold 0.7 Acc 0.9073684210526316, AUC 0.9774752259254456, avg_entr 0.025325657799839973
ep9_t0.7_test_time 0.16630339622497559
Best AUC 0.9785997867584229
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 110.52587485313416
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.7_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9226315789473685, AUC 0.9845767021179199, avg_entr 0.025693479925394058
t0.7_test_time 0.1639997959136963
