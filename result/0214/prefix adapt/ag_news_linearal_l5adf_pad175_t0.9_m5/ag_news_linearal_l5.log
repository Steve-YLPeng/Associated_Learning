total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.9_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.007510900497437
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9065416666666667 (108785/120000), AUC 0.9857349395751953
ep0_train_time 10.68762755393982
Test Epoch0 threshold 0.9 Acc 0.9118421052631579, AUC 0.9785991907119751, avg_entr 0.02562008984386921
ep0_t0.9_test_time 0.16162729263305664
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.951225 (114147/120000), AUC 0.9934229850769043
ep1_train_time 10.138413667678833
Test Epoch1 threshold 0.9 Acc 0.9097368421052632, AUC 0.9784846305847168, avg_entr 0.027391262352466583
ep1_t0.9_test_time 0.15891051292419434
gc 0
Train Epoch2 Acc 0.9522333333333334 (114268/120000), AUC 0.9935153722763062
ep2_train_time 10.133294105529785
Test Epoch2 threshold 0.9 Acc 0.9102631578947369, AUC 0.9780080318450928, avg_entr 0.02580314688384533
ep2_t0.9_test_time 0.15880131721496582
gc 0
Train Epoch3 Acc 0.9531 (114372/120000), AUC 0.9936694502830505
ep3_train_time 10.155006408691406
Test Epoch3 threshold 0.9 Acc 0.911578947368421, AUC 0.9780606031417847, avg_entr 0.02622348628938198
ep3_t0.9_test_time 0.15976500511169434
gc 0
Train Epoch4 Acc 0.9543333333333334 (114520/120000), AUC 0.9939355850219727
ep4_train_time 10.28270959854126
Test Epoch4 threshold 0.9 Acc 0.9102631578947369, AUC 0.9776614904403687, avg_entr 0.025289524346590042
ep4_t0.9_test_time 0.16089248657226562
gc 0
Train Epoch5 Acc 0.9559 (114708/120000), AUC 0.9946384429931641
ep5_train_time 10.192014694213867
Test Epoch5 threshold 0.9 Acc 0.9107894736842105, AUC 0.9777628183364868, avg_entr 0.026553163304924965
ep5_t0.9_test_time 0.15990400314331055
gc 0
Train Epoch6 Acc 0.9565916666666666 (114791/120000), AUC 0.9947341680526733
ep6_train_time 10.198909044265747
Test Epoch6 threshold 0.9 Acc 0.9089473684210526, AUC 0.9775667786598206, avg_entr 0.02634962648153305
ep6_t0.9_test_time 0.16034340858459473
gc 0
Train Epoch7 Acc 0.9566583333333334 (114799/120000), AUC 0.9947263598442078
ep7_train_time 10.192596912384033
Test Epoch7 threshold 0.9 Acc 0.9089473684210526, AUC 0.9775420427322388, avg_entr 0.026305796578526497
ep7_t0.9_test_time 0.1596512794494629
gc 0
Train Epoch8 Acc 0.9572666666666667 (114872/120000), AUC 0.9949178695678711
ep8_train_time 10.160454750061035
Test Epoch8 threshold 0.9 Acc 0.9076315789473685, AUC 0.9774998426437378, avg_entr 0.02639775164425373
ep8_t0.9_test_time 0.15948915481567383
gc 0
Train Epoch9 Acc 0.9579083333333334 (114949/120000), AUC 0.9952314496040344
ep9_train_time 10.245678901672363
Test Epoch9 threshold 0.9 Acc 0.9063157894736842, AUC 0.9774530529975891, avg_entr 0.026252923533320427
ep9_t0.9_test_time 0.1605222225189209
Best AUC 0.9785991907119751
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 104.71847558021545
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.9_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9223684210526316, AUC 0.9844963550567627, avg_entr 0.024456340819597244
t0.9_test_time 0.15730524063110352
