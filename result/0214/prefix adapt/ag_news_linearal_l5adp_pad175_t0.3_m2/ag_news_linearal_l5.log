total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.012094020843506
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.24999166666666667 (29999/120000), AUC 0.383955180644989
ep0_train_time 9.125876426696777
Test Epoch0 threshold 0.3 Acc 0.9134210526315789, AUC 0.9792236089706421, avg_entr 0.027560513466596603
ep0_t0.3_test_time 0.16570019721984863
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24999166666666667 (29999/120000), AUC 0.3177909255027771
ep1_train_time 8.651609182357788
Test Epoch1 threshold 0.3 Acc 0.9128947368421053, AUC 0.9789916276931763, avg_entr 0.026607781648635864
ep1_t0.3_test_time 0.16474056243896484
gc 0
Train Epoch2 Acc 0.24999166666666667 (29999/120000), AUC 0.3200673758983612
ep2_train_time 8.778296947479248
Test Epoch2 threshold 0.3 Acc 0.911578947368421, AUC 0.9788700938224792, avg_entr 0.026741139590740204
ep2_t0.3_test_time 0.16545701026916504
gc 0
Train Epoch3 Acc 0.24999166666666667 (29999/120000), AUC 0.319100022315979
ep3_train_time 8.628288745880127
Test Epoch3 threshold 0.3 Acc 0.91, AUC 0.9784916639328003, avg_entr 0.02612091414630413
ep3_t0.3_test_time 0.16362333297729492
gc 0
Train Epoch4 Acc 0.24999166666666667 (29999/120000), AUC 0.3164159059524536
ep4_train_time 8.597827672958374
Test Epoch4 threshold 0.3 Acc 0.9118421052631579, AUC 0.9783349633216858, avg_entr 0.026787661015987396
ep4_t0.3_test_time 0.16458535194396973
gc 0
Train Epoch5 Acc 0.24999166666666667 (29999/120000), AUC 0.31521517038345337
ep5_train_time 8.631125450134277
Test Epoch5 threshold 0.3 Acc 0.9107894736842105, AUC 0.9783536791801453, avg_entr 0.02689324878156185
ep5_t0.3_test_time 0.16434860229492188
gc 0
Train Epoch6 Acc 0.24999166666666667 (29999/120000), AUC 0.31416749954223633
ep6_train_time 8.647501707077026
Test Epoch6 threshold 0.3 Acc 0.9094736842105263, AUC 0.978264570236206, avg_entr 0.026372920721769333
ep6_t0.3_test_time 0.1637125015258789
gc 0
Train Epoch7 Acc 0.24999166666666667 (29999/120000), AUC 0.31333449482917786
ep7_train_time 8.588742017745972
Test Epoch7 threshold 0.3 Acc 0.9102631578947369, AUC 0.9781453609466553, avg_entr 0.0260836873203516
ep7_t0.3_test_time 0.16403746604919434
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.312467098236084
ep8_train_time 8.78702163696289
Test Epoch8 threshold 0.3 Acc 0.9094736842105263, AUC 0.9781005382537842, avg_entr 0.026399357244372368
ep8_t0.3_test_time 0.16415119171142578
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.31149476766586304
ep9_train_time 8.558615446090698
Test Epoch9 threshold 0.3 Acc 0.9102631578947369, AUC 0.978014349937439, avg_entr 0.02612978033721447
ep9_t0.3_test_time 0.163618803024292
Best AUC 0.9792236089706421
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 89.377854347229
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.3_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9236842105263158, AUC 0.9849641919136047, avg_entr 0.026924217119812965
t0.3_test_time 0.16499710083007812
