total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.3_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.825426816940308
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.20565833333333333 (24679/120000), AUC 0.2940542697906494
ep0_train_time 9.536491870880127
Test Epoch0 threshold 0.3 Acc 0.9113157894736842, AUC 0.9789925813674927, avg_entr 0.02596791833639145
ep0_t0.3_test_time 0.16606950759887695
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.19005 (22806/120000), AUC 0.32728707790374756
ep1_train_time 9.15935468673706
Test Epoch1 threshold 0.3 Acc 0.9113157894736842, AUC 0.9788385629653931, avg_entr 0.026107585057616234
ep1_t0.3_test_time 0.1647803783416748
gc 0
Train Epoch2 Acc 0.18595 (22314/120000), AUC 0.3441055119037628
ep2_train_time 9.1075599193573
Test Epoch2 threshold 0.3 Acc 0.9118421052631579, AUC 0.9786406755447388, avg_entr 0.026502609252929688
ep2_t0.3_test_time 0.16672134399414062
gc 0
Train Epoch3 Acc 0.16830833333333334 (20197/120000), AUC 0.37428686022758484
ep3_train_time 8.937736988067627
Test Epoch3 threshold 0.3 Acc 0.9128947368421053, AUC 0.978657603263855, avg_entr 0.026436904445290565
ep3_t0.3_test_time 0.1652076244354248
gc 0
Train Epoch4 Acc 0.12681666666666666 (15218/120000), AUC 0.3472508192062378
ep4_train_time 9.077799558639526
Test Epoch4 threshold 0.3 Acc 0.9107894736842105, AUC 0.9784425497055054, avg_entr 0.026298291981220245
ep4_t0.3_test_time 0.16431474685668945
gc 0
Train Epoch5 Acc 0.051533333333333334 (6184/120000), AUC 0.3232594430446625
ep5_train_time 9.03025197982788
Test Epoch5 threshold 0.3 Acc 0.9105263157894737, AUC 0.9782143235206604, avg_entr 0.026305343955755234
ep5_t0.3_test_time 0.16402745246887207
gc 0
Train Epoch6 Acc 0.008441666666666667 (1013/120000), AUC 0.31515341997146606
ep6_train_time 9.107342958450317
Test Epoch6 threshold 0.3 Acc 0.9097368421052632, AUC 0.9781301617622375, avg_entr 0.026604119688272476
ep6_t0.3_test_time 0.16363167762756348
gc 0
Train Epoch7 Acc 0.004066666666666666 (488/120000), AUC 0.311654269695282
ep7_train_time 9.140280485153198
Test Epoch7 threshold 0.3 Acc 0.908157894736842, AUC 0.9780362844467163, avg_entr 0.025575749576091766
ep7_t0.3_test_time 0.16342616081237793
gc 0
Train Epoch8 Acc 0.0038083333333333333 (457/120000), AUC 0.3113905191421509
ep8_train_time 8.979674816131592
Test Epoch8 threshold 0.3 Acc 0.9097368421052632, AUC 0.9779708981513977, avg_entr 0.026299377903342247
ep8_t0.3_test_time 0.16345977783203125
gc 0
Train Epoch9 Acc 0.0037166666666666667 (446/120000), AUC 0.3119487762451172
ep9_train_time 9.082107067108154
Test Epoch9 threshold 0.3 Acc 0.9076315789473685, AUC 0.9778714179992676, avg_entr 0.026386547833681107
ep9_t0.3_test_time 0.16384053230285645
Best AUC 0.9789925813674927
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 93.53670454025269
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.3_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9234210526315789, AUC 0.9849067330360413, avg_entr 0.024630680680274963
t0.3_test_time 0.16446781158447266
