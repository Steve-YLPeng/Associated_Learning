total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.5063898563385
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.5342720746994019
ep0_train_time 8.726091146469116
Test Epoch0 threshold 0.3 Acc 0.8957894736842106, AUC 0.9718296527862549, avg_entr 0.18325428664684296
ep0_t0.3_test_time 0.1668400764465332
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.5612490773200989
ep1_train_time 8.210795640945435
Test Epoch1 threshold 0.3 Acc 0.9057894736842105, AUC 0.9760417342185974, avg_entr 0.10776861011981964
ep1_t0.3_test_time 0.16690707206726074
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.5590413808822632
ep2_train_time 8.328708171844482
Test Epoch2 threshold 0.3 Acc 0.9068421052631579, AUC 0.9774356484413147, avg_entr 0.08126988261938095
ep2_t0.3_test_time 0.16478538513183594
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.5540699362754822
ep3_train_time 8.288847208023071
Test Epoch3 threshold 0.3 Acc 0.9110526315789473, AUC 0.9782497882843018, avg_entr 0.06842193752527237
ep3_t0.3_test_time 0.16381072998046875
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.549787163734436
ep4_train_time 8.207751512527466
Test Epoch4 threshold 0.3 Acc 0.9078947368421053, AUC 0.9786631464958191, avg_entr 0.06167818233370781
ep4_t0.3_test_time 0.16479873657226562
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.5454681515693665
ep5_train_time 8.256861209869385
Test Epoch5 threshold 0.3 Acc 0.9126315789473685, AUC 0.978784441947937, avg_entr 0.05565725639462471
ep5_t0.3_test_time 0.166856050491333
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.5418242812156677
ep6_train_time 8.373439311981201
Test Epoch6 threshold 0.3 Acc 0.911578947368421, AUC 0.9788748025894165, avg_entr 0.050001490861177444
ep6_t0.3_test_time 0.16551923751831055
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.5380591154098511
ep7_train_time 8.203131675720215
Test Epoch7 threshold 0.3 Acc 0.9105263157894737, AUC 0.9788340926170349, avg_entr 0.04622982442378998
ep7_t0.3_test_time 0.16597962379455566
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.5352863073348999
ep8_train_time 8.355302095413208
Test Epoch8 threshold 0.3 Acc 0.9121052631578948, AUC 0.9786767959594727, avg_entr 0.045871153473854065
ep8_t0.3_test_time 0.16444659233093262
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.532420814037323
ep9_train_time 8.272513628005981
Test Epoch9 threshold 0.3 Acc 0.9113157894736842, AUC 0.9784963130950928, avg_entr 0.04091520607471466
ep9_t0.3_test_time 0.16576528549194336
Best AUC 0.9788748025894165
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 86.01959872245789
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9226315789473685, AUC 0.984769880771637, avg_entr 0.04922950640320778
t0.3_test_time 0.16264581680297852
