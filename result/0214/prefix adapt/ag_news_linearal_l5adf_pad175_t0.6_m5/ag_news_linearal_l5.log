total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.6_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.81305170059204
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9153583333333334 (109843/120000), AUC 0.9835084080696106
ep0_train_time 10.52352523803711
Test Epoch0 threshold 0.6 Acc 0.9118421052631579, AUC 0.9785726070404053, avg_entr 0.026050876826047897
ep0_t0.6_test_time 0.1629638671875
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9507166666666667 (114086/120000), AUC 0.9934148192405701
ep1_train_time 10.068398237228394
Test Epoch1 threshold 0.6 Acc 0.9121052631578948, AUC 0.9783366918563843, avg_entr 0.025906449183821678
ep1_t0.6_test_time 0.16060280799865723
gc 0
Train Epoch2 Acc 0.9514833333333333 (114178/120000), AUC 0.9935332536697388
ep2_train_time 10.070048332214355
Test Epoch2 threshold 0.6 Acc 0.9110526315789473, AUC 0.9781665802001953, avg_entr 0.02686576172709465
ep2_t0.6_test_time 0.15897178649902344
gc 0
Train Epoch3 Acc 0.9529666666666666 (114356/120000), AUC 0.9938569068908691
ep3_train_time 10.041805028915405
Test Epoch3 threshold 0.6 Acc 0.9094736842105263, AUC 0.9779833555221558, avg_entr 0.02572348527610302
ep3_t0.6_test_time 0.15973639488220215
gc 0
Train Epoch4 Acc 0.953775 (114453/120000), AUC 0.9941650629043579
ep4_train_time 10.097638845443726
Test Epoch4 threshold 0.6 Acc 0.9097368421052632, AUC 0.9778633117675781, avg_entr 0.027017895132303238
ep4_t0.6_test_time 0.15948915481567383
gc 0
Train Epoch5 Acc 0.9553916666666666 (114647/120000), AUC 0.9947583675384521
ep5_train_time 10.055742025375366
Test Epoch5 threshold 0.6 Acc 0.9076315789473685, AUC 0.9777518510818481, avg_entr 0.02533937618136406
ep5_t0.6_test_time 0.15913891792297363
gc 0
Train Epoch6 Acc 0.955875 (114705/120000), AUC 0.9948174953460693
ep6_train_time 10.12740683555603
Test Epoch6 threshold 0.6 Acc 0.9076315789473685, AUC 0.9776653051376343, avg_entr 0.025575002655386925
ep6_t0.6_test_time 0.15915489196777344
gc 0
Train Epoch7 Acc 0.9566583333333334 (114799/120000), AUC 0.9950088262557983
ep7_train_time 10.145201921463013
Test Epoch7 threshold 0.6 Acc 0.9107894736842105, AUC 0.9775870442390442, avg_entr 0.026163306087255478
ep7_t0.6_test_time 0.1599874496459961
gc 0
Train Epoch8 Acc 0.95685 (114822/120000), AUC 0.9950540661811829
ep8_train_time 10.099516868591309
Test Epoch8 threshold 0.6 Acc 0.9084210526315789, AUC 0.9775161743164062, avg_entr 0.025369582697749138
ep8_t0.6_test_time 0.15852785110473633
gc 0
Train Epoch9 Acc 0.957975 (114957/120000), AUC 0.9954482913017273
ep9_train_time 10.130675315856934
Test Epoch9 threshold 0.6 Acc 0.9094736842105263, AUC 0.9774296283721924, avg_entr 0.02622072771191597
ep9_t0.6_test_time 0.15850353240966797
Best AUC 0.9785726070404053
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 103.70018100738525
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.6_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9228947368421052, AUC 0.9846532344818115, avg_entr 0.025616630911827087
t0.6_test_time 0.15803289413452148
