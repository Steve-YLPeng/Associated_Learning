total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.353321313858032
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.24971666666666667 (29966/120000), AUC 0.7055141925811768
ep0_train_time 9.132310152053833
Test Epoch0 threshold 0.5 Acc 0.9126315789473685, AUC 0.9790152311325073, avg_entr 0.027831600978970528
ep0_t0.5_test_time 0.16354680061340332
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.29234166666666667 (35081/120000), AUC 0.8485532402992249
ep1_train_time 8.754391431808472
Test Epoch1 threshold 0.5 Acc 0.9118421052631579, AUC 0.9789690971374512, avg_entr 0.026698127388954163
ep1_t0.5_test_time 0.15961742401123047
gc 0
Train Epoch2 Acc 0.4064333333333333 (48772/120000), AUC 0.8636986017227173
ep2_train_time 8.685267210006714
Test Epoch2 threshold 0.5 Acc 0.9134210526315789, AUC 0.9787537455558777, avg_entr 0.025855302810668945
ep2_t0.5_test_time 0.16101384162902832
gc 0
Train Epoch3 Acc 0.4618333333333333 (55420/120000), AUC 0.8729538917541504
ep3_train_time 8.701832294464111
Test Epoch3 threshold 0.5 Acc 0.9113157894736842, AUC 0.9786350727081299, avg_entr 0.02723049372434616
ep3_t0.5_test_time 0.16070127487182617
gc 0
Train Epoch4 Acc 0.47355833333333336 (56827/120000), AUC 0.8794421553611755
ep4_train_time 8.72410249710083
Test Epoch4 threshold 0.5 Acc 0.9097368421052632, AUC 0.9783061146736145, avg_entr 0.025725362822413445
ep4_t0.5_test_time 0.16255807876586914
gc 0
Train Epoch5 Acc 0.4750083333333333 (57001/120000), AUC 0.8834093809127808
ep5_train_time 8.75930905342102
Test Epoch5 threshold 0.5 Acc 0.9113157894736842, AUC 0.9783233404159546, avg_entr 0.026011386886239052
ep5_t0.5_test_time 0.15938234329223633
gc 0
Train Epoch6 Acc 0.47515833333333335 (57019/120000), AUC 0.8843836188316345
ep6_train_time 8.747408628463745
Test Epoch6 threshold 0.5 Acc 0.9102631578947369, AUC 0.9782008528709412, avg_entr 0.02669675275683403
ep6_t0.5_test_time 0.16127920150756836
gc 0
Train Epoch7 Acc 0.47535 (57042/120000), AUC 0.8857294321060181
ep7_train_time 8.742128372192383
Test Epoch7 threshold 0.5 Acc 0.9092105263157895, AUC 0.9780780076980591, avg_entr 0.0263405479490757
ep7_t0.5_test_time 0.15983819961547852
gc 0
Train Epoch8 Acc 0.4758583333333333 (57103/120000), AUC 0.8866616487503052
ep8_train_time 8.839027404785156
Test Epoch8 threshold 0.5 Acc 0.9073684210526316, AUC 0.9778874516487122, avg_entr 0.026386212557554245
ep8_t0.5_test_time 0.1639413833618164
gc 0
Train Epoch9 Acc 0.476725 (57207/120000), AUC 0.8880793452262878
ep9_train_time 8.729215621948242
Test Epoch9 threshold 0.5 Acc 0.9102631578947369, AUC 0.97779381275177, avg_entr 0.025977039709687233
ep9_t0.5_test_time 0.16033363342285156
Best AUC 0.9790152311325073
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 90.16346955299377
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.5_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9223684210526316, AUC 0.9851245284080505, avg_entr 0.027356358245015144
t0.5_test_time 0.1588120460510254
