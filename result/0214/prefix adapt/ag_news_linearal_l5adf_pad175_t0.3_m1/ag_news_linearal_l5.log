total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.297144174575806
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.5179309844970703
ep0_train_time 8.49867868423462
Test Epoch0 threshold 0.3 Acc 0.8955263157894737, AUC 0.9708387851715088, avg_entr 0.18267659842967987
ep0_t0.3_test_time 0.16007161140441895
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.5268873572349548
ep1_train_time 8.017998695373535
Test Epoch1 threshold 0.3 Acc 0.9055263157894737, AUC 0.9754998683929443, avg_entr 0.10676192492246628
ep1_t0.3_test_time 0.15792012214660645
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.5281451940536499
ep2_train_time 8.129310846328735
Test Epoch2 threshold 0.3 Acc 0.9013157894736842, AUC 0.9770886898040771, avg_entr 0.08671461045742035
ep2_t0.3_test_time 0.15720486640930176
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.5286887884140015
ep3_train_time 8.055269718170166
Test Epoch3 threshold 0.3 Acc 0.9121052631578948, AUC 0.9779961109161377, avg_entr 0.06839830428361893
ep3_t0.3_test_time 0.15902471542358398
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.5292301177978516
ep4_train_time 8.037556886672974
Test Epoch4 threshold 0.3 Acc 0.9102631578947369, AUC 0.9784045815467834, avg_entr 0.060906000435352325
ep4_t0.3_test_time 0.1585080623626709
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.529373049736023
ep5_train_time 8.055760622024536
Test Epoch5 threshold 0.3 Acc 0.9107894736842105, AUC 0.978492796421051, avg_entr 0.05421294644474983
ep5_t0.3_test_time 0.15830397605895996
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.529312014579773
ep6_train_time 8.079530239105225
Test Epoch6 threshold 0.3 Acc 0.911578947368421, AUC 0.9786105155944824, avg_entr 0.04961751773953438
ep6_t0.3_test_time 0.15784811973571777
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.529306173324585
ep7_train_time 8.147670030593872
Test Epoch7 threshold 0.3 Acc 0.9102631578947369, AUC 0.978517472743988, avg_entr 0.047071538865566254
ep7_t0.3_test_time 0.15854716300964355
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.5294860601425171
ep8_train_time 8.008792638778687
Test Epoch8 threshold 0.3 Acc 0.91, AUC 0.9784790277481079, avg_entr 0.04367603361606598
ep8_t0.3_test_time 0.1581401824951172
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.5297951698303223
ep9_train_time 8.081278562545776
Test Epoch9 threshold 0.3 Acc 0.9105263157894737, AUC 0.9783095121383667, avg_entr 0.04049721732735634
ep9_t0.3_test_time 0.15703582763671875
Best AUC 0.9786105155944824
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 83.83920550346375
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9234210526315789, AUC 0.984761655330658, avg_entr 0.04848872497677803
t0.3_test_time 0.15778207778930664
