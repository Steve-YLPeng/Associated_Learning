total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.3_m2//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 20.082843542099
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.24589166666666668 (29507/120000), AUC 0.5330374240875244
ep0_train_time 67.1773591041565
Test Epoch0 threshold 0.3 Acc 0.9073684210526316, AUC 0.9788236618041992, avg_entr 0.022870725020766258
ep0_t0.3_test_time 0.22710871696472168
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.3_m3//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24658333333333332 (29590/120000), AUC 0.47484996914863586
ep1_train_time 67.14121222496033
Test Epoch1 threshold 0.3 Acc 0.9107894736842105, AUC 0.9787464141845703, avg_entr 0.023250559344887733
ep1_t0.3_test_time 0.23067688941955566
gc 0
Train Epoch2 Acc 0.24693333333333334 (29632/120000), AUC 0.4390619397163391
ep2_train_time 67.2324812412262
Test Epoch2 threshold 0.3 Acc 0.9097368421052632, AUC 0.9786683320999146, avg_entr 0.02201433666050434
ep2_t0.3_test_time 0.23438191413879395
gc 0
Train Epoch3 Acc 0.24728333333333333 (29674/120000), AUC 0.4005643129348755
ep3_train_time 67.20462799072266
Test Epoch3 threshold 0.3 Acc 0.9113157894736842, AUC 0.9784281253814697, avg_entr 0.02299707569181919
ep3_t0.3_test_time 0.22070646286010742
gc 0
Train Epoch4 Acc 0.248 (29760/120000), AUC 0.37743276357650757
ep4_train_time 67.20698833465576
Test Epoch4 threshold 0.3 Acc 0.9113157894736842, AUC 0.9780738353729248, avg_entr 0.023268641903996468
ep4_t0.3_test_time 0.22142577171325684
gc 0
Train Epoch5 Acc 0.248 (29760/120000), AUC 0.3708776831626892
ep5_train_time 67.22033381462097
Test Epoch5 threshold 0.3 Acc 0.9086842105263158, AUC 0.9781164526939392, avg_entr 0.023693669587373734
ep5_t0.3_test_time 0.21737933158874512
gc 0
Train Epoch6 Acc 0.24738333333333334 (29686/120000), AUC 0.37225234508514404
ep6_train_time 67.1568169593811
Test Epoch6 threshold 0.3 Acc 0.9105263157894737, AUC 0.9777962565422058, avg_entr 0.023031143471598625
ep6_t0.3_test_time 0.22116875648498535
gc 0
Train Epoch7 Acc 0.24623333333333333 (29548/120000), AUC 0.3689228296279907
ep7_train_time 67.07570934295654
Test Epoch7 threshold 0.3 Acc 0.9107894736842105, AUC 0.9777567386627197, avg_entr 0.023546019569039345
ep7_t0.3_test_time 0.21831226348876953
gc 0
Train Epoch8 Acc 0.24511666666666668 (29414/120000), AUC 0.3720654249191284
ep8_train_time 67.16397666931152
Test Epoch8 threshold 0.3 Acc 0.91, AUC 0.977755069732666, avg_entr 0.02335372567176819
ep8_t0.3_test_time 0.20938658714294434
gc 0
Train Epoch9 Acc 0.24475833333333333 (29371/120000), AUC 0.37041497230529785
ep9_train_time 67.10749292373657
Test Epoch9 threshold 0.3 Acc 0.9102631578947369, AUC 0.9775242805480957, avg_entr 0.02293229289352894
ep9_t0.3_test_time 0.21381497383117676
Best AUC 0.9788236618041992
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 674.6711223125458
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.3_m3//ag_news_lstmal_l5_prefix.pt
Test threshold 0.3 Acc 0.9247368421052632, AUC 0.984559953212738, avg_entr 0.02152971178293228
t0.3_test_time 0.23944330215454102
