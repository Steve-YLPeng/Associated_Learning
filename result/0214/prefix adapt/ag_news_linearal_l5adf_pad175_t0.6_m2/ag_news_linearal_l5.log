total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.00359582901001
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.253325 (30399/120000), AUC 0.4884074330329895
ep0_train_time 9.074676513671875
Test Epoch0 threshold 0.6 Acc 0.9102631578947369, AUC 0.9791207313537598, avg_entr 0.028288627043366432
ep0_t0.6_test_time 0.16321706771850586
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25001666666666666 (30002/120000), AUC 0.4794461727142334
ep1_train_time 8.675720930099487
Test Epoch1 threshold 0.6 Acc 0.911578947368421, AUC 0.9790880680084229, avg_entr 0.026721281930804253
ep1_t0.6_test_time 0.16257071495056152
gc 0
Train Epoch2 Acc 0.25000833333333333 (30001/120000), AUC 0.4857054352760315
ep2_train_time 8.759542226791382
Test Epoch2 threshold 0.6 Acc 0.9128947368421053, AUC 0.978933572769165, avg_entr 0.02636323682963848
ep2_t0.6_test_time 0.16141176223754883
gc 0
Train Epoch3 Acc 0.24999166666666667 (29999/120000), AUC 0.4894157946109772
ep3_train_time 8.803704738616943
Test Epoch3 threshold 0.6 Acc 0.9107894736842105, AUC 0.9787534475326538, avg_entr 0.025571079924702644
ep3_t0.6_test_time 0.163116455078125
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.49238476157188416
ep4_train_time 8.709184885025024
Test Epoch4 threshold 0.6 Acc 0.9084210526315789, AUC 0.9785245656967163, avg_entr 0.02656024508178234
ep4_t0.6_test_time 0.16400647163391113
gc 0
Train Epoch5 Acc 0.24999166666666667 (29999/120000), AUC 0.49369144439697266
ep5_train_time 8.790806770324707
Test Epoch5 threshold 0.6 Acc 0.9121052631578948, AUC 0.9784943461418152, avg_entr 0.025961419567465782
ep5_t0.6_test_time 0.16142559051513672
gc 0
Train Epoch6 Acc 0.24999166666666667 (29999/120000), AUC 0.49440711736679077
ep6_train_time 8.805145740509033
Test Epoch6 threshold 0.6 Acc 0.9128947368421053, AUC 0.9783316254615784, avg_entr 0.026630477979779243
ep6_t0.6_test_time 0.1626570224761963
gc 0
Train Epoch7 Acc 0.24999166666666667 (29999/120000), AUC 0.49522665143013
ep7_train_time 8.792480945587158
Test Epoch7 threshold 0.6 Acc 0.911578947368421, AUC 0.9781970977783203, avg_entr 0.026522239670157433
ep7_t0.6_test_time 0.16136765480041504
gc 0
Train Epoch8 Acc 0.24999166666666667 (29999/120000), AUC 0.49607324600219727
ep8_train_time 8.810432434082031
Test Epoch8 threshold 0.6 Acc 0.9105263157894737, AUC 0.9781219363212585, avg_entr 0.026177089661359787
ep8_t0.6_test_time 0.16228818893432617
gc 0
Train Epoch9 Acc 0.24999166666666667 (29999/120000), AUC 0.4968011677265167
ep9_train_time 8.75964617729187
Test Epoch9 threshold 0.6 Acc 0.9107894736842105, AUC 0.9780788421630859, avg_entr 0.026138238608837128
ep9_t0.6_test_time 0.16275930404663086
Best AUC 0.9791207313537598
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 90.33693170547485
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9244736842105263, AUC 0.9851627349853516, avg_entr 0.027795463800430298
t0.6_test_time 0.15997099876403809
