total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.2_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 22.309505939483643
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.199125 (23895/120000), AUC 0.5361727476119995
ep0_train_time 14.00150442123413
Test Epoch0 threshold 0.2 Acc 0.9134210526315789, AUC 0.9783896207809448, avg_entr 0.02407621406018734
ep0_t0.2_test_time 0.22705650329589844
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.2_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.023866666666666668 (2864/120000), AUC 0.4903508722782135
ep1_train_time 12.608983993530273
Test Epoch1 threshold 0.2 Acc 0.9113157894736842, AUC 0.9781869649887085, avg_entr 0.022567646577954292
ep1_t0.2_test_time 0.23396706581115723
gc 0
Train Epoch2 Acc 0.021416666666666667 (2570/120000), AUC 0.47590839862823486
ep2_train_time 12.490451335906982
Test Epoch2 threshold 0.2 Acc 0.9097368421052632, AUC 0.9780078530311584, avg_entr 0.021341601386666298
ep2_t0.2_test_time 0.2170557975769043
gc 0
Train Epoch3 Acc 0.0175 (2100/120000), AUC 0.4632326066493988
ep3_train_time 12.632436037063599
Test Epoch3 threshold 0.2 Acc 0.9097368421052632, AUC 0.9780380725860596, avg_entr 0.019758768379688263
ep3_t0.2_test_time 0.22553420066833496
gc 0
Train Epoch4 Acc 0.020691666666666667 (2483/120000), AUC 0.45228075981140137
ep4_train_time 14.427325963973999
Test Epoch4 threshold 0.2 Acc 0.9094736842105263, AUC 0.9774691462516785, avg_entr 0.01890498958528042
ep4_t0.2_test_time 0.22950506210327148
gc 0
Train Epoch5 Acc 0.02485 (2982/120000), AUC 0.4381216764450073
ep5_train_time 12.508571863174438
Test Epoch5 threshold 0.2 Acc 0.9073684210526316, AUC 0.9775574207305908, avg_entr 0.018280088901519775
ep5_t0.2_test_time 0.22764229774475098
gc 0
Train Epoch6 Acc 0.026208333333333333 (3145/120000), AUC 0.4245639741420746
ep6_train_time 13.213736057281494
Test Epoch6 threshold 0.2 Acc 0.9068421052631579, AUC 0.9772858023643494, avg_entr 0.017596755176782608
ep6_t0.2_test_time 0.23058009147644043
gc 0
Train Epoch7 Acc 0.026658333333333332 (3199/120000), AUC 0.409641832113266
ep7_train_time 12.808111906051636
Test Epoch7 threshold 0.2 Acc 0.9084210526315789, AUC 0.9773193001747131, avg_entr 0.017631372436881065
ep7_t0.2_test_time 0.22710800170898438
gc 0
Train Epoch8 Acc 0.026483333333333334 (3178/120000), AUC 0.39622142910957336
ep8_train_time 12.663327693939209
Test Epoch8 threshold 0.2 Acc 0.9089473684210526, AUC 0.9771525859832764, avg_entr 0.017170768231153488
ep8_t0.2_test_time 0.22912979125976562
gc 0
Train Epoch9 Acc 0.026208333333333333 (3145/120000), AUC 0.38813212513923645
ep9_train_time 12.490834712982178
Test Epoch9 threshold 0.2 Acc 0.9097368421052632, AUC 0.9771113991737366, avg_entr 0.016780275851488113
ep9_t0.2_test_time 0.2246840000152588
Best AUC 0.9783896207809448
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 133.09752249717712
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.2_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9223684210526316, AUC 0.984586775302887, avg_entr 0.023503195494413376
t0.2_test_time 0.22670984268188477
