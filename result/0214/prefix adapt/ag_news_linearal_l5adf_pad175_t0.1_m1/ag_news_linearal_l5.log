total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.306581258773804
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.5124808549880981
ep0_train_time 8.565553426742554
Test Epoch0 threshold 0.1 Acc 0.886578947368421, AUC 0.9717833995819092, avg_entr 0.1864270269870758
ep0_t0.1_test_time 0.16193485260009766
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.5678061246871948
ep1_train_time 8.12226414680481
Test Epoch1 threshold 0.1 Acc 0.9076315789473685, AUC 0.9761452674865723, avg_entr 0.10692593455314636
ep1_t0.1_test_time 0.1595444679260254
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.5793906450271606
ep2_train_time 8.103105545043945
Test Epoch2 threshold 0.1 Acc 0.9071052631578947, AUC 0.9777662754058838, avg_entr 0.08229093998670578
ep2_t0.1_test_time 0.16105079650878906
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.5774166584014893
ep3_train_time 8.097048044204712
Test Epoch3 threshold 0.1 Acc 0.9102631578947369, AUC 0.9786373376846313, avg_entr 0.06845439225435257
ep3_t0.1_test_time 0.1598985195159912
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.5725260972976685
ep4_train_time 8.178385496139526
Test Epoch4 threshold 0.1 Acc 0.911578947368421, AUC 0.9787335991859436, avg_entr 0.06058136746287346
ep4_t0.1_test_time 0.16020560264587402
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.5686302185058594
ep5_train_time 8.0443115234375
Test Epoch5 threshold 0.1 Acc 0.9071052631578947, AUC 0.9786720871925354, avg_entr 0.05717102065682411
ep5_t0.1_test_time 0.15983891487121582
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.5655142068862915
ep6_train_time 8.097661256790161
Test Epoch6 threshold 0.1 Acc 0.908157894736842, AUC 0.9789178371429443, avg_entr 0.05122511833906174
ep6_t0.1_test_time 0.1600019931793213
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.5617538094520569
ep7_train_time 8.095317602157593
Test Epoch7 threshold 0.1 Acc 0.9126315789473685, AUC 0.9788500666618347, avg_entr 0.04778699204325676
ep7_t0.1_test_time 0.1598351001739502
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.5590998530387878
ep8_train_time 8.063552141189575
Test Epoch8 threshold 0.1 Acc 0.9092105263157895, AUC 0.9788655042648315, avg_entr 0.04689545929431915
ep8_t0.1_test_time 0.1599140167236328
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.5565747022628784
ep9_train_time 8.05149507522583
Test Epoch9 threshold 0.1 Acc 0.9107894736842105, AUC 0.9786964058876038, avg_entr 0.04047054424881935
ep9_t0.1_test_time 0.15994906425476074
Best AUC 0.9789178371429443
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 84.09406471252441
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9234210526315789, AUC 0.9847688674926758, avg_entr 0.04948018863797188
t0.1_test_time 0.1582484245300293
