total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.217493772506714
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.23475833333333335 (28171/120000), AUC 0.4713817834854126
ep0_train_time 10.19534182548523
Test Epoch0 threshold 0.7 Acc 0.9092105263157895, AUC 0.9790202379226685, avg_entr 0.027025800198316574
ep0_t0.7_test_time 0.17043423652648926
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.17576666666666665 (21092/120000), AUC 0.4537971317768097
ep1_train_time 9.86483383178711
Test Epoch1 threshold 0.7 Acc 0.9121052631578948, AUC 0.9788145422935486, avg_entr 0.025705231353640556
ep1_t0.7_test_time 0.1696486473083496
gc 0
Train Epoch2 Acc 0.10453333333333334 (12544/120000), AUC 0.44307801127433777
ep2_train_time 9.806965112686157
Test Epoch2 threshold 0.7 Acc 0.911578947368421, AUC 0.9786844253540039, avg_entr 0.026115374639630318
ep2_t0.7_test_time 0.1699843406677246
gc 0
Train Epoch3 Acc 0.05085833333333333 (6103/120000), AUC 0.4165526330471039
ep3_train_time 9.768689393997192
Test Epoch3 threshold 0.7 Acc 0.9107894736842105, AUC 0.9784271717071533, avg_entr 0.0265856571495533
ep3_t0.7_test_time 0.16957426071166992
gc 0
Train Epoch4 Acc 0.03335 (4002/120000), AUC 0.3814719319343567
ep4_train_time 9.836902856826782
Test Epoch4 threshold 0.7 Acc 0.9071052631578947, AUC 0.9784327745437622, avg_entr 0.02600296400487423
ep4_t0.7_test_time 0.169722318649292
gc 0
Train Epoch5 Acc 0.03225833333333333 (3871/120000), AUC 0.35774266719818115
ep5_train_time 9.824497699737549
Test Epoch5 threshold 0.7 Acc 0.9105263157894737, AUC 0.9782328605651855, avg_entr 0.026301361620426178
ep5_t0.7_test_time 0.16981840133666992
gc 0
Train Epoch6 Acc 0.0447 (5364/120000), AUC 0.3465263247489929
ep6_train_time 9.78628396987915
Test Epoch6 threshold 0.7 Acc 0.91, AUC 0.9781292676925659, avg_entr 0.02653552033007145
ep6_t0.7_test_time 0.16959691047668457
gc 0
Train Epoch7 Acc 0.076825 (9219/120000), AUC 0.3380695879459381
ep7_train_time 9.880632877349854
Test Epoch7 threshold 0.7 Acc 0.9097368421052632, AUC 0.9779287576675415, avg_entr 0.027096832171082497
ep7_t0.7_test_time 0.16922378540039062
gc 0
Train Epoch8 Acc 0.11905 (14286/120000), AUC 0.3329401910305023
ep8_train_time 9.752635717391968
Test Epoch8 threshold 0.7 Acc 0.9097368421052632, AUC 0.9778770208358765, avg_entr 0.025697017088532448
ep8_t0.7_test_time 0.16977691650390625
gc 0
Train Epoch9 Acc 0.14995833333333333 (17995/120000), AUC 0.33114874362945557
ep9_train_time 9.860563039779663
Test Epoch9 threshold 0.7 Acc 0.9105263157894737, AUC 0.9778366684913635, avg_entr 0.02610040083527565
ep9_t0.7_test_time 0.16945171356201172
Best AUC 0.9790202379226685
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 101.06215476989746
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9236842105263158, AUC 0.984924852848053, avg_entr 0.025718240067362785
t0.7_test_time 0.16456151008605957
