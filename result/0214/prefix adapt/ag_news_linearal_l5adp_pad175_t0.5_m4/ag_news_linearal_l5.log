total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.5_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 20.290607690811157
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.37705833333333333 (45247/120000), AUC 0.556302011013031
ep0_train_time 10.097121715545654
Test Epoch0 threshold 0.5 Acc 0.9110526315789473, AUC 0.9786645174026489, avg_entr 0.026006100699305534
ep0_t0.5_test_time 0.1613626480102539
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.3138 (37656/120000), AUC 0.5572176575660706
ep1_train_time 9.655699491500854
Test Epoch1 threshold 0.5 Acc 0.911578947368421, AUC 0.9784663915634155, avg_entr 0.026423409581184387
ep1_t0.5_test_time 0.16124701499938965
gc 0
Train Epoch2 Acc 0.3456666666666667 (41480/120000), AUC 0.6439207792282104
ep2_train_time 9.666149377822876
Test Epoch2 threshold 0.5 Acc 0.9123684210526316, AUC 0.9784183502197266, avg_entr 0.025898640975356102
ep2_t0.5_test_time 0.1601274013519287
gc 0
Train Epoch3 Acc 0.37201666666666666 (44642/120000), AUC 0.6268492937088013
ep3_train_time 9.574289798736572
Test Epoch3 threshold 0.5 Acc 0.91, AUC 0.9782140254974365, avg_entr 0.02672647498548031
ep3_t0.5_test_time 0.1600027084350586
gc 0
Train Epoch4 Acc 0.4020666666666667 (48248/120000), AUC 0.5899088978767395
ep4_train_time 9.611284494400024
Test Epoch4 threshold 0.5 Acc 0.9084210526315789, AUC 0.9779783487319946, avg_entr 0.025743842124938965
ep4_t0.5_test_time 0.15899443626403809
gc 0
Train Epoch5 Acc 0.41254166666666664 (49505/120000), AUC 0.5717824101448059
ep5_train_time 9.618332386016846
Test Epoch5 threshold 0.5 Acc 0.9094736842105263, AUC 0.9779485464096069, avg_entr 0.026057016104459763
ep5_t0.5_test_time 0.15968704223632812
gc 0
Train Epoch6 Acc 0.407625 (48915/120000), AUC 0.5651106834411621
ep6_train_time 9.62616753578186
Test Epoch6 threshold 0.5 Acc 0.91, AUC 0.9778484106063843, avg_entr 0.026236824691295624
ep6_t0.5_test_time 0.15982365608215332
gc 0
Train Epoch7 Acc 0.3978333333333333 (47740/120000), AUC 0.5612818002700806
ep7_train_time 9.600531101226807
Test Epoch7 threshold 0.5 Acc 0.9097368421052632, AUC 0.9778492450714111, avg_entr 0.02612188272178173
ep7_t0.5_test_time 0.15973567962646484
gc 0
Train Epoch8 Acc 0.37933333333333336 (45520/120000), AUC 0.5584344863891602
ep8_train_time 9.71006155014038
Test Epoch8 threshold 0.5 Acc 0.9089473684210526, AUC 0.9776885509490967, avg_entr 0.02651141956448555
ep8_t0.5_test_time 0.16053533554077148
gc 0
Train Epoch9 Acc 0.3544083333333333 (42529/120000), AUC 0.5562421083450317
ep9_train_time 9.622071743011475
Test Epoch9 threshold 0.5 Acc 0.9086842105263158, AUC 0.9776178598403931, avg_entr 0.025931693613529205
ep9_t0.5_test_time 0.15989160537719727
Best AUC 0.9786645174026489
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 99.10536241531372
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.5_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9236842105263158, AUC 0.9847443103790283, avg_entr 0.025134321302175522
t0.5_test_time 0.15875029563903809
