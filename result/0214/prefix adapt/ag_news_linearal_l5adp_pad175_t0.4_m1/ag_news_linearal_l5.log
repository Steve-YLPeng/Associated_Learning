total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.610132217407227
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24995 (29994/120000), AUC 0.4798946976661682
ep0_train_time 8.563923120498657
Test Epoch0 threshold 0.4 Acc 0.895, AUC 0.970706045627594, avg_entr 0.18551984429359436
ep0_t0.4_test_time 0.15992999076843262
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.4453606605529785
ep1_train_time 8.061965703964233
Test Epoch1 threshold 0.4 Acc 0.9057894736842105, AUC 0.9755645990371704, avg_entr 0.10761283338069916
ep1_t0.4_test_time 0.15743350982666016
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.44527965784072876
ep2_train_time 8.071127653121948
Test Epoch2 threshold 0.4 Acc 0.9092105263157895, AUC 0.9772720336914062, avg_entr 0.08127441257238388
ep2_t0.4_test_time 0.15793418884277344
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.4482254981994629
ep3_train_time 8.075507640838623
Test Epoch3 threshold 0.4 Acc 0.9089473684210526, AUC 0.9781374931335449, avg_entr 0.07020323723554611
ep3_t0.4_test_time 0.15782713890075684
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.45150426030158997
ep4_train_time 8.073399305343628
Test Epoch4 threshold 0.4 Acc 0.9084210526315789, AUC 0.9786404371261597, avg_entr 0.06188233941793442
ep4_t0.4_test_time 0.15907788276672363
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.4549126625061035
ep5_train_time 8.265964984893799
Test Epoch5 threshold 0.4 Acc 0.91, AUC 0.9786428213119507, avg_entr 0.053751878440380096
ep5_t0.4_test_time 0.15791034698486328
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.458074152469635
ep6_train_time 8.129685163497925
Test Epoch6 threshold 0.4 Acc 0.9102631578947369, AUC 0.9786794185638428, avg_entr 0.050977922976017
ep6_t0.4_test_time 0.159454345703125
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.4603089690208435
ep7_train_time 8.153693675994873
Test Epoch7 threshold 0.4 Acc 0.9071052631578947, AUC 0.9786874651908875, avg_entr 0.04742167145013809
ep7_t0.4_test_time 0.15823674201965332
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.46259066462516785
ep8_train_time 8.11562466621399
Test Epoch8 threshold 0.4 Acc 0.9097368421052632, AUC 0.978537917137146, avg_entr 0.044553909450769424
ep8_t0.4_test_time 0.15841984748840332
gc 0
Train Epoch9 Acc 0.24999166666666667 (29999/120000), AUC 0.463541179895401
ep9_train_time 8.129102945327759
Test Epoch9 threshold 0.4 Acc 0.9113157894736842, AUC 0.9785322546958923, avg_entr 0.04225444421172142
ep9_t0.4_test_time 0.158738374710083
Best AUC 0.9786874651908875
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 84.42376708984375
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9236842105263158, AUC 0.9847004413604736, avg_entr 0.04632062837481499
t0.4_test_time 0.15700602531433105
