total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.4_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.25315 (30378/120000), AUC 0.4640558362007141
ep0_train_time 9.887676000595093
Test Epoch0 threshold 0.4 Acc 0.915296052631579, AUC 0.9807180762290955, avg_entr 0.024945633485913277
ep0_t0.4_test_time 0.2582070827484131
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.41184088587760925
ep1_train_time 9.452017545700073
Test Epoch1 threshold 0.4 Acc 0.9159539473684211, AUC 0.9806917905807495, avg_entr 0.025613505393266678
ep1_t0.4_test_time 0.2579801082611084
gc 0
Train Epoch2 Acc 0.24264166666666667 (29117/120000), AUC 0.3463784158229828
ep2_train_time 9.469340562820435
Test Epoch2 threshold 0.4 Acc 0.9120065789473685, AUC 0.9804174900054932, avg_entr 0.02508784644305706
ep2_t0.4_test_time 0.255260705947876
gc 0
Train Epoch3 Acc 0.12085 (14502/120000), AUC 0.31350183486938477
ep3_train_time 9.661991834640503
Test Epoch3 threshold 0.4 Acc 0.9141447368421053, AUC 0.9803870916366577, avg_entr 0.025081142783164978
ep3_t0.4_test_time 0.25795459747314453
gc 0
Train Epoch4 Acc 0.06328333333333333 (7594/120000), AUC 0.290590763092041
ep4_train_time 9.458430528640747
Test Epoch4 threshold 0.4 Acc 0.9139802631578947, AUC 0.9802455902099609, avg_entr 0.024932360276579857
ep4_t0.4_test_time 0.25619935989379883
gc 0
Train Epoch5 Acc 0.06458333333333334 (7750/120000), AUC 0.2609512209892273
ep5_train_time 9.617002964019775
Test Epoch5 threshold 0.4 Acc 0.9148026315789474, AUC 0.9800275564193726, avg_entr 0.025377564132213593
ep5_t0.4_test_time 0.25641608238220215
gc 0
Train Epoch6 Acc 0.07175 (8610/120000), AUC 0.24900680780410767
ep6_train_time 9.503227233886719
Test Epoch6 threshold 0.4 Acc 0.9134868421052632, AUC 0.9799965620040894, avg_entr 0.024857299402356148
ep6_t0.4_test_time 0.2553529739379883
gc 0
Train Epoch7 Acc 0.07866666666666666 (9440/120000), AUC 0.240144744515419
ep7_train_time 9.512725353240967
Test Epoch7 threshold 0.4 Acc 0.9131578947368421, AUC 0.9798118472099304, avg_entr 0.026204325258731842
ep7_t0.4_test_time 0.2546510696411133
gc 0
Train Epoch8 Acc 0.08260833333333334 (9913/120000), AUC 0.23762552440166473
ep8_train_time 9.368635654449463
Test Epoch8 threshold 0.4 Acc 0.9129934210526316, AUC 0.9797548055648804, avg_entr 0.025886470451951027
ep8_t0.4_test_time 0.2547731399536133
gc 0
Train Epoch9 Acc 0.08785833333333333 (10543/120000), AUC 0.236685648560524
ep9_train_time 9.445372104644775
Test Epoch9 threshold 0.4 Acc 0.9121710526315789, AUC 0.9797042012214661, avg_entr 0.026710400357842445
ep9_t0.4_test_time 0.2577338218688965
Best AUC 0.9807180762290955
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.4_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9236842105263158, AUC 0.9860612154006958, avg_entr 0.02456751838326454
t0.4_test_time 0.06613278388977051
