total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.6_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.407075 (48849/120000), AUC 0.5670254826545715
ep0_train_time 5.630556583404541
Test Epoch0 threshold 0.6 Acc 0.9121710526315789, AUC 0.9809974431991577, avg_entr 0.02589862048625946
ep0_t0.6_test_time 0.07433152198791504
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.6_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.3496416666666667 (41957/120000), AUC 0.5130435824394226
ep1_train_time 5.196874380111694
Test Epoch1 threshold 0.6 Acc 0.9125, AUC 0.9809359312057495, avg_entr 0.024633653461933136
ep1_t0.6_test_time 0.07302427291870117
gc 0
Train Epoch2 Acc 0.3219 (38628/120000), AUC 0.4398578107357025
ep2_train_time 5.196642875671387
Test Epoch2 threshold 0.6 Acc 0.9129934210526316, AUC 0.980790913105011, avg_entr 0.025247521698474884
ep2_t0.6_test_time 0.0711965560913086
gc 0
Train Epoch3 Acc 0.2930833333333333 (35170/120000), AUC 0.42411935329437256
ep3_train_time 5.053229570388794
Test Epoch3 threshold 0.6 Acc 0.9100328947368421, AUC 0.9800724983215332, avg_entr 0.024811608716845512
ep3_t0.6_test_time 0.07095885276794434
gc 0
Train Epoch4 Acc 0.236125 (28335/120000), AUC 0.43660321831703186
ep4_train_time 5.0592803955078125
Test Epoch4 threshold 0.6 Acc 0.9120065789473685, AUC 0.979925274848938, avg_entr 0.024828946217894554
ep4_t0.6_test_time 0.07148480415344238
gc 0
Train Epoch5 Acc 0.1792 (21504/120000), AUC 0.4505774676799774
ep5_train_time 5.0353405475616455
Test Epoch5 threshold 0.6 Acc 0.9101973684210526, AUC 0.9796186089515686, avg_entr 0.02469872497022152
ep5_t0.6_test_time 0.07197046279907227
gc 0
Train Epoch6 Acc 0.16008333333333333 (19210/120000), AUC 0.4579578638076782
ep6_train_time 4.907787799835205
Test Epoch6 threshold 0.6 Acc 0.9092105263157895, AUC 0.979607880115509, avg_entr 0.024944545701146126
ep6_t0.6_test_time 0.07536697387695312
gc 0
Train Epoch7 Acc 0.15710833333333332 (18853/120000), AUC 0.4622318744659424
ep7_train_time 4.952776193618774
Test Epoch7 threshold 0.6 Acc 0.9100328947368421, AUC 0.9793330430984497, avg_entr 0.024551663547754288
ep7_t0.6_test_time 0.07252764701843262
gc 0
Train Epoch8 Acc 0.17016666666666666 (20420/120000), AUC 0.4653008282184601
ep8_train_time 5.0266828536987305
Test Epoch8 threshold 0.6 Acc 0.9087171052631579, AUC 0.9790239334106445, avg_entr 0.024655994027853012
ep8_t0.6_test_time 0.07102847099304199
gc 0
Train Epoch9 Acc 0.1835 (22020/120000), AUC 0.46718451380729675
ep9_train_time 5.093712568283081
Test Epoch9 threshold 0.6 Acc 0.909375, AUC 0.9789230823516846, avg_entr 0.0253126323223114
ep9_t0.6_test_time 0.07205510139465332
Best AUC 0.9809974431991577
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.6_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9210526315789473, AUC 0.9860633015632629, avg_entr 0.0276603065431118
t0.6_test_time 0.018781661987304688
